!function(E){function M(ne,se,le){return 4===arguments.length?A.apply(this,arguments):void R(ne,{declarative:!0,deps:se,declare:le})}function A(ne,se,le,pe){R(ne,{declarative:!1,deps:se,executingRequire:le,execute:pe})}function R(ne,se){se.name=ne,ne in K||(K[ne]=se),se.normalizedDeps=se.deps}function C(ne,se){if(se[ne.groupIndex]=se[ne.groupIndex]||[],-1==Q.call(se[ne.groupIndex],ne)){se[ne.groupIndex].push(ne);for(var le=0,pe=ne.normalizedDeps.length;pe>le;le++){var ue=ne.normalizedDeps[le],fe=K[ue];if(fe&&!fe.evaluated){var ge=ne.groupIndex+(fe.declarative!=ne.declarative);if(void 0===fe.groupIndex||fe.groupIndex<ge){if(void 0!==fe.groupIndex&&(se[fe.groupIndex].splice(Q.call(se[fe.groupIndex],fe),1),0==se[fe.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");fe.groupIndex=ge}C(fe,se)}}}}function G(ne){var se=K[ne];se.groupIndex=0;var le=[];C(se,le);for(var pe=!!se.declarative==le.length%2,ue=le.length-1;0<=ue;ue--){for(var fe=le[ue],ge=0;ge<fe.length;ge++){var he=fe[ge];pe?H(he):V(he)}pe=!pe}}function F(ne){return ee[ne]||(ee[ne]={name:ne,dependencies:[],exports:{},importers:[]})}function H(ne){if(!ne.module){var se=ne.module=F(ne.name),le=ne.module.exports,pe=ne.declare.call(E,function(Te,ve){if(se.locked=!0,"object"==typeof Te)for(var Se in Te)le[Se]=Te[Se];else le[Te]=ve;for(var Ee=0,Me=se.importers.length;Me>Ee;Ee++){var Ae=se.importers[Ee];if(!Ae.locked)for(var Pe=0;Pe<Ae.dependencies.length;++Pe)Ae.dependencies[Pe]===se&&Ae.setters[Pe](le)}return se.locked=!1,ve},{id:ne.name});se.setters=pe.setters,se.execute=pe.execute;for(var ue=0,fe=ne.normalizedDeps.length;fe>ue;ue++){var he=ne.normalizedDeps[ue],ye=K[he],xe=ee[he],ge;xe?ge=xe.exports:ye&&!ye.declarative?ge=ye.esModule:ye?(H(ye),xe=ye.module,ge=xe.exports):ge=Z(he),xe&&xe.importers?(xe.importers.push(se),se.dependencies.push(xe)):se.dependencies.push(null),se.setters[ue]&&se.setters[ue](ge)}}}function O(ne){var le=K[ne],se;if(le)le.declarative?Y(ne,[]):le.evaluated||V(le),se=le.module.exports;else if(se=Z(ne),!se)throw new Error("Unable to load dependency "+ne+".");return(!le||le.declarative)&&se&&se.__useDefault?se["default"]:se}function V(ne){if(!ne.module){var se={},le=ne.module={exports:se,id:ne.name};if(!ne.executingRequire)for(var pe=0,ue=ne.normalizedDeps.length;ue>pe;pe++){var fe=ne.normalizedDeps[pe],ge=K[fe];ge&&V(ge)}ne.evaluated=!0;var he=ne.execute.call(E,function(ye){for(var xe=0,Te=ne.deps.length;Te>xe;xe++)if(ne.deps[xe]==ye)return O(ne.normalizedDeps[xe]);throw new TypeError("Module "+ye+" not declared as a dependency.")},se,le);void 0!==typeof he&&(le.exports=he),se=le.exports,ne.esModule=se&&se.__esModule?se:W(se)}}function W(ne){var se={};if(("object"==typeof ne||"function"==typeof ne)&&ne!==E)if(J)for(var le in ne)"default"!==le&&X(se,ne,le);else{var pe=ne&&ne.hasOwnProperty;for(var le in ne)"default"===le||pe&&!ne.hasOwnProperty(le)||(se[le]=ne[le])}return se["default"]=ne,$(se,"__useDefault",{value:!0}),se}function X(ne,se,le){try{var pe;(pe=Object.getOwnPropertyDescriptor(se,le))&&$(ne,le,pe)}catch(ue){return ne[le]=se[le],!1}}function Y(ne,se){var le=K[ne];if(le&&!le.evaluated&&le.declarative){se.push(ne);for(var pe=0,ue=le.normalizedDeps.length;ue>pe;pe++){var fe=le.normalizedDeps[pe];-1==Q.call(se,fe)&&(K[fe]?Y(fe,se):Z(fe))}le.evaluated||(le.evaluated=!0,le.module.execute.call(E))}}function Z(ne){if(ie[ne])return ie[ne];if("@node/"==ne.substr(0,6))return ie[ne]=W(oe(ne.substr(6)));var se=K[ne];if(!se)throw"Module "+ne+" not present.";return G(ne),Y(ne,[]),K[ne]=void 0,se.declarative&&$(se.module.exports,"__esModule",{value:!0}),ie[ne]=se.declarative?se.module.exports:se.esModule}var K={},Q=Array.prototype.indexOf||function(ne){for(var se=0,le=this.length;le>se;se++)if(this[se]===ne)return se;return-1},J=!0;try{Object.getOwnPropertyDescriptor({a:0},"a")}catch(ne){J=!1}var $;!function(){try{Object.defineProperty({},"a",{})&&($=Object.defineProperty)}catch(ne){$=function(se,le,pe){try{se[le]=pe.value||pe.get.call(se)}catch(ue){}}}}();var ee={},oe="undefined"!=typeof System&&System._nodeRequire||"undefined"!=typeof require&&require.resolve&&"undefined"!=typeof process&&require,ie={"@empty":{}};return function(ne,se,le,pe){return function(ue){ue(function(){for(var fe={_nodeRequire:oe,register:M,registerDynamic:A,get:Z,set:function(ye,xe){ie[ye]=xe},newModule:function(ye){return ye}},ge=0;ge<se.length;ge++)(function(ye,xe){ie[ye]=xe&&xe.__esModule?xe:W(xe)})(se[ge],arguments[ge]);pe(fe);var he=Z(ne[0]);if(1<ne.length)for(var ge=1;ge<ne.length;ge++)Z(ne[ge]);return le?he["default"]:he})}}}("undefined"==typeof self?global:self)(["1"],[],!1,function(E){var M=this.require,A=this.exports,R=this.module;!function(C){function G(K,Q){for(var J=K.split(".");J.length;)Q=Q[J.shift()];return Q}function F(K){if("string"==typeof K)return G(K,C);if(!(K instanceof Array))throw new Error("Global exports must be a string or array.");for(var Q={},J=!0,$=0;$<K.length;$++){var ee=G(K[$],C);J&&(Q["default"]=ee,J=!1),Q[K[$].split(".").pop()]=ee}return Q}function H(K){if(Object.keys)Object.keys(C).forEach(K);else for(var Q in C)X.call(C,Q)&&K(Q)}function O(K){H(function(Q){if(-1==Y.call(Z,Q)){try{var J=C[Q]}catch($){Z.push(Q)}K(Q,J)}})}var W=E,X=Object.prototype.hasOwnProperty,Y=Array.prototype.indexOf||function(K){for(var Q=0,J=this.length;J>Q;Q++)if(this[Q]===K)return Q;return-1},Z=["_g","sessionStorage","localStorage","clipboardData","frames","frameElement","external","mozAnimationStartTime","webkitStorageInfo","webkitIndexedDB","mozInnerScreenY","mozInnerScreenX"],V;W.set("@@global-helpers",W.newModule({prepareGlobal:function(K,Q,J){var $=C.define;C.define=void 0;var ee;if(J)for(var oe in ee={},J)ee[oe]=C[oe],C[oe]=J[oe];return Q||(V={},O(function(ie,ne){V[ie]=ne})),function(){var ie;if(Q)ie=F(Q);else{ie={};var ne,se;O(function(pe,ue){V[pe]!==ue&&"undefined"!=typeof ue&&(ie[pe]=ue,"undefined"==typeof ne?ne=ue:se||ne===ue||(se=!0))}),ie=se?ie:ne}if(ee)for(var le in ee)C[le]=ee[le];return C.define=$,ie}}}))}("undefined"==typeof self?global:self),!function(C){function G(Q,J){Q=Q.replace(W,"");var $=Q.match(X),ee=($[1].split(",")[J]||"require").replace(Y,""),oe=Z[ee]||(Z[ee]=new RegExp("(?:^|[^$_a-zA-Z\\xA0-\\uFFFF.])"+ee+"\\s*\\(\\s*(\"([^\"]+)\"|'([^']+)')\\s*\\)","g"));oe.lastIndex=0;for(var ne=[],ie;ie=oe.exec(Q);)ne.push(ie[2]||ie[3]);return ne}function F(Q,J,$,ee){if("object"==typeof Q&&!(Q instanceof Array))return F.apply(null,Array.prototype.splice.call(arguments,1,arguments.length-1));if("string"==typeof Q&&"function"==typeof J&&(Q=[Q]),!(Q instanceof Array)){if("string"==typeof Q){var oe=O.get(Q);return oe.__useDefault?oe["default"]:oe}throw new TypeError("Invalid require")}for(var ie=[],ne=0;ne<Q.length;ne++)ie.push(O["import"](Q[ne],ee));Promise.all(ie).then(function(se){J&&J.apply(null,se)},$)}function H(Q,J,$){"string"!=typeof Q&&($=J,J=Q,Q=null),J instanceof Array||($=J,J=["require","exports","module"].splice(0,$.length)),"function"!=typeof $&&($=function(se){return function(){return se}}($)),void 0===J[J.length-1]&&J.pop();var ee,oe,ie;-1!=(ee=V.call(J,"require"))&&(J.splice(ee,1),Q||(J=J.concat(G($.toString(),ee)))),-1!=(oe=V.call(J,"exports"))&&J.splice(oe,1),-1!=(ie=V.call(J,"module"))&&J.splice(ie,1);var ne={name:Q,deps:J,execute:function(se,le,pe){for(var ue=[],fe=0;fe<J.length;fe++)ue.push(se(J[fe]));pe.uri=pe.id,pe.config=function(){},-1!=ie&&ue.splice(ie,0,pe),-1!=oe&&ue.splice(oe,0,le),-1!=ee&&ue.splice(ee,0,function(he,ye,xe){return"string"==typeof he&&"function"!=typeof ye?se(he):F.call(O,he,ye,xe,pe.id)});var ge=$.apply(-1==oe?C:le,ue);return"undefined"==typeof ge&&pe&&(ge=pe.exports),"undefined"==typeof ge?void 0:ge}};if(Q)K.anonDefine||K.isBundle?K.anonDefine&&K.anonDefine.name&&(K.anonDefine=null):K.anonDefine=ne,K.isBundle=!0,O.registerDynamic(ne.name,ne.deps,!1,ne.execute);else{if(K.anonDefine&&!K.anonDefine.name)throw new Error("Multiple anonymous defines in module "+Q);K.anonDefine=ne}}var O=E,V=Array.prototype.indexOf||function(Q){for(var J=0,$=this.length;$>J;J++)if(this[J]===Q)return J;return-1},W=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,X=/\(([^\)]*)\)/,Y=/^\s+|\s+$/g,Z={};H.amd={};var K={isBundle:!1,anonDefine:null};O.amdDefine=H,O.amdRequire=F}("undefined"==typeof self?global:self),E.registerDynamic("2",[],!1,function(C,G,F){var H=E.get("@@global-helpers").prepareGlobal(F.id,null,null);return function(){/*
    
     Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
     This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
     The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
     The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
     Code distributed by Google as part of the polymer project is also
     subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
    */"use strict";(function(){function O(){function le(){pe.C=!0,pe.b(Z.childNodes)}var pe=this;this.a=new Map,this.j=new Map,this.h=new Map,this.m=new Set,this.v=new MutationObserver(this.A.bind(this)),this.f=null,this.B=new Set,this.enableFlush=!0,this.C=!1,this.G=this.c(Z),window.HTMLImports?window.HTMLImports.whenReady(le):le()}function V(){return K.customElements}function W(le){if(!/^[a-z][.0-9_a-z]*-[\-.0-9_a-z]*$/.test(le)||-1!==Q.indexOf(le))return Error("The element name '"+le+"' is not valid.")}function X(le,pe,ue,fe){var ge=V();return le=$.call(le,pe,ue),(pe=ge.a.get(pe.toLowerCase()))&&ge.D(le,pe,fe),ge.c(le),le}function Y(le,pe,ue,fe){pe=pe.toLowerCase();var ge=le.getAttribute(pe);fe.call(le,pe,ue),1==le.__$CE_upgraded&&(fe=V().a.get(le.localName),ue=fe.w,(fe=fe.i)&&0<=ue.indexOf(pe)&&(ue=le.getAttribute(pe),ue!==ge&&fe.call(le,pe,ge,ue,null)))}var Z=document,K=window;if(!(V()&&(V().g=function(){},!V().forcePolyfill))){var Q="annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ");O.prototype.K=function(Se,Ee){function Me(Ce){var Ie=Le[Ce];if(void 0!==Ie&&"function"!=typeof Ie)throw Error(Pe+" '"+Ce+"' is not a Function");return Ie}if("function"!=typeof Ee)throw new TypeError("constructor must be a Constructor");var Ae=W(Se);if(Ae)throw Ae;if(this.a.has(Se))throw Error("An element with name '"+Se+"' is already defined");if(this.j.has(Ee))throw Error("Definition failed for '"+Se+"': The constructor is already used.");var Pe=Se,Le=Ee.prototype;if("object"!=typeof Le)throw new TypeError("Definition failed for '"+Se+"': constructor.prototype must be an object");var Ae=Me("connectedCallback"),we=Me("disconnectedCallback"),Re=Me("attributeChangedCallback");this.a.set(Pe,{name:Se,localName:Pe,constructor:Ee,o:Ae,s:we,i:Re,w:Re&&Ee.observedAttributes||[]}),this.j.set(Ee,Pe),this.C&&this.b(Z.childNodes),(Se=this.h.get(Pe))&&(Se.resolve(void 0),this.h.delete(Pe))},O.prototype.get=function(Se){return(Se=this.a.get(Se))?Se.constructor:void 0},O.prototype.L=function(Se){var Ee=W(Se);if(Ee)return Promise.reject(Ee);if(this.a.has(Se))return Promise.resolve();if(Ee=this.h.get(Se))return Ee.M;var Ae=new Promise(function(Pe){Me=Pe}),Ee={M:Ae,resolve:Me},Me;return this.h.set(Se,Ee),Ae},O.prototype.g=function(){this.enableFlush&&(this.l(this.G.takeRecords()),this.A(this.v.takeRecords()),this.m.forEach(function(Se){this.l(Se.takeRecords())},this))},O.prototype.I=function(Se){this.f=Se},O.prototype.c=function(Se){return null==Se.__$CE_observer?(Se.__$CE_observer=new MutationObserver(this.l.bind(this)),Se.__$CE_observer.observe(Se,{childList:!0,subtree:!0}),this.enableFlush&&this.m.add(Se.__$CE_observer),Se.__$CE_observer):Se.__$CE_observer},O.prototype.J=function(Se){null!=Se.__$CE_observer&&(Se.__$CE_observer.disconnect(),this.enableFlush&&this.m.delete(Se.__$CE_observer),Se.__$CE_observer=null)},O.prototype.l=function(Se){for(var Ee=0;Ee<Se.length;Ee++){var Me=Se[Ee];if("childList"===Me.type){var Ae=Me.removedNodes;this.b(Me.addedNodes),this.H(Ae)}}},O.prototype.b=function(Se,Ee){Ee=Ee||new Set;for(var Me=0;Me<Se.length;Me++){var Ae=Se[Me];if(Ae.nodeType===Node.ELEMENT_NODE){this.J(Ae),Ae=Z.createTreeWalker(Ae,NodeFilter.SHOW_ELEMENT,null,!1);do this.F(Ae.currentNode,Ee);while(Ae.nextNode())}}},O.prototype.F=function(Se,Ee){if(!Ee.has(Se)){Ee.add(Se);var Me=this.a.get(Se.localName);if(Me){Se.__$CE_upgraded||this.D(Se,Me,!0);var Ae;if(Ae=Se.__$CE_upgraded&&!Se.__$CE_attached)a:{Ae=Se;do{if(Ae.__$CE_attached||Ae.nodeType===Node.DOCUMENT_NODE){Ae=!0;break a}Ae=Ae.parentNode||Ae.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&Ae.host}while(Ae);Ae=!1}Ae&&(Se.__$CE_attached=!0,Me.o&&Me.o.call(Se))}Se.shadowRoot&&this.b(Se.shadowRoot.childNodes,Ee),"LINK"===Se.tagName&&Se.rel&&-1!==Se.rel.toLowerCase().split(" ").indexOf("import")&&this.u(Se,Ee)}},O.prototype.u=function(Se,Ee){var Me=Se.import;if(Me)Ee.has(Me)||(Ee.add(Me),Me.__$CE_observer||this.c(Me),this.b(Me.childNodes,Ee));else if(Ee=Se.href,!this.B.has(Ee)){this.B.add(Ee);var Ae=this,Pe=function(){Se.removeEventListener("load",Pe),Se.import.__$CE_observer||Ae.c(Se.import),Ae.b(Se.import.childNodes)};Se.addEventListener("load",Pe)}},O.prototype.H=function(Se){for(var Ee=0;Ee<Se.length;Ee++){var Me=Se[Ee];if(Me.nodeType===Node.ELEMENT_NODE){this.c(Me),Me=Z.createTreeWalker(Me,NodeFilter.SHOW_ELEMENT,null,!1);do{var Ae=Me.currentNode;if(Ae.__$CE_upgraded&&Ae.__$CE_attached){Ae.__$CE_attached=!1;var Pe=this.a.get(Ae.localName);Pe&&Pe.s&&Pe.s.call(Ae)}}while(Me.nextNode())}}},O.prototype.D=function(Se,Ee,Me){if(Se.__proto__=Ee.constructor.prototype,Me&&(this.I(Se),new Ee.constructor,Se.__$CE_upgraded=!0,console.assert(!this.f)),Me=Ee.w,(Ee=Ee.i)&&0<Me.length){this.v.observe(Se,{attributes:!0,attributeOldValue:!0,attributeFilter:Me});for(var Ae=0;Ae<Me.length;Ae++){var Pe=Me[Ae];if(Se.hasAttribute(Pe)){var Le=Se.getAttribute(Pe);Ee.call(Se,Pe,null,Le,null)}}}},O.prototype.A=function(Se){for(var Ee=0;Ee<Se.length;Ee++){var Me=Se[Ee];if("attributes"===Me.type){var Ae=Me.target,Pe=this.a.get(Ae.localName),Le=Me.attributeName,we=Me.oldValue,Re=Ae.getAttribute(Le);Re!==we&&Pe.i.call(Ae,Le,we,Re,Me.attributeNamespace)}}},window.CustomElementRegistry=O,O.prototype.define=O.prototype.K,O.prototype.get=O.prototype.get,O.prototype.whenDefined=O.prototype.L,O.prototype.flush=O.prototype.g,O.prototype.polyfilled=!0,O.prototype._observeRoot=O.prototype.c,O.prototype._addImport=O.prototype.u;var J=K.HTMLElement;K.HTMLElement=function(){var Se=V();if(Se.f){var Ee=Se.f;return Se.f=null,Ee}if(this.constructor)return Se=Se.j.get(this.constructor),X(Z,Se,void 0,!1);throw Error("Unknown constructor. Did you call customElements.define()?")},K.HTMLElement.prototype=Object.create(J.prototype,{constructor:{value:K.HTMLElement,configurable:!0,writable:!0}});var $=Z.createElement;Z.createElement=function(Se,Ee){return X(Z,Se,Ee,!0)};var ee=Z.createElementNS;Z.createElementNS=function(Se,Ee){return"http://www.w3.org/1999/xhtml"===Se?Z.createElement(Ee):ee.call(Z,Se,Ee)};var oe=Element.prototype.attachShadow;oe&&Object.defineProperty(Element.prototype,"attachShadow",{value:function(Se){return Se=oe.call(this,Se),V().c(Se),Se}});var ie=Z.importNode;Z.importNode=function(Se,Ee){return Se=ie.call(Z,Se,Ee),V().b(Se.nodeType===Node.ELEMENT_NODE?[Se]:Se.childNodes),Se};var ne=Element.prototype.setAttribute;Element.prototype.setAttribute=function(Se,Ee){Y(this,Se,Ee,ne)};var se=Element.prototype.removeAttribute;Element.prototype.removeAttribute=function(Se){Y(this,Se,null,se)},Object.defineProperty(window,"customElements",{value:new O,configurable:!0,enumerable:!0}),window.CustomElements={takeRecords:function(){V().g&&V().g()}}}})()}(this),H()}),function(){var C=E.amdDefine;(function(G,F){"object"==typeof A&&"undefined"!=typeof R?F(A):"function"==typeof C&&C.amd?C("3",["exports"],F):F(G.THREE=G.THREE||{})})(this,function(G){"use strict";function F(){}function H(_l,Sl){this.x=_l||0,this.y=Sl||0}function O(_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl,Cl){Object.defineProperty(this,"id",{value:ws++}),this.uuid=Ls.generateUUID(),this.name="",this.image=_l===void 0?O.DEFAULT_IMAGE:_l,this.mipmaps=[],this.mapping=Sl===void 0?O.DEFAULT_MAPPING:Sl,this.wrapS=El===void 0?vn:El,this.wrapT=Ml===void 0?vn:Ml,this.magFilter=Al===void 0?Pn:Al,this.minFilter=Pl===void 0?wn:Pl,this.anisotropy=Rl===void 0?1:Rl,this.format=Ll===void 0?Xn:Ll,this.type=wl===void 0?Cn:wl,this.offset=new H(0,0),this.repeat=new H(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=Cl===void 0?xs:Cl,this.version=0,this.onUpdate=null}function V(_l,Sl,El,Ml){this.x=_l||0,this.y=Sl||0,this.z=El||0,this.w=Ml===void 0?1:Ml}function W(_l,Sl,El){this.uuid=Ls.generateUUID(),this.width=_l,this.height=Sl,this.scissor=new V(0,0,_l,Sl),this.scissorTest=!1,this.viewport=new V(0,0,_l,Sl),El=El||{},El.minFilter===void 0&&(El.minFilter=Pn),this.texture=new O(void 0,void 0,El.wrapS,El.wrapT,El.magFilter,El.minFilter,El.format,El.type,El.anisotropy,El.encoding),this.depthBuffer=!(El.depthBuffer!==void 0)||El.depthBuffer,this.stencilBuffer=!(El.stencilBuffer!==void 0)||El.stencilBuffer,this.depthTexture=El.depthTexture===void 0?null:El.depthTexture}function X(_l,Sl,El){W.call(this,_l,Sl,El),this.activeCubeFace=0,this.activeMipMapLevel=0}function Y(_l,Sl,El,Ml){this._x=_l||0,this._y=Sl||0,this._z=El||0,this._w=Ml===void 0?1:Ml}function Z(_l,Sl,El){this.x=_l||0,this.y=Sl||0,this.z=El||0}function K(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Q(_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl,Cl){_l=_l===void 0?[]:_l,Sl=Sl===void 0?cn:Sl,O.call(this,_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl,Cl),this.flipY=!1}function J(){this.seq=[],this.map={}}function $(_l,Sl,El){var Ml=_l[0];if(0>=Ml||0<Ml)return _l;var Al=Sl*El,Pl=Is[Al];if(void 0===Pl&&(Pl=new Float32Array(Al),Is[Al]=Pl),0!==Sl){Ml.toArray(Pl,0);for(var Ll=1,wl=0;Ll!==Sl;++Ll)wl+=El,_l[Ll].toArray(Pl,wl)}return Pl}function ee(_l,Sl){var El=Ds[Sl];El===void 0&&(El=new Int32Array(Sl),Ds[Sl]=El);for(var Ml=0;Ml!==Sl;++Ml)El[Ml]=_l.allocTextureUnit();return El}function oe(_l,Sl){_l.uniform1f(this.addr,Sl)}function ie(_l,Sl){_l.uniform1i(this.addr,Sl)}function ne(_l,Sl){Sl.x===void 0?_l.uniform2fv(this.addr,Sl):_l.uniform2f(this.addr,Sl.x,Sl.y)}function se(_l,Sl){Sl.x===void 0?Sl.r===void 0?_l.uniform3fv(this.addr,Sl):_l.uniform3f(this.addr,Sl.r,Sl.g,Sl.b):_l.uniform3f(this.addr,Sl.x,Sl.y,Sl.z)}function le(_l,Sl){Sl.x===void 0?_l.uniform4fv(this.addr,Sl):_l.uniform4f(this.addr,Sl.x,Sl.y,Sl.z,Sl.w)}function pe(_l,Sl){_l.uniformMatrix2fv(this.addr,!1,Sl.elements||Sl)}function ue(_l,Sl){_l.uniformMatrix3fv(this.addr,!1,Sl.elements||Sl)}function fe(_l,Sl){_l.uniformMatrix4fv(this.addr,!1,Sl.elements||Sl)}function ge(_l,Sl,El){var Ml=El.allocTextureUnit();_l.uniform1i(this.addr,Ml),El.setTexture2D(Sl||Rs,Ml)}function he(_l,Sl,El){var Ml=El.allocTextureUnit();_l.uniform1i(this.addr,Ml),El.setTextureCube(Sl||Cs,Ml)}function ye(_l,Sl){_l.uniform2iv(this.addr,Sl)}function xe(_l,Sl){_l.uniform3iv(this.addr,Sl)}function Te(_l,Sl){_l.uniform4iv(this.addr,Sl)}function ve(_l){return 5126===_l?oe:35664===_l?ne:35665===_l?se:35666===_l?le:35674===_l?pe:35675===_l?ue:35676===_l?fe:35678===_l?ge:35680===_l?he:5124===_l||35670===_l?ie:35667===_l||35671===_l?ye:35668===_l||35672===_l?xe:35669===_l||35673===_l?Te:void 0}function Se(_l,Sl){_l.uniform1fv(this.addr,Sl)}function Ee(_l,Sl){_l.uniform1iv(this.addr,Sl)}function Me(_l,Sl){_l.uniform2fv(this.addr,$(Sl,this.size,2))}function Ae(_l,Sl){_l.uniform3fv(this.addr,$(Sl,this.size,3))}function Pe(_l,Sl){_l.uniform4fv(this.addr,$(Sl,this.size,4))}function Le(_l,Sl){_l.uniformMatrix2fv(this.addr,!1,$(Sl,this.size,4))}function we(_l,Sl){_l.uniformMatrix3fv(this.addr,!1,$(Sl,this.size,9))}function Re(_l,Sl){_l.uniformMatrix4fv(this.addr,!1,$(Sl,this.size,16))}function Ce(_l,Sl,El){var Ml=Sl.length,Al=ee(El,Ml);_l.uniform1iv(this.addr,Al);for(var Pl=0;Pl!==Ml;++Pl)El.setTexture2D(Sl[Pl]||Rs,Al[Pl])}function Ie(_l,Sl,El){var Ml=Sl.length,Al=ee(El,Ml);_l.uniform1iv(this.addr,Al);for(var Pl=0;Pl!==Ml;++Pl)El.setTextureCube(Sl[Pl]||Cs,Al[Pl])}function De(_l){return 5126===_l?Se:35664===_l?Me:35665===_l?Ae:35666===_l?Pe:35674===_l?Le:35675===_l?we:35676===_l?Re:35678===_l?Ce:35680===_l?Ie:5124===_l||35670===_l?Ee:35667===_l||35671===_l?ye:35668===_l||35672===_l?xe:35669===_l||35673===_l?Te:void 0}function Ge(_l,Sl,El){this.id=_l,this.addr=El,this.setValue=ve(Sl.type)}function Be(_l,Sl,El){this.id=_l,this.addr=El,this.size=Sl.size,this.setValue=De(Sl.type)}function Fe(_l){this.id=_l,J.call(this)}function Ne(_l,Sl){_l.seq.push(Sl),_l.map[Sl.id]=Sl}function Ue(_l,Sl,El){var Ml=_l.name,Al=Ml.length;for(Gs.lastIndex=0;;){var Pl=Gs.exec(Ml),Ll=Gs.lastIndex,wl=Pl[1],Rl="]"===Pl[2],Cl=Pl[3];if(Rl&&(wl=0|wl),void 0===Cl||"["===Cl&&Ll+2===Al){Ne(El,void 0===Cl?new Ge(wl,_l,Sl):new Be(wl,_l,Sl));break}else{var Il=El.map,Dl=Il[wl];void 0===Dl&&(Dl=new Fe(wl),Ne(El,Dl)),El=Dl}}}function He(_l,Sl,El){J.call(this),this.renderer=El;var Ml=_l.getProgramParameter(Sl,_l.ACTIVE_UNIFORMS);for(var Al=0;Al!==Ml;++Al){var Pl=_l.getActiveUniform(Sl,Al),Ll=Pl.name,wl=_l.getUniformLocation(Sl,Ll);Ue(Pl,wl,this)}}function ze(_l,Sl,El){return void 0===Sl&&void 0===El?this.set(_l):this.setRGB(_l,Sl,El)}function Oe(_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl,Cl,Il,Dl){O.call(this,null,Pl,Ll,wl,Rl,Cl,Ml,Al,Il,Dl),this.image={data:_l,width:Sl,height:El},this.magFilter=Rl===void 0?En:Rl,this.minFilter=Cl===void 0?En:Cl,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Ve(_l,Sl){this.min=_l===void 0?new H(+(1/0),+(1/0)):_l,this.max=Sl===void 0?new H(-(1/0),-(1/0)):Sl}function ke(_l,Sl){function El(){var Fl=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),Nl=new Uint16Array([0,1,2,0,2,3]);Ll=Al.createBuffer(),wl=Al.createBuffer(),Al.bindBuffer(Al.ARRAY_BUFFER,Ll),Al.bufferData(Al.ARRAY_BUFFER,Fl,Al.STATIC_DRAW),Al.bindBuffer(Al.ELEMENT_ARRAY_BUFFER,wl),Al.bufferData(Al.ELEMENT_ARRAY_BUFFER,Nl,Al.STATIC_DRAW),Gl=Al.createTexture(),Bl=Al.createTexture(),Pl.bindTexture(Al.TEXTURE_2D,Gl),Al.texImage2D(Al.TEXTURE_2D,0,Al.RGB,16,16,0,Al.RGB,Al.UNSIGNED_BYTE,null),Al.texParameteri(Al.TEXTURE_2D,Al.TEXTURE_WRAP_S,Al.CLAMP_TO_EDGE),Al.texParameteri(Al.TEXTURE_2D,Al.TEXTURE_WRAP_T,Al.CLAMP_TO_EDGE),Al.texParameteri(Al.TEXTURE_2D,Al.TEXTURE_MAG_FILTER,Al.NEAREST),Al.texParameteri(Al.TEXTURE_2D,Al.TEXTURE_MIN_FILTER,Al.NEAREST),Pl.bindTexture(Al.TEXTURE_2D,Bl),Al.texImage2D(Al.TEXTURE_2D,0,Al.RGBA,16,16,0,Al.RGBA,Al.UNSIGNED_BYTE,null),Al.texParameteri(Al.TEXTURE_2D,Al.TEXTURE_WRAP_S,Al.CLAMP_TO_EDGE),Al.texParameteri(Al.TEXTURE_2D,Al.TEXTURE_WRAP_T,Al.CLAMP_TO_EDGE),Al.texParameteri(Al.TEXTURE_2D,Al.TEXTURE_MAG_FILTER,Al.NEAREST),Al.texParameteri(Al.TEXTURE_2D,Al.TEXTURE_MIN_FILTER,Al.NEAREST),Rl={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},Cl=Ml(Rl),Il={vertex:Al.getAttribLocation(Cl,"position"),uv:Al.getAttribLocation(Cl,"uv")},Dl={renderType:Al.getUniformLocation(Cl,"renderType"),map:Al.getUniformLocation(Cl,"map"),occlusionMap:Al.getUniformLocation(Cl,"occlusionMap"),opacity:Al.getUniformLocation(Cl,"opacity"),color:Al.getUniformLocation(Cl,"color"),scale:Al.getUniformLocation(Cl,"scale"),rotation:Al.getUniformLocation(Cl,"rotation"),screenPosition:Al.getUniformLocation(Cl,"screenPosition")}}function Ml(Fl){var Nl=Al.createProgram(),Ul=Al.createShader(Al.FRAGMENT_SHADER),Hl=Al.createShader(Al.VERTEX_SHADER),zl="precision "+_l.getPrecision()+" float;\n";return Al.shaderSource(Ul,zl+Fl.fragmentShader),Al.shaderSource(Hl,zl+Fl.vertexShader),Al.compileShader(Ul),Al.compileShader(Hl),Al.attachShader(Nl,Ul),Al.attachShader(Nl,Hl),Al.linkProgram(Nl),Nl}var Al=_l.context,Pl=_l.state,Ll,wl,Rl,Cl,Il,Dl,Gl,Bl;this.render=function(Fl,Nl,Ul){if(0!==Sl.length){var Hl=new Z,zl=Ul.w/Ul.z,Ol=0.5*Ul.z,Vl=0.5*Ul.w,Wl=16/Ul.w,Xl=new H(Wl*zl,Wl),Yl=new Z(1,1,0),ql=new H(1,1),Zl=new Ve;Zl.min.set(Ul.x,Ul.y),Zl.max.set(Ul.x+(Ul.z-16),Ul.y+(Ul.w-16)),Cl===void 0&&El(),Al.useProgram(Cl),Pl.initAttributes(),Pl.enableAttribute(Il.vertex),Pl.enableAttribute(Il.uv),Pl.disableUnusedAttributes(),Al.uniform1i(Dl.occlusionMap,0),Al.uniform1i(Dl.map,1),Al.bindBuffer(Al.ARRAY_BUFFER,Ll),Al.vertexAttribPointer(Il.vertex,2,Al.FLOAT,!1,16,0),Al.vertexAttribPointer(Il.uv,2,Al.FLOAT,!1,16,8),Al.bindBuffer(Al.ELEMENT_ARRAY_BUFFER,wl),Pl.disable(Al.CULL_FACE),Pl.setDepthWrite(!1);for(var Kl=0,Ql=Sl.length;Kl<Ql;Kl++){Wl=16/Ul.w,Xl.set(Wl*zl,Wl);var Jl=Sl[Kl];if(Hl.set(Jl.matrixWorld.elements[12],Jl.matrixWorld.elements[13],Jl.matrixWorld.elements[14]),Hl.applyMatrix4(Nl.matrixWorldInverse),Hl.applyProjection(Nl.projectionMatrix),Yl.copy(Hl),ql.x=Ul.x+Yl.x*Ol+Ol-8,ql.y=Ul.y+Yl.y*Vl+Vl-8,!0===Zl.containsPoint(ql)){Pl.activeTexture(Al.TEXTURE0),Pl.bindTexture(Al.TEXTURE_2D,null),Pl.activeTexture(Al.TEXTURE1),Pl.bindTexture(Al.TEXTURE_2D,Gl),Al.copyTexImage2D(Al.TEXTURE_2D,0,Al.RGB,ql.x,ql.y,16,16,0),Al.uniform1i(Dl.renderType,0),Al.uniform2f(Dl.scale,Xl.x,Xl.y),Al.uniform3f(Dl.screenPosition,Yl.x,Yl.y,Yl.z),Pl.disable(Al.BLEND),Pl.enable(Al.DEPTH_TEST),Al.drawElements(Al.TRIANGLES,6,Al.UNSIGNED_SHORT,0),Pl.activeTexture(Al.TEXTURE0),Pl.bindTexture(Al.TEXTURE_2D,Bl),Al.copyTexImage2D(Al.TEXTURE_2D,0,Al.RGBA,ql.x,ql.y,16,16,0),Al.uniform1i(Dl.renderType,1),Pl.disable(Al.DEPTH_TEST),Pl.activeTexture(Al.TEXTURE1),Pl.bindTexture(Al.TEXTURE_2D,Gl),Al.drawElements(Al.TRIANGLES,6,Al.UNSIGNED_SHORT,0),Jl.positionScreen.copy(Yl),Jl.customUpdateCallback?Jl.customUpdateCallback(Jl):Jl.updateLensFlares(),Al.uniform1i(Dl.renderType,2),Pl.enable(Al.BLEND);for(var $l=0,ed=Jl.lensFlares.length;$l<ed;$l++){var td=Jl.lensFlares[$l];1e-3<td.opacity&&1e-3<td.scale&&(Yl.x=td.x,Yl.y=td.y,Yl.z=td.z,Wl=td.size*td.scale/Ul.w,Xl.x=Wl*zl,Xl.y=Wl,Al.uniform3f(Dl.screenPosition,Yl.x,Yl.y,Yl.z),Al.uniform2f(Dl.scale,Xl.x,Xl.y),Al.uniform1f(Dl.rotation,td.rotation),Al.uniform1f(Dl.opacity,td.opacity),Al.uniform3f(Dl.color,td.color.r,td.color.g,td.color.b),Pl.setBlending(td.blending,td.blendEquation,td.blendSrc,td.blendDst),_l.setTexture2D(td.texture,1),Al.drawElements(Al.TRIANGLES,6,Al.UNSIGNED_SHORT,0))}}}Pl.enable(Al.CULL_FACE),Pl.enable(Al.DEPTH_TEST),Pl.setDepthWrite(!0),_l.resetGLState()}}}function We(_l,Sl){function El(){var Ul=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]),Hl=new Uint16Array([0,1,2,0,2,3]);wl=Pl.createBuffer(),Rl=Pl.createBuffer(),Pl.bindBuffer(Pl.ARRAY_BUFFER,wl),Pl.bufferData(Pl.ARRAY_BUFFER,Ul,Pl.STATIC_DRAW),Pl.bindBuffer(Pl.ELEMENT_ARRAY_BUFFER,Rl),Pl.bufferData(Pl.ELEMENT_ARRAY_BUFFER,Hl,Pl.STATIC_DRAW),Cl=Ml(),Il={position:Pl.getAttribLocation(Cl,"position"),uv:Pl.getAttribLocation(Cl,"uv")},Dl={uvOffset:Pl.getUniformLocation(Cl,"uvOffset"),uvScale:Pl.getUniformLocation(Cl,"uvScale"),rotation:Pl.getUniformLocation(Cl,"rotation"),scale:Pl.getUniformLocation(Cl,"scale"),color:Pl.getUniformLocation(Cl,"color"),map:Pl.getUniformLocation(Cl,"map"),opacity:Pl.getUniformLocation(Cl,"opacity"),modelViewMatrix:Pl.getUniformLocation(Cl,"modelViewMatrix"),projectionMatrix:Pl.getUniformLocation(Cl,"projectionMatrix"),fogType:Pl.getUniformLocation(Cl,"fogType"),fogDensity:Pl.getUniformLocation(Cl,"fogDensity"),fogNear:Pl.getUniformLocation(Cl,"fogNear"),fogFar:Pl.getUniformLocation(Cl,"fogFar"),fogColor:Pl.getUniformLocation(Cl,"fogColor"),alphaTest:Pl.getUniformLocation(Cl,"alphaTest")};var zl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");zl.width=8,zl.height=8;var Ol=zl.getContext("2d");Ol.fillStyle="white",Ol.fillRect(0,0,8,8),Gl=new O(zl),Gl.needsUpdate=!0}function Ml(){var Ul=Pl.createProgram(),Hl=Pl.createShader(Pl.VERTEX_SHADER),zl=Pl.createShader(Pl.FRAGMENT_SHADER);return Pl.shaderSource(Hl,["precision "+_l.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),Pl.shaderSource(zl,["precision "+_l.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),Pl.compileShader(Hl),Pl.compileShader(zl),Pl.attachShader(Ul,Hl),Pl.attachShader(Ul,zl),Pl.linkProgram(Ul),Ul}function Al(Ul,Hl){if(Ul.renderOrder!==Hl.renderOrder)return Ul.renderOrder-Hl.renderOrder;return Ul.z===Hl.z?Hl.id-Ul.id:Hl.z-Ul.z}var Pl=_l.context,Ll=_l.state,wl,Rl,Cl,Il,Dl,Gl,Bl=new Z,Fl=new Y,Nl=new Z;this.render=function(Ul,Hl){if(0!==Sl.length){Cl===void 0&&El(),Pl.useProgram(Cl),Ll.initAttributes(),Ll.enableAttribute(Il.position),Ll.enableAttribute(Il.uv),Ll.disableUnusedAttributes(),Ll.disable(Pl.CULL_FACE),Ll.enable(Pl.BLEND),Pl.bindBuffer(Pl.ARRAY_BUFFER,wl),Pl.vertexAttribPointer(Il.position,2,Pl.FLOAT,!1,16,0),Pl.vertexAttribPointer(Il.uv,2,Pl.FLOAT,!1,16,8),Pl.bindBuffer(Pl.ELEMENT_ARRAY_BUFFER,Rl),Pl.uniformMatrix4fv(Dl.projectionMatrix,!1,Hl.projectionMatrix.elements),Ll.activeTexture(Pl.TEXTURE0),Pl.uniform1i(Dl.map,0);var zl=0,Ol=0,Vl=Ul.fog;Vl?(Pl.uniform3f(Dl.fogColor,Vl.color.r,Vl.color.g,Vl.color.b),Vl.isFog?(Pl.uniform1f(Dl.fogNear,Vl.near),Pl.uniform1f(Dl.fogFar,Vl.far),Pl.uniform1i(Dl.fogType,1),zl=1,Ol=1):Vl.isFogExp2&&(Pl.uniform1f(Dl.fogDensity,Vl.density),Pl.uniform1i(Dl.fogType,2),zl=2,Ol=2)):(Pl.uniform1i(Dl.fogType,0),zl=0,Ol=0);for(var Wl=0,Xl=Sl.length;Wl<Xl;Wl++){var Yl=Sl[Wl];Yl.modelViewMatrix.multiplyMatrices(Hl.matrixWorldInverse,Yl.matrixWorld),Yl.z=-Yl.modelViewMatrix.elements[14]}Sl.sort(Al);var ql=[];for(var Wl=0,Xl=Sl.length;Wl<Xl;Wl++){var Yl=Sl[Wl],Zl=Yl.material;if(!1!==Zl.visible){Pl.uniform1f(Dl.alphaTest,Zl.alphaTest),Pl.uniformMatrix4fv(Dl.modelViewMatrix,!1,Yl.modelViewMatrix.elements),Yl.matrixWorld.decompose(Bl,Fl,Nl),ql[0]=Nl.x,ql[1]=Nl.y;var Kl=0;Ul.fog&&Zl.fog&&(Kl=Ol),zl!=Kl&&(Pl.uniform1i(Dl.fogType,Kl),zl=Kl),null===Zl.map?(Pl.uniform2f(Dl.uvOffset,0,0),Pl.uniform2f(Dl.uvScale,1,1)):(Pl.uniform2f(Dl.uvOffset,Zl.map.offset.x,Zl.map.offset.y),Pl.uniform2f(Dl.uvScale,Zl.map.repeat.x,Zl.map.repeat.y)),Pl.uniform1f(Dl.opacity,Zl.opacity),Pl.uniform3f(Dl.color,Zl.color.r,Zl.color.g,Zl.color.b),Pl.uniform1f(Dl.rotation,Zl.rotation),Pl.uniform2fv(Dl.scale,ql),Ll.setBlending(Zl.blending,Zl.blendEquation,Zl.blendSrc,Zl.blendDst),Ll.setDepthTest(Zl.depthTest),Ll.setDepthWrite(Zl.depthWrite),Zl.map?_l.setTexture2D(Zl.map,0):_l.setTexture2D(Gl,0),Pl.drawElements(Pl.TRIANGLES,6,Pl.UNSIGNED_SHORT,0)}}Ll.enable(Pl.CULL_FACE),_l.resetGLState()}}}function Xe(){Object.defineProperty(this,"id",{value:zs++}),this.uuid=Ls.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=Mi,this.side=hi,this.shading=bi,this.vertexColors=vi,this.opacity=1,this.transparent=!1,this.blendSrc=zi,this.blendDst=Oi,this.blendEquation=Ci,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Ki,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0}function je(_l){Xe.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,_l!==void 0&&(_l.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(_l))}function Ye(_l){Xe.call(this),this.type="MeshDepthMaterial",this.depthPacking=As,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(_l)}function qe(_l,Sl){this.min=_l===void 0?new Z(+(1/0),+(1/0),+(1/0)):_l,this.max=Sl===void 0?new Z(-(1/0),-(1/0),-(1/0)):Sl}function Ze(_l,Sl){this.center=_l===void 0?new Z:_l,this.radius=Sl===void 0?0:Sl}function Ke(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function Qe(_l,Sl){this.normal=_l===void 0?new Z(1,0,0):_l,this.constant=Sl===void 0?0:Sl}function Je(_l,Sl,El,Ml,Al,Pl){this.planes=[_l===void 0?new Qe:_l,Sl===void 0?new Qe:Sl,El===void 0?new Qe:El,Ml===void 0?new Qe:Ml,Al===void 0?new Qe:Al,Pl===void 0?new Qe:Pl]}function $e(_l,Sl,El,Ml){function Al(nd,sd,ld,dd){var cd=nd.geometry,ud=null,md=Ol,fd=nd.customDepthMaterial;if(ld&&(md=Vl,fd=nd.customDistanceMaterial),!fd){var gd=!1;sd.morphTargets&&(cd&&cd.isBufferGeometry?gd=cd.morphAttributes&&cd.morphAttributes.position&&0<cd.morphAttributes.position.length:cd&&cd.isGeometry&&(gd=cd.morphTargets&&0<cd.morphTargets.length));var hd=nd.isSkinnedMesh&&sd.skinning,yd=0;gd&&(yd|=Ul),hd&&(yd|=Hl),ud=md[yd]}else ud=fd;if(_l.localClippingEnabled&&!0===sd.clipShadows&&0!==sd.clippingPlanes.length){var xd=ud.uuid,Td=sd.uuid,vd=Wl[xd];void 0===vd&&(vd={},Wl[xd]=vd);var _d=vd[Td];void 0===_d&&(_d=ud.clone(),vd[Td]=_d),ud=_d}ud.visible=sd.visible,ud.wireframe=sd.wireframe;var Sd=sd.side;return od.renderSingleSided&&Sd==xi&&(Sd=hi),od.renderReverseSided&&(Sd===hi?Sd=yi:Sd===yi&&(Sd=hi)),ud.side=Sd,ud.clipShadows=sd.clipShadows,ud.clippingPlanes=sd.clippingPlanes,ud.wireframeLinewidth=sd.wireframeLinewidth,ud.linewidth=sd.linewidth,ld&&void 0!==ud.uniforms.lightPos&&ud.uniforms.lightPos.value.copy(dd),ud}function Pl(nd,sd,ld){if(!1!==nd.visible){var dd=0!=(nd.layers.mask&sd.layers.mask);if(dd&&(nd.isMesh||nd.isLine||nd.isPoints)&&nd.castShadow&&(!1===nd.frustumCulled||!0===Rl.intersectsObject(nd))){var cd=nd.material;!0===cd.visible&&(nd.modelViewMatrix.multiplyMatrices(ld.matrixWorldInverse,nd.matrixWorld),Nl.push(nd))}var ud=nd.children;for(var md=0,fd=ud.length;md<fd;md++)Pl(ud[md],sd,ld)}}var Ll=_l.context,wl=_l.state,Rl=new Je,Cl=new K,Il=Sl.shadows,Dl=new H,Gl=new H(Ml.maxTextureSize,Ml.maxTextureSize),Bl=new Z,Fl=new Z,Nl=[],Ul=1,Hl=2,zl=(Ul|Hl)+1,Ol=[,,,,],Vl=[,,,,],Wl={},Xl=[new Z(1,0,0),new Z(-1,0,0),new Z(0,0,1),new Z(0,0,-1),new Z(0,1,0),new Z(0,-1,0)],Yl=[new Z(0,1,0),new Z(0,1,0),new Z(0,1,0),new Z(0,1,0),new Z(0,0,1),new Z(0,0,-1)],ql=[new V,new V,new V,new V,new V,new V],Zl=new Ye;Zl.depthPacking=Ps,Zl.clipping=!0;var Kl=Hs.distanceRGBA,Ql=Bs.clone(Kl.uniforms);for(var Jl=0;Jl!==zl;++Jl){var $l=0!=(Jl&Ul),ed=0!=(Jl&Hl),td=Zl.clone();td.morphTargets=$l,td.skinning=ed,Ol[Jl]=td;var rd=new je({defines:{USE_SHADOWMAP:""},uniforms:Ql,vertexShader:Kl.vertexShader,fragmentShader:Kl.fragmentShader,morphTargets:$l,skinning:ed,clipping:!0});Vl[Jl]=rd}var od=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=mi,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(nd,sd){if(!1!==od.enabled&&(!1!==od.autoUpdate||!1!==od.needsUpdate)&&0!==Il.length){wl.buffers.color.setClear(1,1,1,1),wl.disable(Ll.BLEND),wl.setDepthTest(!0),wl.setScissorTest(!1);var ld,dd;for(var cd=0,ud=Il.length;cd<ud;cd++){var md=Il[cd],fd=md.shadow;if(void 0===fd){console.warn("THREE.WebGLShadowMap:",md,"has no shadow.");continue}var gd=fd.camera;if(Dl.copy(fd.mapSize),Dl.min(Gl),md&&md.isPointLight){ld=6,dd=!0;var hd=Dl.x,yd=Dl.y;ql[0].set(2*hd,yd,hd,yd),ql[1].set(0,yd,hd,yd),ql[2].set(3*hd,yd,hd,yd),ql[3].set(hd,yd,hd,yd),ql[4].set(3*hd,0,hd,yd),ql[5].set(hd,0,hd,yd),Dl.x*=4,Dl.y*=2}else ld=1,dd=!1;null===fd.map&&(fd.map=new W(Dl.x,Dl.y,{minFilter:En,magFilter:En,format:Xn}),gd.updateProjectionMatrix()),fd.isSpotLightShadow&&fd.update(md),fd&&fd.isRectAreaLightShadow&&fd.update(md);var xd=fd.map,Td=fd.matrix;Fl.setFromMatrixPosition(md.matrixWorld),gd.position.copy(Fl),_l.setRenderTarget(xd),_l.clear();for(var vd=0;vd<ld;vd++){if(dd){Bl.copy(gd.position),Bl.add(Xl[vd]),gd.up.copy(Yl[vd]),gd.lookAt(Bl);var _d=ql[vd];wl.viewport(_d)}else Bl.setFromMatrixPosition(md.target.matrixWorld),gd.lookAt(Bl);gd.updateMatrixWorld(),gd.matrixWorldInverse.getInverse(gd.matrixWorld),Td.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1),Td.multiply(gd.projectionMatrix),Td.multiply(gd.matrixWorldInverse),Cl.multiplyMatrices(gd.projectionMatrix,gd.matrixWorldInverse),Rl.setFromMatrix(Cl),Nl.length=0,Pl(nd,sd,gd);for(var Sd=0,Ed=Nl.length;Sd<Ed;Sd++){var Md=Nl[Sd],Ad=El.update(Md),Pd=Md.material;if(Pd&&Pd.isMultiMaterial){var Ld=Ad.groups,wd=Pd.materials;for(var Rd=0,Cd=Ld.length;Rd<Cd;Rd++){var Id=Ld[Rd],Dd=wd[Id.materialIndex];if(!0===Dd.visible){var Gd=Al(Md,Dd,dd,Fl);_l.renderBufferDirect(gd,null,Ad,Gd,Md,Id)}}}else{var Gd=Al(Md,Pd,dd,Fl);_l.renderBufferDirect(gd,null,Ad,Gd,Md,null)}}}}var Bd=_l.getClearColor(),Fd=_l.getClearAlpha();_l.setClearColor(Bd,Fd),od.needsUpdate=!1}}}function et(_l,Sl){this.origin=_l===void 0?new Z:_l,this.direction=Sl===void 0?new Z:Sl}function tt(_l,Sl,El,Ml){this._x=_l||0,this._y=Sl||0,this._z=El||0,this._order=Ml||tt.DefaultOrder}function rt(){this.mask=1}function at(){Object.defineProperty(this,"id",{value:Os++}),this.uuid=Ls.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=at.DefaultUp.clone();var _l=new Z,Sl=new tt,El=new Y,Ml=new Z(1,1,1);Sl.onChange(function(){El.setFromEuler(Sl,!1)}),El.onChange(function(){Sl.setFromQuaternion(El,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:_l},rotation:{enumerable:!0,value:Sl},quaternion:{enumerable:!0,value:El},scale:{enumerable:!0,value:Ml},modelViewMatrix:{value:new K},normalMatrix:{value:new Ke}}),this.matrix=new K,this.matrixWorld=new K,this.matrixAutoUpdate=at.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new rt,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={},this.onBeforeRender=function(){},this.onAfterRender=function(){}}function ot(_l,Sl){this.start=_l===void 0?new Z:_l,this.end=Sl===void 0?new Z:Sl}function it(_l,Sl,El){this.a=_l===void 0?new Z:_l,this.b=Sl===void 0?new Z:Sl,this.c=El===void 0?new Z:El}function nt(_l,Sl,El,Ml,Al,Pl){this.a=_l,this.b=Sl,this.c=El,this.normal=Ml&&Ml.isVector3?Ml:new Z,this.vertexNormals=Array.isArray(Ml)?Ml:[],this.color=Al&&Al.isColor?Al:new ze,this.vertexColors=Array.isArray(Al)?Al:[],this.materialIndex=Pl===void 0?0:Pl}function st(_l){Xe.call(this),this.type="MeshBasicMaterial",this.color=new ze(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tn,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(_l)}function lt(_l,Sl,El){if(Array.isArray(_l))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Ls.generateUUID(),this.array=_l,this.itemSize=Sl,this.count=_l===void 0?0:_l.length/Sl,this.normalized=!0===El,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function dt(_l,Sl){lt.call(this,new Int8Array(_l),Sl)}function ct(_l,Sl){lt.call(this,new Uint8Array(_l),Sl)}function ut(_l,Sl){lt.call(this,new Uint8ClampedArray(_l),Sl)}function mt(_l,Sl){lt.call(this,new Int16Array(_l),Sl)}function ft(_l,Sl){lt.call(this,new Uint16Array(_l),Sl)}function gt(_l,Sl){lt.call(this,new Int32Array(_l),Sl)}function ht(_l,Sl){lt.call(this,new Uint32Array(_l),Sl)}function yt(_l,Sl){lt.call(this,new Float32Array(_l),Sl)}function xt(_l,Sl){lt.call(this,new Float64Array(_l),Sl)}function Tt(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function vt(){Object.defineProperty(this,"id",{value:_t()}),this.uuid=Ls.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function _t(){return Vs++}function St(){Object.defineProperty(this,"id",{value:_t()}),this.uuid=Ls.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function Et(_l,Sl){at.call(this),this.type="Mesh",this.geometry=_l===void 0?new St:_l,this.material=Sl===void 0?new st({color:16777215*Math.random()}):Sl,this.drawMode=gs,this.updateMorphTargets()}function Mt(_l,Sl,El,Ml,Al,Pl){function Ll(Ol,Vl,Wl,Xl,Yl,ql,Zl,Kl,Ql,Jl,$l){var ed=Ql+1,td=0,rd=0,od=new Z;for(var nd=0;nd<Jl+1;nd++){var sd=nd*(Zl/Jl)-Zl/2;for(var ld=0;ld<ed;ld++){var dd=ld*(ql/Ql)-ql/2;od[Ol]=dd*Xl,od[Vl]=sd*Yl,od[Wl]=Kl/2,Dl[Fl]=od.x,Dl[Fl+1]=od.y,Dl[Fl+2]=od.z,od[Ol]=0,od[Vl]=0,od[Wl]=0<Kl?1:-1,Gl[Fl]=od.x,Gl[Fl+1]=od.y,Gl[Fl+2]=od.z,Bl[Nl]=ld/Ql,Bl[Nl+1]=1-nd/Jl,Fl+=3,Nl+=2,td+=1}}for(nd=0;nd<Jl;nd++)for(ld=0;ld<Ql;ld++){var cd=Hl+ld+ed*nd,ud=Hl+ld+ed*(nd+1),md=Hl+(ld+1)+ed*(nd+1),fd=Hl+(ld+1)+ed*nd;Il[Ul]=cd,Il[Ul+1]=ud,Il[Ul+2]=fd,Il[Ul+3]=ud,Il[Ul+4]=md,Il[Ul+5]=fd,Ul+=6,rd+=6}wl.addGroup(zl,rd,$l),zl+=rd,Hl+=td}St.call(this),this.type="BoxBufferGeometry",this.parameters={width:_l,height:Sl,depth:El,widthSegments:Ml,heightSegments:Al,depthSegments:Pl};var wl=this;Ml=Math.floor(Ml)||1,Al=Math.floor(Al)||1,Pl=Math.floor(Pl)||1;var Rl=function(Vl,Wl,Xl){var Yl=0;return Yl+=2*((Vl+1)*(Wl+1)),Yl+=2*((Vl+1)*(Xl+1)),Yl+=2*((Xl+1)*(Wl+1)),Yl}(Ml,Al,Pl),Cl=function(Vl,Wl,Xl){var Yl=0;return Yl+=2*(Vl*Wl),Yl+=2*(Vl*Xl),Yl+=2*(Xl*Wl),6*Yl}(Ml,Al,Pl),Il=new(65535<Cl?Uint32Array:Uint16Array)(Cl),Dl=new Float32Array(3*Rl),Gl=new Float32Array(3*Rl),Bl=new Float32Array(2*Rl),Fl=0,Nl=0,Ul=0,Hl=0,zl=0;Ll("z","y","x",-1,-1,El,Sl,_l,Pl,Al,0),Ll("z","y","x",1,-1,El,Sl,-_l,Pl,Al,1),Ll("x","z","y",1,1,_l,El,Sl,Ml,Pl,2),Ll("x","z","y",1,-1,_l,El,-Sl,Ml,Pl,3),Ll("x","y","z",1,-1,_l,Sl,El,Ml,Al,4),Ll("x","y","z",-1,-1,_l,Sl,-El,Ml,Al,5),this.setIndex(new lt(Il,1)),this.addAttribute("position",new lt(Dl,3)),this.addAttribute("normal",new lt(Gl,3)),this.addAttribute("uv",new lt(Bl,2))}function At(_l,Sl,El,Ml){St.call(this),this.type="PlaneBufferGeometry",this.parameters={width:_l,height:Sl,widthSegments:El,heightSegments:Ml};var Al=Math.floor(El)||1,Pl=Math.floor(Ml)||1,Ll=Al+1,wl=Pl+1,Rl=new Float32Array(3*(Ll*wl)),Cl=new Float32Array(3*(Ll*wl)),Il=new Float32Array(2*(Ll*wl)),Dl=0,Gl=0;for(var Bl=0;Bl<wl;Bl++){var Fl=Bl*(Sl/Pl)-Sl/2;for(var Nl=0;Nl<Ll;Nl++){var Ul=Nl*(_l/Al)-_l/2;Rl[Dl]=Ul,Rl[Dl+1]=-Fl,Cl[Dl+2]=1,Il[Gl]=Nl/Al,Il[Gl+1]=1-Bl/Pl,Dl+=3,Gl+=2}}Dl=0;var Hl=new(65535<Rl.length/3?Uint32Array:Uint16Array)(6*(Al*Pl));for(var Bl=0;Bl<Pl;Bl++)for(var Nl=0;Nl<Al;Nl++){var zl=Nl+Ll*Bl,Ol=Nl+Ll*(Bl+1),Vl=Nl+1+Ll*(Bl+1),Wl=Nl+1+Ll*Bl;Hl[Dl]=zl,Hl[Dl+1]=Ol,Hl[Dl+2]=Wl,Hl[Dl+3]=Ol,Hl[Dl+4]=Vl,Hl[Dl+5]=Wl,Dl+=6}this.setIndex(new lt(Hl,1)),this.addAttribute("position",new lt(Rl,3)),this.addAttribute("normal",new lt(Cl,3)),this.addAttribute("uv",new lt(Il,2))}function Pt(){at.call(this),this.type="Camera",this.matrixWorldInverse=new K,this.projectionMatrix=new K}function Lt(_l,Sl,El,Ml){Pt.call(this),this.type="PerspectiveCamera",this.fov=_l===void 0?50:_l,this.zoom=1,this.near=El===void 0?0.1:El,this.far=Ml===void 0?2e3:Ml,this.focus=10,this.aspect=Sl===void 0?1:Sl,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function wt(_l,Sl,El,Ml,Al,Pl){Pt.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_l,this.right=Sl,this.top=El,this.bottom=Ml,this.near=Al===void 0?0.1:Al,this.far=Pl===void 0?2e3:Pl,this.updateProjectionMatrix()}function Rt(_l,Sl,El){var Ml,Al,Pl;return{setMode:function(wl){Ml=wl},setIndex:function(wl){wl.array instanceof Uint32Array&&Sl.get("OES_element_index_uint")?(Al=_l.UNSIGNED_INT,Pl=4):wl.array instanceof Uint16Array?(Al=_l.UNSIGNED_SHORT,Pl=2):(Al=_l.UNSIGNED_BYTE,Pl=1)},render:function(wl,Rl){_l.drawElements(Ml,Rl,Al,wl*Pl),El.calls++,El.vertices+=Rl,Ml===_l.TRIANGLES&&(El.faces+=Rl/3)},renderInstances:function(wl,Rl,Cl){var Il=Sl.get("ANGLE_instanced_arrays");return null===Il?void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):void(Il.drawElementsInstancedANGLE(Ml,Cl,Al,Rl*Pl,wl.maxInstancedCount),El.calls++,El.vertices+=Cl*wl.maxInstancedCount,Ml===_l.TRIANGLES&&(El.faces+=wl.maxInstancedCount*Cl/3))}}}function Ct(_l,Sl,El){var Ml;return{setMode:function(Pl){Ml=Pl},render:function(Pl,Ll){_l.drawArrays(Ml,Pl,Ll),El.calls++,El.vertices+=Ll,Ml===_l.TRIANGLES&&(El.faces+=Ll/3)},renderInstances:function(Pl){var Ll=Sl.get("ANGLE_instanced_arrays");if(null===Ll)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var wl=Pl.attributes.position,Rl=0;wl.isInterleavedBufferAttribute?(Rl=wl.data.count,Ll.drawArraysInstancedANGLE(Ml,0,Rl,Pl.maxInstancedCount)):(Rl=wl.count,Ll.drawArraysInstancedANGLE(Ml,0,Rl,Pl.maxInstancedCount)),El.calls++,El.vertices+=Rl*Pl.maxInstancedCount,Ml===_l.TRIANGLES&&(El.faces+=Pl.maxInstancedCount*Rl/3)}}}function It(){var _l={};return{get:function(Sl){if(void 0!==_l[Sl.id])return _l[Sl.id];var El;switch(Sl.type){case"DirectionalLight":El={direction:new Z,color:new ze,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new H};break;case"SpotLight":El={position:new Z,direction:new Z,color:new ze,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new H};break;case"PointLight":El={position:new Z,color:new ze,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new H};break;case"HemisphereLight":El={direction:new Z,skyColor:new ze,groundColor:new ze};break;case"RectAreaLight":El={color:new ze,position:new Z,halfWidth:new Z,halfHeight:new Z};}return _l[Sl.id]=El,El}}}function Dt(_l){var Sl=_l.split("\n");for(var El=0;El<Sl.length;El++)Sl[El]=El+1+": "+Sl[El];return Sl.join("\n")}function Gt(_l,Sl,El){var Ml=_l.createShader(Sl);return _l.shaderSource(Ml,El),_l.compileShader(Ml),!1===_l.getShaderParameter(Ml,_l.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==_l.getShaderInfoLog(Ml)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",Sl===_l.VERTEX_SHADER?"vertex":"fragment",_l.getShaderInfoLog(Ml),Dt(El)),Ml}function Bt(_l){switch(_l){case xs:return["Linear","( value )"];case Ts:return["sRGB","( value )"];case _s:return["RGBE","( value )"];case Ss:return["RGBM","( value, 7.0 )"];case Es:return["RGBM","( value, 16.0 )"];case Ms:return["RGBD","( value, 256.0 )"];case vs:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+_l);}}function Ft(_l,Sl){var El=Bt(Sl);return"vec4 "+_l+"( vec4 value ) { return "+El[0]+"ToLinear"+El[1]+"; }"}function Nt(_l,Sl){var El=Bt(Sl);return"vec4 "+_l+"( vec4 value ) { return LinearTo"+El[0]+El[1]+"; }"}function Ut(_l,Sl){var El;switch(Sl){case nn:El="Linear";break;case sn:El="Reinhard";break;case ln:El="Uncharted2";break;case dn:El="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+Sl);}return"vec3 "+_l+"( vec3 color ) { return "+El+"ToneMapping( color ); }"}function Ht(_l,Sl,El){_l=_l||{};var Ml=[_l.derivatives||Sl.envMapCubeUV||Sl.bumpMap||Sl.normalMap||Sl.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(_l.fragDepth||Sl.logarithmicDepthBuffer)&&El.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",_l.drawBuffers&&El.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(_l.shaderTextureLOD||Sl.envMap)&&El.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return Ml.filter(Vt).join("\n")}function zt(_l){var Sl=[];for(var El in _l){var Ml=_l[El];!1===Ml||Sl.push("#define "+El+" "+Ml)}return Sl.join("\n")}function Ot(_l,Sl){var El={},Ml=_l.getProgramParameter(Sl,_l.ACTIVE_ATTRIBUTES);for(var Al=0;Al<Ml;Al++){var Pl=_l.getActiveAttrib(Sl,Al),Ll=Pl.name;El[Ll]=_l.getAttribLocation(Sl,Ll)}return El}function Vt(_l){return""!==_l}function kt(_l,Sl){return _l.replace(/NUM_DIR_LIGHTS/g,Sl.numDirLights).replace(/NUM_SPOT_LIGHTS/g,Sl.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,Sl.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,Sl.numPointLights).replace(/NUM_HEMI_LIGHTS/g,Sl.numHemiLights)}function Wt(_l){var Sl=/#include +<([\w\d.]+)>/g;return _l.replace(Sl,function(Ml,Al){var El=Fs[Al];if(El===void 0)throw new Error("Can not resolve #include <"+Al+">");return Wt(El)})}function Xt(_l){var Sl=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return _l.replace(Sl,function(Ml,Al,Pl,Ll){var wl="";for(var Rl=parseInt(Al);Rl<parseInt(Pl);Rl++)wl+=Ll.replace(/\[ i \]/g,"[ "+Rl+" ]");return wl})}function jt(_l,Sl,El,Ml){var Al=_l.context,Pl=El.extensions,Ll=El.defines,wl=El.__webglShader.vertexShader,Rl=El.__webglShader.fragmentShader,Cl="SHADOWMAP_TYPE_BASIC";Ml.shadowMapType===mi?Cl="SHADOWMAP_TYPE_PCF":Ml.shadowMapType===gi&&(Cl="SHADOWMAP_TYPE_PCF_SOFT");var Il="ENVMAP_TYPE_CUBE",Dl="ENVMAP_MODE_REFLECTION",Gl="ENVMAP_BLENDING_MULTIPLY";if(Ml.envMap){switch(El.envMap.mapping){case cn:case un:Il="ENVMAP_TYPE_CUBE";break;case yn:case xn:Il="ENVMAP_TYPE_CUBE_UV";break;case mn:case gn:Il="ENVMAP_TYPE_EQUIREC";break;case hn:Il="ENVMAP_TYPE_SPHERE";}switch(El.envMap.mapping){case un:case gn:Dl="ENVMAP_MODE_REFRACTION";}switch(El.combine){case tn:Gl="ENVMAP_BLENDING_MULTIPLY";break;case rn:Gl="ENVMAP_BLENDING_MIX";break;case an:Gl="ENVMAP_BLENDING_ADD";}}var Bl=0<_l.gammaFactor?_l.gammaFactor:1,Fl=Ht(Pl,Ml,_l.extensions),Nl=zt(Ll),Ul=Al.createProgram(),Hl,zl;El.isRawShaderMaterial?(Hl=[Nl,"\n"].filter(Vt).join("\n"),zl=[Fl,Nl,"\n"].filter(Vt).join("\n")):(Hl=["precision "+Ml.precision+" float;","precision "+Ml.precision+" int;","#define SHADER_NAME "+El.__webglShader.name,Nl,Ml.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+Bl,"#define MAX_BONES "+Ml.maxBones,Ml.map?"#define USE_MAP":"",Ml.envMap?"#define USE_ENVMAP":"",Ml.envMap?"#define "+Dl:"",Ml.lightMap?"#define USE_LIGHTMAP":"",Ml.aoMap?"#define USE_AOMAP":"",Ml.emissiveMap?"#define USE_EMISSIVEMAP":"",Ml.bumpMap?"#define USE_BUMPMAP":"",Ml.normalMap?"#define USE_NORMALMAP":"",Ml.displacementMap&&Ml.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",Ml.specularMap?"#define USE_SPECULARMAP":"",Ml.roughnessMap?"#define USE_ROUGHNESSMAP":"",Ml.metalnessMap?"#define USE_METALNESSMAP":"",Ml.alphaMap?"#define USE_ALPHAMAP":"",Ml.vertexColors?"#define USE_COLOR":"",Ml.flatShading?"#define FLAT_SHADED":"",Ml.skinning?"#define USE_SKINNING":"",Ml.useVertexTexture?"#define BONE_TEXTURE":"",Ml.morphTargets?"#define USE_MORPHTARGETS":"",Ml.morphNormals&&!1===Ml.flatShading?"#define USE_MORPHNORMALS":"",Ml.doubleSided?"#define DOUBLE_SIDED":"",Ml.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+Ml.numClippingPlanes,Ml.shadowMapEnabled?"#define USE_SHADOWMAP":"",Ml.shadowMapEnabled?"#define "+Cl:"",Ml.sizeAttenuation?"#define USE_SIZEATTENUATION":"",Ml.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Ml.logarithmicDepthBuffer&&_l.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Vt).join("\n"),zl=[Fl,"precision "+Ml.precision+" float;","precision "+Ml.precision+" int;","#define SHADER_NAME "+El.__webglShader.name,Nl,Ml.alphaTest?"#define ALPHATEST "+Ml.alphaTest:"","#define GAMMA_FACTOR "+Bl,Ml.useFog&&Ml.fog?"#define USE_FOG":"",Ml.useFog&&Ml.fogExp?"#define FOG_EXP2":"",Ml.map?"#define USE_MAP":"",Ml.envMap?"#define USE_ENVMAP":"",Ml.envMap?"#define "+Il:"",Ml.envMap?"#define "+Dl:"",Ml.envMap?"#define "+Gl:"",Ml.lightMap?"#define USE_LIGHTMAP":"",Ml.aoMap?"#define USE_AOMAP":"",Ml.emissiveMap?"#define USE_EMISSIVEMAP":"",Ml.bumpMap?"#define USE_BUMPMAP":"",Ml.normalMap?"#define USE_NORMALMAP":"",Ml.specularMap?"#define USE_SPECULARMAP":"",Ml.roughnessMap?"#define USE_ROUGHNESSMAP":"",Ml.metalnessMap?"#define USE_METALNESSMAP":"",Ml.alphaMap?"#define USE_ALPHAMAP":"",Ml.vertexColors?"#define USE_COLOR":"",Ml.gradientMap?"#define USE_GRADIENTMAP":"",Ml.flatShading?"#define FLAT_SHADED":"",Ml.doubleSided?"#define DOUBLE_SIDED":"",Ml.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+Ml.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(Ml.numClippingPlanes-Ml.numClipIntersection),Ml.shadowMapEnabled?"#define USE_SHADOWMAP":"",Ml.shadowMapEnabled?"#define "+Cl:"",Ml.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",Ml.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",Ml.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Ml.logarithmicDepthBuffer&&_l.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",Ml.envMap&&_l.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",Ml.toneMapping===on?"":"#define TONE_MAPPING",Ml.toneMapping===on?"":Fs.tonemapping_pars_fragment,Ml.toneMapping===on?"":Ut("toneMapping",Ml.toneMapping),Ml.outputEncoding||Ml.mapEncoding||Ml.envMapEncoding||Ml.emissiveMapEncoding?Fs.encodings_pars_fragment:"",Ml.mapEncoding?Ft("mapTexelToLinear",Ml.mapEncoding):"",Ml.envMapEncoding?Ft("envMapTexelToLinear",Ml.envMapEncoding):"",Ml.emissiveMapEncoding?Ft("emissiveMapTexelToLinear",Ml.emissiveMapEncoding):"",Ml.outputEncoding?Nt("linearToOutputTexel",Ml.outputEncoding):"",Ml.depthPacking?"#define DEPTH_PACKING "+El.depthPacking:"","\n"].filter(Vt).join("\n")),wl=Wt(wl,Ml),wl=kt(wl,Ml),Rl=Wt(Rl,Ml),Rl=kt(Rl,Ml),El.isShaderMaterial||(wl=Xt(wl),Rl=Xt(Rl));var Ol=Hl+wl,Vl=zl+Rl,Wl=Gt(Al,Al.VERTEX_SHADER,Ol),Xl=Gt(Al,Al.FRAGMENT_SHADER,Vl);Al.attachShader(Ul,Wl),Al.attachShader(Ul,Xl),void 0===El.index0AttributeName?!0===Ml.morphTargets&&Al.bindAttribLocation(Ul,0,"position"):Al.bindAttribLocation(Ul,0,El.index0AttributeName),Al.linkProgram(Ul);var Yl=Al.getProgramInfoLog(Ul),ql=Al.getShaderInfoLog(Wl),Zl=Al.getShaderInfoLog(Xl),Kl=!0,Ql=!0;!1===Al.getProgramParameter(Ul,Al.LINK_STATUS)?(Kl=!1,console.error("THREE.WebGLProgram: shader error: ",Al.getError(),"gl.VALIDATE_STATUS",Al.getProgramParameter(Ul,Al.VALIDATE_STATUS),"gl.getProgramInfoLog",Yl,ql,Zl)):""===Yl?(""===ql||""===Zl)&&(Ql=!1):console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",Yl),Ql&&(this.diagnostics={runnable:Kl,material:El,programLog:Yl,vertexShader:{log:ql,prefix:Hl},fragmentShader:{log:Zl,prefix:zl}}),Al.deleteShader(Wl),Al.deleteShader(Xl);var Jl;this.getUniforms=function(){return void 0==Jl&&(Jl=new He(Al,Ul,_l)),Jl};var $l;return this.getAttributes=function(){return void 0==$l&&($l=Ot(Al,Ul)),$l},this.destroy=function(){Al.deleteProgram(Ul),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=ks++,this.code=Sl,this.usedTimes=1,this.program=Ul,this.vertexShader=Wl,this.fragmentShader=Xl,this}function Yt(_l,Sl){function El(wl){if(Sl.floatVertexTextures&&wl&&wl.skeleton&&wl.skeleton.useVertexTexture)return 1024;var Rl=Sl.maxVertexUniforms,Cl=Math.floor((Rl-20)/4),Il=Cl;return void 0!==wl&&wl&&wl.isSkinnedMesh&&(Il=Math.min(wl.skeleton.bones.length,Il),Il<wl.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+wl.skeleton.bones.length+", this GPU supports just "+Il+" (try OpenGL instead of ANGLE)")),Il}function Ml(wl,Rl){var Cl;return wl?wl.isTexture?Cl=wl.encoding:wl.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),Cl=wl.texture.encoding):Cl=xs,Cl===xs&&Rl&&(Cl=vs),Cl}var Al=[],Pl={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},Ll=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking"];this.getParameters=function(wl,Rl,Cl,Il,Dl,Gl){var Bl=Pl[wl.type],Fl=El(Gl),Nl=_l.getPrecision();null!==wl.precision&&(Nl=Sl.getMaxPrecision(wl.precision),Nl!==wl.precision&&console.warn("THREE.WebGLProgram.getParameters:",wl.precision,"not supported, using",Nl,"instead."));var Ul=_l.getCurrentRenderTarget(),Hl={shaderID:Bl,precision:Nl,supportsVertexTextures:Sl.vertexTextures,outputEncoding:Ml(Ul?Ul.texture:null,_l.gammaOutput),map:!!wl.map,mapEncoding:Ml(wl.map,_l.gammaInput),envMap:!!wl.envMap,envMapMode:wl.envMap&&wl.envMap.mapping,envMapEncoding:Ml(wl.envMap,_l.gammaInput),envMapCubeUV:!!wl.envMap&&(wl.envMap.mapping===yn||wl.envMap.mapping===xn),lightMap:!!wl.lightMap,aoMap:!!wl.aoMap,emissiveMap:!!wl.emissiveMap,emissiveMapEncoding:Ml(wl.emissiveMap,_l.gammaInput),bumpMap:!!wl.bumpMap,normalMap:!!wl.normalMap,displacementMap:!!wl.displacementMap,roughnessMap:!!wl.roughnessMap,metalnessMap:!!wl.metalnessMap,specularMap:!!wl.specularMap,alphaMap:!!wl.alphaMap,gradientMap:!!wl.gradientMap,combine:wl.combine,vertexColors:wl.vertexColors,fog:!!Cl,useFog:wl.fog,fogExp:Cl&&Cl.isFogExp2,flatShading:wl.shading===Ti,sizeAttenuation:wl.sizeAttenuation,logarithmicDepthBuffer:Sl.logarithmicDepthBuffer,skinning:wl.skinning,maxBones:Fl,useVertexTexture:Sl.floatVertexTextures&&Gl&&Gl.skeleton&&Gl.skeleton.useVertexTexture,morphTargets:wl.morphTargets,morphNormals:wl.morphNormals,maxMorphTargets:_l.maxMorphTargets,maxMorphNormals:_l.maxMorphNormals,numDirLights:Rl.directional.length,numPointLights:Rl.point.length,numSpotLights:Rl.spot.length,numRectAreaLights:Rl.rectArea.length,numHemiLights:Rl.hemi.length,numClippingPlanes:Il,numClipIntersection:Dl,shadowMapEnabled:_l.shadowMap.enabled&&Gl.receiveShadow&&0<Rl.shadows.length,shadowMapType:_l.shadowMap.type,toneMapping:_l.toneMapping,physicallyCorrectLights:_l.physicallyCorrectLights,premultipliedAlpha:wl.premultipliedAlpha,alphaTest:wl.alphaTest,doubleSided:wl.side===xi,flipSided:wl.side===yi,depthPacking:wl.depthPacking!==void 0&&wl.depthPacking};return Hl},this.getProgramCode=function(wl,Rl){var Cl=[];if(Rl.shaderID?Cl.push(Rl.shaderID):(Cl.push(wl.fragmentShader),Cl.push(wl.vertexShader)),void 0!==wl.defines)for(var Il in wl.defines)Cl.push(Il),Cl.push(wl.defines[Il]);for(var Dl=0;Dl<Ll.length;Dl++)Cl.push(Rl[Ll[Dl]]);return Cl.join()},this.acquireProgram=function(wl,Rl,Cl){var Il;for(var Dl=0,Gl=Al.length;Dl<Gl;Dl++){var Bl=Al[Dl];if(Bl.code===Cl){Il=Bl,++Il.usedTimes;break}}return void 0===Il&&(Il=new jt(_l,Cl,wl,Rl),Al.push(Il)),Il},this.releaseProgram=function(wl){if(0==--wl.usedTimes){var Rl=Al.indexOf(wl);Al[Rl]=Al[Al.length-1],Al.pop(),wl.destroy()}},this.programs=Al}function qt(_l,Sl,El){function Ml(Cl){var Il=Cl.target,Dl=Rl[Il.id];null!==Dl.index&&Pl(Dl.index),Ll(Dl.attributes),Il.removeEventListener("dispose",Ml),delete Rl[Il.id];var Gl=Sl.get(Il);Gl.wireframe&&Pl(Gl.wireframe),Sl.delete(Il);var Bl=Sl.get(Dl);Bl.wireframe&&Pl(Bl.wireframe),Sl.delete(Dl),El.memory.geometries--}function Al(Cl){return Cl.isInterleavedBufferAttribute?Sl.get(Cl.data).__webglBuffer:Sl.get(Cl).__webglBuffer}function Pl(Cl){var Il=Al(Cl);Il!==void 0&&(_l.deleteBuffer(Il),wl(Cl))}function Ll(Cl){for(var Il in Cl)Pl(Cl[Il])}function wl(Cl){Cl.isInterleavedBufferAttribute?Sl.delete(Cl.data):Sl.delete(Cl)}var Rl={};return{get:function(Cl){var Il=Cl.geometry;if(void 0!==Rl[Il.id])return Rl[Il.id];Il.addEventListener("dispose",Ml);var Dl;return Il.isBufferGeometry?Dl=Il:Il.isGeometry&&(void 0===Il._bufferGeometry&&(Il._bufferGeometry=new St().setFromObject(Cl)),Dl=Il._bufferGeometry),Rl[Il.id]=Dl,El.memory.geometries++,Dl}}}function Zt(_l,Sl,El){function Ml(wl,Rl){var Cl=wl.isInterleavedBufferAttribute?wl.data:wl,Il=Sl.get(Cl);Il.__webglBuffer===void 0?Al(Il,Cl,Rl):Il.version!==Cl.version&&Pl(Il,Cl,Rl)}function Al(wl,Rl,Cl){wl.__webglBuffer=_l.createBuffer(),_l.bindBuffer(Cl,wl.__webglBuffer);var Il=Rl.dynamic?_l.DYNAMIC_DRAW:_l.STATIC_DRAW;_l.bufferData(Cl,Rl.array,Il);var Dl=_l.FLOAT,Gl=Rl.array;Gl instanceof Float32Array?Dl=_l.FLOAT:Gl instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):Gl instanceof Uint16Array?Dl=_l.UNSIGNED_SHORT:Gl instanceof Int16Array?Dl=_l.SHORT:Gl instanceof Uint32Array?Dl=_l.UNSIGNED_INT:Gl instanceof Int32Array?Dl=_l.INT:Gl instanceof Int8Array?Dl=_l.BYTE:Gl instanceof Uint8Array&&(Dl=_l.UNSIGNED_BYTE),wl.bytesPerElement=Gl.BYTES_PER_ELEMENT,wl.type=Dl,wl.version=Rl.version,Rl.onUploadCallback()}function Pl(wl,Rl,Cl){_l.bindBuffer(Cl,wl.__webglBuffer),!1===Rl.dynamic?_l.bufferData(Cl,Rl.array,_l.STATIC_DRAW):-1===Rl.updateRange.count?_l.bufferSubData(Cl,0,Rl.array):0===Rl.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(_l.bufferSubData(Cl,Rl.updateRange.offset*Rl.array.BYTES_PER_ELEMENT,Rl.array.subarray(Rl.updateRange.offset,Rl.updateRange.offset+Rl.updateRange.count)),Rl.updateRange.count=0),wl.version=Rl.version}var Ll=new qt(_l,Sl,El);return{getAttributeBuffer:function(Rl){return Rl.isInterleavedBufferAttribute?Sl.get(Rl.data).__webglBuffer:Sl.get(Rl).__webglBuffer},getAttributeProperties:function(Rl){return Rl.isInterleavedBufferAttribute?Sl.get(Rl.data):Sl.get(Rl)},getWireframeAttribute:function(Rl){var Cl=Sl.get(Rl);if(void 0!==Cl.wireframe)return Cl.wireframe;var Il=[],Dl=Rl.index,Gl=Rl.attributes,Bl=Gl.position;if(null!==Dl){var Fl=Dl.array;for(var Nl=0,Ul=Fl.length;Nl<Ul;Nl+=3){var Hl=Fl[Nl+0],zl=Fl[Nl+1],Ol=Fl[Nl+2];Il.push(Hl,zl,zl,Ol,Ol,Hl)}}else{var Fl=Gl.position.array;for(var Nl=0,Ul=Fl.length/3-1;Nl<Ul;Nl+=3){var Hl=Nl+0,zl=Nl+1,Ol=Nl+2;Il.push(Hl,zl,zl,Ol,Ol,Hl)}}var Vl=65535<Bl.count?Uint32Array:Uint16Array,Wl=new lt(new Vl(Il),1);return Ml(Wl,_l.ELEMENT_ARRAY_BUFFER),Cl.wireframe=Wl,Wl},update:function(Rl){var Cl=Ll.get(Rl);Rl.geometry.isGeometry&&Cl.updateFromObject(Rl);var Il=Cl.index,Dl=Cl.attributes;for(var Gl in null!==Il&&Ml(Il,_l.ELEMENT_ARRAY_BUFFER),Dl)Ml(Dl[Gl],_l.ARRAY_BUFFER);var Bl=Cl.morphAttributes;for(var Gl in Bl){var Fl=Bl[Gl];for(var Nl=0,Ul=Fl.length;Nl<Ul;Nl++)Ml(Fl[Nl],_l.ARRAY_BUFFER)}return Cl}}}function Kt(_l,Sl,El,Ml,Al,Pl,Ll){function wl(Zl,Kl){if(Zl.width>Kl||Zl.height>Kl){var Ql=Kl/Math.max(Zl.width,Zl.height),Jl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");Jl.width=Math.floor(Zl.width*Ql),Jl.height=Math.floor(Zl.height*Ql);var $l=Jl.getContext("2d");return $l.drawImage(Zl,0,0,Zl.width,Zl.height,0,0,Jl.width,Jl.height),console.warn("THREE.WebGLRenderer: image is too big ("+Zl.width+"x"+Zl.height+"). Resized to "+Jl.width+"x"+Jl.height,Zl),Jl}return Zl}function Rl(Zl){return Ls.isPowerOfTwo(Zl.width)&&Ls.isPowerOfTwo(Zl.height)}function Cl(Zl){if(Zl instanceof HTMLImageElement||Zl instanceof HTMLCanvasElement){var Kl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");Kl.width=Ls.nearestPowerOfTwo(Zl.width),Kl.height=Ls.nearestPowerOfTwo(Zl.height);var Ql=Kl.getContext("2d");return Ql.drawImage(Zl,0,0,Kl.width,Kl.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+Zl.width+"x"+Zl.height+"). Resized to "+Kl.width+"x"+Kl.height,Zl),Kl}return Zl}function Il(Zl){return Zl.wrapS!==vn||Zl.wrapT!==vn||Zl.minFilter!==En&&Zl.minFilter!==Pn}function Dl(Zl){return Zl===En||Zl===Mn||Zl===An?_l.NEAREST:_l.LINEAR}function Gl(Zl){var Kl=Zl.target;Kl.removeEventListener("dispose",Gl),Fl(Kl),Yl.textures--}function Bl(Zl){var Kl=Zl.target;Kl.removeEventListener("dispose",Bl),Nl(Kl),Yl.textures--}function Fl(Zl){var Kl=Ml.get(Zl);if(Zl.image&&Kl.__image__webglTextureCube)_l.deleteTexture(Kl.__image__webglTextureCube);else{if(Kl.__webglInit===void 0)return;_l.deleteTexture(Kl.__webglTexture)}Ml.delete(Zl)}function Nl(Zl){var Kl=Ml.get(Zl),Ql=Ml.get(Zl.texture);if(Zl){if(void 0!==Ql.__webglTexture&&_l.deleteTexture(Ql.__webglTexture),Zl.depthTexture&&Zl.depthTexture.dispose(),Zl.isWebGLRenderTargetCube)for(var Jl=0;6>Jl;Jl++)_l.deleteFramebuffer(Kl.__webglFramebuffer[Jl]),Kl.__webglDepthbuffer&&_l.deleteRenderbuffer(Kl.__webglDepthbuffer[Jl]);else _l.deleteFramebuffer(Kl.__webglFramebuffer),Kl.__webglDepthbuffer&&_l.deleteRenderbuffer(Kl.__webglDepthbuffer);Ml.delete(Zl.texture),Ml.delete(Zl)}}function Ul(Zl,Kl){var Ql=Ml.get(Zl);if(0<Zl.version&&Ql.__version!==Zl.version){var Jl=Zl.image;if(Jl===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",Zl);else if(!1===Jl.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",Zl);else return void zl(Ql,Zl,Kl)}El.activeTexture(_l.TEXTURE0+Kl),El.bindTexture(_l.TEXTURE_2D,Ql.__webglTexture)}function Hl(Zl,Kl,Ql){var Jl;if(Ql?(_l.texParameteri(Zl,_l.TEXTURE_WRAP_S,Pl(Kl.wrapS)),_l.texParameteri(Zl,_l.TEXTURE_WRAP_T,Pl(Kl.wrapT)),_l.texParameteri(Zl,_l.TEXTURE_MAG_FILTER,Pl(Kl.magFilter)),_l.texParameteri(Zl,_l.TEXTURE_MIN_FILTER,Pl(Kl.minFilter))):(_l.texParameteri(Zl,_l.TEXTURE_WRAP_S,_l.CLAMP_TO_EDGE),_l.texParameteri(Zl,_l.TEXTURE_WRAP_T,_l.CLAMP_TO_EDGE),(Kl.wrapS!==vn||Kl.wrapT!==vn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",Kl),_l.texParameteri(Zl,_l.TEXTURE_MAG_FILTER,Dl(Kl.magFilter)),_l.texParameteri(Zl,_l.TEXTURE_MIN_FILTER,Dl(Kl.minFilter)),Kl.minFilter!==En&&Kl.minFilter!==Pn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",Kl)),Jl=Sl.get("EXT_texture_filter_anisotropic"),Jl){if(Kl.type===Nn&&null===Sl.get("OES_texture_float_linear"))return;if(Kl.type===Un&&null===Sl.get("OES_texture_half_float_linear"))return;(1<Kl.anisotropy||Ml.get(Kl).__currentAnisotropy)&&(_l.texParameterf(Zl,Jl.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Kl.anisotropy,Al.getMaxAnisotropy())),Ml.get(Kl).__currentAnisotropy=Kl.anisotropy)}}function zl(Zl,Kl,Ql){Zl.__webglInit===void 0&&(Zl.__webglInit=!0,Kl.addEventListener("dispose",Gl),Zl.__webglTexture=_l.createTexture(),Yl.textures++),El.activeTexture(_l.TEXTURE0+Ql),El.bindTexture(_l.TEXTURE_2D,Zl.__webglTexture),_l.pixelStorei(_l.UNPACK_FLIP_Y_WEBGL,Kl.flipY),_l.pixelStorei(_l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Kl.premultiplyAlpha),_l.pixelStorei(_l.UNPACK_ALIGNMENT,Kl.unpackAlignment);var Jl=wl(Kl.image,Al.maxTextureSize);Il(Kl)&&!1===Rl(Jl)&&(Jl=Cl(Jl));var $l=Rl(Jl),ed=Pl(Kl.format),td=Pl(Kl.type);Hl(_l.TEXTURE_2D,Kl,$l);var od=Kl.mipmaps,rd;if(Kl.isDepthTexture){var nd=_l.DEPTH_COMPONENT;if(Kl.type===Nn){if(!ql)throw new Error("Float Depth Texture only supported in WebGL2.0");nd=_l.DEPTH_COMPONENT32F}else ql&&(nd=_l.DEPTH_COMPONENT16);Kl.format===qn&&nd===_l.DEPTH_COMPONENT&&Kl.type!==Gn&&Kl.type!==Fn&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Kl.type=Gn,td=Pl(Kl.type)),Kl.format===Zn&&(nd=_l.DEPTH_STENCIL,Kl.type!==Vn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Kl.type=Vn,td=Pl(Kl.type))),El.texImage2D(_l.TEXTURE_2D,0,nd,Jl.width,Jl.height,0,ed,td,null)}else if(Kl.isDataTexture){if(0<od.length&&$l){for(var sd=0,ld=od.length;sd<ld;sd++)rd=od[sd],El.texImage2D(_l.TEXTURE_2D,sd,ed,rd.width,rd.height,0,ed,td,rd.data);Kl.generateMipmaps=!1}else El.texImage2D(_l.TEXTURE_2D,0,ed,Jl.width,Jl.height,0,ed,td,Jl.data);}else if(Kl.isCompressedTexture)for(var sd=0,ld=od.length;sd<ld;sd++)rd=od[sd],Kl.format!==Xn&&Kl.format!==Wn?-1<El.getCompressedTextureFormats().indexOf(ed)?El.compressedTexImage2D(_l.TEXTURE_2D,sd,ed,rd.width,rd.height,0,rd.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):El.texImage2D(_l.TEXTURE_2D,sd,ed,rd.width,rd.height,0,ed,td,rd.data);else if(0<od.length&&$l){for(var sd=0,ld=od.length;sd<ld;sd++)rd=od[sd],El.texImage2D(_l.TEXTURE_2D,sd,ed,ed,td,rd);Kl.generateMipmaps=!1}else El.texImage2D(_l.TEXTURE_2D,0,ed,ed,td,Jl);Kl.generateMipmaps&&$l&&_l.generateMipmap(_l.TEXTURE_2D),Zl.__version=Kl.version,Kl.onUpdate&&Kl.onUpdate(Kl)}function Ol(Zl,Kl,Ql,Jl){var $l=Pl(Kl.texture.format),ed=Pl(Kl.texture.type);El.texImage2D(Jl,0,$l,Kl.width,Kl.height,0,$l,ed,null),_l.bindFramebuffer(_l.FRAMEBUFFER,Zl),_l.framebufferTexture2D(_l.FRAMEBUFFER,Ql,Jl,Ml.get(Kl.texture).__webglTexture,0),_l.bindFramebuffer(_l.FRAMEBUFFER,null)}function Vl(Zl,Kl){_l.bindRenderbuffer(_l.RENDERBUFFER,Zl),Kl.depthBuffer&&!Kl.stencilBuffer?(_l.renderbufferStorage(_l.RENDERBUFFER,_l.DEPTH_COMPONENT16,Kl.width,Kl.height),_l.framebufferRenderbuffer(_l.FRAMEBUFFER,_l.DEPTH_ATTACHMENT,_l.RENDERBUFFER,Zl)):Kl.depthBuffer&&Kl.stencilBuffer?(_l.renderbufferStorage(_l.RENDERBUFFER,_l.DEPTH_STENCIL,Kl.width,Kl.height),_l.framebufferRenderbuffer(_l.FRAMEBUFFER,_l.DEPTH_STENCIL_ATTACHMENT,_l.RENDERBUFFER,Zl)):_l.renderbufferStorage(_l.RENDERBUFFER,_l.RGBA4,Kl.width,Kl.height),_l.bindRenderbuffer(_l.RENDERBUFFER,null)}function Wl(Zl,Kl){var Ql=Kl&&Kl.isWebGLRenderTargetCube;if(Ql)throw new Error("Depth Texture with cube render targets is not supported!");if(_l.bindFramebuffer(_l.FRAMEBUFFER,Zl),!(Kl.depthTexture&&Kl.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");Ml.get(Kl.depthTexture).__webglTexture&&Kl.depthTexture.image.width===Kl.width&&Kl.depthTexture.image.height===Kl.height||(Kl.depthTexture.image.width=Kl.width,Kl.depthTexture.image.height=Kl.height,Kl.depthTexture.needsUpdate=!0),Ul(Kl.depthTexture,0);var Jl=Ml.get(Kl.depthTexture).__webglTexture;if(Kl.depthTexture.format===qn)_l.framebufferTexture2D(_l.FRAMEBUFFER,_l.DEPTH_ATTACHMENT,_l.TEXTURE_2D,Jl,0);else if(Kl.depthTexture.format===Zn)_l.framebufferTexture2D(_l.FRAMEBUFFER,_l.DEPTH_STENCIL_ATTACHMENT,_l.TEXTURE_2D,Jl,0);else throw new Error("Unknown depthTexture format")}function Xl(Zl){var Kl=Ml.get(Zl),Ql=!0===Zl.isWebGLRenderTargetCube;if(Zl.depthTexture){if(Ql)throw new Error("target.depthTexture not supported in Cube render targets");Wl(Kl.__webglFramebuffer,Zl)}else if(Ql){Kl.__webglDepthbuffer=[];for(var Jl=0;6>Jl;Jl++)_l.bindFramebuffer(_l.FRAMEBUFFER,Kl.__webglFramebuffer[Jl]),Kl.__webglDepthbuffer[Jl]=_l.createRenderbuffer(),Vl(Kl.__webglDepthbuffer[Jl],Zl)}else _l.bindFramebuffer(_l.FRAMEBUFFER,Kl.__webglFramebuffer),Kl.__webglDepthbuffer=_l.createRenderbuffer(),Vl(Kl.__webglDepthbuffer,Zl);_l.bindFramebuffer(_l.FRAMEBUFFER,null)}var Yl=Ll.memory,ql="undefined"!=typeof WebGL2RenderingContext&&_l instanceof WebGL2RenderingContext;this.setTexture2D=Ul,this.setTextureCube=function(Kl,Ql){var Jl=Ml.get(Kl);if(6===Kl.image.length)if(0<Kl.version&&Jl.__version!==Kl.version){Jl.__image__webglTextureCube||(Kl.addEventListener("dispose",Gl),Jl.__image__webglTextureCube=_l.createTexture(),Yl.textures++),El.activeTexture(_l.TEXTURE0+Ql),El.bindTexture(_l.TEXTURE_CUBE_MAP,Jl.__image__webglTextureCube),_l.pixelStorei(_l.UNPACK_FLIP_Y_WEBGL,Kl.flipY);var $l=Kl&&Kl.isCompressedTexture,ed=Kl.image[0]&&Kl.image[0].isDataTexture,td=[];for(var rd=0;6>rd;rd++)td[rd]=$l||ed?ed?Kl.image[rd].image:Kl.image[rd]:wl(Kl.image[rd],Al.maxCubemapSize);var od=td[0],nd=Rl(od),sd=Pl(Kl.format),ld=Pl(Kl.type);Hl(_l.TEXTURE_CUBE_MAP,Kl,nd);for(var rd=0;6>rd;rd++)if(!$l)ed?El.texImage2D(_l.TEXTURE_CUBE_MAP_POSITIVE_X+rd,0,sd,td[rd].width,td[rd].height,0,sd,ld,td[rd].data):El.texImage2D(_l.TEXTURE_CUBE_MAP_POSITIVE_X+rd,0,sd,sd,ld,td[rd]);else{var cd=td[rd].mipmaps,dd;for(var ud=0,md=cd.length;ud<md;ud++)dd=cd[ud],Kl.format!==Xn&&Kl.format!==Wn?-1<El.getCompressedTextureFormats().indexOf(sd)?El.compressedTexImage2D(_l.TEXTURE_CUBE_MAP_POSITIVE_X+rd,ud,sd,dd.width,dd.height,0,dd.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):El.texImage2D(_l.TEXTURE_CUBE_MAP_POSITIVE_X+rd,ud,sd,dd.width,dd.height,0,sd,ld,dd.data)}Kl.generateMipmaps&&nd&&_l.generateMipmap(_l.TEXTURE_CUBE_MAP),Jl.__version=Kl.version,Kl.onUpdate&&Kl.onUpdate(Kl)}else El.activeTexture(_l.TEXTURE0+Ql),El.bindTexture(_l.TEXTURE_CUBE_MAP,Jl.__image__webglTextureCube)},this.setTextureCubeDynamic=function(Kl,Ql){El.activeTexture(_l.TEXTURE0+Ql),El.bindTexture(_l.TEXTURE_CUBE_MAP,Ml.get(Kl).__webglTexture)},this.setupRenderTarget=function(Kl){var Ql=Ml.get(Kl),Jl=Ml.get(Kl.texture);Kl.addEventListener("dispose",Bl),Jl.__webglTexture=_l.createTexture(),Yl.textures++;var $l=!0===Kl.isWebGLRenderTargetCube,ed=Rl(Kl);if($l){Ql.__webglFramebuffer=[];for(var td=0;6>td;td++)Ql.__webglFramebuffer[td]=_l.createFramebuffer()}else Ql.__webglFramebuffer=_l.createFramebuffer();if($l){El.bindTexture(_l.TEXTURE_CUBE_MAP,Jl.__webglTexture),Hl(_l.TEXTURE_CUBE_MAP,Kl.texture,ed);for(var td=0;6>td;td++)Ol(Ql.__webglFramebuffer[td],Kl,_l.COLOR_ATTACHMENT0,_l.TEXTURE_CUBE_MAP_POSITIVE_X+td);Kl.texture.generateMipmaps&&ed&&_l.generateMipmap(_l.TEXTURE_CUBE_MAP),El.bindTexture(_l.TEXTURE_CUBE_MAP,null)}else El.bindTexture(_l.TEXTURE_2D,Jl.__webglTexture),Hl(_l.TEXTURE_2D,Kl.texture,ed),Ol(Ql.__webglFramebuffer,Kl,_l.COLOR_ATTACHMENT0,_l.TEXTURE_2D),Kl.texture.generateMipmaps&&ed&&_l.generateMipmap(_l.TEXTURE_2D),El.bindTexture(_l.TEXTURE_2D,null);Kl.depthBuffer&&Xl(Kl)},this.updateRenderTargetMipmap=function(Kl){var Ql=Kl.texture;if(Ql.generateMipmaps&&Rl(Kl)&&Ql.minFilter!==En&&Ql.minFilter!==Pn){var Jl=Kl&&Kl.isWebGLRenderTargetCube?_l.TEXTURE_CUBE_MAP:_l.TEXTURE_2D,$l=Ml.get(Ql).__webglTexture;El.bindTexture(Jl,$l),_l.generateMipmap(Jl),El.bindTexture(Jl,null)}}}function Qt(){var _l={};return{get:function(Sl){var El=Sl.uuid,Ml=_l[El];return void 0===Ml&&(Ml={},_l[El]=Ml),Ml},delete:function(Sl){delete _l[Sl.uuid]},clear:function(){_l={}}}}function Jt(_l,Sl,El){function Ml(gd,hd,yd){var xd=new Uint8Array(4),Td=_l.createTexture();_l.bindTexture(gd,Td),_l.texParameteri(gd,_l.TEXTURE_MIN_FILTER,_l.NEAREST),_l.texParameteri(gd,_l.TEXTURE_MAG_FILTER,_l.NEAREST);for(var vd=0;vd<yd;vd++)_l.texImage2D(hd+vd,0,_l.RGBA,1,1,0,_l.RGBA,_l.UNSIGNED_BYTE,xd);return Td}function Al(gd){!0!==zl[gd]&&(_l.enable(gd),zl[gd]=!0)}function Pl(gd){!1!==zl[gd]&&(_l.disable(gd),zl[gd]=!1)}function Ll(gd,hd,yd,xd,Td,vd,_d,Sd){gd===Ei?Pl(_l.BLEND):Al(_l.BLEND),(gd!==Vl||Sd!==Ql)&&(gd===Ai?Sd?(_l.blendEquationSeparate(_l.FUNC_ADD,_l.FUNC_ADD),_l.blendFuncSeparate(_l.ONE,_l.ONE,_l.ONE,_l.ONE)):(_l.blendEquation(_l.FUNC_ADD),_l.blendFunc(_l.SRC_ALPHA,_l.ONE)):gd===Pi?Sd?(_l.blendEquationSeparate(_l.FUNC_ADD,_l.FUNC_ADD),_l.blendFuncSeparate(_l.ZERO,_l.ZERO,_l.ONE_MINUS_SRC_COLOR,_l.ONE_MINUS_SRC_ALPHA)):(_l.blendEquation(_l.FUNC_ADD),_l.blendFunc(_l.ZERO,_l.ONE_MINUS_SRC_COLOR)):gd===Li?Sd?(_l.blendEquationSeparate(_l.FUNC_ADD,_l.FUNC_ADD),_l.blendFuncSeparate(_l.ZERO,_l.SRC_COLOR,_l.ZERO,_l.SRC_ALPHA)):(_l.blendEquation(_l.FUNC_ADD),_l.blendFunc(_l.ZERO,_l.SRC_COLOR)):Sd?(_l.blendEquationSeparate(_l.FUNC_ADD,_l.FUNC_ADD),_l.blendFuncSeparate(_l.ONE,_l.ONE_MINUS_SRC_ALPHA,_l.ONE,_l.ONE_MINUS_SRC_ALPHA)):(_l.blendEquationSeparate(_l.FUNC_ADD,_l.FUNC_ADD),_l.blendFuncSeparate(_l.SRC_ALPHA,_l.ONE_MINUS_SRC_ALPHA,_l.ONE,_l.ONE_MINUS_SRC_ALPHA)),Vl=gd,Ql=Sd),gd===wi?(Td=Td||hd,vd=vd||yd,_d=_d||xd,(hd!==Wl||Td!==ql)&&(_l.blendEquationSeparate(El(hd),El(Td)),Wl=hd,ql=Td),(yd!==Xl||xd!==Yl||vd!==Zl||_d!==Kl)&&(_l.blendFuncSeparate(El(yd),El(xd),El(vd),El(_d)),Xl=yd,Yl=xd,Zl=vd,Kl=_d)):(Wl=null,Xl=null,Yl=null,ql=null,Zl=null,Kl=null)}function wl(gd){Gl.setFunc(gd)}function Rl(gd){Jl!==gd&&(gd?_l.frontFace(_l.CW):_l.frontFace(_l.CCW),Jl=gd)}function Cl(gd){gd===di?Pl(_l.CULL_FACE):(Al(_l.CULL_FACE),gd!==$l&&(gd===pi?_l.cullFace(_l.BACK):gd===ci?_l.cullFace(_l.FRONT):_l.cullFace(_l.FRONT_AND_BACK))),$l=gd}function Il(gd){void 0===gd&&(gd=_l.TEXTURE0+nd-1),dd!==gd&&(_l.activeTexture(gd),dd=gd)}var Dl=new function(){var hd=!1,yd=new V,xd=null,Td=new V;return{setMask:function(vd){xd===vd||hd||(_l.colorMask(vd,vd,vd,vd),xd=vd)},setLocked:function(vd){hd=vd},setClear:function(vd,_d,Sd,Ed,Md){!0===Md&&(vd*=Ed,_d*=Ed,Sd*=Ed),yd.set(vd,_d,Sd,Ed),!1===Td.equals(yd)&&(_l.clearColor(vd,_d,Sd,Ed),Td.copy(yd))},reset:function(){hd=!1,xd=null,Td.set(0,0,0,1)}}},Gl=new function(){var hd=!1,yd=null,xd=null,Td=null;return{setTest:function(vd){vd?Al(_l.DEPTH_TEST):Pl(_l.DEPTH_TEST)},setMask:function(vd){yd===vd||hd||(_l.depthMask(vd),yd=vd)},setFunc:function(vd){xd!==vd&&(vd?vd===Yi?_l.depthFunc(_l.NEVER):vd===qi?_l.depthFunc(_l.ALWAYS):vd===Zi?_l.depthFunc(_l.LESS):vd===Ki?_l.depthFunc(_l.LEQUAL):vd===Qi?_l.depthFunc(_l.EQUAL):vd===Ji?_l.depthFunc(_l.GEQUAL):vd===$i?_l.depthFunc(_l.GREATER):vd===en?_l.depthFunc(_l.NOTEQUAL):_l.depthFunc(_l.LEQUAL):_l.depthFunc(_l.LEQUAL),xd=vd)},setLocked:function(vd){hd=vd},setClear:function(vd){Td!==vd&&(_l.clearDepth(vd),Td=vd)},reset:function(){hd=!1,yd=null,xd=null,Td=null}}},Bl=new function(){var hd=!1,yd=null,xd=null,Td=null,vd=null,_d=null,Sd=null,Ed=null,Md=null;return{setTest:function(Ad){Ad?Al(_l.STENCIL_TEST):Pl(_l.STENCIL_TEST)},setMask:function(Ad){yd===Ad||hd||(_l.stencilMask(Ad),yd=Ad)},setFunc:function(Ad,Pd,Ld){(xd!==Ad||Td!==Pd||vd!==Ld)&&(_l.stencilFunc(Ad,Pd,Ld),xd=Ad,Td=Pd,vd=Ld)},setOp:function(Ad,Pd,Ld){(_d!==Ad||Sd!==Pd||Ed!==Ld)&&(_l.stencilOp(Ad,Pd,Ld),_d=Ad,Sd=Pd,Ed=Ld)},setLocked:function(Ad){hd=Ad},setClear:function(Ad){Md!==Ad&&(_l.clearStencil(Ad),Md=Ad)},reset:function(){hd=!1,yd=null,xd=null,Td=null,vd=null,_d=null,Sd=null,Ed=null,Md=null}}},Fl=_l.getParameter(_l.MAX_VERTEX_ATTRIBS),Nl=new Uint8Array(Fl),Ul=new Uint8Array(Fl),Hl=new Uint8Array(Fl),zl={},Ol=null,Vl=null,Wl=null,Xl=null,Yl=null,ql=null,Zl=null,Kl=null,Ql=!1,Jl=null,$l=null,ed=null,td=null,rd=null,od=null,nd=_l.getParameter(_l.MAX_TEXTURE_IMAGE_UNITS),sd=parseFloat(/^WebGL\ ([0-9])/.exec(_l.getParameter(_l.VERSION))[1]),ld=1<=parseFloat(sd),dd=null,cd={},ud=new V,md=new V,fd={};return fd[_l.TEXTURE_2D]=Ml(_l.TEXTURE_2D,_l.TEXTURE_2D,1),fd[_l.TEXTURE_CUBE_MAP]=Ml(_l.TEXTURE_CUBE_MAP,_l.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:Dl,depth:Gl,stencil:Bl},init:function(){Dl.setClear(0,0,0,1),Gl.setClear(1),Bl.setClear(0),Al(_l.DEPTH_TEST),wl(Ki),Rl(!1),Cl(pi),Al(_l.CULL_FACE),Al(_l.BLEND),Ll(Mi)},initAttributes:function(){for(var hd=0,yd=Nl.length;hd<yd;hd++)Nl[hd]=0},enableAttribute:function(hd){if(Nl[hd]=1,0===Ul[hd]&&(_l.enableVertexAttribArray(hd),Ul[hd]=1),0!==Hl[hd]){var yd=Sl.get("ANGLE_instanced_arrays");yd.vertexAttribDivisorANGLE(hd,0),Hl[hd]=0}},enableAttributeAndDivisor:function(hd,yd,xd){Nl[hd]=1,0===Ul[hd]&&(_l.enableVertexAttribArray(hd),Ul[hd]=1),Hl[hd]!==yd&&(xd.vertexAttribDivisorANGLE(hd,yd),Hl[hd]=yd)},disableUnusedAttributes:function(){for(var hd=0,yd=Ul.length;hd!==yd;++hd)Ul[hd]!==Nl[hd]&&(_l.disableVertexAttribArray(hd),Ul[hd]=0)},enable:Al,disable:Pl,getCompressedTextureFormats:function(){if(null==Ol&&(Ol=[],Sl.get("WEBGL_compressed_texture_pvrtc")||Sl.get("WEBGL_compressed_texture_s3tc")||Sl.get("WEBGL_compressed_texture_etc1"))){var hd=_l.getParameter(_l.COMPRESSED_TEXTURE_FORMATS);for(var yd=0;yd<hd.length;yd++)Ol.push(hd[yd])}return Ol},setBlending:Ll,setColorWrite:function(hd){Dl.setMask(hd)},setDepthTest:function(hd){Gl.setTest(hd)},setDepthWrite:function(hd){Gl.setMask(hd)},setDepthFunc:wl,setStencilTest:function(hd){Bl.setTest(hd)},setStencilWrite:function(hd){Bl.setMask(hd)},setStencilFunc:function(hd,yd,xd){Bl.setFunc(hd,yd,xd)},setStencilOp:function(hd,yd,xd){Bl.setOp(hd,yd,xd)},setFlipSided:Rl,setCullFace:Cl,setLineWidth:function(hd){hd!==ed&&(ld&&_l.lineWidth(hd),ed=hd)},setPolygonOffset:function(hd,yd,xd){hd?(Al(_l.POLYGON_OFFSET_FILL),(td!==yd||rd!==xd)&&(_l.polygonOffset(yd,xd),td=yd,rd=xd)):Pl(_l.POLYGON_OFFSET_FILL)},getScissorTest:function(){return od},setScissorTest:function(hd){od=hd,hd?Al(_l.SCISSOR_TEST):Pl(_l.SCISSOR_TEST)},activeTexture:Il,bindTexture:function(hd,yd){null===dd&&Il();var xd=cd[dd];void 0===xd&&(xd={type:void 0,texture:void 0},cd[dd]=xd),(xd.type!==hd||xd.texture!==yd)&&(_l.bindTexture(hd,yd||fd[hd]),xd.type=hd,xd.texture=yd)},compressedTexImage2D:function(){try{_l.compressedTexImage2D.apply(_l,arguments)}catch(hd){console.error(hd)}},texImage2D:function(){try{_l.texImage2D.apply(_l,arguments)}catch(hd){console.error(hd)}},scissor:function(gd){!1===ud.equals(gd)&&(_l.scissor(gd.x,gd.y,gd.z,gd.w),ud.copy(gd))},viewport:function(gd){!1===md.equals(gd)&&(_l.viewport(gd.x,gd.y,gd.z,gd.w),md.copy(gd))},reset:function(){for(var hd=0;hd<Ul.length;hd++)1===Ul[hd]&&(_l.disableVertexAttribArray(hd),Ul[hd]=0);zl={},Ol=null,dd=null,cd={},Vl=null,Jl=null,$l=null,Dl.reset(),Gl.reset(),Bl.reset()}}}function $t(_l,Sl,El){function Ml(zl){if("highp"===zl){if(0<_l.getShaderPrecisionFormat(_l.VERTEX_SHADER,_l.HIGH_FLOAT).precision&&0<_l.getShaderPrecisionFormat(_l.FRAGMENT_SHADER,_l.HIGH_FLOAT).precision)return"highp";zl="mediump"}return"mediump"===zl&&0<_l.getShaderPrecisionFormat(_l.VERTEX_SHADER,_l.MEDIUM_FLOAT).precision&&0<_l.getShaderPrecisionFormat(_l.FRAGMENT_SHADER,_l.MEDIUM_FLOAT).precision?"mediump":"lowp"}var Al,Pl=El.precision===void 0?"highp":El.precision,Ll=Ml(Pl);Ll!==Pl&&(console.warn("THREE.WebGLRenderer:",Pl,"not supported, using",Ll,"instead."),Pl=Ll);var wl=!0===El.logarithmicDepthBuffer&&!!Sl.get("EXT_frag_depth"),Rl=_l.getParameter(_l.MAX_TEXTURE_IMAGE_UNITS),Cl=_l.getParameter(_l.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Il=_l.getParameter(_l.MAX_TEXTURE_SIZE),Dl=_l.getParameter(_l.MAX_CUBE_MAP_TEXTURE_SIZE),Gl=_l.getParameter(_l.MAX_VERTEX_ATTRIBS),Bl=_l.getParameter(_l.MAX_VERTEX_UNIFORM_VECTORS),Fl=_l.getParameter(_l.MAX_VARYING_VECTORS),Nl=_l.getParameter(_l.MAX_FRAGMENT_UNIFORM_VECTORS),Ul=0<Cl,Hl=!!Sl.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!=Al)return Al;var Ol=Sl.get("EXT_texture_filter_anisotropic");return Al=null===Ol?0:_l.getParameter(Ol.MAX_TEXTURE_MAX_ANISOTROPY_EXT),Al},getMaxPrecision:Ml,precision:Pl,logarithmicDepthBuffer:wl,maxTextures:Rl,maxVertexTextures:Cl,maxTextureSize:Il,maxCubemapSize:Dl,maxAttributes:Gl,maxVertexUniforms:Bl,maxVaryings:Fl,maxFragmentUniforms:Nl,vertexTextures:Ul,floatFragmentTextures:Hl,floatVertexTextures:Ul&&Hl}}function er(_l){var Sl={};return{get:function(El){if(void 0!==Sl[El])return Sl[El];var Ml;return Ml="WEBGL_depth_texture"===El?_l.getExtension("WEBGL_depth_texture")||_l.getExtension("MOZ_WEBGL_depth_texture")||_l.getExtension("WEBKIT_WEBGL_depth_texture"):"EXT_texture_filter_anisotropic"===El?_l.getExtension("EXT_texture_filter_anisotropic")||_l.getExtension("MOZ_EXT_texture_filter_anisotropic")||_l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"):"WEBGL_compressed_texture_s3tc"===El?_l.getExtension("WEBGL_compressed_texture_s3tc")||_l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||_l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"):"WEBGL_compressed_texture_pvrtc"===El?_l.getExtension("WEBGL_compressed_texture_pvrtc")||_l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"):"WEBGL_compressed_texture_etc1"===El?_l.getExtension("WEBGL_compressed_texture_etc1"):_l.getExtension(El),null===Ml&&console.warn("THREE.WebGLRenderer: "+El+" extension not supported."),Sl[El]=Ml,Ml}}}function tr(){function _l(){Cl.value!==Ml&&(Cl.value=Ml,Cl.needsUpdate=0<Al),El.numPlanes=Al,El.numIntersection=0}function Sl(Il,Dl,Gl,Bl){var Fl=null===Il?0:Il.length,Nl=null;if(0!==Fl){if(Nl=Cl.value,!0!==Bl||null==Nl){var Ul=Gl+4*Fl,Hl=Dl.matrixWorldInverse;Rl.getNormalMatrix(Hl),(null==Nl||Nl.length<Ul)&&(Nl=new Float32Array(Ul));for(var zl=0,Ol=Gl;zl!==Fl;++zl,Ol+=4)wl.copy(Il[zl]).applyMatrix4(Hl,Rl),wl.normal.toArray(Nl,Ol),Nl[Ol+3]=wl.constant}Cl.value=Nl,Cl.needsUpdate=!0}return El.numPlanes=Fl,Nl}var El=this,Ml=null,Al=0,Pl=!1,Ll=!1,wl=new Qe,Rl=new Ke,Cl={value:null,needsUpdate:!1};this.uniform=Cl,this.numPlanes=0,this.numIntersection=0,this.init=function(Il,Dl,Gl){var Bl=0!==Il.length||Dl||0!=Al||Pl;return Pl=Dl,Ml=Sl(Il,Gl,0),Al=Il.length,Bl},this.beginShadows=function(){Ll=!0,Sl(null)},this.endShadows=function(){Ll=!1,_l()},this.setState=function(Il,Dl,Gl,Bl,Fl,Nl){if(!Pl||null===Il||0===Il.length||Ll&&!Gl)Ll?Sl(null):_l();else{var Ul=Ll?0:Al,Hl=4*Ul,zl=Fl.clippingState||null;Cl.value=zl,zl=Sl(Il,Bl,Hl,Nl);for(var Ol=0;Ol!==Hl;++Ol)zl[Ol]=Ml[Ol];Fl.clippingState=zl,this.numIntersection=Dl?this.numPlanes:0,this.numPlanes+=Ul}}}function rr(_l){function Sl(){return null===Ld?Od:1}function El(){np.init(),np.scissor(Dd.copy(Vd).multiplyScalar(Od)),np.viewport(Bd.copy(Wd).multiplyScalar(Od)),np.buffers.color.setClear(Nd.r,Nd.g,Nd.b,Ud,gd)}function Ml(){Pd=null,Id=null,Cd="",Rd=-1,np.reset()}function Al(Ep){Ep.preventDefault(),Ml(),El(),sp.clear()}function Pl(Ep){var Mp=Ep.target;Mp.removeEventListener("dispose",Pl),Ll(Mp)}function Ll(Ep){wl(Ep),sp.delete(Ep)}function wl(Ep){var Mp=sp.get(Ep).program;Ep.program=void 0,Mp!==void 0&&cp.releaseProgram(Mp)}function Rl(Ep,Mp,Ap,Pp){var Lp;if(Ap&&Ap.isInstancedBufferGeometry&&(Lp=op.get("ANGLE_instanced_arrays"),null===Lp))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Pp===void 0&&(Pp=0),np.initAttributes();var wp=Ap.attributes,Rp=Mp.getAttributes(),Cp=Ep.defaultAttributeValues;for(var Ip in Rp){var Dp=Rp[Ip];if(0<=Dp){var Gp=wp[Ip];if(Gp!==void 0){var Bp=Gp.normalized,Fp=Gp.itemSize,Np=dp.getAttributeProperties(Gp),Up=Np.__webglBuffer,Hp=Np.type,zp=Np.bytesPerElement;if(Gp.isInterleavedBufferAttribute){var Op=Gp.data,Vp=Op.stride,kp=Gp.offset;Op&&Op.isInstancedInterleavedBuffer?(np.enableAttributeAndDivisor(Dp,Op.meshPerAttribute,Lp),Ap.maxInstancedCount===void 0&&(Ap.maxInstancedCount=Op.meshPerAttribute*Op.count)):np.enableAttribute(Dp),rp.bindBuffer(rp.ARRAY_BUFFER,Up),rp.vertexAttribPointer(Dp,Fp,Hp,Bp,Vp*zp,(Pp*Vp+kp)*zp)}else Gp.isInstancedBufferAttribute?(np.enableAttributeAndDivisor(Dp,Gp.meshPerAttribute,Lp),void 0===Ap.maxInstancedCount&&(Ap.maxInstancedCount=Gp.meshPerAttribute*Gp.count)):np.enableAttribute(Dp),rp.bindBuffer(rp.ARRAY_BUFFER,Up),rp.vertexAttribPointer(Dp,Fp,Hp,Bp,0,Pp*Fp*zp)}else if(Cp!==void 0){var Wp=Cp[Ip];if(Wp!==void 0)switch(Wp.length){case 2:rp.vertexAttrib2fv(Dp,Wp);break;case 3:rp.vertexAttrib3fv(Dp,Wp);break;case 4:rp.vertexAttrib4fv(Dp,Wp);break;default:rp.vertexAttrib1fv(Dp,Wp);}}}}np.disableUnusedAttributes()}function Cl(Ep,Mp){return Math.abs(Mp[0])-Math.abs(Ep[0])}function Il(Ep,Mp){if(Ep.object.renderOrder!==Mp.object.renderOrder)return Ep.object.renderOrder-Mp.object.renderOrder;return Ep.material.program&&Mp.material.program&&Ep.material.program!==Mp.material.program?Ep.material.program.id-Mp.material.program.id:Ep.material.id===Mp.material.id?Ep.z===Mp.z?Ep.id-Mp.id:Ep.z-Mp.z:Ep.material.id-Mp.material.id}function Dl(Ep,Mp){return Ep.object.renderOrder===Mp.object.renderOrder?Ep.z===Mp.z?Ep.id-Mp.id:Mp.z-Ep.z:Ep.object.renderOrder-Mp.object.renderOrder}function Gl(Ep,Mp,Ap,Pp,Lp){var wp,Rp;Ap.transparent?(wp=vd,Rp=++_d):(wp=xd,Rp=++Td);var Cp=wp[Rp];Cp===void 0?(Cp={id:Ep.id,object:Ep,geometry:Mp,material:Ap,z:Qd.z,group:Lp},wp.push(Cp)):(Cp.id=Ep.id,Cp.object=Ep,Cp.geometry=Mp,Cp.material=Ap,Cp.z=Qd.z,Cp.group=Lp)}function Bl(Ep){var Mp=Ep.geometry;return null===Mp.boundingSphere&&Mp.computeBoundingSphere(),Zd.copy(Mp.boundingSphere).applyMatrix4(Ep.matrixWorld),Nl(Zd)}function Fl(Ep){return Zd.center.set(0,0,0),Zd.radius=0.7071067811865476,Zd.applyMatrix4(Ep.matrixWorld),Nl(Zd)}function Nl(Ep){if(!Xd.intersectsSphere(Ep))return!1;var Mp=jd.numPlanes;if(0===Mp)return!0;var Ap=Ad.clippingPlanes,Pp=Ep.center,Lp=-Ep.radius,wp=0;do if(Ap[wp].distanceToPoint(Pp)<Lp)return!1;while(++wp!==Mp);return!0}function Ul(Ep,Mp){if(!1!==Ep.visible){var Ap=0!=(Ep.layers.mask&Mp.layers.mask);if(Ap)if(Ep.isLight)yd.push(Ep);else if(Ep.isSprite)(!1===Ep.frustumCulled||!0===Fl(Ep))&&Ed.push(Ep);else if(Ep.isLensFlare)Md.push(Ep);else if(Ep.isImmediateRenderObject)!0===Ad.sortObjects&&(Qd.setFromMatrixPosition(Ep.matrixWorld),Qd.applyProjection(Kd)),Gl(Ep,null,Ep.material,Qd.z,null);else if((Ep.isMesh||Ep.isLine||Ep.isPoints)&&(Ep.isSkinnedMesh&&Ep.skeleton.update(),!1===Ep.frustumCulled||!0===Bl(Ep))){var Pp=Ep.material;if(!0===Pp.visible){!0===Ad.sortObjects&&(Qd.setFromMatrixPosition(Ep.matrixWorld),Qd.applyProjection(Kd));var Lp=dp.update(Ep);if(Pp.isMultiMaterial){var wp=Lp.groups,Rp=Pp.materials;for(var Cp=0,Ip=wp.length;Cp<Ip;Cp++){var Dp=wp[Cp],Gp=Rp[Dp.materialIndex];!0===Gp.visible&&Gl(Ep,Lp,Gp,Qd.z,Dp)}}else Gl(Ep,Lp,Pp,Qd.z,null)}}var Bp=Ep.children;for(var Cp=0,Ip=Bp.length;Cp<Ip;Cp++)Ul(Bp[Cp],Mp)}}function Hl(Ep,Mp,Ap,Pp){for(var Lp=0,wp=Ep.length;Lp<wp;Lp++){var Rp=Ep[Lp],Cp=Rp.object,Ip=Rp.geometry,Dp=void 0===Pp?Rp.material:Pp,Gp=Rp.group;if(Cp.modelViewMatrix.multiplyMatrices(Ap.matrixWorldInverse,Cp.matrixWorld),Cp.normalMatrix.getNormalMatrix(Cp.modelViewMatrix),Cp.onBeforeRender(Ad,Mp,Ap,Ip,Dp,Gp),Cp.isImmediateRenderObject){Ol(Dp);var Bp=Vl(Ap,Mp.fog,Dp,Cp);Cd="",Cp.render(function(Fp){Ad.renderBufferImmediate(Fp,Bp,Dp)})}else Ad.renderBufferDirect(Ap,Mp.fog,Ip,Dp,Cp,Gp);Cp.onAfterRender(Ad,Mp,Ap,Ip,Dp,Gp)}}function zl(Ep,Mp,Ap){var Pp=sp.get(Ep),Lp=cp.getParameters(Ep,ep,Mp,jd.numPlanes,jd.numIntersection,Ap),wp=cp.getProgramCode(Ep,Lp),Rp=Pp.program,Cp=!0;if(Rp===void 0)Ep.addEventListener("dispose",Pl);else if(Rp.code!==wp)wl(Ep);else{if(Lp.shaderID!==void 0)return;Cp=!1}if(Cp){if(Lp.shaderID){var Ip=Hs[Lp.shaderID];Pp.__webglShader={name:Ep.type,uniforms:Bs.clone(Ip.uniforms),vertexShader:Ip.vertexShader,fragmentShader:Ip.fragmentShader}}else Pp.__webglShader={name:Ep.type,uniforms:Ep.uniforms,vertexShader:Ep.vertexShader,fragmentShader:Ep.fragmentShader};Ep.__webglShader=Pp.__webglShader,Rp=cp.acquireProgram(Ep,Lp,wp),Pp.program=Rp,Ep.program=Rp}var Dp=Rp.getAttributes();if(Ep.morphTargets){Ep.numSupportedMorphTargets=0;for(var Gp=0;Gp<Ad.maxMorphTargets;Gp++)0<=Dp["morphTarget"+Gp]&&Ep.numSupportedMorphTargets++}if(Ep.morphNormals){Ep.numSupportedMorphNormals=0;for(var Gp=0;Gp<Ad.maxMorphNormals;Gp++)0<=Dp["morphNormal"+Gp]&&Ep.numSupportedMorphNormals++}var Bp=Pp.__webglShader.uniforms;(Ep.isShaderMaterial||Ep.isRawShaderMaterial)&&!0!==Ep.clipping||(Pp.numClippingPlanes=jd.numPlanes,Pp.numIntersection=jd.numIntersection,Bp.clippingPlanes=jd.uniform),Pp.fog=Mp,Pp.lightsHash=ep.hash,Ep.lights&&(Bp.ambientLightColor.value=ep.ambient,Bp.directionalLights.value=ep.directional,Bp.spotLights.value=ep.spot,Bp.rectAreaLights.value=ep.rectArea,Bp.pointLights.value=ep.point,Bp.hemisphereLights.value=ep.hemi,Bp.directionalShadowMap.value=ep.directionalShadowMap,Bp.directionalShadowMatrix.value=ep.directionalShadowMatrix,Bp.spotShadowMap.value=ep.spotShadowMap,Bp.spotShadowMatrix.value=ep.spotShadowMatrix,Bp.pointShadowMap.value=ep.pointShadowMap,Bp.pointShadowMatrix.value=ep.pointShadowMatrix);var Fp=Pp.program.getUniforms(),Np=He.seqWithValue(Fp.seq,Bp);Pp.uniformsList=Np}function Ol(Ep){Ep.side===xi?np.disable(rp.CULL_FACE):np.enable(rp.CULL_FACE),np.setFlipSided(Ep.side===yi),!0===Ep.transparent?np.setBlending(Ep.blending,Ep.blendEquation,Ep.blendSrc,Ep.blendDst,Ep.blendEquationAlpha,Ep.blendSrcAlpha,Ep.blendDstAlpha,Ep.premultipliedAlpha):np.setBlending(Ei),np.setDepthFunc(Ep.depthFunc),np.setDepthTest(Ep.depthTest),np.setDepthWrite(Ep.depthWrite),np.setColorWrite(Ep.colorWrite),np.setPolygonOffset(Ep.polygonOffset,Ep.polygonOffsetFactor,Ep.polygonOffsetUnits)}function Vl(Ep,Mp,Ap,Pp){Fd=0;var Lp=sp.get(Ap);if(Yd&&(qd||Ep!==Id)){var wp=Ep===Id&&Ap.id===Rd;jd.setState(Ap.clippingPlanes,Ap.clipIntersection,Ap.clipShadows,Ep,Lp,wp)}!1===Ap.needsUpdate&&(void 0===Lp.program?Ap.needsUpdate=!0:Ap.fog&&Lp.fog!==Mp?Ap.needsUpdate=!0:Ap.lights&&Lp.lightsHash!==ep.hash?Ap.needsUpdate=!0:void 0!==Lp.numClippingPlanes&&(Lp.numClippingPlanes!==jd.numPlanes||Lp.numIntersection!==jd.numIntersection)&&(Ap.needsUpdate=!0)),Ap.needsUpdate&&(zl(Ap,Mp,Pp),Ap.needsUpdate=!1);var Rp=!1,Cp=!1,Ip=!1,Dp=Lp.program,Gp=Dp.getUniforms(),Bp=Lp.__webglShader.uniforms;if(Dp.id!==Pd&&(rp.useProgram(Dp.program),Pd=Dp.id,Rp=!0,Cp=!0,Ip=!0),Ap.id!==Rd&&(Rd=Ap.id,Cp=!0),Rp||Ep!==Id){if(Gp.set(rp,Ep,"projectionMatrix"),ip.logarithmicDepthBuffer&&Gp.setValue(rp,"logDepthBufFC",2/(Math.log(Ep.far+1)/Math.LN2)),Ep!==Id&&(Id=Ep,Cp=!0,Ip=!0),Ap.isShaderMaterial||Ap.isMeshPhongMaterial||Ap.isMeshStandardMaterial||Ap.envMap){var Fp=Gp.map.cameraPosition;void 0!==Fp&&Fp.setValue(rp,Qd.setFromMatrixPosition(Ep.matrixWorld))}(Ap.isMeshPhongMaterial||Ap.isMeshLambertMaterial||Ap.isMeshBasicMaterial||Ap.isMeshStandardMaterial||Ap.isShaderMaterial||Ap.skinning)&&Gp.setValue(rp,"viewMatrix",Ep.matrixWorldInverse),Gp.set(rp,Ad,"toneMappingExposure"),Gp.set(rp,Ad,"toneMappingWhitePoint")}if(Ap.skinning){Gp.setOptional(rp,Pp,"bindMatrix"),Gp.setOptional(rp,Pp,"bindMatrixInverse");var Np=Pp.skeleton;Np&&(ip.floatVertexTextures&&Np.useVertexTexture?(Gp.set(rp,Np,"boneTexture"),Gp.set(rp,Np,"boneTextureWidth"),Gp.set(rp,Np,"boneTextureHeight")):Gp.setOptional(rp,Np,"boneMatrices"))}return Cp&&(Ap.lights&&rd(Bp,Ip),Mp&&Ap.fog&&Zl(Bp,Mp),(Ap.isMeshBasicMaterial||Ap.isMeshLambertMaterial||Ap.isMeshPhongMaterial||Ap.isMeshStandardMaterial||Ap.isMeshNormalMaterial||Ap.isMeshDepthMaterial)&&Wl(Bp,Ap),Ap.isLineBasicMaterial?Xl(Bp,Ap):Ap.isLineDashedMaterial?(Xl(Bp,Ap),Yl(Bp,Ap)):Ap.isPointsMaterial?ql(Bp,Ap):Ap.isMeshLambertMaterial?Kl(Bp,Ap):Ap.isMeshToonMaterial?Jl(Bp,Ap):Ap.isMeshPhongMaterial?Ql(Bp,Ap):Ap.isMeshPhysicalMaterial?ed(Bp,Ap):Ap.isMeshStandardMaterial?$l(Bp,Ap):Ap.isMeshDepthMaterial?Ap.displacementMap&&(Bp.displacementMap.value=Ap.displacementMap,Bp.displacementScale.value=Ap.displacementScale,Bp.displacementBias.value=Ap.displacementBias):Ap.isMeshNormalMaterial&&td(Bp,Ap),void 0!==Bp.ltcMat&&(Bp.ltcMat.value=THREE.UniformsLib.LTC_MAT_TEXTURE),void 0!==Bp.ltcMag&&(Bp.ltcMag.value=THREE.UniformsLib.LTC_MAG_TEXTURE),He.upload(rp,Lp.uniformsList,Bp,Ad)),Gp.set(rp,Pp,"modelViewMatrix"),Gp.set(rp,Pp,"normalMatrix"),Gp.setValue(rp,"modelMatrix",Pp.matrixWorld),Dp}function Wl(Ep,Mp){Ep.opacity.value=Mp.opacity,Ep.diffuse.value=Mp.color,Mp.emissive&&Ep.emissive.value.copy(Mp.emissive).multiplyScalar(Mp.emissiveIntensity),Ep.map.value=Mp.map,Ep.specularMap.value=Mp.specularMap,Ep.alphaMap.value=Mp.alphaMap,Mp.lightMap&&(Ep.lightMap.value=Mp.lightMap,Ep.lightMapIntensity.value=Mp.lightMapIntensity),Mp.aoMap&&(Ep.aoMap.value=Mp.aoMap,Ep.aoMapIntensity.value=Mp.aoMapIntensity);var Ap;if(Mp.map?Ap=Mp.map:Mp.specularMap?Ap=Mp.specularMap:Mp.displacementMap?Ap=Mp.displacementMap:Mp.normalMap?Ap=Mp.normalMap:Mp.bumpMap?Ap=Mp.bumpMap:Mp.roughnessMap?Ap=Mp.roughnessMap:Mp.metalnessMap?Ap=Mp.metalnessMap:Mp.alphaMap?Ap=Mp.alphaMap:Mp.emissiveMap&&(Ap=Mp.emissiveMap),void 0!=Ap){Ap.isWebGLRenderTarget&&(Ap=Ap.texture);var Pp=Ap.offset,Lp=Ap.repeat;Ep.offsetRepeat.value.set(Pp.x,Pp.y,Lp.x,Lp.y)}Ep.envMap.value=Mp.envMap,Ep.flipEnvMap.value=Mp.envMap&&Mp.envMap.isCubeTexture?-1:1,Ep.reflectivity.value=Mp.reflectivity,Ep.refractionRatio.value=Mp.refractionRatio}function Xl(Ep,Mp){Ep.diffuse.value=Mp.color,Ep.opacity.value=Mp.opacity}function Yl(Ep,Mp){Ep.dashSize.value=Mp.dashSize,Ep.totalSize.value=Mp.dashSize+Mp.gapSize,Ep.scale.value=Mp.scale}function ql(Ep,Mp){if(Ep.diffuse.value=Mp.color,Ep.opacity.value=Mp.opacity,Ep.size.value=Mp.size*Od,Ep.scale.value=0.5*zd,Ep.map.value=Mp.map,null!==Mp.map){var Ap=Mp.map.offset,Pp=Mp.map.repeat;Ep.offsetRepeat.value.set(Ap.x,Ap.y,Pp.x,Pp.y)}}function Zl(Ep,Mp){Ep.fogColor.value=Mp.color,Mp.isFog?(Ep.fogNear.value=Mp.near,Ep.fogFar.value=Mp.far):Mp.isFogExp2&&(Ep.fogDensity.value=Mp.density)}function Kl(Ep,Mp){Mp.emissiveMap&&(Ep.emissiveMap.value=Mp.emissiveMap)}function Ql(Ep,Mp){Ep.specular.value=Mp.specular,Ep.shininess.value=Math.max(Mp.shininess,1e-4),Mp.emissiveMap&&(Ep.emissiveMap.value=Mp.emissiveMap),Mp.bumpMap&&(Ep.bumpMap.value=Mp.bumpMap,Ep.bumpScale.value=Mp.bumpScale),Mp.normalMap&&(Ep.normalMap.value=Mp.normalMap,Ep.normalScale.value.copy(Mp.normalScale)),Mp.displacementMap&&(Ep.displacementMap.value=Mp.displacementMap,Ep.displacementScale.value=Mp.displacementScale,Ep.displacementBias.value=Mp.displacementBias)}function Jl(Ep,Mp){Ql(Ep,Mp),Mp.gradientMap&&(Ep.gradientMap.value=Mp.gradientMap)}function $l(Ep,Mp){Ep.roughness.value=Mp.roughness,Ep.metalness.value=Mp.metalness,Mp.roughnessMap&&(Ep.roughnessMap.value=Mp.roughnessMap),Mp.metalnessMap&&(Ep.metalnessMap.value=Mp.metalnessMap),Mp.emissiveMap&&(Ep.emissiveMap.value=Mp.emissiveMap),Mp.bumpMap&&(Ep.bumpMap.value=Mp.bumpMap,Ep.bumpScale.value=Mp.bumpScale),Mp.normalMap&&(Ep.normalMap.value=Mp.normalMap,Ep.normalScale.value.copy(Mp.normalScale)),Mp.displacementMap&&(Ep.displacementMap.value=Mp.displacementMap,Ep.displacementScale.value=Mp.displacementScale,Ep.displacementBias.value=Mp.displacementBias),Mp.envMap&&(Ep.envMapIntensity.value=Mp.envMapIntensity)}function ed(Ep,Mp){Ep.clearCoat.value=Mp.clearCoat,Ep.clearCoatRoughness.value=Mp.clearCoatRoughness,$l(Ep,Mp)}function td(Ep,Mp){Mp.bumpMap&&(Ep.bumpMap.value=Mp.bumpMap,Ep.bumpScale.value=Mp.bumpScale),Mp.normalMap&&(Ep.normalMap.value=Mp.normalMap,Ep.normalScale.value.copy(Mp.normalScale)),Mp.displacementMap&&(Ep.displacementMap.value=Mp.displacementMap,Ep.displacementScale.value=Mp.displacementScale,Ep.displacementBias.value=Mp.displacementBias)}function rd(Ep,Mp){Ep.ambientLightColor.needsUpdate=Mp,Ep.directionalLights.needsUpdate=Mp,Ep.pointLights.needsUpdate=Mp,Ep.spotLights.needsUpdate=Mp,Ep.rectAreaLights.needsUpdate=Mp,Ep.hemisphereLights.needsUpdate=Mp}function od(Ep){var Mp=0;for(var Ap=0,Pp=Ep.length;Ap<Pp;Ap++){var Lp=Ep[Ap];Lp.castShadow&&(ep.shadows[Mp++]=Lp)}ep.shadows.length=Mp}function nd(Ep,Mp){var wp=0,Rp=0,Cp=0,Fp=Mp.matrixWorldInverse,Np=0,Up=0,Hp=0,zp=0,Op=0,Ap,Pp,Lp,Ip,Dp,Gp,Bp;for(Ap=0,Pp=Ep.length;Ap<Pp;Ap++)if(Lp=Ep[Ap],Ip=Lp.color,Dp=Lp.intensity,Gp=Lp.distance,Bp=Lp.shadow&&Lp.shadow.map?Lp.shadow.map.texture:null,Lp.isAmbientLight)wp+=Ip.r*Dp,Rp+=Ip.g*Dp,Cp+=Ip.b*Dp;else if(Lp.isDirectionalLight){var Vp=mp.get(Lp);Vp.color.copy(Lp.color).multiplyScalar(Lp.intensity),Vp.direction.setFromMatrixPosition(Lp.matrixWorld),Qd.setFromMatrixPosition(Lp.target.matrixWorld),Vp.direction.sub(Qd),Vp.direction.transformDirection(Fp),Vp.shadow=Lp.castShadow,Lp.castShadow&&(Vp.shadowBias=Lp.shadow.bias,Vp.shadowRadius=Lp.shadow.radius,Vp.shadowMapSize=Lp.shadow.mapSize),ep.directionalShadowMap[Np]=Bp,ep.directionalShadowMatrix[Np]=Lp.shadow.matrix,ep.directional[Np++]=Vp}else if(Lp.isSpotLight){var Vp=mp.get(Lp);Vp.position.setFromMatrixPosition(Lp.matrixWorld),Vp.position.applyMatrix4(Fp),Vp.color.copy(Ip).multiplyScalar(Dp),Vp.distance=Gp,Vp.direction.setFromMatrixPosition(Lp.matrixWorld),Qd.setFromMatrixPosition(Lp.target.matrixWorld),Vp.direction.sub(Qd),Vp.direction.transformDirection(Fp),Vp.coneCos=Math.cos(Lp.angle),Vp.penumbraCos=Math.cos(Lp.angle*(1-Lp.penumbra)),Vp.decay=0===Lp.distance?0:Lp.decay,Vp.shadow=Lp.castShadow,Lp.castShadow&&(Vp.shadowBias=Lp.shadow.bias,Vp.shadowRadius=Lp.shadow.radius,Vp.shadowMapSize=Lp.shadow.mapSize),ep.spotShadowMap[Hp]=Bp,ep.spotShadowMatrix[Hp]=Lp.shadow.matrix,ep.spot[Hp++]=Vp}else if(Lp.isRectAreaLight){var Vp=mp.get(Lp);Vp.color.copy(Ip).multiplyScalar(Dp/(Lp.width*Lp.height)),Vp.position.setFromMatrixPosition(Lp.matrixWorld),Vp.position.applyMatrix4(Fp),$d.identity(),Jd.copy(Lp.matrixWorld),Jd.premultiply(Fp),$d.extractRotation(Jd),Vp.halfWidth.set(0.5*Lp.width,0,0),Vp.halfHeight.set(0,0.5*Lp.height,0),Vp.halfWidth.applyMatrix4($d),Vp.halfHeight.applyMatrix4($d),ep.rectArea[zp++]=Vp}else if(Lp.isPointLight){var Vp=mp.get(Lp);Vp.position.setFromMatrixPosition(Lp.matrixWorld),Vp.position.applyMatrix4(Fp),Vp.color.copy(Lp.color).multiplyScalar(Lp.intensity),Vp.distance=Lp.distance,Vp.decay=0===Lp.distance?0:Lp.decay,Vp.shadow=Lp.castShadow,Lp.castShadow&&(Vp.shadowBias=Lp.shadow.bias,Vp.shadowRadius=Lp.shadow.radius,Vp.shadowMapSize=Lp.shadow.mapSize),ep.pointShadowMap[Up]=Bp,void 0===ep.pointShadowMatrix[Up]&&(ep.pointShadowMatrix[Up]=new K),Qd.setFromMatrixPosition(Lp.matrixWorld).negate(),ep.pointShadowMatrix[Up].identity().setPosition(Qd),ep.point[Up++]=Vp}else if(Lp.isHemisphereLight){var Vp=mp.get(Lp);Vp.direction.setFromMatrixPosition(Lp.matrixWorld),Vp.direction.transformDirection(Fp),Vp.direction.normalize(),Vp.skyColor.copy(Lp.color).multiplyScalar(Dp),Vp.groundColor.copy(Lp.groundColor).multiplyScalar(Dp),ep.hemi[Op++]=Vp}ep.ambient[0]=wp,ep.ambient[1]=Rp,ep.ambient[2]=Cp,ep.directional.length=Np,ep.spot.length=Hp,ep.rectArea.length=zp,ep.point.length=Up,ep.hemi.length=Op,ep.hash=Np+","+Up+","+Hp+","+zp+","+Op+","+ep.shadows.length}function sd(Ep){var Mp;if(Ep===bn)return rp.REPEAT;if(Ep===vn)return rp.CLAMP_TO_EDGE;if(Ep===_n)return rp.MIRRORED_REPEAT;if(Ep===En)return rp.NEAREST;if(Ep===Mn)return rp.NEAREST_MIPMAP_NEAREST;if(Ep===An)return rp.NEAREST_MIPMAP_LINEAR;if(Ep===Pn)return rp.LINEAR;if(Ep===Ln)return rp.LINEAR_MIPMAP_NEAREST;if(Ep===wn)return rp.LINEAR_MIPMAP_LINEAR;if(Ep===Cn)return rp.UNSIGNED_BYTE;if(Ep===Hn)return rp.UNSIGNED_SHORT_4_4_4_4;if(Ep===zn)return rp.UNSIGNED_SHORT_5_5_5_1;if(Ep===On)return rp.UNSIGNED_SHORT_5_6_5;if(Ep===In)return rp.BYTE;if(Ep===Dn)return rp.SHORT;if(Ep===Gn)return rp.UNSIGNED_SHORT;if(Ep===Bn)return rp.INT;if(Ep===Fn)return rp.UNSIGNED_INT;if(Ep===Nn)return rp.FLOAT;if(Ep===Un&&(Mp=op.get("OES_texture_half_float"),null!==Mp))return Mp.HALF_FLOAT_OES;if(Ep===kn)return rp.ALPHA;if(Ep===Wn)return rp.RGB;if(Ep===Xn)return rp.RGBA;if(Ep===jn)return rp.LUMINANCE;if(Ep===Yn)return rp.LUMINANCE_ALPHA;if(Ep===qn)return rp.DEPTH_COMPONENT;if(Ep===Zn)return rp.DEPTH_STENCIL;if(Ep===Ci)return rp.FUNC_ADD;if(Ep===Ii)return rp.FUNC_SUBTRACT;if(Ep===Di)return rp.FUNC_REVERSE_SUBTRACT;if(Ep===Fi)return rp.ZERO;if(Ep===Ni)return rp.ONE;if(Ep===Ui)return rp.SRC_COLOR;if(Ep===Hi)return rp.ONE_MINUS_SRC_COLOR;if(Ep===zi)return rp.SRC_ALPHA;if(Ep===Oi)return rp.ONE_MINUS_SRC_ALPHA;if(Ep===Vi)return rp.DST_ALPHA;if(Ep===ki)return rp.ONE_MINUS_DST_ALPHA;if(Ep===Wi)return rp.DST_COLOR;if(Ep===Xi)return rp.ONE_MINUS_DST_COLOR;if(Ep===ji)return rp.SRC_ALPHA_SATURATE;if((Ep===Kn||Ep===Qn||Ep===Jn||Ep===$n)&&(Mp=op.get("WEBGL_compressed_texture_s3tc"),null!==Mp)){if(Ep===Kn)return Mp.COMPRESSED_RGB_S3TC_DXT1_EXT;if(Ep===Qn)return Mp.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(Ep===Jn)return Mp.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(Ep===$n)return Mp.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((Ep===es||Ep===ts||Ep===rs||Ep===as)&&(Mp=op.get("WEBGL_compressed_texture_pvrtc"),null!==Mp)){if(Ep===es)return Mp.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(Ep===ts)return Mp.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(Ep===rs)return Mp.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(Ep===as)return Mp.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(Ep===os&&(Mp=op.get("WEBGL_compressed_texture_etc1"),null!==Mp))return Mp.COMPRESSED_RGB_ETC1_WEBGL;if((Ep===Gi||Ep===Bi)&&(Mp=op.get("EXT_blend_minmax"),null!==Mp)){if(Ep===Gi)return Mp.MIN_EXT;if(Ep===Bi)return Mp.MAX_EXT}return Ep===Vn&&(Mp=op.get("WEBGL_depth_texture"),null!==Mp)?Mp.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer",li),_l=_l||{};var ld=_l.canvas===void 0?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):_l.canvas,dd=_l.context===void 0?null:_l.context,cd=_l.alpha!==void 0&&_l.alpha,ud=!(_l.depth!==void 0)||_l.depth,md=!(_l.stencil!==void 0)||_l.stencil,fd=_l.antialias!==void 0&&_l.antialias,gd=!(_l.premultipliedAlpha!==void 0)||_l.premultipliedAlpha,hd=_l.preserveDrawingBuffer!==void 0&&_l.preserveDrawingBuffer,yd=[],xd=[],Td=-1,vd=[],_d=-1,Sd=new Float32Array(8),Ed=[],Md=[];this.domElement=ld,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=nn,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Ad=this,Pd=null,Ld=null,wd=null,Rd=-1,Cd="",Id=null,Dd=new V,Gd=null,Bd=new V,Fd=0,Nd=new ze(0),Ud=0,Hd=ld.width,zd=ld.height,Od=1,Vd=new V(0,0,Hd,zd),kd=!1,Wd=new V(0,0,Hd,zd),Xd=new Je,jd=new tr,Yd=!1,qd=!1,Zd=new Ze,Kd=new K,Qd=new Z,Jd=new K,$d=new K,ep={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},tp={calls:0,vertices:0,faces:0,points:0};this.info={render:tp,memory:{geometries:0,textures:0},programs:null};var rp;try{var ap={alpha:cd,depth:ud,stencil:md,antialias:fd,premultipliedAlpha:gd,preserveDrawingBuffer:hd};if(rp=dd||ld.getContext("webgl",ap)||ld.getContext("experimental-webgl",ap),null===rp)if(null!==ld.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";else throw"Error creating WebGL context.";void 0===rp.getShaderPrecisionFormat&&(rp.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),ld.addEventListener("webglcontextlost",Al,!1)}catch(Ep){console.error("THREE.WebGLRenderer: "+Ep)}var op=new er(rp);op.get("WEBGL_depth_texture"),op.get("OES_texture_float"),op.get("OES_texture_float_linear"),op.get("OES_texture_half_float"),op.get("OES_texture_half_float_linear"),op.get("OES_standard_derivatives"),op.get("ANGLE_instanced_arrays"),op.get("OES_element_index_uint")&&(St.MaxIndex=4294967296);var ip=new $t(rp,op,_l),np=new Jt(rp,op,sd),sp=new Qt,lp=new Kt(rp,op,np,sp,ip,sd,this.info),dp=new Zt(rp,sp,this.info),cp=new Yt(this,ip),mp=new It;this.info.programs=cp.programs;var fp=new Ct(rp,op,tp),gp=new Rt(rp,op,tp),hp=new wt(-1,1,1,-1,0,1),yp=new Lt,xp=new Et(new At(2,2),new st({depthTest:!1,depthWrite:!1,fog:!1})),Tp=Hs.cube,bp=new Et(new Mt(5,5,5),new je({uniforms:Tp.uniforms,vertexShader:Tp.vertexShader,fragmentShader:Tp.fragmentShader,side:yi,depthTest:!1,depthWrite:!1,fog:!1}));El(),this.context=rp,this.capabilities=ip,this.extensions=op,this.properties=sp,this.state=np;var vp=new $e(this,ep,dp,ip);this.shadowMap=vp;var _p=new We(this,Ed),Sp=new ke(this,Md);this.getContext=function(){return rp},this.getContextAttributes=function(){return rp.getContextAttributes()},this.forceContextLoss=function(){op.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){return ip.getMaxAnisotropy()},this.getPrecision=function(){return ip.precision},this.getPixelRatio=function(){return Od},this.setPixelRatio=function(Ep){Ep===void 0||(Od=Ep,this.setSize(Wd.z,Wd.w,!1))},this.getSize=function(){return{width:Hd,height:zd}},this.setSize=function(Ep,Mp,Ap){Hd=Ep,zd=Mp,ld.width=Ep*Od,ld.height=Mp*Od,!1!==Ap&&(ld.style.width=Ep+"px",ld.style.height=Mp+"px"),this.setViewport(0,0,Ep,Mp)},this.setViewport=function(Ep,Mp,Ap,Pp){np.viewport(Wd.set(Ep,Mp,Ap,Pp))},this.setScissor=function(Ep,Mp,Ap,Pp){np.scissor(Vd.set(Ep,Mp,Ap,Pp))},this.setScissorTest=function(Ep){np.setScissorTest(kd=Ep)},this.getClearColor=function(){return Nd},this.setClearColor=function(Ep,Mp){Nd.set(Ep),Ud=Mp===void 0?1:Mp,np.buffers.color.setClear(Nd.r,Nd.g,Nd.b,Ud,gd)},this.getClearAlpha=function(){return Ud},this.setClearAlpha=function(Ep){Ud=Ep,np.buffers.color.setClear(Nd.r,Nd.g,Nd.b,Ud,gd)},this.clear=function(Ep,Mp,Ap){var Pp=0;(Ep===void 0||Ep)&&(Pp|=rp.COLOR_BUFFER_BIT),(Mp===void 0||Mp)&&(Pp|=rp.DEPTH_BUFFER_BIT),(Ap===void 0||Ap)&&(Pp|=rp.STENCIL_BUFFER_BIT),rp.clear(Pp)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(Ep,Mp,Ap,Pp){this.setRenderTarget(Ep),this.clear(Mp,Ap,Pp)},this.resetGLState=Ml,this.dispose=function(){vd=[],_d=-1,xd=[],Td=-1,ld.removeEventListener("webglcontextlost",Al,!1)},this.renderBufferImmediate=function(Ep,Mp,Ap){np.initAttributes();var Pp=sp.get(Ep);Ep.hasPositions&&!Pp.position&&(Pp.position=rp.createBuffer()),Ep.hasNormals&&!Pp.normal&&(Pp.normal=rp.createBuffer()),Ep.hasUvs&&!Pp.uv&&(Pp.uv=rp.createBuffer()),Ep.hasColors&&!Pp.color&&(Pp.color=rp.createBuffer());var Lp=Mp.getAttributes();if(Ep.hasPositions&&(rp.bindBuffer(rp.ARRAY_BUFFER,Pp.position),rp.bufferData(rp.ARRAY_BUFFER,Ep.positionArray,rp.DYNAMIC_DRAW),np.enableAttribute(Lp.position),rp.vertexAttribPointer(Lp.position,3,rp.FLOAT,!1,0,0)),Ep.hasNormals){if(rp.bindBuffer(rp.ARRAY_BUFFER,Pp.normal),!Ap.isMeshPhongMaterial&&!Ap.isMeshStandardMaterial&&!Ap.isMeshNormalMaterial&&Ap.shading===Ti)for(var wp=0,Rp=3*Ep.count;wp<Rp;wp+=9){var Cp=Ep.normalArray,Ip=(Cp[wp+0]+Cp[wp+3]+Cp[wp+6])/3,Dp=(Cp[wp+1]+Cp[wp+4]+Cp[wp+7])/3,Gp=(Cp[wp+2]+Cp[wp+5]+Cp[wp+8])/3;Cp[wp+0]=Ip,Cp[wp+1]=Dp,Cp[wp+2]=Gp,Cp[wp+3]=Ip,Cp[wp+4]=Dp,Cp[wp+5]=Gp,Cp[wp+6]=Ip,Cp[wp+7]=Dp,Cp[wp+8]=Gp}rp.bufferData(rp.ARRAY_BUFFER,Ep.normalArray,rp.DYNAMIC_DRAW),np.enableAttribute(Lp.normal),rp.vertexAttribPointer(Lp.normal,3,rp.FLOAT,!1,0,0)}Ep.hasUvs&&Ap.map&&(rp.bindBuffer(rp.ARRAY_BUFFER,Pp.uv),rp.bufferData(rp.ARRAY_BUFFER,Ep.uvArray,rp.DYNAMIC_DRAW),np.enableAttribute(Lp.uv),rp.vertexAttribPointer(Lp.uv,2,rp.FLOAT,!1,0,0)),Ep.hasColors&&Ap.vertexColors!==vi&&(rp.bindBuffer(rp.ARRAY_BUFFER,Pp.color),rp.bufferData(rp.ARRAY_BUFFER,Ep.colorArray,rp.DYNAMIC_DRAW),np.enableAttribute(Lp.color),rp.vertexAttribPointer(Lp.color,3,rp.FLOAT,!1,0,0)),np.disableUnusedAttributes(),rp.drawArrays(rp.TRIANGLES,0,Ep.count),Ep.count=0},this.renderBufferDirect=function(Ep,Mp,Ap,Pp,Lp,wp){Ol(Pp);var Rp=Vl(Ep,Mp,Pp,Lp),Cp=!1,Ip=Ap.id+"_"+Rp.id+"_"+Pp.wireframe;Ip!=Cd&&(Cd=Ip,Cp=!0);var Dp=Lp.morphTargetInfluences;if(Dp!==void 0){var Gp=[];for(var Bp=0,Fp=Dp.length;Bp<Fp;Bp++){var Np=Dp[Bp];Gp.push([Np,Bp])}Gp.sort(Cl),8<Gp.length&&(Gp.length=8);var Up=Ap.morphAttributes;for(var Bp=0,Fp=Gp.length;Bp<Fp;Bp++){var Np=Gp[Bp];if(Sd[Bp]=Np[0],0!==Np[0]){var Hp=Np[1];!0===Pp.morphTargets&&Up.position&&Ap.addAttribute("morphTarget"+Bp,Up.position[Hp]),!0===Pp.morphNormals&&Up.normal&&Ap.addAttribute("morphNormal"+Bp,Up.normal[Hp])}else!0===Pp.morphTargets&&Ap.removeAttribute("morphTarget"+Bp),!0===Pp.morphNormals&&Ap.removeAttribute("morphNormal"+Bp)}for(var Bp=Gp.length,zp=Sd.length;Bp<zp;Bp++)Sd[Bp]=0;Rp.getUniforms().setValue(rp,"morphTargetInfluences",Sd),Cp=!0}var Hp=Ap.index,Op=Ap.attributes.position,Vp=1;!0===Pp.wireframe&&(Hp=dp.getWireframeAttribute(Ap),Vp=2);var kp;null===Hp?kp=fp:(kp=gp,kp.setIndex(Hp)),Cp&&(Rl(Pp,Rp,Ap),null!==Hp&&rp.bindBuffer(rp.ELEMENT_ARRAY_BUFFER,dp.getAttributeBuffer(Hp)));var Wp=0;null===Hp?Op!==void 0&&(Wp=Op.count):Wp=Hp.count;var Xp=Ap.drawRange.start*Vp,jp=Ap.drawRange.count*Vp,Yp=null===wp?0:wp.start*Vp,qp=null===wp?1/0:wp.count*Vp,Zp=Math.max(Xp,Yp),Kp=Math.min(Wp,Xp+jp,Yp+qp)-1,Qp=Math.max(0,Kp-Zp+1);if(0!==Qp){if(Lp.isMesh){if(!0===Pp.wireframe)np.setLineWidth(Pp.wireframeLinewidth*Sl()),kp.setMode(rp.LINES);else switch(Lp.drawMode){case gs:kp.setMode(rp.TRIANGLES);break;case hs:kp.setMode(rp.TRIANGLE_STRIP);break;case ys:kp.setMode(rp.TRIANGLE_FAN);}}else if(Lp.isLine){var Jp=Pp.linewidth;Jp===void 0&&(Jp=1),np.setLineWidth(Jp*Sl()),Lp.isLineSegments?kp.setMode(rp.LINES):kp.setMode(rp.LINE_STRIP)}else Lp.isPoints&&kp.setMode(rp.POINTS);Ap&&Ap.isInstancedBufferGeometry?0<Ap.maxInstancedCount&&kp.renderInstances(Ap,Zp,Qp):kp.render(Zp,Qp)}},this.render=function(Ep,Mp,Ap,Pp){if(void 0!==Mp&&!0!==Mp.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");Cd="",Rd=-1,Id=null,!0===Ep.autoUpdate&&Ep.updateMatrixWorld(),null===Mp.parent&&Mp.updateMatrixWorld(),Mp.matrixWorldInverse.getInverse(Mp.matrixWorld),Kd.multiplyMatrices(Mp.projectionMatrix,Mp.matrixWorldInverse),Xd.setFromMatrix(Kd),yd.length=0,Td=-1,_d=-1,Ed.length=0,Md.length=0,qd=this.localClippingEnabled,Yd=jd.init(this.clippingPlanes,qd,Mp),Ul(Ep,Mp),xd.length=Td+1,vd.length=_d+1,!0===Ad.sortObjects&&(xd.sort(Il),vd.sort(Dl)),Yd&&jd.beginShadows(),od(yd),vp.render(Ep,Mp),nd(yd,Mp),Yd&&jd.endShadows(),tp.calls=0,tp.vertices=0,tp.faces=0,tp.points=0,void 0===Ap&&(Ap=null),this.setRenderTarget(Ap);var Lp=Ep.background;if(null===Lp?np.buffers.color.setClear(Nd.r,Nd.g,Nd.b,Ud,gd):Lp&&Lp.isColor&&(np.buffers.color.setClear(Lp.r,Lp.g,Lp.b,1,gd),Pp=!0),(this.autoClear||Pp)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),Lp&&Lp.isCubeTexture?(yp.projectionMatrix.copy(Mp.projectionMatrix),yp.matrixWorld.extractRotation(Mp.matrixWorld),yp.matrixWorldInverse.getInverse(yp.matrixWorld),bp.material.uniforms.tCube.value=Lp,bp.modelViewMatrix.multiplyMatrices(yp.matrixWorldInverse,bp.matrixWorld),dp.update(bp),Ad.renderBufferDirect(yp,null,bp.geometry,bp.material,bp,null)):Lp&&Lp.isTexture&&(xp.material.map=Lp,dp.update(xp),Ad.renderBufferDirect(hp,null,xp.geometry,xp.material,xp,null)),Ep.overrideMaterial){var wp=Ep.overrideMaterial;Hl(xd,Ep,Mp,wp),Hl(vd,Ep,Mp,wp)}else np.setBlending(Ei),Hl(xd,Ep,Mp),Hl(vd,Ep,Mp);_p.render(Ep,Mp),Sp.render(Ep,Mp,Bd),Ap&&lp.updateRenderTargetMipmap(Ap),np.setDepthTest(!0),np.setDepthWrite(!0),np.setColorWrite(!0)},this.setFaceCulling=function(Ep,Mp){np.setCullFace(Ep),np.setFlipSided(Mp===ui)},this.allocTextureUnit=function(){var Mp=Fd;return Mp>=ip.maxTextures&&console.warn("WebGLRenderer: trying to use "+Mp+" texture units while this GPU supports only "+ip.maxTextures),Fd+=1,Mp},this.setTexture2D=function(){var Ep=!1;return function(Ap,Pp){Ap&&Ap.isWebGLRenderTarget&&(!Ep&&(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),Ep=!0),Ap=Ap.texture),lp.setTexture2D(Ap,Pp)}}(),this.setTexture=function(){var Ep=!1;return function(Ap,Pp){Ep||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),Ep=!0),lp.setTexture2D(Ap,Pp)}}(),this.setTextureCube=function(){var Ep=!1;return function(Ap,Pp){Ap&&Ap.isWebGLRenderTargetCube&&(!Ep&&(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Ep=!0),Ap=Ap.texture),Ap&&Ap.isCubeTexture||Array.isArray(Ap.image)&&6===Ap.image.length?lp.setTextureCube(Ap,Pp):lp.setTextureCubeDynamic(Ap,Pp)}}(),this.getCurrentRenderTarget=function(){return Ld},this.setRenderTarget=function(Ep){Ld=Ep,Ep&&void 0===sp.get(Ep).__webglFramebuffer&&lp.setupRenderTarget(Ep);var Mp=Ep&&Ep.isWebGLRenderTargetCube,Ap;if(Ep){var Pp=sp.get(Ep);Ap=Mp?Pp.__webglFramebuffer[Ep.activeCubeFace]:Pp.__webglFramebuffer,Dd.copy(Ep.scissor),Gd=Ep.scissorTest,Bd.copy(Ep.viewport)}else Ap=null,Dd.copy(Vd).multiplyScalar(Od),Gd=kd,Bd.copy(Wd).multiplyScalar(Od);if(wd!==Ap&&(rp.bindFramebuffer(rp.FRAMEBUFFER,Ap),wd=Ap),np.scissor(Dd),np.setScissorTest(Gd),np.viewport(Bd),Mp){var Lp=sp.get(Ep.texture);rp.framebufferTexture2D(rp.FRAMEBUFFER,rp.COLOR_ATTACHMENT0,rp.TEXTURE_CUBE_MAP_POSITIVE_X+Ep.activeCubeFace,Lp.__webglTexture,Ep.activeMipMapLevel)}},this.readRenderTargetPixels=function(Ep,Mp,Ap,Pp,Lp,wp){if(!1===(Ep&&Ep.isWebGLRenderTarget))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var Rp=sp.get(Ep).__webglFramebuffer;if(Rp){var Cp=!1;Rp!==wd&&(rp.bindFramebuffer(rp.FRAMEBUFFER,Rp),Cp=!0);try{var Ip=Ep.texture,Dp=Ip.format,Gp=Ip.type;if(Dp!==Xn&&sd(Dp)!==rp.getParameter(rp.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(Gp!==Cn&&sd(Gp)!==rp.getParameter(rp.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Gp===Nn&&(op.get("OES_texture_float")||op.get("WEBGL_color_buffer_float")))&&!(Gp===Un&&op.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");rp.checkFramebufferStatus(rp.FRAMEBUFFER)===rp.FRAMEBUFFER_COMPLETE?0<=Mp&&Mp<=Ep.width-Pp&&0<=Ap&&Ap<=Ep.height-Lp&&rp.readPixels(Mp,Ap,Pp,Lp,sd(Dp),sd(Gp),wp):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Cp&&rp.bindFramebuffer(rp.FRAMEBUFFER,wd)}}}}function ar(_l,Sl){this.name="",this.color=new ze(_l),this.density=Sl===void 0?2.5e-4:Sl}function or(_l,Sl,El){this.name="",this.color=new ze(_l),this.near=Sl===void 0?1:Sl,this.far=El===void 0?1e3:El}function ir(){at.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function nr(_l,Sl,El,Ml,Al){at.call(this),this.lensFlares=[],this.positionScreen=new Z,this.customUpdateCallback=void 0,_l!==void 0&&this.add(_l,Sl,El,Ml,Al)}function sr(_l){Xe.call(this),this.type="SpriteMaterial",this.color=new ze(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(_l)}function dr(_l){at.call(this),this.type="Sprite",this.material=_l===void 0?new sr:_l}function pr(){at.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function cr(_l,Sl,El){if(this.useVertexTexture=void 0===El||El,this.identityMatrix=new K,_l=_l||[],this.bones=_l.slice(0),this.useVertexTexture){var Ml=Math.sqrt(4*this.bones.length);Ml=Ls.nextPowerOfTwo(Math.ceil(Ml)),Ml=Math.max(Ml,4),this.boneTextureWidth=Ml,this.boneTextureHeight=Ml,this.boneMatrices=new Float32Array(4*(this.boneTextureWidth*this.boneTextureHeight)),this.boneTexture=new Oe(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,Xn,Nn)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===Sl)this.calculateInverses();else if(this.bones.length===Sl.length)this.boneInverses=Sl.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var Al=0,Pl=this.bones.length;Al<Pl;Al++)this.boneInverses.push(new K)}}function ur(){at.call(this),this.type="Bone"}function mr(_l,Sl,El){Et.call(this,_l,Sl),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new K,this.bindMatrixInverse=new K;var Ml=[];if(this.geometry&&this.geometry.bones!==void 0){var Al,Pl;for(var Ll=0,wl=this.geometry.bones.length;Ll<wl;++Ll)Pl=this.geometry.bones[Ll],Al=new ur,Ml.push(Al),Al.name=Pl.name,Al.position.fromArray(Pl.pos),Al.quaternion.fromArray(Pl.rotq),void 0!==Pl.scl&&Al.scale.fromArray(Pl.scl);for(var Ll=0,wl=this.geometry.bones.length;Ll<wl;++Ll)Pl=this.geometry.bones[Ll],-1!==Pl.parent&&null!==Pl.parent&&void 0!==Ml[Pl.parent]?Ml[Pl.parent].add(Ml[Ll]):this.add(Ml[Ll])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new cr(Ml,void 0,El),this.matrixWorld)}function fr(_l){Xe.call(this),this.type="LineBasicMaterial",this.color=new ze(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(_l)}function gr(_l,Sl,El){return 1===El?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new hr(_l,Sl)):void(at.call(this),this.type="Line",this.geometry=_l===void 0?new St:_l,this.material=Sl===void 0?new fr({color:16777215*Math.random()}):Sl)}function hr(_l,Sl){gr.call(this,_l,Sl),this.type="LineSegments"}function yr(_l){Xe.call(this),this.type="PointsMaterial",this.color=new ze(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(_l)}function xr(_l,Sl){at.call(this),this.type="Points",this.geometry=_l===void 0?new St:_l,this.material=Sl===void 0?new yr({color:16777215*Math.random()}):Sl}function Tr(){at.call(this),this.type="Group"}function br(_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl){function Cl(){requestAnimationFrame(Cl),_l.readyState>=_l.HAVE_CURRENT_DATA&&(Il.needsUpdate=!0)}O.call(this,_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl),this.generateMipmaps=!1;var Il=this;Cl()}function vr(_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl,Cl,Il,Dl){O.call(this,null,Pl,Ll,wl,Rl,Cl,Ml,Al,Il,Dl),this.image={width:Sl,height:El},this.mipmaps=_l,this.flipY=!1,this.generateMipmaps=!1}function _r(_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl){O.call(this,_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl),this.needsUpdate=!0}function Sr(_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl,Cl){if(Cl=void 0===Cl?qn:Cl,Cl!==qn&&Cl!==Zn)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===El&&Cl===qn&&(El=Gn),void 0===El&&Cl===Zn&&(El=Vn),O.call(this,null,Ml,Al,Pl,Ll,wl,Cl,El,Rl),this.image={width:_l,height:Sl},this.magFilter=void 0===Ll?En:Ll,this.minFilter=void 0===wl?En:wl,this.flipY=!1,this.generateMipmaps=!1}function Er(_l){function Sl(Ql,Jl){return Ql-Jl}St.call(this);var El=[0,0],Ml={},Al=["a","b","c"];if(_l&&_l.isGeometry){var Pl=_l.vertices,Ll=_l.faces,wl=0,Rl=new Uint32Array(6*Ll.length);for(var Cl=0,Il=Ll.length;Cl<Il;Cl++){var Dl=Ll[Cl];for(var Gl=0;3>Gl;Gl++){El[0]=Dl[Al[Gl]],El[1]=Dl[Al[(Gl+1)%3]],El.sort(Sl);var Bl=El.toString();Ml[Bl]===void 0&&(Rl[2*wl]=El[0],Rl[2*wl+1]=El[1],Ml[Bl]=!0,wl++)}}var Fl=new Float32Array(3*(2*wl));for(var Cl=0,Il=wl;Cl<Il;Cl++)for(var Gl=0;2>Gl;Gl++){var Nl=Pl[Rl[2*Cl+Gl]],Ul=6*Cl+3*Gl;Fl[Ul+0]=Nl.x,Fl[Ul+1]=Nl.y,Fl[Ul+2]=Nl.z}this.addAttribute("position",new lt(Fl,3))}else if(_l&&_l.isBufferGeometry)if(null!==_l.index){var Hl=_l.index.array,Pl=_l.attributes.position,zl=_l.groups,wl=0;0===zl.length&&_l.addGroup(0,Hl.length);var Rl=new Uint32Array(2*Hl.length);for(var Ol=0,Vl=zl.length;Ol<Vl;++Ol){var Wl=zl[Ol],Xl=Wl.start,Yl=Wl.count;for(var Cl=Xl;Cl<Xl+Yl;Cl+=3)for(var Gl=0;3>Gl;Gl++){El[0]=Hl[Cl+Gl],El[1]=Hl[Cl+(Gl+1)%3],El.sort(Sl);var Bl=El.toString();void 0===Ml[Bl]&&(Rl[2*wl]=El[0],Rl[2*wl+1]=El[1],Ml[Bl]=!0,wl++)}}var Fl=new Float32Array(3*(2*wl));for(var Cl=0,Il=wl;Cl<Il;Cl++)for(var Gl=0;2>Gl;Gl++){var Ul=6*Cl+3*Gl,ql=Rl[2*Cl+Gl];Fl[Ul+0]=Pl.getX(ql),Fl[Ul+1]=Pl.getY(ql),Fl[Ul+2]=Pl.getZ(ql)}this.addAttribute("position",new lt(Fl,3))}else{var Pl=_l.attributes.position.array,wl=Pl.length/3,Zl=wl/3,Fl=new Float32Array(3*(2*wl));for(var Cl=0,Il=Zl;Cl<Il;Cl++)for(var Gl=0;3>Gl;Gl++){var Ul=18*Cl+6*Gl,Kl=9*Cl+3*Gl;Fl[Ul+0]=Pl[Kl],Fl[Ul+1]=Pl[Kl+1],Fl[Ul+2]=Pl[Kl+2];var ql=9*Cl+3*((Gl+1)%3);Fl[Ul+3]=Pl[ql],Fl[Ul+4]=Pl[ql+1],Fl[Ul+5]=Pl[ql+2]}this.addAttribute("position",new lt(Fl,3))}}function Mr(_l,Sl,El){St.call(this),this.type="ParametricBufferGeometry",this.parameters={func:_l,slices:Sl,stacks:El};var Ml=[],Al=[],Pl,Ll,wl,Rl,Cl,Il=Sl+1;for(Pl=0;Pl<=El;Pl++)for(Cl=Pl/El,Ll=0;Ll<=Sl;Ll++)Rl=Ll/Sl,wl=_l(Rl,Cl),Ml.push(wl.x,wl.y,wl.z),Al.push(Rl,Cl);var Dl=[],Gl,Bl,Fl,Nl;for(Pl=0;Pl<El;Pl++)for(Ll=0;Ll<Sl;Ll++)Gl=Pl*Il+Ll,Bl=Pl*Il+Ll+1,Fl=(Pl+1)*Il+Ll+1,Nl=(Pl+1)*Il+Ll,Dl.push(Gl,Bl,Nl),Dl.push(Bl,Fl,Nl);this.setIndex(new(65535<Dl.length?ht:ft)(Dl,1)),this.addAttribute("position",new yt(Ml,3)),this.addAttribute("uv",new yt(Al,2)),this.computeVertexNormals()}function Ar(_l,Sl,El){vt.call(this),this.type="ParametricGeometry",this.parameters={func:_l,slices:Sl,stacks:El},this.fromBufferGeometry(new Mr(_l,Sl,El)),this.mergeVertices()}function Pr(_l,Sl,El,Ml){function Al(Fl,Nl,Ul,Hl){var zl=Math.pow(2,Hl),Ol=[],Vl,Wl;for(Vl=0;Vl<=zl;Vl++){Ol[Vl]=[];var Xl=Fl.clone().lerp(Ul,Vl/zl),Yl=Nl.clone().lerp(Ul,Vl/zl),ql=zl-Vl;for(Wl=0;Wl<=ql;Wl++)Ol[Vl][Wl]=0===Wl&&Vl===zl?Xl:Xl.clone().lerp(Yl,Wl/ql)}for(Vl=0;Vl<zl;Vl++)for(Wl=0;Wl<2*(zl-Vl)-1;Wl++){var Zl=Math.floor(Wl/2);0==Wl%2?(Ll(Ol[Vl][Zl+1]),Ll(Ol[Vl+1][Zl]),Ll(Ol[Vl][Zl])):(Ll(Ol[Vl][Zl+1]),Ll(Ol[Vl+1][Zl+1]),Ll(Ol[Vl+1][Zl]))}}function Pl(){for(var Fl=0;Fl<Bl.length;Fl+=6){var Nl=Bl[Fl+0],Ul=Bl[Fl+2],Hl=Bl[Fl+4],zl=Math.max(Nl,Ul,Hl),Ol=Math.min(Nl,Ul,Hl);0.9<zl&&0.1>Ol&&(0.2>Nl&&(Bl[Fl+0]+=1),0.2>Ul&&(Bl[Fl+2]+=1),0.2>Hl&&(Bl[Fl+4]+=1))}}function Ll(Fl){Gl.push(Fl.x,Fl.y,Fl.z)}function wl(Fl,Nl){var Ul=3*Fl;Nl.x=_l[Ul+0],Nl.y=_l[Ul+1],Nl.z=_l[Ul+2]}function Rl(){var Fl=new Z,Nl=new Z,Ul=new Z,Hl=new Z,zl=new H,Ol=new H,Vl=new H;for(var Wl=0,Xl=0;Wl<Gl.length;Wl+=9,Xl+=6){Fl.set(Gl[Wl+0],Gl[Wl+1],Gl[Wl+2]),Nl.set(Gl[Wl+3],Gl[Wl+4],Gl[Wl+5]),Ul.set(Gl[Wl+6],Gl[Wl+7],Gl[Wl+8]),zl.set(Bl[Xl+0],Bl[Xl+1]),Ol.set(Bl[Xl+2],Bl[Xl+3]),Vl.set(Bl[Xl+4],Bl[Xl+5]),Hl.copy(Fl).add(Nl).add(Ul).divideScalar(3);var Yl=Il(Hl);Cl(zl,Xl+0,Fl,Yl),Cl(Ol,Xl+2,Nl,Yl),Cl(Vl,Xl+4,Ul,Yl)}}function Cl(Fl,Nl,Ul,Hl){0>Hl&&1===Fl.x&&(Bl[Nl]=Fl.x-1),0===Ul.x&&0===Ul.z&&(Bl[Nl]=Hl/2/Math.PI+0.5)}function Il(Fl){return Math.atan2(Fl.z,-Fl.x)}function Dl(Fl){return Math.atan2(-Fl.y,Math.sqrt(Fl.x*Fl.x+Fl.z*Fl.z))}St.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:_l,indices:Sl,radius:El,detail:Ml},El=El||1,Ml=Ml||0;var Gl=[],Bl=[];(function(Nl){var Ul=new Z,Hl=new Z,zl=new Z;for(var Ol=0;Ol<Sl.length;Ol+=3)wl(Sl[Ol+0],Ul),wl(Sl[Ol+1],Hl),wl(Sl[Ol+2],zl),Al(Ul,Hl,zl,Nl)})(Ml),function(Nl){var Ul=new Z;for(var Hl=0;Hl<Gl.length;Hl+=3)Ul.x=Gl[Hl+0],Ul.y=Gl[Hl+1],Ul.z=Gl[Hl+2],Ul.normalize().multiplyScalar(Nl),Gl[Hl+0]=Ul.x,Gl[Hl+1]=Ul.y,Gl[Hl+2]=Ul.z}(El),function(){var Nl=new Z;for(var Ul=0;Ul<Gl.length;Ul+=3){Nl.x=Gl[Ul+0],Nl.y=Gl[Ul+1],Nl.z=Gl[Ul+2];var Hl=Il(Nl)/2/Math.PI+0.5,zl=Dl(Nl)/Math.PI+0.5;Bl.push(Hl,1-zl)}Rl(),Pl()}(),this.addAttribute("position",new yt(Gl,3)),this.addAttribute("normal",new yt(Gl.slice(),3)),this.addAttribute("uv",new yt(Bl,2)),this.normalizeNormals(),this.boundingSphere=new Ze(new Z(),El)}function Lr(_l,Sl){Pr.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],_l,Sl),this.type="TetrahedronBufferGeometry",this.parameters={radius:_l,detail:Sl}}function wr(_l,Sl){vt.call(this),this.type="TetrahedronGeometry",this.parameters={radius:_l,detail:Sl},this.fromBufferGeometry(new Lr(_l,Sl)),this.mergeVertices()}function Rr(_l,Sl){Pr.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],_l,Sl),this.type="OctahedronBufferGeometry",this.parameters={radius:_l,detail:Sl}}function Cr(_l,Sl){vt.call(this),this.type="OctahedronGeometry",this.parameters={radius:_l,detail:Sl},this.fromBufferGeometry(new Rr(_l,Sl)),this.mergeVertices()}function Ir(_l,Sl){var El=(1+Math.sqrt(5))/2;Pr.call(this,[-1,El,0,1,El,0,-1,-El,0,1,-El,0,0,-1,El,0,1,El,0,-1,-El,0,1,-El,El,0,-1,El,0,1,-El,0,-1,-El,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],_l,Sl),this.type="IcosahedronBufferGeometry",this.parameters={radius:_l,detail:Sl}}function Dr(_l,Sl){vt.call(this),this.type="IcosahedronGeometry",this.parameters={radius:_l,detail:Sl},this.fromBufferGeometry(new Ir(_l,Sl)),this.mergeVertices()}function Gr(_l,Sl){var El=(1+Math.sqrt(5))/2,Ml=1/El;Pr.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-Ml,-El,0,-Ml,El,0,Ml,-El,0,Ml,El,-Ml,-El,0,-Ml,El,0,Ml,-El,0,Ml,El,0,-El,0,-Ml,El,0,-Ml,-El,0,Ml,El,0,Ml],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],_l,Sl),this.type="DodecahedronBufferGeometry",this.parameters={radius:_l,detail:Sl}}function Br(_l,Sl){vt.call(this),this.type="DodecahedronGeometry",this.parameters={radius:_l,detail:Sl},this.fromBufferGeometry(new Gr(_l,Sl)),this.mergeVertices()}function Fr(_l,Sl,El,Ml){vt.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:_l,indices:Sl,radius:El,detail:Ml},this.fromBufferGeometry(new Pr(_l,Sl,El,Ml)),this.mergeVertices()}function Nr(_l,Sl,El,Ml,Al){function Pl(zl){var Ol=_l.getPointAt(zl/Sl),Vl=Rl.normals[zl],Wl=Rl.binormals[zl];for(Bl=0;Bl<=Ml;Bl++){var Xl=2*(Bl/Ml*Math.PI),Yl=Math.sin(Xl),ql=-Math.cos(Xl);Il.x=ql*Vl.x+Yl*Wl.x,Il.y=ql*Vl.y+Yl*Wl.y,Il.z=ql*Vl.z+Yl*Wl.z,Il.normalize(),Nl.push(Il.x,Il.y,Il.z),Cl.x=Ol.x+El*Il.x,Cl.y=Ol.y+El*Il.y,Cl.z=Ol.z+El*Il.z,Fl.push(Cl.x,Cl.y,Cl.z)}}function Ll(){for(Bl=1;Bl<=Sl;Bl++)for(Gl=1;Gl<=Ml;Gl++){var zl=(Ml+1)*(Bl-1)+(Gl-1),Ol=(Ml+1)*Bl+(Gl-1),Vl=(Ml+1)*Bl+Gl,Wl=(Ml+1)*(Bl-1)+Gl;Hl.push(zl,Ol,Wl),Hl.push(Ol,Vl,Wl)}}function wl(){for(Gl=0;Gl<=Sl;Gl++)for(Bl=0;Bl<=Ml;Bl++)Dl.x=Gl/Sl,Dl.y=Bl/Ml,Ul.push(Dl.x,Dl.y)}St.call(this),this.type="TubeBufferGeometry",this.parameters={path:_l,tubularSegments:Sl,radius:El,radialSegments:Ml,closed:Al},Sl=Sl||64,El=El||1,Ml=Ml||8,Al=Al||!1;var Rl=_l.computeFrenetFrames(Sl,Al);this.tangents=Rl.tangents,this.normals=Rl.normals,this.binormals=Rl.binormals;var Cl=new Z,Il=new Z,Dl=new H,Gl,Bl,Fl=[],Nl=[],Ul=[],Hl=[];(function(){for(Gl=0;Gl<Sl;Gl++)Pl(Gl);Pl(!1===Al?Sl:0),wl(),Ll()})(),this.setIndex(new(65535<Hl.length?ht:ft)(Hl,1)),this.addAttribute("position",new yt(Fl,3)),this.addAttribute("normal",new yt(Nl,3)),this.addAttribute("uv",new yt(Ul,2))}function Ur(_l,Sl,El,Ml,Al,Pl){vt.call(this),this.type="TubeGeometry",this.parameters={path:_l,tubularSegments:Sl,radius:El,radialSegments:Ml,closed:Al},Pl!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var Ll=new Nr(_l,Sl,El,Ml,Al);this.tangents=Ll.tangents,this.normals=Ll.normals,this.binormals=Ll.binormals,this.fromBufferGeometry(Ll),this.mergeVertices()}function Hr(_l,Sl,El,Ml,Al,Pl){function Ll(od,nd,sd,ld,dd){var cd=Math.cos(od),ud=Math.sin(od),md=sd/nd*od,fd=Math.cos(md);dd.x=0.5*(ld*(2+fd))*cd,dd.y=0.5*(ld*(2+fd)*ud),dd.z=0.5*(ld*Math.sin(md))}St.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:_l,tube:Sl,tubularSegments:El,radialSegments:Ml,p:Al,q:Pl},_l=_l||100,Sl=Sl||40,El=Math.floor(El)||64,Ml=Math.floor(Ml)||8,Al=Al||2,Pl=Pl||3;var wl=(Ml+1)*(El+1),Rl=3*(2*(Ml*El)),Cl=new lt(new(65535<Rl?Uint32Array:Uint16Array)(Rl),1),Il=new lt(new Float32Array(3*wl),3),Dl=new lt(new Float32Array(3*wl),3),Gl=new lt(new Float32Array(2*wl),2),Bl,Fl,Nl=0,Ul=0,Hl=new Z,zl=new Z,Ol=new H,Vl=new Z,Wl=new Z,Xl=new Z,Yl=new Z,ql=new Z;for(Bl=0;Bl<=El;++Bl){var Zl=2*(Bl/El*Al*Math.PI);for(Ll(Zl,Al,Pl,_l,Vl),Ll(Zl+0.01,Al,Pl,_l,Wl),Yl.subVectors(Wl,Vl),ql.addVectors(Wl,Vl),Xl.crossVectors(Yl,ql),ql.crossVectors(Xl,Yl),Xl.normalize(),ql.normalize(),Fl=0;Fl<=Ml;++Fl){var Kl=2*(Fl/Ml*Math.PI),Ql=-Sl*Math.cos(Kl),Jl=Sl*Math.sin(Kl);Hl.x=Vl.x+(Ql*ql.x+Jl*Xl.x),Hl.y=Vl.y+(Ql*ql.y+Jl*Xl.y),Hl.z=Vl.z+(Ql*ql.z+Jl*Xl.z),Il.setXYZ(Nl,Hl.x,Hl.y,Hl.z),zl.subVectors(Hl,Vl).normalize(),Dl.setXYZ(Nl,zl.x,zl.y,zl.z),Ol.x=Bl/El,Ol.y=Fl/Ml,Gl.setXY(Nl,Ol.x,Ol.y),Nl++}}for(Fl=1;Fl<=El;Fl++)for(Bl=1;Bl<=Ml;Bl++){var $l=(Ml+1)*(Fl-1)+(Bl-1),ed=(Ml+1)*Fl+(Bl-1),td=(Ml+1)*Fl+Bl,rd=(Ml+1)*(Fl-1)+Bl;Cl.setX(Ul,$l),Ul++,Cl.setX(Ul,ed),Ul++,Cl.setX(Ul,rd),Ul++,Cl.setX(Ul,ed),Ul++,Cl.setX(Ul,td),Ul++,Cl.setX(Ul,rd),Ul++}this.setIndex(Cl),this.addAttribute("position",Il),this.addAttribute("normal",Dl),this.addAttribute("uv",Gl)}function zr(_l,Sl,El,Ml,Al,Pl,Ll){vt.call(this),this.type="TorusKnotGeometry",this.parameters={radius:_l,tube:Sl,tubularSegments:El,radialSegments:Ml,p:Al,q:Pl},Ll!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Hr(_l,Sl,El,Ml,Al,Pl)),this.mergeVertices()}function Or(_l,Sl,El,Ml,Al){St.call(this),this.type="TorusBufferGeometry",this.parameters={radius:_l,tube:Sl,radialSegments:El,tubularSegments:Ml,arc:Al},_l=_l||100,Sl=Sl||40,El=Math.floor(El)||8,Ml=Math.floor(Ml)||6,Al=Al||2*Math.PI;var Pl=(El+1)*(Ml+1),Ll=3*(2*(El*Ml)),wl=new(65535<Ll?Uint32Array:Uint16Array)(Ll),Rl=new Float32Array(3*Pl),Cl=new Float32Array(3*Pl),Il=new Float32Array(2*Pl),Dl=0,Gl=0,Bl=0,Fl=new Z,Nl=new Z,Ul=new Z,Hl,zl;for(Hl=0;Hl<=El;Hl++)for(zl=0;zl<=Ml;zl++){var Ol=zl/Ml*Al,Vl=2*(Hl/El*Math.PI);Nl.x=(_l+Sl*Math.cos(Vl))*Math.cos(Ol),Nl.y=(_l+Sl*Math.cos(Vl))*Math.sin(Ol),Nl.z=Sl*Math.sin(Vl),Rl[Dl]=Nl.x,Rl[Dl+1]=Nl.y,Rl[Dl+2]=Nl.z,Fl.x=_l*Math.cos(Ol),Fl.y=_l*Math.sin(Ol),Ul.subVectors(Nl,Fl).normalize(),Cl[Dl]=Ul.x,Cl[Dl+1]=Ul.y,Cl[Dl+2]=Ul.z,Il[Gl]=zl/Ml,Il[Gl+1]=Hl/El,Dl+=3,Gl+=2}for(Hl=1;Hl<=El;Hl++)for(zl=1;zl<=Ml;zl++){var Wl=(Ml+1)*Hl+zl-1,Xl=(Ml+1)*(Hl-1)+zl-1,Yl=(Ml+1)*(Hl-1)+zl,ql=(Ml+1)*Hl+zl;wl[Bl]=Wl,wl[Bl+1]=Xl,wl[Bl+2]=ql,wl[Bl+3]=Xl,wl[Bl+4]=Yl,wl[Bl+5]=ql,Bl+=6}this.setIndex(new lt(wl,1)),this.addAttribute("position",new lt(Rl,3)),this.addAttribute("normal",new lt(Cl,3)),this.addAttribute("uv",new lt(Il,2))}function Vr(_l,Sl,El,Ml,Al){vt.call(this),this.type="TorusGeometry",this.parameters={radius:_l,tube:Sl,radialSegments:El,tubularSegments:Ml,arc:Al},this.fromBufferGeometry(new Or(_l,Sl,El,Ml,Al))}function kr(_l,Sl){return"undefined"==typeof _l?void(_l=[]):void(vt.call(this),this.type="ExtrudeGeometry",_l=Array.isArray(_l)?_l:[_l],this.addShapeList(_l,Sl),this.computeFaceNormals())}function Wr(_l,Sl){Sl=Sl||{};var El=Sl.font;if(!1===(El&&El.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new vt;var Ml=El.generateShapes(_l,Sl.size,Sl.curveSegments);Sl.amount=Sl.height===void 0?50:Sl.height,Sl.bevelThickness===void 0&&(Sl.bevelThickness=10),Sl.bevelSize===void 0&&(Sl.bevelSize=8),Sl.bevelEnabled===void 0&&(Sl.bevelEnabled=!1),kr.call(this,Ml,Sl),this.type="TextGeometry"}function Xr(_l,Sl,El,Ml,Al,Pl,Ll){St.call(this),this.type="SphereBufferGeometry",this.parameters={radius:_l,widthSegments:Sl,heightSegments:El,phiStart:Ml,phiLength:Al,thetaStart:Pl,thetaLength:Ll},_l=_l||50,Sl=Math.max(3,Math.floor(Sl)||8),El=Math.max(2,Math.floor(El)||6),Ml=Ml===void 0?0:Ml,Al=Al===void 0?2*Math.PI:Al,Pl=Pl===void 0?0:Pl,Ll=Ll===void 0?Math.PI:Ll;var wl=Pl+Ll,Rl=(Sl+1)*(El+1),Cl=new lt(new Float32Array(3*Rl),3),Il=new lt(new Float32Array(3*Rl),3),Dl=new lt(new Float32Array(2*Rl),2),Gl=0,Bl=[],Fl=new Z;for(var Nl=0;Nl<=El;Nl++){var Ul=[],Hl=Nl/El;for(var zl=0;zl<=Sl;zl++){var Ol=zl/Sl,Vl=-_l*Math.cos(Ml+Ol*Al)*Math.sin(Pl+Hl*Ll),Wl=_l*Math.cos(Pl+Hl*Ll),Xl=_l*Math.sin(Ml+Ol*Al)*Math.sin(Pl+Hl*Ll);Fl.set(Vl,Wl,Xl).normalize(),Cl.setXYZ(Gl,Vl,Wl,Xl),Il.setXYZ(Gl,Fl.x,Fl.y,Fl.z),Dl.setXY(Gl,Ol,1-Hl),Ul.push(Gl),Gl++}Bl.push(Ul)}var Yl=[];for(var Nl=0;Nl<El;Nl++)for(var zl=0;zl<Sl;zl++){var ql=Bl[Nl][zl+1],Zl=Bl[Nl][zl],Kl=Bl[Nl+1][zl],Ql=Bl[Nl+1][zl+1];(0!==Nl||0<Pl)&&Yl.push(ql,Zl,Ql),(Nl!==El-1||wl<Math.PI)&&Yl.push(Zl,Kl,Ql)}this.setIndex(new(65535<Cl.count?ht:ft)(Yl,1)),this.addAttribute("position",Cl),this.addAttribute("normal",Il),this.addAttribute("uv",Dl),this.boundingSphere=new Ze(new Z(),_l)}function jr(_l,Sl,El,Ml,Al,Pl,Ll){vt.call(this),this.type="SphereGeometry",this.parameters={radius:_l,widthSegments:Sl,heightSegments:El,phiStart:Ml,phiLength:Al,thetaStart:Pl,thetaLength:Ll},this.fromBufferGeometry(new Xr(_l,Sl,El,Ml,Al,Pl,Ll))}function Yr(_l,Sl,El,Ml,Al,Pl){St.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:_l,outerRadius:Sl,thetaSegments:El,phiSegments:Ml,thetaStart:Al,thetaLength:Pl},_l=_l||20,Sl=Sl||50,Al=Al===void 0?0:Al,Pl=Pl===void 0?2*Math.PI:Pl,El=El===void 0?8:Math.max(3,El),Ml=Ml===void 0?1:Math.max(1,Ml);var Ll=(El+1)*(Ml+1),wl=3*(2*(El*Ml)),Rl=new lt(new(65535<wl?Uint32Array:Uint16Array)(wl),1),Cl=new lt(new Float32Array(3*Ll),3),Il=new lt(new Float32Array(3*Ll),3),Dl=new lt(new Float32Array(2*Ll),2),Gl=0,Bl=0,Fl,Nl=_l,Ul=(Sl-_l)/Ml,Hl=new Z,zl=new H,Ol,Vl;for(Ol=0;Ol<=Ml;Ol++){for(Vl=0;Vl<=El;Vl++)Fl=Al+Vl/El*Pl,Hl.x=Nl*Math.cos(Fl),Hl.y=Nl*Math.sin(Fl),Cl.setXYZ(Gl,Hl.x,Hl.y,Hl.z),Il.setXYZ(Gl,0,0,1),zl.x=(Hl.x/Sl+1)/2,zl.y=(Hl.y/Sl+1)/2,Dl.setXY(Gl,zl.x,zl.y),Gl++;Nl+=Ul}for(Ol=0;Ol<Ml;Ol++){var Wl=Ol*(El+1);for(Vl=0;Vl<El;Vl++){Fl=Vl+Wl;var Xl=Fl,Yl=Fl+El+1,ql=Fl+El+2,Zl=Fl+1;Rl.setX(Bl,Xl),Bl++,Rl.setX(Bl,Yl),Bl++,Rl.setX(Bl,ql),Bl++,Rl.setX(Bl,Xl),Bl++,Rl.setX(Bl,ql),Bl++,Rl.setX(Bl,Zl),Bl++}}this.setIndex(Rl),this.addAttribute("position",Cl),this.addAttribute("normal",Il),this.addAttribute("uv",Dl)}function qr(_l,Sl,El,Ml,Al,Pl){vt.call(this),this.type="RingGeometry",this.parameters={innerRadius:_l,outerRadius:Sl,thetaSegments:El,phiSegments:Ml,thetaStart:Al,thetaLength:Pl},this.fromBufferGeometry(new Yr(_l,Sl,El,Ml,Al,Pl))}function Zr(_l,Sl,El,Ml){vt.call(this),this.type="PlaneGeometry",this.parameters={width:_l,height:Sl,widthSegments:El,heightSegments:Ml},this.fromBufferGeometry(new At(_l,Sl,El,Ml))}function Kr(_l,Sl,El,Ml){St.call(this),this.type="LatheBufferGeometry",this.parameters={points:_l,segments:Sl,phiStart:El,phiLength:Ml},Sl=Math.floor(Sl)||12,El=El||0,Ml=Ml||2*Math.PI,Ml=Ls.clamp(Ml,0,2*Math.PI);var Al=(Sl+1)*_l.length,Pl=3*(2*(Sl*_l.length)),Ll=new lt(new(65535<Pl?Uint32Array:Uint16Array)(Pl),1),wl=new lt(new Float32Array(3*Al),3),Rl=new lt(new Float32Array(2*Al),2),Cl=0,Il=0,Gl=1/Sl,Bl=new Z,Fl=new H,Dl,Nl,Ul;for(Nl=0;Nl<=Sl;Nl++){var Hl=El+Nl*Gl*Ml,zl=Math.sin(Hl),Ol=Math.cos(Hl);for(Ul=0;Ul<=_l.length-1;Ul++)Bl.x=_l[Ul].x*zl,Bl.y=_l[Ul].y,Bl.z=_l[Ul].x*Ol,wl.setXYZ(Cl,Bl.x,Bl.y,Bl.z),Fl.x=Nl/Sl,Fl.y=Ul/(_l.length-1),Rl.setXY(Cl,Fl.x,Fl.y),Cl++}for(Nl=0;Nl<Sl;Nl++)for(Ul=0;Ul<_l.length-1;Ul++){Dl=Ul+Nl*_l.length;var Vl=Dl,Wl=Dl+_l.length,Xl=Dl+_l.length+1,Yl=Dl+1;Ll.setX(Il,Vl),Il++,Ll.setX(Il,Wl),Il++,Ll.setX(Il,Yl),Il++,Ll.setX(Il,Wl),Il++,Ll.setX(Il,Xl),Il++,Ll.setX(Il,Yl),Il++}if(this.setIndex(Ll),this.addAttribute("position",wl),this.addAttribute("uv",Rl),this.computeVertexNormals(),Ml===2*Math.PI){var ql=this.attributes.normal.array,Zl=new Z,Kl=new Z,Ql=new Z;for(Dl=3*(Sl*_l.length),Nl=0,Ul=0;Nl<_l.length;Nl++,Ul+=3)Zl.x=ql[Ul+0],Zl.y=ql[Ul+1],Zl.z=ql[Ul+2],Kl.x=ql[Dl+Ul+0],Kl.y=ql[Dl+Ul+1],Kl.z=ql[Dl+Ul+2],Ql.addVectors(Zl,Kl).normalize(),ql[Ul+0]=ql[Dl+Ul+0]=Ql.x,ql[Ul+1]=ql[Dl+Ul+1]=Ql.y,ql[Ul+2]=ql[Dl+Ul+2]=Ql.z}}function Qr(_l,Sl,El,Ml){vt.call(this),this.type="LatheGeometry",this.parameters={points:_l,segments:Sl,phiStart:El,phiLength:Ml},this.fromBufferGeometry(new Kr(_l,Sl,El,Ml)),this.mergeVertices()}function Jr(_l,Sl){function El(Il){var Dl,Gl,Bl,Fl=Ml.length/3,Nl=Il.extractPoints(Sl),Ul=Nl.shape,Hl=Nl.holes;if(!1===Ws.isClockWise(Ul))for(Ul=Ul.reverse(),Dl=0,Gl=Hl.length;Dl<Gl;Dl++)Bl=Hl[Dl],!0===Ws.isClockWise(Bl)&&(Hl[Dl]=Bl.reverse());var zl=Ws.triangulateShape(Ul,Hl);for(Dl=0,Gl=Hl.length;Dl<Gl;Dl++)Bl=Hl[Dl],Ul=Ul.concat(Bl);for(Dl=0,Gl=Ul.length;Dl<Gl;Dl++){var Ol=Ul[Dl];Ml.push(Ol.x,Ol.y,0),Al.push(0,0,1),Pl.push(Ol.x,Ol.y)}for(Dl=0,Gl=zl.length;Dl<Gl;Dl++){var Vl=zl[Dl],Wl=Vl[0]+Fl,Xl=Vl[1]+Fl,Yl=Vl[2]+Fl;Ll.push(Wl,Xl,Yl),Rl+=3}}St.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:_l,curveSegments:Sl},Sl=Sl||12;var Ml=[],Al=[],Pl=[],Ll=[],wl=0,Rl=0;if(!1===Array.isArray(_l))El(_l);else for(var Cl=0;Cl<_l.length;Cl++)El(_l[Cl]),this.addGroup(wl,Rl,Cl),wl+=Rl,Rl=0;this.setIndex(new(65535<Ll.length?ht:ft)(Ll,1)),this.addAttribute("position",new yt(Ml,3)),this.addAttribute("normal",new yt(Al,3)),this.addAttribute("uv",new yt(Pl,2))}function $r(_l,Sl){vt.call(this),this.type="ShapeGeometry","object"==typeof Sl&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),Sl=Sl.curveSegments),this.parameters={shapes:_l,curveSegments:Sl},this.fromBufferGeometry(new Jr(_l,Sl)),this.mergeVertices()}function ea(_l,Sl){function El(zl,Ol){return zl-Ol}St.call(this),Sl=Sl===void 0?1:Sl;var Ml=Math.cos(Ls.DEG2RAD*Sl),Al=[0,0],Pl={},Ll=["a","b","c"],wl;_l.isBufferGeometry?(wl=new vt,wl.fromBufferGeometry(_l)):wl=_l.clone(),wl.mergeVertices(),wl.computeFaceNormals();var Rl=wl.vertices,Cl=wl.faces;for(var Il=0,Dl=Cl.length;Il<Dl;Il++){var Gl=Cl[Il];for(var Bl=0;3>Bl;Bl++){Al[0]=Gl[Ll[Bl]],Al[1]=Gl[Ll[(Bl+1)%3]],Al.sort(El);var Fl=Al.toString();Pl[Fl]===void 0?Pl[Fl]={vert1:Al[0],vert2:Al[1],face1:Il,face2:void 0}:Pl[Fl].face2=Il}}var Nl=[];for(var Fl in Pl){var Ul=Pl[Fl];if(Ul.face2===void 0||Cl[Ul.face1].normal.dot(Cl[Ul.face2].normal)<=Ml){var Hl=Rl[Ul.vert1];Nl.push(Hl.x),Nl.push(Hl.y),Nl.push(Hl.z),Hl=Rl[Ul.vert2],Nl.push(Hl.x),Nl.push(Hl.y),Nl.push(Hl.z)}}this.addAttribute("position",new yt(Nl,3))}function ta(_l,Sl,El,Ml,Al,Pl,Ll,wl){function Rl(Xl){var Yl,ql,Zl,Kl=new H,Ql=new Z,Jl=0,$l=!0===Xl?_l:Sl,ed=!0===Xl?1:-1;for(ql=Hl,Yl=1;Yl<=Ml;Yl++)Fl.setXYZ(Hl,0,Vl*ed,0),Nl.setXYZ(Hl,0,ed,0),Kl.x=0.5,Kl.y=0.5,Ul.setXY(Hl,Kl.x,Kl.y),Hl++;for(Zl=Hl,Yl=0;Yl<=Ml;Yl++){var td=Yl/Ml,rd=td*wl+Ll,od=Math.cos(rd),nd=Math.sin(rd);Ql.x=$l*nd,Ql.y=Vl*ed,Ql.z=$l*od,Fl.setXYZ(Hl,Ql.x,Ql.y,Ql.z),Nl.setXYZ(Hl,0,ed,0),Kl.x=0.5*od+0.5,Kl.y=0.5*nd*ed+0.5,Ul.setXY(Hl,Kl.x,Kl.y),Hl++}for(Yl=0;Yl<Ml;Yl++){var sd=ql+Yl,ld=Zl+Yl;!0===Xl?(Bl.setX(zl,ld),zl++,Bl.setX(zl,ld+1),zl++,Bl.setX(zl,sd),zl++):(Bl.setX(zl,ld+1),zl++,Bl.setX(zl,ld),zl++,Bl.setX(zl,sd),zl++),Jl+=3}Cl.addGroup(Wl,Jl,!0===Xl?1:2),Wl+=Jl}St.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:_l,radiusBottom:Sl,height:El,radialSegments:Ml,heightSegments:Al,openEnded:Pl,thetaStart:Ll,thetaLength:wl};var Cl=this;_l=_l===void 0?20:_l,Sl=Sl===void 0?20:Sl,El=El===void 0?100:El,Ml=Math.floor(Ml)||8,Al=Math.floor(Al)||1,Pl=Pl!==void 0&&Pl,Ll=Ll===void 0?0:Ll,wl=wl===void 0?2*Math.PI:wl;var Il=0;!1===Pl&&(0<_l&&Il++,0<Sl&&Il++);var Dl=function(){var Yl=(Ml+1)*(Al+1);return!1===Pl&&(Yl+=(Ml+1)*Il+Ml*Il),Yl}(),Gl=function(){var Yl=3*(2*(Ml*Al));return!1===Pl&&(Yl+=3*(Ml*Il)),Yl}(),Bl=new lt(new(65535<Gl?Uint32Array:Uint16Array)(Gl),1),Fl=new lt(new Float32Array(3*Dl),3),Nl=new lt(new Float32Array(3*Dl),3),Ul=new lt(new Float32Array(2*Dl),2),Hl=0,zl=0,Ol=[],Vl=El/2,Wl=0;(function(){var Yl,ql,Zl=new Z,Kl=new Z,Ql=0,Jl=(Sl-_l)/El;for(ql=0;ql<=Al;ql++){var $l=[],ed=ql/Al,td=ed*(Sl-_l)+_l;for(Yl=0;Yl<=Ml;Yl++){var rd=Yl/Ml,od=rd*wl+Ll,nd=Math.sin(od),sd=Math.cos(od);Kl.x=td*nd,Kl.y=-ed*El+Vl,Kl.z=td*sd,Fl.setXYZ(Hl,Kl.x,Kl.y,Kl.z),Zl.set(nd,Jl,sd).normalize(),Nl.setXYZ(Hl,Zl.x,Zl.y,Zl.z),Ul.setXY(Hl,rd,1-ed),$l.push(Hl),Hl++}Ol.push($l)}for(Yl=0;Yl<Ml;Yl++)for(ql=0;ql<Al;ql++){var ld=Ol[ql][Yl],dd=Ol[ql+1][Yl],cd=Ol[ql+1][Yl+1],ud=Ol[ql][Yl+1];Bl.setX(zl,ld),zl++,Bl.setX(zl,dd),zl++,Bl.setX(zl,ud),zl++,Bl.setX(zl,dd),zl++,Bl.setX(zl,cd),zl++,Bl.setX(zl,ud),zl++,Ql+=6}Cl.addGroup(Wl,Ql,0),Wl+=Ql})(),!1===Pl&&(0<_l&&Rl(!0),0<Sl&&Rl(!1)),this.setIndex(Bl),this.addAttribute("position",Fl),this.addAttribute("normal",Nl),this.addAttribute("uv",Ul)}function ra(_l,Sl,El,Ml,Al,Pl,Ll,wl){vt.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:_l,radiusBottom:Sl,height:El,radialSegments:Ml,heightSegments:Al,openEnded:Pl,thetaStart:Ll,thetaLength:wl},this.fromBufferGeometry(new ta(_l,Sl,El,Ml,Al,Pl,Ll,wl)),this.mergeVertices()}function oa(_l,Sl,El,Ml,Al,Pl,Ll){ra.call(this,0,_l,Sl,El,Ml,Al,Pl,Ll),this.type="ConeGeometry",this.parameters={radius:_l,height:Sl,radialSegments:El,heightSegments:Ml,openEnded:Al,thetaStart:Pl,thetaLength:Ll}}function ia(_l,Sl,El,Ml,Al,Pl,Ll){ta.call(this,0,_l,Sl,El,Ml,Al,Pl,Ll),this.type="ConeBufferGeometry",this.parameters={radius:_l,height:Sl,radialSegments:El,heightSegments:Ml,openEnded:Al,thetaStart:Pl,thetaLength:Ll}}function na(_l,Sl,El,Ml){St.call(this),this.type="CircleBufferGeometry",this.parameters={radius:_l,segments:Sl,thetaStart:El,thetaLength:Ml},_l=_l||50,Sl=Sl===void 0?8:Math.max(3,Sl),El=El===void 0?0:El,Ml=Ml===void 0?2*Math.PI:Ml;var Al=Sl+2,Pl=new Float32Array(3*Al),Ll=new Float32Array(3*Al),wl=new Float32Array(2*Al);Ll[2]=1,wl[0]=0.5,wl[1]=0.5;for(var Rl=0,Cl=3,Il=2;Rl<=Sl;Rl++,Cl+=3,Il+=2){var Dl=El+Rl/Sl*Ml;Pl[Cl]=_l*Math.cos(Dl),Pl[Cl+1]=_l*Math.sin(Dl),Ll[Cl+2]=1,wl[Il]=(Pl[Cl]/_l+1)/2,wl[Il+1]=(Pl[Cl+1]/_l+1)/2}var Gl=[];for(var Cl=1;Cl<=Sl;Cl++)Gl.push(Cl,Cl+1,0);this.setIndex(new lt(new Uint16Array(Gl),1)),this.addAttribute("position",new lt(Pl,3)),this.addAttribute("normal",new lt(Ll,3)),this.addAttribute("uv",new lt(wl,2)),this.boundingSphere=new Ze(new Z(),_l)}function sa(_l,Sl,El,Ml){vt.call(this),this.type="CircleGeometry",this.parameters={radius:_l,segments:Sl,thetaStart:El,thetaLength:Ml},this.fromBufferGeometry(new na(_l,Sl,El,Ml))}function la(_l,Sl,El,Ml,Al,Pl){vt.call(this),this.type="BoxGeometry",this.parameters={width:_l,height:Sl,depth:El,widthSegments:Ml,heightSegments:Al,depthSegments:Pl},this.fromBufferGeometry(new Mt(_l,Sl,El,Ml,Al,Pl)),this.mergeVertices()}function da(){je.call(this,{uniforms:Bs.merge([Us.lights,{opacity:{value:1}}]),vertexShader:Fs.shadow_vert,fragmentShader:Fs.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(_l){this.uniforms.opacity.value=_l}}})}function ca(_l){je.call(this,_l),this.type="RawShaderMaterial"}function ma(_l){this.uuid=Ls.generateUUID(),this.type="MultiMaterial",this.materials=Array.isArray(_l)?_l:[],this.visible=!0}function fa(_l){Xe.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ze(16777215),this.roughness=0.5,this.metalness=0.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ze(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new H(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(_l)}function ga(_l){fa.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=0.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(_l)}function ha(_l){Xe.call(this),this.type="MeshPhongMaterial",this.color=new ze(16777215),this.specular=new ze(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ze(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new H(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tn,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(_l)}function ya(_l){ha.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(_l)}function xa(_l){Xe.call(this,_l),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new H(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(_l)}function Ta(_l){Xe.call(this),this.type="MeshLambertMaterial",this.color=new ze(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ze(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tn,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(_l)}function ba(_l){Xe.call(this),this.type="LineDashedMaterial",this.color=new ze(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(_l)}function va(_l,Sl,El){var Ml=this,Al=!1,Pl=0,Ll=0;this.onStart=void 0,this.onLoad=_l,this.onProgress=Sl,this.onError=El,this.itemStart=function(wl){Ll++,!1==Al&&Ml.onStart!==void 0&&Ml.onStart(wl,Pl,Ll),Al=!0},this.itemEnd=function(wl){Pl++,Ml.onProgress!==void 0&&Ml.onProgress(wl,Pl,Ll),Pl==Ll&&(Al=!1,Ml.onLoad!==void 0&&Ml.onLoad())},this.itemError=function(wl){Ml.onError!==void 0&&Ml.onError(wl)}}function _a(_l){this.manager=_l===void 0?qs:_l}function Sa(_l){this.manager=_l===void 0?qs:_l,this._parser=null}function Ea(_l){this.manager=_l===void 0?qs:_l,this._parser=null}function Ma(_l){this.manager=_l===void 0?qs:_l}function Aa(_l){this.manager=_l===void 0?qs:_l}function Pa(_l){this.manager=_l===void 0?qs:_l}function La(_l,Sl){at.call(this),this.type="Light",this.color=new ze(_l),this.intensity=Sl===void 0?1:Sl,this.receiveShadow=void 0}function wa(_l,Sl,El){La.call(this,_l,El),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(at.DefaultUp),this.updateMatrix(),this.groundColor=new ze(Sl)}function Ra(_l){this.camera=_l,this.bias=0,this.radius=1,this.mapSize=new H(512,512),this.map=null,this.matrix=new K}function Ca(){Ra.call(this,new Lt(50,1,0.5,500))}function Ia(_l,Sl,El,Ml,Al,Pl){La.call(this,_l,Sl),this.type="SpotLight",this.position.copy(at.DefaultUp),this.updateMatrix(),this.target=new at,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(Ll){this.intensity=Ll/Math.PI}}),this.distance=El===void 0?0:El,this.angle=Ml===void 0?Math.PI/3:Ml,this.penumbra=Al===void 0?0:Al,this.decay=Pl===void 0?1:Pl,this.shadow=new Ca}function Da(_l,Sl,El,Ml){La.call(this,_l,Sl),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(Al){this.intensity=Al/(4*Math.PI)}}),this.distance=El===void 0?0:El,this.decay=Ml===void 0?1:Ml,this.shadow=new Ra(new Lt(90,1,0.5,500))}function Ga(){Ra.call(this,new wt(-5,5,5,-5,0.5,500))}function Ba(_l,Sl){La.call(this,_l,Sl),this.type="DirectionalLight",this.position.copy(at.DefaultUp),this.updateMatrix(),this.target=new at,this.shadow=new Ga}function Fa(_l,Sl){La.call(this,_l,Sl),this.type="AmbientLight",this.castShadow=void 0}function Na(_l,Sl,El,Ml){this.parameterPositions=_l,this._cachedIndex=0,this.resultBuffer=Ml===void 0?new Sl.constructor(El):Ml,this.sampleValues=Sl,this.valueSize=El}function Ua(_l,Sl,El,Ml){Na.call(this,_l,Sl,El,Ml),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ha(_l,Sl,El,Ml){Na.call(this,_l,Sl,El,Ml)}function za(_l,Sl,El,Ml){Na.call(this,_l,Sl,El,Ml)}function Oa(_l,Sl,El,Ml){if(_l===void 0)throw new Error("track name is undefined");if(void 0===Sl||0===Sl.length)throw new Error("no keyframes in track named "+_l);this.name=_l,this.times=Zs.convertArray(Sl,this.TimeBufferType),this.values=Zs.convertArray(El,this.ValueBufferType),this.setInterpolation(Ml||this.DefaultInterpolation),this.validate(),this.optimize()}function Va(_l,Sl,El,Ml){Oa.call(this,_l,Sl,El,Ml)}function ka(_l,Sl,El,Ml){Na.call(this,_l,Sl,El,Ml)}function Wa(_l,Sl,El,Ml){Oa.call(this,_l,Sl,El,Ml)}function Xa(_l,Sl,El,Ml){Oa.call(this,_l,Sl,El,Ml)}function ja(_l,Sl,El,Ml){Oa.call(this,_l,Sl,El,Ml)}function Ya(_l,Sl,El){Oa.call(this,_l,Sl,El)}function Za(_l,Sl,El,Ml){Oa.call(this,_l,Sl,El,Ml)}function Ka(){Oa.apply(this,arguments)}function Qa(_l,Sl,El){this.name=_l,this.tracks=El,this.duration=Sl===void 0?-1:Sl,this.uuid=Ls.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function Ja(_l){this.manager=_l===void 0?qs:_l,this.textures={}}function $a(_l){this.manager=_l===void 0?qs:_l}function eo(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function ro(_l){"boolean"==typeof _l&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),_l=void 0),this.manager=_l===void 0?qs:_l,this.withCredentials=!1}function ao(_l){this.manager=_l===void 0?qs:_l,this.texturePath=""}function oo(){}function io(_l,Sl){this.v1=_l,this.v2=Sl}function no(){this.curves=[],this.autoClose=!1}function so(_l,Sl,El,Ml,Al,Pl,Ll,wl){this.aX=_l,this.aY=Sl,this.xRadius=El,this.yRadius=Ml,this.aStartAngle=Al,this.aEndAngle=Pl,this.aClockwise=Ll,this.aRotation=wl||0}function lo(_l){this.points=_l===void 0?[]:_l}function po(_l,Sl,El,Ml){this.v0=_l,this.v1=Sl,this.v2=El,this.v3=Ml}function co(_l,Sl,El){this.v0=_l,this.v1=Sl,this.v2=El}function uo(){mo.apply(this,arguments),this.holes=[]}function mo(_l){no.call(this),this.currentPoint=new H,_l&&this.fromPoints(_l)}function fo(){this.subPaths=[],this.currentPath=null}function go(_l){this.data=_l}function yo(_l){this.manager=_l===void 0?qs:_l}function xo(_l){this.manager=_l===void 0?qs:_l}function To(_l,Sl,El,Ml){La.call(this,_l,Sl),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=El===void 0?10:El,this.height=Ml===void 0?10:Ml}function bo(){this.type="StereoCamera",this.aspect=1,this.eyeSep=0.064,this.cameraL=new Lt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Lt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function vo(_l,Sl,El){at.call(this),this.type="CubeCamera";var Ml=90,Al=1,Pl=new Lt(Ml,Al,_l,Sl);Pl.up.set(0,-1,0),Pl.lookAt(new Z(1,0,0)),this.add(Pl);var Ll=new Lt(Ml,Al,_l,Sl);Ll.up.set(0,-1,0),Ll.lookAt(new Z(-1,0,0)),this.add(Ll);var wl=new Lt(Ml,Al,_l,Sl);wl.up.set(0,0,1),wl.lookAt(new Z(0,1,0)),this.add(wl);var Rl=new Lt(Ml,Al,_l,Sl);Rl.up.set(0,0,-1),Rl.lookAt(new Z(0,-1,0)),this.add(Rl);var Cl=new Lt(Ml,Al,_l,Sl);Cl.up.set(0,-1,0),Cl.lookAt(new Z(0,0,1)),this.add(Cl);var Il=new Lt(Ml,Al,_l,Sl);Il.up.set(0,-1,0),Il.lookAt(new Z(0,0,-1)),this.add(Il),this.renderTarget=new X(El,El,{format:Wn,magFilter:Pn,minFilter:Pn}),this.updateCubeMap=function(Dl,Gl){null===this.parent&&this.updateMatrixWorld();var Bl=this.renderTarget,Fl=Bl.texture.generateMipmaps;Bl.texture.generateMipmaps=!1,Bl.activeCubeFace=0,Dl.render(Gl,Pl,Bl),Bl.activeCubeFace=1,Dl.render(Gl,Ll,Bl),Bl.activeCubeFace=2,Dl.render(Gl,wl,Bl),Bl.activeCubeFace=3,Dl.render(Gl,Rl,Bl),Bl.activeCubeFace=4,Dl.render(Gl,Cl,Bl),Bl.texture.generateMipmaps=Fl,Bl.activeCubeFace=5,Dl.render(Gl,Il,Bl),Dl.setRenderTarget(null)}}function _o(){at.call(this),this.type="AudioListener",this.context=el.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function So(_l){at.call(this),this.type="Audio",this.context=_l.context,this.gain=this.context.createGain(),this.gain.connect(_l.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Eo(_l){So.call(this,_l),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Mo(_l,Sl){this.analyser=_l.context.createAnalyser(),this.analyser.fftSize=Sl===void 0?2048:Sl,this.data=new Uint8Array(this.analyser.frequencyBinCount),_l.getOutput().connect(this.analyser)}function Ao(_l,Sl,El){this.binding=_l,this.valueSize=El;var Ml=Float64Array,Al;"quaternion"===Sl?Al=this._slerp:"string"===Sl||"bool"===Sl?(Ml=Array,Al=this._select):Al=this._lerp;this.buffer=new Ml(4*El),this._mixBufferRegion=Al,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Po(_l,Sl,El){this.path=Sl,this.parsedPath=El||Po.parseTrackName(Sl),this.node=Po.findNode(_l,this.parsedPath.nodeName)||_l,this.rootNode=_l}function Lo(){this.uuid=Ls.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var _l={};this._indicesByUUID=_l;for(var Sl=0,El=arguments.length;Sl!==El;++Sl)_l[arguments[Sl].uuid]=Sl;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var Ml=this;this.stats={objects:{get total(){return Ml._objects.length},get inUse(){return this.total-Ml.nCachedObjects_}},get bindingsPerObject(){return Ml._bindings.length}}}function wo(_l,Sl,El){this._mixer=_l,this._clip=Sl,this._localRoot=El||null;var Ml=Sl.tracks,Al=Ml.length,Pl=Array(Al),Ll={endingStart:us,endingEnd:us};for(var wl=0;wl!==Al;++wl){var Rl=Ml[wl].createInterpolant(null);Pl[wl]=Rl,Rl.settings=Ll}this._interpolantSettings=Ll,this._interpolants=Pl,this._propertyBindings=Array(Al),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ns,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Ro(_l){this._root=_l,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Co(_l){"string"==typeof _l&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),_l=arguments[1]),this.value=_l}function Io(){St.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Do(_l,Sl,El,Ml){this.uuid=Ls.generateUUID(),this.data=_l,this.itemSize=Sl,this.offset=El,this.normalized=!0===Ml}function Go(_l,Sl){this.uuid=Ls.generateUUID(),this.array=_l,this.stride=Sl,this.count=_l===void 0?0:_l.length/Sl,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Bo(_l,Sl,El){Go.call(this,_l,Sl),this.meshPerAttribute=El||1}function Fo(_l,Sl,El){lt.call(this,_l,Sl),this.meshPerAttribute=El||1}function No(_l,Sl,El,Ml){this.ray=new et(_l,Sl),this.near=El||0,this.far=Ml||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Uo(_l,Sl){return _l.distance-Sl.distance}function Ho(_l,Sl,El,Ml){if(!1!==_l.visible&&(_l.raycast(Sl,El),!0===Ml)){var Al=_l.children;for(var Pl=0,Ll=Al.length;Pl<Ll;Pl++)Ho(Al[Pl],Sl,El,!0)}}function zo(_l){this.autoStart=!(_l!==void 0)||_l,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Oo(_l,Sl,El){return this.radius=void 0===_l?1:_l,this.phi=void 0===Sl?0:Sl,this.theta=void 0===El?0:El,this}function Vo(_l,Sl,El){return this.radius=void 0===_l?1:_l,this.theta=void 0===Sl?0:Sl,this.y=void 0===El?0:El,this}function ko(_l,Sl){Et.call(this,_l,Sl),this.animationsMap={},this.animationsList=[];var El=this.geometry.morphTargets.length,Ml="__default";this.createAnimation(Ml,0,El-1,El/1),this.setAnimationWeight(Ml,1)}function Wo(_l){at.call(this),this.material=_l,this.render=function(){}}function Xo(_l,Sl,El,Ml){this.object=_l,this.size=Sl===void 0?1:Sl;var Al=El===void 0?16711680:El,Pl=Ml===void 0?1:Ml,Ll=0,wl=this.object.geometry;wl&&wl.isGeometry?Ll=3*wl.faces.length:wl&&wl.isBufferGeometry&&(Ll=wl.attributes.normal.count);var Rl=new St,Cl=new yt(3*(2*Ll),3);Rl.addAttribute("position",Cl),hr.call(this,Rl,new fr({color:Al,linewidth:Pl})),this.matrixAutoUpdate=!1,this.update()}function jo(_l){at.call(this),this.light=_l,this.light.updateMatrixWorld(),this.matrix=_l.matrixWorld,this.matrixAutoUpdate=!1;var Sl=new St,El=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var Ml=0,Al=1,Pl=32;Ml<Pl;Ml++,Al++){var Ll=2*(Ml/Pl*Math.PI),wl=2*(Al/Pl*Math.PI);El.push(Math.cos(Ll),Math.sin(Ll),1,Math.cos(wl),Math.sin(wl),1)}Sl.addAttribute("position",new yt(El,3));var Rl=new fr({fog:!1});this.cone=new hr(Sl,Rl),this.add(this.cone),this.update()}function Yo(_l){this.bones=this.getBoneList(_l);var Sl=new St,El=[],Ml=[],Al=new ze(0,0,1),Pl=new ze(0,1,0);for(var Ll=0;Ll<this.bones.length;Ll++){var wl=this.bones[Ll];wl.parent&&wl.parent.isBone&&(El.push(0,0,0),El.push(0,0,0),Ml.push(Al.r,Al.g,Al.b),Ml.push(Pl.r,Pl.g,Pl.b))}Sl.addAttribute("position",new yt(El,3)),Sl.addAttribute("color",new yt(Ml,3));var Rl=new fr({vertexColors:Si,depthTest:!1,depthWrite:!1,transparent:!0});hr.call(this,Sl,Rl),this.root=_l,this.matrix=_l.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function qo(_l,Sl){this.light=_l,this.light.updateMatrixWorld();var El=new Xr(Sl,4,2),Ml=new st({wireframe:!0,fog:!1});Ml.color.copy(this.light.color).multiplyScalar(this.light.intensity),Et.call(this,El,Ml),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function Zo(_l){at.call(this),this.light=_l,this.light.updateMatrixWorld();var Sl=new st({color:_l.color,fog:!1}),El=new st({color:_l.color,fog:!1,wireframe:!0}),Ml=new St;Ml.addAttribute("position",new lt(new Float32Array(18),3)),this.add(new Et(Ml,Sl)),this.add(new Et(Ml,El)),this.update()}function Ko(_l,Sl){at.call(this),this.light=_l,this.light.updateMatrixWorld(),this.matrix=_l.matrixWorld,this.matrixAutoUpdate=!1;var El=new Rr(Sl);El.rotateY(0.5*Math.PI);var Ml=new st({vertexColors:Si,wireframe:!0}),Al=El.getAttribute("position"),Pl=new Float32Array(3*Al.count);El.addAttribute("color",new lt(Pl,3)),this.add(new Et(El,Ml)),this.update()}function Qo(_l,Sl,El,Ml){_l=_l||10,Sl=Sl||10,El=new ze(El===void 0?4473924:El),Ml=new ze(Ml===void 0?8947848:Ml);var Al=Sl/2,Pl=2*_l/Sl,Ll=[],wl=[];for(var Rl=0,Cl=0,Il=-_l;Rl<=Sl;Rl++,Il+=Pl){Ll.push(-_l,0,Il,_l,0,Il),Ll.push(Il,0,-_l,Il,0,_l);var Dl=Rl===Al?El:Ml;Dl.toArray(wl,Cl),Cl+=3,Dl.toArray(wl,Cl),Cl+=3,Dl.toArray(wl,Cl),Cl+=3,Dl.toArray(wl,Cl),Cl+=3}var Gl=new St;Gl.addAttribute("position",new yt(Ll,3)),Gl.addAttribute("color",new yt(wl,3));var Bl=new fr({vertexColors:Si});hr.call(this,Gl,Bl)}function Jo(_l,Sl,El,Ml,Al,Pl){_l=_l||10,Sl=Sl||16,El=El||8,Ml=Ml||64,Al=new ze(Al===void 0?4473924:Al),Pl=new ze(Pl===void 0?8947848:Pl);var Ll=[],wl=[],Rl,Cl,Il,Dl,Gl,Bl,Fl;for(Dl=0;Dl<=Sl;Dl++)Il=Dl/Sl*(2*Math.PI),Rl=Math.sin(Il)*_l,Cl=Math.cos(Il)*_l,Ll.push(0,0,0),Ll.push(Rl,0,Cl),Fl=1&Dl?Al:Pl,wl.push(Fl.r,Fl.g,Fl.b),wl.push(Fl.r,Fl.g,Fl.b);for(Dl=0;Dl<=El;Dl++)for(Fl=1&Dl?Al:Pl,Bl=_l-_l/El*Dl,Gl=0;Gl<Ml;Gl++)Il=Gl/Ml*(2*Math.PI),Rl=Math.sin(Il)*Bl,Cl=Math.cos(Il)*Bl,Ll.push(Rl,0,Cl),wl.push(Fl.r,Fl.g,Fl.b),Il=(Gl+1)/Ml*(2*Math.PI),Rl=Math.sin(Il)*Bl,Cl=Math.cos(Il)*Bl,Ll.push(Rl,0,Cl),wl.push(Fl.r,Fl.g,Fl.b);var Nl=new St;Nl.addAttribute("position",new yt(Ll,3)),Nl.addAttribute("color",new yt(wl,3));var Ul=new fr({vertexColors:Si});hr.call(this,Nl,Ul)}function $o(_l,Sl,El,Ml){this.object=_l,this.size=Sl===void 0?1:Sl;var Al=El===void 0?16776960:El,Pl=Ml===void 0?1:Ml,Ll=0,wl=this.object.geometry;wl&&wl.isGeometry?Ll=wl.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var Rl=new St,Cl=new yt(3*(2*Ll),3);Rl.addAttribute("position",Cl),hr.call(this,Rl,new fr({color:Al,linewidth:Pl})),this.matrixAutoUpdate=!1,this.update()}function ei(_l,Sl){at.call(this),this.light=_l,this.light.updateMatrixWorld(),this.matrix=_l.matrixWorld,this.matrixAutoUpdate=!1,Sl===void 0&&(Sl=1);var El=new St;El.addAttribute("position",new yt([-Sl,Sl,0,Sl,Sl,0,Sl,-Sl,0,-Sl,-Sl,0,-Sl,Sl,0],3));var Ml=new fr({fog:!1});this.add(new gr(El,Ml)),El=new St,El.addAttribute("position",new yt([0,0,0,0,0,1],3)),this.add(new gr(El,Ml)),this.update()}function ti(_l){function Sl(Bl,Fl,Nl){El(Bl,Nl),El(Fl,Nl)}function El(Bl,Fl){Pl.push(0,0,0),Ll.push(Fl.r,Fl.g,Fl.b),wl[Bl]===void 0&&(wl[Bl]=[]),wl[Bl].push(Pl.length/3-1)}var Ml=new St,Al=new fr({color:16777215,vertexColors:_i}),Pl=[],Ll=[],wl={},Rl=new ze(16755200),Cl=new ze(16711680),Il=new ze(43775),Dl=new ze(16777215),Gl=new ze(3355443);Sl("n1","n2",Rl),Sl("n2","n4",Rl),Sl("n4","n3",Rl),Sl("n3","n1",Rl),Sl("f1","f2",Rl),Sl("f2","f4",Rl),Sl("f4","f3",Rl),Sl("f3","f1",Rl),Sl("n1","f1",Rl),Sl("n2","f2",Rl),Sl("n3","f3",Rl),Sl("n4","f4",Rl),Sl("p","n1",Cl),Sl("p","n2",Cl),Sl("p","n3",Cl),Sl("p","n4",Cl),Sl("u1","u2",Il),Sl("u2","u3",Il),Sl("u3","u1",Il),Sl("c","t",Dl),Sl("p","c",Gl),Sl("cn1","cn2",Gl),Sl("cn3","cn4",Gl),Sl("cf1","cf2",Gl),Sl("cf3","cf4",Gl),Ml.addAttribute("position",new yt(Pl,3)),Ml.addAttribute("color",new yt(Ll,3)),hr.call(this,Ml,Al),this.camera=_l,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_l.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=wl,this.update()}function ri(_l,Sl){Sl===void 0&&(Sl=16776960);var El=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),Ml=new Float32Array(24),Al=new St;Al.setIndex(new lt(El,1)),Al.addAttribute("position",new lt(Ml,3)),hr.call(this,Al,new fr({color:Sl})),_l!==void 0&&this.update(_l)}function ai(_l,Sl,El,Ml,Al,Pl){at.call(this),Ml===void 0&&(Ml=16776960),El===void 0&&(El=1),Al===void 0&&(Al=0.2*El),Pl===void 0&&(Pl=0.2*Al),this.position.copy(Sl),this.line=new gr(al,new fr({color:Ml})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Et(nl,new st({color:Ml})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_l),this.setLength(El,Al,Pl)}function oi(_l){_l=_l||1;var Sl=[0,0,0,_l,0,0,0,0,0,0,_l,0,0,0,0,0,0,_l],El=new St;El.addAttribute("position",new yt(Sl,3)),El.addAttribute("color",new yt([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1],3));var Ml=new fr({vertexColors:Si});hr.call(this,El,Ml)}function ni(_l,Sl,El,Ml,Al,Pl){so.call(this,_l,Sl,El,El,Ml,Al,Pl)}function si(_l){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),dl.call(this,_l),this.type="catmullrom",this.closed=!0}Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Math.sign===void 0&&(Math.sign=function(_l){return 0>_l?-1:0<_l?1:+_l}),Function.prototype.name===void 0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&function(){Object.assign=function(_l){"use strict";if(_l===void 0||null===_l)throw new TypeError("Cannot convert undefined or null to object");var Sl=Object(_l);for(var El=1;El<arguments.length;El++){var Ml=arguments[El];if(Ml!==void 0&&null!==Ml)for(var Al in Ml)Object.prototype.hasOwnProperty.call(Ml,Al)&&(Sl[Al]=Ml[Al])}return Sl}}(),Object.assign(F.prototype,{addEventListener:function(_l,Sl){this._listeners===void 0&&(this._listeners={});var El=this._listeners;El[_l]===void 0&&(El[_l]=[]),-1===El[_l].indexOf(Sl)&&El[_l].push(Sl)},hasEventListener:function(_l,Sl){if(this._listeners===void 0)return!1;var El=this._listeners;return El[_l]!==void 0&&-1!==El[_l].indexOf(Sl)},removeEventListener:function(_l,Sl){if(this._listeners!==void 0){var El=this._listeners,Ml=El[_l];if(Ml!==void 0){var Al=Ml.indexOf(Sl);-1!==Al&&Ml.splice(Al,1)}}},dispatchEvent:function(_l){if(this._listeners!==void 0){var Sl=this._listeners,El=Sl[_l.type];if(El!==void 0){_l.target=this;var Ml=[],Al=0,Pl=El.length;for(Al=0;Al<Pl;Al++)Ml[Al]=El[Al];for(Al=0;Al<Pl;Al++)Ml[Al].call(this,_l)}}}});var li="83",di=0,pi=1,ci=2,ui=0,mi=1,gi=2,hi=0,yi=1,xi=2,Ti=1,bi=2,vi=0,_i=1,Si=2,Ei=0,Mi=1,Ai=2,Pi=3,Li=4,wi=5,Ri={NoBlending:Ei,NormalBlending:Mi,AdditiveBlending:Ai,SubtractiveBlending:Pi,MultiplyBlending:Li,CustomBlending:wi},Ci=100,Ii=101,Di=102,Gi=103,Bi=104,Fi=200,Ni=201,Ui=202,Hi=203,zi=204,Oi=205,Vi=206,ki=207,Wi=208,Xi=209,ji=210,Yi=0,qi=1,Zi=2,Ki=3,Qi=4,Ji=5,$i=6,en=7,tn=0,rn=1,an=2,on=0,nn=1,sn=2,ln=3,dn=4,pn=300,cn=301,un=302,mn=303,gn=304,hn=305,yn=306,xn=307,Tn={UVMapping:pn,CubeReflectionMapping:cn,CubeRefractionMapping:un,EquirectangularReflectionMapping:mn,EquirectangularRefractionMapping:gn,SphericalReflectionMapping:hn,CubeUVReflectionMapping:yn,CubeUVRefractionMapping:xn},bn=1e3,vn=1001,_n=1002,Sn={RepeatWrapping:bn,ClampToEdgeWrapping:vn,MirroredRepeatWrapping:_n},En=1003,Mn=1004,An=1005,Pn=1006,Ln=1007,wn=1008,Rn={NearestFilter:En,NearestMipMapNearestFilter:Mn,NearestMipMapLinearFilter:An,LinearFilter:Pn,LinearMipMapNearestFilter:Ln,LinearMipMapLinearFilter:wn},Cn=1009,In=1010,Dn=1011,Gn=1012,Bn=1013,Fn=1014,Nn=1015,Un=1016,Hn=1017,zn=1018,On=1019,Vn=1020,kn=1021,Wn=1022,Xn=1023,jn=1024,Yn=1025,qn=1026,Zn=1027,Kn=2001,Qn=2002,Jn=2003,$n=2004,es=2100,ts=2101,rs=2102,as=2103,os=2151,is=2200,ns=2201,ss=2202,ls=2300,ds=2301,ps=2302,us=2400,ms=2401,fs=2402,gs=0,hs=1,ys=2,xs=3e3,Ts=3001,vs=3007,_s=3002,Ss=3004,Es=3005,Ms=3006,As=3200,Ps=3201,Ls={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var _l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Sl=Array(36),El=0,Ml;return function(){for(var Pl=0;36>Pl;Pl++)8===Pl||13===Pl||18===Pl||23===Pl?Sl[Pl]="-":14===Pl?Sl[Pl]="4":(2>=El&&(El=0|33554432+16777216*Math.random()),Ml=15&El,El=El>>4,Sl[Pl]=_l[19===Pl?8|3&Ml:Ml]);return Sl.join("")}}(),clamp:function(_l,Sl,El){return Math.max(Sl,Math.min(El,_l))},euclideanModulo:function(_l,Sl){return(_l%Sl+Sl)%Sl},mapLinear:function(_l,Sl,El,Ml,Al){return Ml+(_l-Sl)*(Al-Ml)/(El-Sl)},lerp:function(_l,Sl,El){return(1-El)*_l+El*Sl},smoothstep:function(_l,Sl,El){return _l<=Sl?0:_l>=El?1:(_l=(_l-Sl)/(El-Sl),_l*_l*(3-2*_l))},smootherstep:function(_l,Sl,El){return _l<=Sl?0:_l>=El?1:(_l=(_l-Sl)/(El-Sl),_l*_l*_l*(_l*(6*_l-15)+10))},randInt:function(_l,Sl){return _l+Math.floor(Math.random()*(Sl-_l+1))},randFloat:function(_l,Sl){return _l+Math.random()*(Sl-_l)},randFloatSpread:function(_l){return _l*(0.5-Math.random())},degToRad:function(_l){return _l*Ls.DEG2RAD},radToDeg:function(_l){return _l*Ls.RAD2DEG},isPowerOfTwo:function(_l){return 0==(_l&_l-1)&&0!==_l},nearestPowerOfTwo:function(_l){return Math.pow(2,Math.round(Math.log(_l)/Math.LN2))},nextPowerOfTwo:function(_l){return _l--,_l|=_l>>1,_l|=_l>>2,_l|=_l>>4,_l|=_l>>8,_l|=_l>>16,_l++,_l}};H.prototype={constructor:H,isVector2:!0,get width(){return this.x},set width(_l){this.x=_l},get height(){return this.y},set height(_l){this.y=_l},set:function(_l,Sl){return this.x=_l,this.y=Sl,this},setScalar:function(_l){return this.x=_l,this.y=_l,this},setX:function(_l){return this.x=_l,this},setY:function(_l){return this.y=_l,this},setComponent:function(_l,Sl){switch(_l){case 0:this.x=Sl;break;case 1:this.y=Sl;break;default:throw new Error("index is out of range: "+_l);}return this},getComponent:function(_l){switch(_l){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_l);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(_l){return this.x=_l.x,this.y=_l.y,this},add:function(_l,Sl){return void 0===Sl?(this.x+=_l.x,this.y+=_l.y,this):(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(_l,Sl))},addScalar:function(_l){return this.x+=_l,this.y+=_l,this},addVectors:function(_l,Sl){return this.x=_l.x+Sl.x,this.y=_l.y+Sl.y,this},addScaledVector:function(_l,Sl){return this.x+=_l.x*Sl,this.y+=_l.y*Sl,this},sub:function(_l,Sl){return void 0===Sl?(this.x-=_l.x,this.y-=_l.y,this):(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(_l,Sl))},subScalar:function(_l){return this.x-=_l,this.y-=_l,this},subVectors:function(_l,Sl){return this.x=_l.x-Sl.x,this.y=_l.y-Sl.y,this},multiply:function(_l){return this.x*=_l.x,this.y*=_l.y,this},multiplyScalar:function(_l){return isFinite(_l)?(this.x*=_l,this.y*=_l):(this.x=0,this.y=0),this},divide:function(_l){return this.x/=_l.x,this.y/=_l.y,this},divideScalar:function(_l){return this.multiplyScalar(1/_l)},min:function(_l){return this.x=Math.min(this.x,_l.x),this.y=Math.min(this.y,_l.y),this},max:function(_l){return this.x=Math.max(this.x,_l.x),this.y=Math.max(this.y,_l.y),this},clamp:function(_l,Sl){return this.x=Math.max(_l.x,Math.min(Sl.x,this.x)),this.y=Math.max(_l.y,Math.min(Sl.y,this.y)),this},clampScalar:function(){var _l,Sl;return function(Ml,Al){return void 0==_l&&(_l=new H,Sl=new H),_l.set(Ml,Ml),Sl.set(Al,Al),this.clamp(_l,Sl)}}(),clampLength:function(_l,Sl){var El=this.length();return this.multiplyScalar(Math.max(_l,Math.min(Sl,El))/El)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(_l){return this.x*_l.x+this.y*_l.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var _l=Math.atan2(this.y,this.x);return 0>_l&&(_l+=2*Math.PI),_l},distanceTo:function(_l){return Math.sqrt(this.distanceToSquared(_l))},distanceToSquared:function(_l){var Sl=this.x-_l.x,El=this.y-_l.y;return Sl*Sl+El*El},distanceToManhattan:function(_l){return Math.abs(this.x-_l.x)+Math.abs(this.y-_l.y)},setLength:function(_l){return this.multiplyScalar(_l/this.length())},lerp:function(_l,Sl){return this.x+=(_l.x-this.x)*Sl,this.y+=(_l.y-this.y)*Sl,this},lerpVectors:function(_l,Sl,El){return this.subVectors(Sl,_l).multiplyScalar(El).add(_l)},equals:function(_l){return _l.x===this.x&&_l.y===this.y},fromArray:function(_l,Sl){return void 0===Sl&&(Sl=0),this.x=_l[Sl],this.y=_l[Sl+1],this},toArray:function(_l,Sl){return void 0===_l&&(_l=[]),void 0===Sl&&(Sl=0),_l[Sl]=this.x,_l[Sl+1]=this.y,_l},fromAttribute:function(_l,Sl,El){return void 0!==El&&console.warn("THREE.Vector2: offset has been removed from .fromAttribute()."),this.x=_l.getX(Sl),this.y=_l.getY(Sl),this},rotateAround:function(_l,Sl){var El=Math.cos(Sl),Ml=Math.sin(Sl),Al=this.x-_l.x,Pl=this.y-_l.y;return this.x=Al*El-Pl*Ml+_l.x,this.y=Al*Ml+Pl*El+_l.y,this}};var ws=0;O.DEFAULT_IMAGE=void 0,O.DEFAULT_MAPPING=pn,O.prototype={constructor:O,isTexture:!0,set needsUpdate(_l){!0===_l&&this.version++},clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.image=_l.image,this.mipmaps=_l.mipmaps.slice(0),this.mapping=_l.mapping,this.wrapS=_l.wrapS,this.wrapT=_l.wrapT,this.magFilter=_l.magFilter,this.minFilter=_l.minFilter,this.anisotropy=_l.anisotropy,this.format=_l.format,this.type=_l.type,this.offset.copy(_l.offset),this.repeat.copy(_l.repeat),this.generateMipmaps=_l.generateMipmaps,this.premultiplyAlpha=_l.premultiplyAlpha,this.flipY=_l.flipY,this.unpackAlignment=_l.unpackAlignment,this.encoding=_l.encoding,this},toJSON:function(_l){function Sl(Al){var Pl;return void 0===Al.toDataURL?(Pl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),Pl.width=Al.width,Pl.height=Al.height,Pl.getContext("2d").drawImage(Al,0,0,Al.width,Al.height)):Pl=Al,2048<Pl.width||2048<Pl.height?Pl.toDataURL("image/jpeg",0.6):Pl.toDataURL("image/png")}if(void 0!==_l.textures[this.uuid])return _l.textures[this.uuid];var El={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var Ml=this.image;void 0===Ml.uuid&&(Ml.uuid=Ls.generateUUID()),void 0===_l.images[Ml.uuid]&&(_l.images[Ml.uuid]={uuid:Ml.uuid,url:Sl(Ml)}),El.image=Ml.uuid}return _l.textures[this.uuid]=El,El},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(_l){if(this.mapping===pn){if(_l.multiply(this.repeat),_l.add(this.offset),0>_l.x||1<_l.x)switch(this.wrapS){case bn:_l.x=_l.x-Math.floor(_l.x);break;case vn:_l.x=0>_l.x?0:1;break;case _n:_l.x=1===Math.abs(Math.floor(_l.x)%2)?Math.ceil(_l.x)-_l.x:_l.x-Math.floor(_l.x);}if(0>_l.y||1<_l.y)switch(this.wrapT){case bn:_l.y=_l.y-Math.floor(_l.y);break;case vn:_l.y=0>_l.y?0:1;break;case _n:_l.y=1===Math.abs(Math.floor(_l.y)%2)?Math.ceil(_l.y)-_l.y:_l.y-Math.floor(_l.y);}this.flipY&&(_l.y=1-_l.y)}}},Object.assign(O.prototype,F.prototype),V.prototype={constructor:V,isVector4:!0,set:function(_l,Sl,El,Ml){return this.x=_l,this.y=Sl,this.z=El,this.w=Ml,this},setScalar:function(_l){return this.x=_l,this.y=_l,this.z=_l,this.w=_l,this},setX:function(_l){return this.x=_l,this},setY:function(_l){return this.y=_l,this},setZ:function(_l){return this.z=_l,this},setW:function(_l){return this.w=_l,this},setComponent:function(_l,Sl){switch(_l){case 0:this.x=Sl;break;case 1:this.y=Sl;break;case 2:this.z=Sl;break;case 3:this.w=Sl;break;default:throw new Error("index is out of range: "+_l);}return this},getComponent:function(_l){switch(_l){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_l);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(_l){return this.x=_l.x,this.y=_l.y,this.z=_l.z,this.w=void 0===_l.w?1:_l.w,this},add:function(_l,Sl){return void 0===Sl?(this.x+=_l.x,this.y+=_l.y,this.z+=_l.z,this.w+=_l.w,this):(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(_l,Sl))},addScalar:function(_l){return this.x+=_l,this.y+=_l,this.z+=_l,this.w+=_l,this},addVectors:function(_l,Sl){return this.x=_l.x+Sl.x,this.y=_l.y+Sl.y,this.z=_l.z+Sl.z,this.w=_l.w+Sl.w,this},addScaledVector:function(_l,Sl){return this.x+=_l.x*Sl,this.y+=_l.y*Sl,this.z+=_l.z*Sl,this.w+=_l.w*Sl,this},sub:function(_l,Sl){return void 0===Sl?(this.x-=_l.x,this.y-=_l.y,this.z-=_l.z,this.w-=_l.w,this):(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(_l,Sl))},subScalar:function(_l){return this.x-=_l,this.y-=_l,this.z-=_l,this.w-=_l,this},subVectors:function(_l,Sl){return this.x=_l.x-Sl.x,this.y=_l.y-Sl.y,this.z=_l.z-Sl.z,this.w=_l.w-Sl.w,this},multiplyScalar:function(_l){return isFinite(_l)?(this.x*=_l,this.y*=_l,this.z*=_l,this.w*=_l):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(_l){var Sl=this.x,El=this.y,Ml=this.z,Al=this.w,Pl=_l.elements;return this.x=Pl[0]*Sl+Pl[4]*El+Pl[8]*Ml+Pl[12]*Al,this.y=Pl[1]*Sl+Pl[5]*El+Pl[9]*Ml+Pl[13]*Al,this.z=Pl[2]*Sl+Pl[6]*El+Pl[10]*Ml+Pl[14]*Al,this.w=Pl[3]*Sl+Pl[7]*El+Pl[11]*Ml+Pl[15]*Al,this},divideScalar:function(_l){return this.multiplyScalar(1/_l)},setAxisAngleFromQuaternion:function(_l){this.w=2*Math.acos(_l.w);var Sl=Math.sqrt(1-_l.w*_l.w);return 1e-4>Sl?(this.x=1,this.y=0,this.z=0):(this.x=_l.x/Sl,this.y=_l.y/Sl,this.z=_l.z/Sl),this},setAxisAngleFromRotationMatrix:function(_l){var Pl=0.01,Ll=0.1,wl=_l.elements,Rl=wl[0],Cl=wl[4],Il=wl[8],Dl=wl[1],Gl=wl[5],Bl=wl[9],Fl=wl[2],Nl=wl[6],Ul=wl[10],Sl,El,Ml,Al;if(Math.abs(Cl-Dl)<Pl&&Math.abs(Il-Fl)<Pl&&Math.abs(Bl-Nl)<Pl){if(Math.abs(Cl+Dl)<Ll&&Math.abs(Il+Fl)<Ll&&Math.abs(Bl+Nl)<Ll&&Math.abs(Rl+Gl+Ul-3)<Ll)return this.set(1,0,0,0),this;Sl=Math.PI;var Hl=(Rl+1)/2,zl=(Gl+1)/2,Ol=(Ul+1)/2,Vl=(Cl+Dl)/4,Wl=(Il+Fl)/4,Xl=(Bl+Nl)/4;return Hl>zl&&Hl>Ol?Hl<Pl?(El=0,Ml=0.707106781,Al=0.707106781):(El=Math.sqrt(Hl),Ml=Vl/El,Al=Wl/El):zl>Ol?zl<Pl?(El=0.707106781,Ml=0,Al=0.707106781):(Ml=Math.sqrt(zl),El=Vl/Ml,Al=Xl/Ml):Ol<Pl?(El=0.707106781,Ml=0.707106781,Al=0):(Al=Math.sqrt(Ol),El=Wl/Al,Ml=Xl/Al),this.set(El,Ml,Al,Sl),this}var Yl=Math.sqrt((Nl-Bl)*(Nl-Bl)+(Il-Fl)*(Il-Fl)+(Dl-Cl)*(Dl-Cl));return 1e-3>Math.abs(Yl)&&(Yl=1),this.x=(Nl-Bl)/Yl,this.y=(Il-Fl)/Yl,this.z=(Dl-Cl)/Yl,this.w=Math.acos((Rl+Gl+Ul-1)/2),this},min:function(_l){return this.x=Math.min(this.x,_l.x),this.y=Math.min(this.y,_l.y),this.z=Math.min(this.z,_l.z),this.w=Math.min(this.w,_l.w),this},max:function(_l){return this.x=Math.max(this.x,_l.x),this.y=Math.max(this.y,_l.y),this.z=Math.max(this.z,_l.z),this.w=Math.max(this.w,_l.w),this},clamp:function(_l,Sl){return this.x=Math.max(_l.x,Math.min(Sl.x,this.x)),this.y=Math.max(_l.y,Math.min(Sl.y,this.y)),this.z=Math.max(_l.z,Math.min(Sl.z,this.z)),this.w=Math.max(_l.w,Math.min(Sl.w,this.w)),this},clampScalar:function(){var _l,Sl;return function(Ml,Al){return void 0==_l&&(_l=new V,Sl=new V),_l.set(Ml,Ml,Ml,Ml),Sl.set(Al,Al,Al,Al),this.clamp(_l,Sl)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(_l){return this.x*_l.x+this.y*_l.y+this.z*_l.z+this.w*_l.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(_l){return this.multiplyScalar(_l/this.length())},lerp:function(_l,Sl){return this.x+=(_l.x-this.x)*Sl,this.y+=(_l.y-this.y)*Sl,this.z+=(_l.z-this.z)*Sl,this.w+=(_l.w-this.w)*Sl,this},lerpVectors:function(_l,Sl,El){return this.subVectors(Sl,_l).multiplyScalar(El).add(_l)},equals:function(_l){return _l.x===this.x&&_l.y===this.y&&_l.z===this.z&&_l.w===this.w},fromArray:function(_l,Sl){return void 0===Sl&&(Sl=0),this.x=_l[Sl],this.y=_l[Sl+1],this.z=_l[Sl+2],this.w=_l[Sl+3],this},toArray:function(_l,Sl){return void 0===_l&&(_l=[]),void 0===Sl&&(Sl=0),_l[Sl]=this.x,_l[Sl+1]=this.y,_l[Sl+2]=this.z,_l[Sl+3]=this.w,_l},fromAttribute:function(_l,Sl,El){return void 0!==El&&console.warn("THREE.Vector4: offset has been removed from .fromAttribute()."),this.x=_l.getX(Sl),this.y=_l.getY(Sl),this.z=_l.getZ(Sl),this.w=_l.getW(Sl),this}},Object.assign(W.prototype,F.prototype,{isWebGLRenderTarget:!0,setSize:function(_l,Sl){(this.width!==_l||this.height!==Sl)&&(this.width=_l,this.height=Sl,this.dispose()),this.viewport.set(0,0,_l,Sl),this.scissor.set(0,0,_l,Sl)},clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.width=_l.width,this.height=_l.height,this.viewport.copy(_l.viewport),this.texture=_l.texture.clone(),this.depthBuffer=_l.depthBuffer,this.stencilBuffer=_l.stencilBuffer,this.depthTexture=_l.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),X.prototype=Object.create(W.prototype),X.prototype.constructor=X,X.prototype.isWebGLRenderTargetCube=!0,Y.prototype={constructor:Y,get x(){return this._x},set x(_l){this._x=_l,this.onChangeCallback()},get y(){return this._y},set y(_l){this._y=_l,this.onChangeCallback()},get z(){return this._z},set z(_l){this._z=_l,this.onChangeCallback()},get w(){return this._w},set w(_l){this._w=_l,this.onChangeCallback()},set:function(_l,Sl,El,Ml){return this._x=_l,this._y=Sl,this._z=El,this._w=Ml,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(_l){return this._x=_l.x,this._y=_l.y,this._z=_l.z,this._w=_l.w,this.onChangeCallback(),this},setFromEuler:function(_l,Sl){if(!1===(_l&&_l.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var El=Math.cos(_l._x/2),Ml=Math.cos(_l._y/2),Al=Math.cos(_l._z/2),Pl=Math.sin(_l._x/2),Ll=Math.sin(_l._y/2),wl=Math.sin(_l._z/2),Rl=_l.order;return"XYZ"===Rl?(this._x=Pl*Ml*Al+El*Ll*wl,this._y=El*Ll*Al-Pl*Ml*wl,this._z=El*Ml*wl+Pl*Ll*Al,this._w=El*Ml*Al-Pl*Ll*wl):"YXZ"===Rl?(this._x=Pl*Ml*Al+El*Ll*wl,this._y=El*Ll*Al-Pl*Ml*wl,this._z=El*Ml*wl-Pl*Ll*Al,this._w=El*Ml*Al+Pl*Ll*wl):"ZXY"===Rl?(this._x=Pl*Ml*Al-El*Ll*wl,this._y=El*Ll*Al+Pl*Ml*wl,this._z=El*Ml*wl+Pl*Ll*Al,this._w=El*Ml*Al-Pl*Ll*wl):"ZYX"===Rl?(this._x=Pl*Ml*Al-El*Ll*wl,this._y=El*Ll*Al+Pl*Ml*wl,this._z=El*Ml*wl-Pl*Ll*Al,this._w=El*Ml*Al+Pl*Ll*wl):"YZX"===Rl?(this._x=Pl*Ml*Al+El*Ll*wl,this._y=El*Ll*Al+Pl*Ml*wl,this._z=El*Ml*wl-Pl*Ll*Al,this._w=El*Ml*Al-Pl*Ll*wl):"XZY"===Rl&&(this._x=Pl*Ml*Al-El*Ll*wl,this._y=El*Ll*Al-Pl*Ml*wl,this._z=El*Ml*wl+Pl*Ll*Al,this._w=El*Ml*Al+Pl*Ll*wl),!1!==Sl&&this.onChangeCallback(),this},setFromAxisAngle:function(_l,Sl){var El=Sl/2,Ml=Math.sin(El);return this._x=_l.x*Ml,this._y=_l.y*Ml,this._z=_l.z*Ml,this._w=Math.cos(El),this.onChangeCallback(),this},setFromRotationMatrix:function(_l){var Sl=_l.elements,El=Sl[0],Ml=Sl[4],Al=Sl[8],Pl=Sl[1],Ll=Sl[5],wl=Sl[9],Rl=Sl[2],Cl=Sl[6],Il=Sl[10],Dl=El+Ll+Il,Gl;return 0<Dl?(Gl=0.5/Math.sqrt(Dl+1),this._w=0.25/Gl,this._x=(Cl-wl)*Gl,this._y=(Al-Rl)*Gl,this._z=(Pl-Ml)*Gl):El>Ll&&El>Il?(Gl=2*Math.sqrt(1+El-Ll-Il),this._w=(Cl-wl)/Gl,this._x=0.25*Gl,this._y=(Ml+Pl)/Gl,this._z=(Al+Rl)/Gl):Ll>Il?(Gl=2*Math.sqrt(1+Ll-El-Il),this._w=(Al-Rl)/Gl,this._x=(Ml+Pl)/Gl,this._y=0.25*Gl,this._z=(wl+Cl)/Gl):(Gl=2*Math.sqrt(1+Il-El-Ll),this._w=(Pl-Ml)/Gl,this._x=(Al+Rl)/Gl,this._y=(wl+Cl)/Gl,this._z=0.25*Gl),this.onChangeCallback(),this},setFromUnitVectors:function(){var _l,Sl;return function(Ml,Al){return void 0==_l&&(_l=new Z),Sl=Ml.dot(Al)+1,1e-6>Sl?(Sl=0,Math.abs(Ml.x)>Math.abs(Ml.z)?_l.set(-Ml.y,Ml.x,0):_l.set(0,-Ml.z,Ml.y)):_l.crossVectors(Ml,Al),this._x=_l.x,this._y=_l.y,this._z=_l.z,this._w=Sl,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(_l){return this._x*_l._x+this._y*_l._y+this._z*_l._z+this._w*_l._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var _l=this.length();return 0===_l?(this._x=0,this._y=0,this._z=0,this._w=1):(_l=1/_l,this._x=this._x*_l,this._y=this._y*_l,this._z=this._z*_l,this._w=this._w*_l),this.onChangeCallback(),this},multiply:function(_l,Sl){return void 0===Sl?this.multiplyQuaternions(this,_l):(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(_l,Sl))},premultiply:function(_l){return this.multiplyQuaternions(_l,this)},multiplyQuaternions:function(_l,Sl){var El=_l._x,Ml=_l._y,Al=_l._z,Pl=_l._w,Ll=Sl._x,wl=Sl._y,Rl=Sl._z,Cl=Sl._w;return this._x=El*Cl+Pl*Ll+Ml*Rl-Al*wl,this._y=Ml*Cl+Pl*wl+Al*Ll-El*Rl,this._z=Al*Cl+Pl*Rl+El*wl-Ml*Ll,this._w=Pl*Cl-El*Ll-Ml*wl-Al*Rl,this.onChangeCallback(),this},slerp:function(_l,Sl){if(0===Sl)return this;if(1===Sl)return this.copy(_l);var El=this._x,Ml=this._y,Al=this._z,Pl=this._w,Ll=Pl*_l._w+El*_l._x+Ml*_l._y+Al*_l._z;if(0>Ll?(this._w=-_l._w,this._x=-_l._x,this._y=-_l._y,this._z=-_l._z,Ll=-Ll):this.copy(_l),1<=Ll)return this._w=Pl,this._x=El,this._y=Ml,this._z=Al,this;var wl=Math.sqrt(1-Ll*Ll);if(1e-3>Math.abs(wl))return this._w=0.5*(Pl+this._w),this._x=0.5*(El+this._x),this._y=0.5*(Ml+this._y),this._z=0.5*(Al+this._z),this;var Rl=Math.atan2(wl,Ll),Cl=Math.sin((1-Sl)*Rl)/wl,Il=Math.sin(Sl*Rl)/wl;return this._w=Pl*Cl+this._w*Il,this._x=El*Cl+this._x*Il,this._y=Ml*Cl+this._y*Il,this._z=Al*Cl+this._z*Il,this.onChangeCallback(),this},equals:function(_l){return _l._x===this._x&&_l._y===this._y&&_l._z===this._z&&_l._w===this._w},fromArray:function(_l,Sl){return void 0===Sl&&(Sl=0),this._x=_l[Sl],this._y=_l[Sl+1],this._z=_l[Sl+2],this._w=_l[Sl+3],this.onChangeCallback(),this},toArray:function(_l,Sl){return void 0===_l&&(_l=[]),void 0===Sl&&(Sl=0),_l[Sl]=this._x,_l[Sl+1]=this._y,_l[Sl+2]=this._z,_l[Sl+3]=this._w,_l},onChange:function(_l){return this.onChangeCallback=_l,this},onChangeCallback:function(){}},Object.assign(Y,{slerp:function(_l,Sl,El,Ml){return El.copy(_l).slerp(Sl,Ml)},slerpFlat:function(_l,Sl,El,Ml,Al,Pl,Ll){var wl=El[Ml+0],Rl=El[Ml+1],Cl=El[Ml+2],Il=El[Ml+3],Dl=Al[Pl+0],Gl=Al[Pl+1],Bl=Al[Pl+2],Fl=Al[Pl+3];if(Il!==Fl||wl!==Dl||Rl!==Gl||Cl!==Bl){var Nl=1-Ll,Ul=wl*Dl+Rl*Gl+Cl*Bl+Il*Fl,Hl=0<=Ul?1:-1,zl=1-Ul*Ul;if(zl>Number.EPSILON){var Ol=Math.sqrt(zl),Vl=Math.atan2(Ol,Ul*Hl);Nl=Math.sin(Nl*Vl)/Ol,Ll=Math.sin(Ll*Vl)/Ol}var Wl=Ll*Hl;if(wl=wl*Nl+Dl*Wl,Rl=Rl*Nl+Gl*Wl,Cl=Cl*Nl+Bl*Wl,Il=Il*Nl+Fl*Wl,Nl==1-Ll){var Xl=1/Math.sqrt(wl*wl+Rl*Rl+Cl*Cl+Il*Il);wl*=Xl,Rl*=Xl,Cl*=Xl,Il*=Xl}}_l[Sl]=wl,_l[Sl+1]=Rl,_l[Sl+2]=Cl,_l[Sl+3]=Il}}),Z.prototype={constructor:Z,isVector3:!0,set:function(_l,Sl,El){return this.x=_l,this.y=Sl,this.z=El,this},setScalar:function(_l){return this.x=_l,this.y=_l,this.z=_l,this},setX:function(_l){return this.x=_l,this},setY:function(_l){return this.y=_l,this},setZ:function(_l){return this.z=_l,this},setComponent:function(_l,Sl){switch(_l){case 0:this.x=Sl;break;case 1:this.y=Sl;break;case 2:this.z=Sl;break;default:throw new Error("index is out of range: "+_l);}return this},getComponent:function(_l){switch(_l){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_l);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(_l){return this.x=_l.x,this.y=_l.y,this.z=_l.z,this},add:function(_l,Sl){return void 0===Sl?(this.x+=_l.x,this.y+=_l.y,this.z+=_l.z,this):(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(_l,Sl))},addScalar:function(_l){return this.x+=_l,this.y+=_l,this.z+=_l,this},addVectors:function(_l,Sl){return this.x=_l.x+Sl.x,this.y=_l.y+Sl.y,this.z=_l.z+Sl.z,this},addScaledVector:function(_l,Sl){return this.x+=_l.x*Sl,this.y+=_l.y*Sl,this.z+=_l.z*Sl,this},sub:function(_l,Sl){return void 0===Sl?(this.x-=_l.x,this.y-=_l.y,this.z-=_l.z,this):(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(_l,Sl))},subScalar:function(_l){return this.x-=_l,this.y-=_l,this.z-=_l,this},subVectors:function(_l,Sl){return this.x=_l.x-Sl.x,this.y=_l.y-Sl.y,this.z=_l.z-Sl.z,this},multiply:function(_l,Sl){return void 0===Sl?(this.x*=_l.x,this.y*=_l.y,this.z*=_l.z,this):(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(_l,Sl))},multiplyScalar:function(_l){return isFinite(_l)?(this.x*=_l,this.y*=_l,this.z*=_l):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(_l,Sl){return this.x=_l.x*Sl.x,this.y=_l.y*Sl.y,this.z=_l.z*Sl.z,this},applyEuler:function(){var _l;return function(El){return!1===(El&&El.isEuler)&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0==_l&&(_l=new Y),this.applyQuaternion(_l.setFromEuler(El))}}(),applyAxisAngle:function(){var _l;return function(El,Ml){return void 0==_l&&(_l=new Y),this.applyQuaternion(_l.setFromAxisAngle(El,Ml))}}(),applyMatrix3:function(_l){var Sl=this.x,El=this.y,Ml=this.z,Al=_l.elements;return this.x=Al[0]*Sl+Al[3]*El+Al[6]*Ml,this.y=Al[1]*Sl+Al[4]*El+Al[7]*Ml,this.z=Al[2]*Sl+Al[5]*El+Al[8]*Ml,this},applyMatrix4:function(_l){var Sl=this.x,El=this.y,Ml=this.z,Al=_l.elements;return this.x=Al[0]*Sl+Al[4]*El+Al[8]*Ml+Al[12],this.y=Al[1]*Sl+Al[5]*El+Al[9]*Ml+Al[13],this.z=Al[2]*Sl+Al[6]*El+Al[10]*Ml+Al[14],this},applyProjection:function(_l){var Sl=this.x,El=this.y,Ml=this.z,Al=_l.elements,Pl=1/(Al[3]*Sl+Al[7]*El+Al[11]*Ml+Al[15]);return this.x=(Al[0]*Sl+Al[4]*El+Al[8]*Ml+Al[12])*Pl,this.y=(Al[1]*Sl+Al[5]*El+Al[9]*Ml+Al[13])*Pl,this.z=(Al[2]*Sl+Al[6]*El+Al[10]*Ml+Al[14])*Pl,this},applyQuaternion:function(_l){var Sl=this.x,El=this.y,Ml=this.z,Al=_l.x,Pl=_l.y,Ll=_l.z,wl=_l.w,Rl=wl*Sl+Pl*Ml-Ll*El,Cl=wl*El+Ll*Sl-Al*Ml,Il=wl*Ml+Al*El-Pl*Sl,Dl=-Al*Sl-Pl*El-Ll*Ml;return this.x=Rl*wl+Dl*-Al+Cl*-Ll-Il*-Pl,this.y=Cl*wl+Dl*-Pl+Il*-Al-Rl*-Ll,this.z=Il*wl+Dl*-Ll+Rl*-Pl-Cl*-Al,this},project:function(){var _l;return function(El){return void 0==_l&&(_l=new K),_l.multiplyMatrices(El.projectionMatrix,_l.getInverse(El.matrixWorld)),this.applyProjection(_l)}}(),unproject:function(){var _l;return function(El){return void 0==_l&&(_l=new K),_l.multiplyMatrices(El.matrixWorld,_l.getInverse(El.projectionMatrix)),this.applyProjection(_l)}}(),transformDirection:function(_l){var Sl=this.x,El=this.y,Ml=this.z,Al=_l.elements;return this.x=Al[0]*Sl+Al[4]*El+Al[8]*Ml,this.y=Al[1]*Sl+Al[5]*El+Al[9]*Ml,this.z=Al[2]*Sl+Al[6]*El+Al[10]*Ml,this.normalize()},divide:function(_l){return this.x/=_l.x,this.y/=_l.y,this.z/=_l.z,this},divideScalar:function(_l){return this.multiplyScalar(1/_l)},min:function(_l){return this.x=Math.min(this.x,_l.x),this.y=Math.min(this.y,_l.y),this.z=Math.min(this.z,_l.z),this},max:function(_l){return this.x=Math.max(this.x,_l.x),this.y=Math.max(this.y,_l.y),this.z=Math.max(this.z,_l.z),this},clamp:function(_l,Sl){return this.x=Math.max(_l.x,Math.min(Sl.x,this.x)),this.y=Math.max(_l.y,Math.min(Sl.y,this.y)),this.z=Math.max(_l.z,Math.min(Sl.z,this.z)),this},clampScalar:function(){var _l,Sl;return function(Ml,Al){return void 0==_l&&(_l=new Z,Sl=new Z),_l.set(Ml,Ml,Ml),Sl.set(Al,Al,Al),this.clamp(_l,Sl)}}(),clampLength:function(_l,Sl){var El=this.length();return this.multiplyScalar(Math.max(_l,Math.min(Sl,El))/El)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(_l){return this.x*_l.x+this.y*_l.y+this.z*_l.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(_l){return this.multiplyScalar(_l/this.length())},lerp:function(_l,Sl){return this.x+=(_l.x-this.x)*Sl,this.y+=(_l.y-this.y)*Sl,this.z+=(_l.z-this.z)*Sl,this},lerpVectors:function(_l,Sl,El){return this.subVectors(Sl,_l).multiplyScalar(El).add(_l)},cross:function(_l,Sl){if(void 0!==Sl)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(_l,Sl);var El=this.x,Ml=this.y,Al=this.z;return this.x=Ml*_l.z-Al*_l.y,this.y=Al*_l.x-El*_l.z,this.z=El*_l.y-Ml*_l.x,this},crossVectors:function(_l,Sl){var El=_l.x,Ml=_l.y,Al=_l.z,Pl=Sl.x,Ll=Sl.y,wl=Sl.z;return this.x=Ml*wl-Al*Ll,this.y=Al*Pl-El*wl,this.z=El*Ll-Ml*Pl,this},projectOnVector:function(_l){var Sl=_l.dot(this)/_l.lengthSq();return this.copy(_l).multiplyScalar(Sl)},projectOnPlane:function(){var _l;return function(El){return void 0==_l&&(_l=new Z),_l.copy(this).projectOnVector(El),this.sub(_l)}}(),reflect:function(){var _l;return function(El){return void 0==_l&&(_l=new Z),this.sub(_l.copy(El).multiplyScalar(2*this.dot(El)))}}(),angleTo:function(_l){var Sl=this.dot(_l)/Math.sqrt(this.lengthSq()*_l.lengthSq());return Math.acos(Ls.clamp(Sl,-1,1))},distanceTo:function(_l){return Math.sqrt(this.distanceToSquared(_l))},distanceToSquared:function(_l){var Sl=this.x-_l.x,El=this.y-_l.y,Ml=this.z-_l.z;return Sl*Sl+El*El+Ml*Ml},distanceToManhattan:function(_l){return Math.abs(this.x-_l.x)+Math.abs(this.y-_l.y)+Math.abs(this.z-_l.z)},setFromSpherical:function(_l){var Sl=Math.sin(_l.phi)*_l.radius;return this.x=Sl*Math.sin(_l.theta),this.y=Math.cos(_l.phi)*_l.radius,this.z=Sl*Math.cos(_l.theta),this},setFromCylindrical:function(_l){return this.x=_l.radius*Math.sin(_l.theta),this.y=_l.y,this.z=_l.radius*Math.cos(_l.theta),this},setFromMatrixPosition:function(_l){return this.setFromMatrixColumn(_l,3)},setFromMatrixScale:function(_l){var Sl=this.setFromMatrixColumn(_l,0).length(),El=this.setFromMatrixColumn(_l,1).length(),Ml=this.setFromMatrixColumn(_l,2).length();return this.x=Sl,this.y=El,this.z=Ml,this},setFromMatrixColumn:function(_l,Sl){if("number"==typeof _l){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var El=_l;_l=Sl,Sl=El}return this.fromArray(_l.elements,4*Sl)},equals:function(_l){return _l.x===this.x&&_l.y===this.y&&_l.z===this.z},fromArray:function(_l,Sl){return void 0===Sl&&(Sl=0),this.x=_l[Sl],this.y=_l[Sl+1],this.z=_l[Sl+2],this},toArray:function(_l,Sl){return void 0===_l&&(_l=[]),void 0===Sl&&(Sl=0),_l[Sl]=this.x,_l[Sl+1]=this.y,_l[Sl+2]=this.z,_l},fromAttribute:function(_l,Sl,El){return void 0!==El&&console.warn("THREE.Vector3: offset has been removed from .fromAttribute()."),this.x=_l.getX(Sl),this.y=_l.getY(Sl),this.z=_l.getZ(Sl),this}},K.prototype={constructor:K,isMatrix4:!0,set:function(_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl,Cl,Il,Dl,Gl,Bl,Fl,Nl){var Ul=this.elements;return Ul[0]=_l,Ul[4]=Sl,Ul[8]=El,Ul[12]=Ml,Ul[1]=Al,Ul[5]=Pl,Ul[9]=Ll,Ul[13]=wl,Ul[2]=Rl,Ul[6]=Cl,Ul[10]=Il,Ul[14]=Dl,Ul[3]=Gl,Ul[7]=Bl,Ul[11]=Fl,Ul[15]=Nl,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new K().fromArray(this.elements)},copy:function(_l){return this.elements.set(_l.elements),this},copyPosition:function(_l){var Sl=this.elements,El=_l.elements;return Sl[12]=El[12],Sl[13]=El[13],Sl[14]=El[14],this},extractBasis:function(_l,Sl,El){return _l.setFromMatrixColumn(this,0),Sl.setFromMatrixColumn(this,1),El.setFromMatrixColumn(this,2),this},makeBasis:function(_l,Sl,El){return this.set(_l.x,Sl.x,El.x,0,_l.y,Sl.y,El.y,0,_l.z,Sl.z,El.z,0,0,0,0,1),this},extractRotation:function(){var _l;return function(El){void 0==_l&&(_l=new Z);var Ml=this.elements,Al=El.elements,Pl=1/_l.setFromMatrixColumn(El,0).length(),Ll=1/_l.setFromMatrixColumn(El,1).length(),wl=1/_l.setFromMatrixColumn(El,2).length();return Ml[0]=Al[0]*Pl,Ml[1]=Al[1]*Pl,Ml[2]=Al[2]*Pl,Ml[4]=Al[4]*Ll,Ml[5]=Al[5]*Ll,Ml[6]=Al[6]*Ll,Ml[8]=Al[8]*wl,Ml[9]=Al[9]*wl,Ml[10]=Al[10]*wl,this}}(),makeRotationFromEuler:function(_l){!1===(_l&&_l.isEuler)&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var Sl=this.elements,El=_l.x,Ml=_l.y,Al=_l.z,Pl=Math.cos(El),Ll=Math.sin(El),wl=Math.cos(Ml),Rl=Math.sin(Ml),Cl=Math.cos(Al),Il=Math.sin(Al);if("XYZ"===_l.order){var Dl=Pl*Cl,Gl=Pl*Il,Bl=Ll*Cl,Fl=Ll*Il;Sl[0]=wl*Cl,Sl[4]=-wl*Il,Sl[8]=Rl,Sl[1]=Gl+Bl*Rl,Sl[5]=Dl-Fl*Rl,Sl[9]=-Ll*wl,Sl[2]=Fl-Dl*Rl,Sl[6]=Bl+Gl*Rl,Sl[10]=Pl*wl}else if("YXZ"===_l.order){var Nl=wl*Cl,Ul=wl*Il,Hl=Rl*Cl,zl=Rl*Il;Sl[0]=Nl+zl*Ll,Sl[4]=Hl*Ll-Ul,Sl[8]=Pl*Rl,Sl[1]=Pl*Il,Sl[5]=Pl*Cl,Sl[9]=-Ll,Sl[2]=Ul*Ll-Hl,Sl[6]=zl+Nl*Ll,Sl[10]=Pl*wl}else if("ZXY"===_l.order){var Nl=wl*Cl,Ul=wl*Il,Hl=Rl*Cl,zl=Rl*Il;Sl[0]=Nl-zl*Ll,Sl[4]=-Pl*Il,Sl[8]=Hl+Ul*Ll,Sl[1]=Ul+Hl*Ll,Sl[5]=Pl*Cl,Sl[9]=zl-Nl*Ll,Sl[2]=-Pl*Rl,Sl[6]=Ll,Sl[10]=Pl*wl}else if("ZYX"===_l.order){var Dl=Pl*Cl,Gl=Pl*Il,Bl=Ll*Cl,Fl=Ll*Il;Sl[0]=wl*Cl,Sl[4]=Bl*Rl-Gl,Sl[8]=Dl*Rl+Fl,Sl[1]=wl*Il,Sl[5]=Fl*Rl+Dl,Sl[9]=Gl*Rl-Bl,Sl[2]=-Rl,Sl[6]=Ll*wl,Sl[10]=Pl*wl}else if("YZX"===_l.order){var Ol=Pl*wl,Vl=Pl*Rl,Wl=Ll*wl,Xl=Ll*Rl;Sl[0]=wl*Cl,Sl[4]=Xl-Ol*Il,Sl[8]=Wl*Il+Vl,Sl[1]=Il,Sl[5]=Pl*Cl,Sl[9]=-Ll*Cl,Sl[2]=-Rl*Cl,Sl[6]=Vl*Il+Wl,Sl[10]=Ol-Xl*Il}else if("XZY"===_l.order){var Ol=Pl*wl,Vl=Pl*Rl,Wl=Ll*wl,Xl=Ll*Rl;Sl[0]=wl*Cl,Sl[4]=-Il,Sl[8]=Rl*Cl,Sl[1]=Ol*Il+Xl,Sl[5]=Pl*Cl,Sl[9]=Vl*Il-Wl,Sl[2]=Wl*Il-Vl,Sl[6]=Ll*Cl,Sl[10]=Xl*Il+Ol}return Sl[3]=0,Sl[7]=0,Sl[11]=0,Sl[12]=0,Sl[13]=0,Sl[14]=0,Sl[15]=1,this},makeRotationFromQuaternion:function(_l){var Sl=this.elements,El=_l.x,Ml=_l.y,Al=_l.z,Pl=_l.w,Ll=El+El,wl=Ml+Ml,Rl=Al+Al,Cl=El*Ll,Il=El*wl,Dl=El*Rl,Gl=Ml*wl,Bl=Ml*Rl,Fl=Al*Rl,Nl=Pl*Ll,Ul=Pl*wl,Hl=Pl*Rl;return Sl[0]=1-(Gl+Fl),Sl[4]=Il-Hl,Sl[8]=Dl+Ul,Sl[1]=Il+Hl,Sl[5]=1-(Cl+Fl),Sl[9]=Bl-Nl,Sl[2]=Dl-Ul,Sl[6]=Bl+Nl,Sl[10]=1-(Cl+Gl),Sl[3]=0,Sl[7]=0,Sl[11]=0,Sl[12]=0,Sl[13]=0,Sl[14]=0,Sl[15]=1,this},lookAt:function(){var _l,Sl,El;return function(Al,Pl,Ll){void 0==_l&&(_l=new Z,Sl=new Z,El=new Z);var wl=this.elements;return El.subVectors(Al,Pl).normalize(),0===El.lengthSq()&&(El.z=1),_l.crossVectors(Ll,El).normalize(),0===_l.lengthSq()&&(El.z+=1e-4,_l.crossVectors(Ll,El).normalize()),Sl.crossVectors(El,_l),wl[0]=_l.x,wl[4]=Sl.x,wl[8]=El.x,wl[1]=_l.y,wl[5]=Sl.y,wl[9]=El.y,wl[2]=_l.z,wl[6]=Sl.z,wl[10]=El.z,this}}(),multiply:function(_l,Sl){return void 0===Sl?this.multiplyMatrices(this,_l):(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(_l,Sl))},premultiply:function(_l){return this.multiplyMatrices(_l,this)},multiplyMatrices:function(_l,Sl){var El=_l.elements,Ml=Sl.elements,Al=this.elements,Pl=El[0],Ll=El[4],wl=El[8],Rl=El[12],Cl=El[1],Il=El[5],Dl=El[9],Gl=El[13],Bl=El[2],Fl=El[6],Nl=El[10],Ul=El[14],Hl=El[3],zl=El[7],Ol=El[11],Vl=El[15],Wl=Ml[0],Xl=Ml[4],Yl=Ml[8],ql=Ml[12],Zl=Ml[1],Kl=Ml[5],Ql=Ml[9],Jl=Ml[13],$l=Ml[2],ed=Ml[6],td=Ml[10],rd=Ml[14],od=Ml[3],nd=Ml[7],sd=Ml[11],ld=Ml[15];return Al[0]=Pl*Wl+Ll*Zl+wl*$l+Rl*od,Al[4]=Pl*Xl+Ll*Kl+wl*ed+Rl*nd,Al[8]=Pl*Yl+Ll*Ql+wl*td+Rl*sd,Al[12]=Pl*ql+Ll*Jl+wl*rd+Rl*ld,Al[1]=Cl*Wl+Il*Zl+Dl*$l+Gl*od,Al[5]=Cl*Xl+Il*Kl+Dl*ed+Gl*nd,Al[9]=Cl*Yl+Il*Ql+Dl*td+Gl*sd,Al[13]=Cl*ql+Il*Jl+Dl*rd+Gl*ld,Al[2]=Bl*Wl+Fl*Zl+Nl*$l+Ul*od,Al[6]=Bl*Xl+Fl*Kl+Nl*ed+Ul*nd,Al[10]=Bl*Yl+Fl*Ql+Nl*td+Ul*sd,Al[14]=Bl*ql+Fl*Jl+Nl*rd+Ul*ld,Al[3]=Hl*Wl+zl*Zl+Ol*$l+Vl*od,Al[7]=Hl*Xl+zl*Kl+Ol*ed+Vl*nd,Al[11]=Hl*Yl+zl*Ql+Ol*td+Vl*sd,Al[15]=Hl*ql+zl*Jl+Ol*rd+Vl*ld,this},multiplyToArray:function(_l,Sl,El){var Ml=this.elements;return this.multiplyMatrices(_l,Sl),El[0]=Ml[0],El[1]=Ml[1],El[2]=Ml[2],El[3]=Ml[3],El[4]=Ml[4],El[5]=Ml[5],El[6]=Ml[6],El[7]=Ml[7],El[8]=Ml[8],El[9]=Ml[9],El[10]=Ml[10],El[11]=Ml[11],El[12]=Ml[12],El[13]=Ml[13],El[14]=Ml[14],El[15]=Ml[15],this},multiplyScalar:function(_l){var Sl=this.elements;return Sl[0]*=_l,Sl[4]*=_l,Sl[8]*=_l,Sl[12]*=_l,Sl[1]*=_l,Sl[5]*=_l,Sl[9]*=_l,Sl[13]*=_l,Sl[2]*=_l,Sl[6]*=_l,Sl[10]*=_l,Sl[14]*=_l,Sl[3]*=_l,Sl[7]*=_l,Sl[11]*=_l,Sl[15]*=_l,this},applyToVector3Array:function(){var _l;return function(El,Ml,Al){_l==void 0&&(_l=new Z),Ml===void 0&&(Ml=0),Al===void 0&&(Al=El.length);for(var Pl=0,Ll=Ml;Pl<Al;Pl+=3,Ll+=3)_l.fromArray(El,Ll),_l.applyMatrix4(this),_l.toArray(El,Ll);return El}}(),applyToBufferAttribute:function(){var _l;return function(El){_l==void 0&&(_l=new Z);for(var Ml=0,Al=El.count;Ml<Al;Ml++)_l.x=El.getX(Ml),_l.y=El.getY(Ml),_l.z=El.getZ(Ml),_l.applyMatrix4(this),El.setXYZ(Ml,_l.x,_l.y,_l.z);return El}}(),determinant:function(){var _l=this.elements,Sl=_l[0],El=_l[4],Ml=_l[8],Al=_l[12],Pl=_l[1],Ll=_l[5],wl=_l[9],Rl=_l[13],Cl=_l[2],Il=_l[6],Dl=_l[10],Gl=_l[14],Bl=_l[3],Fl=_l[7],Nl=_l[11],Ul=_l[15];return Bl*(+Al*wl*Il-Ml*Rl*Il-Al*Ll*Dl+El*Rl*Dl+Ml*Ll*Gl-El*wl*Gl)+Fl*(+Sl*wl*Gl-Sl*Rl*Dl+Al*Pl*Dl-Ml*Pl*Gl+Ml*Rl*Cl-Al*wl*Cl)+Nl*(+Sl*Rl*Il-Sl*Ll*Gl-Al*Pl*Il+El*Pl*Gl+Al*Ll*Cl-El*Rl*Cl)+Ul*(-Ml*Ll*Cl-Sl*wl*Il+Sl*Ll*Dl+Ml*Pl*Il-El*Pl*Dl+El*wl*Cl)},transpose:function(){var _l=this.elements,Sl=_l[1];return _l[1]=_l[4],_l[4]=Sl,Sl=_l[2],_l[2]=_l[8],_l[8]=Sl,Sl=_l[6],_l[6]=_l[9],_l[9]=Sl,Sl=_l[3],_l[3]=_l[12],_l[12]=Sl,Sl=_l[7],_l[7]=_l[13],_l[13]=Sl,Sl=_l[11],_l[11]=_l[14],_l[14]=Sl,this},setPosition:function(_l){var Sl=this.elements;return Sl[12]=_l.x,Sl[13]=_l.y,Sl[14]=_l.z,this},getInverse:function(_l,Sl){var El=this.elements,Ml=_l.elements,Al=Ml[0],Pl=Ml[1],Ll=Ml[2],wl=Ml[3],Rl=Ml[4],Cl=Ml[5],Il=Ml[6],Dl=Ml[7],Gl=Ml[8],Bl=Ml[9],Fl=Ml[10],Nl=Ml[11],Ul=Ml[12],Hl=Ml[13],zl=Ml[14],Ol=Ml[15],Vl=Bl*zl*Dl-Hl*Fl*Dl+Hl*Il*Nl-Cl*zl*Nl-Bl*Il*Ol+Cl*Fl*Ol,Wl=Ul*Fl*Dl-Gl*zl*Dl-Ul*Il*Nl+Rl*zl*Nl+Gl*Il*Ol-Rl*Fl*Ol,Xl=Gl*Hl*Dl-Ul*Bl*Dl+Ul*Cl*Nl-Rl*Hl*Nl-Gl*Cl*Ol+Rl*Bl*Ol,Yl=Ul*Bl*Il-Gl*Hl*Il-Ul*Cl*Fl+Rl*Hl*Fl+Gl*Cl*zl-Rl*Bl*zl,ql=Al*Vl+Pl*Wl+Ll*Xl+wl*Yl;if(0==ql){var Zl="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(!0===Sl)throw new Error(Zl);else console.warn(Zl);return this.identity()}var Kl=1/ql;return El[0]=Vl*Kl,El[1]=(Hl*Fl*wl-Bl*zl*wl-Hl*Ll*Nl+Pl*zl*Nl+Bl*Ll*Ol-Pl*Fl*Ol)*Kl,El[2]=(Cl*zl*wl-Hl*Il*wl+Hl*Ll*Dl-Pl*zl*Dl-Cl*Ll*Ol+Pl*Il*Ol)*Kl,El[3]=(Bl*Il*wl-Cl*Fl*wl-Bl*Ll*Dl+Pl*Fl*Dl+Cl*Ll*Nl-Pl*Il*Nl)*Kl,El[4]=Wl*Kl,El[5]=(Gl*zl*wl-Ul*Fl*wl+Ul*Ll*Nl-Al*zl*Nl-Gl*Ll*Ol+Al*Fl*Ol)*Kl,El[6]=(Ul*Il*wl-Rl*zl*wl-Ul*Ll*Dl+Al*zl*Dl+Rl*Ll*Ol-Al*Il*Ol)*Kl,El[7]=(Rl*Fl*wl-Gl*Il*wl+Gl*Ll*Dl-Al*Fl*Dl-Rl*Ll*Nl+Al*Il*Nl)*Kl,El[8]=Xl*Kl,El[9]=(Ul*Bl*wl-Gl*Hl*wl-Ul*Pl*Nl+Al*Hl*Nl+Gl*Pl*Ol-Al*Bl*Ol)*Kl,El[10]=(Rl*Hl*wl-Ul*Cl*wl+Ul*Pl*Dl-Al*Hl*Dl-Rl*Pl*Ol+Al*Cl*Ol)*Kl,El[11]=(Gl*Cl*wl-Rl*Bl*wl-Gl*Pl*Dl+Al*Bl*Dl+Rl*Pl*Nl-Al*Cl*Nl)*Kl,El[12]=Yl*Kl,El[13]=(Gl*Hl*Ll-Ul*Bl*Ll+Ul*Pl*Fl-Al*Hl*Fl-Gl*Pl*zl+Al*Bl*zl)*Kl,El[14]=(Ul*Cl*Ll-Rl*Hl*Ll-Ul*Pl*Il+Al*Hl*Il+Rl*Pl*zl-Al*Cl*zl)*Kl,El[15]=(Rl*Bl*Ll-Gl*Cl*Ll+Gl*Pl*Il-Al*Bl*Il-Rl*Pl*Fl+Al*Cl*Fl)*Kl,this},scale:function(_l){var Sl=this.elements,El=_l.x,Ml=_l.y,Al=_l.z;return Sl[0]*=El,Sl[4]*=Ml,Sl[8]*=Al,Sl[1]*=El,Sl[5]*=Ml,Sl[9]*=Al,Sl[2]*=El,Sl[6]*=Ml,Sl[10]*=Al,Sl[3]*=El,Sl[7]*=Ml,Sl[11]*=Al,this},getMaxScaleOnAxis:function(){var _l=this.elements,Sl=_l[0]*_l[0]+_l[1]*_l[1]+_l[2]*_l[2],El=_l[4]*_l[4]+_l[5]*_l[5]+_l[6]*_l[6],Ml=_l[8]*_l[8]+_l[9]*_l[9]+_l[10]*_l[10];return Math.sqrt(Math.max(Sl,El,Ml))},makeTranslation:function(_l,Sl,El){return this.set(1,0,0,_l,0,1,0,Sl,0,0,1,El,0,0,0,1),this},makeRotationX:function(_l){var Sl=Math.cos(_l),El=Math.sin(_l);return this.set(1,0,0,0,0,Sl,-El,0,0,El,Sl,0,0,0,0,1),this},makeRotationY:function(_l){var Sl=Math.cos(_l),El=Math.sin(_l);return this.set(Sl,0,El,0,0,1,0,0,-El,0,Sl,0,0,0,0,1),this},makeRotationZ:function(_l){var Sl=Math.cos(_l),El=Math.sin(_l);return this.set(Sl,-El,0,0,El,Sl,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(_l,Sl){var El=Math.cos(Sl),Ml=Math.sin(Sl),Al=1-El,Pl=_l.x,Ll=_l.y,wl=_l.z,Rl=Al*Pl,Cl=Al*Ll;return this.set(Rl*Pl+El,Rl*Ll-Ml*wl,Rl*wl+Ml*Ll,0,Rl*Ll+Ml*wl,Cl*Ll+El,Cl*wl-Ml*Pl,0,Rl*wl-Ml*Ll,Cl*wl+Ml*Pl,Al*wl*wl+El,0,0,0,0,1),this},makeScale:function(_l,Sl,El){return this.set(_l,0,0,0,0,Sl,0,0,0,0,El,0,0,0,0,1),this},makeShear:function(_l,Sl,El){return this.set(1,Sl,El,0,_l,1,El,0,_l,Sl,1,0,0,0,0,1),this},compose:function(_l,Sl,El){return this.makeRotationFromQuaternion(Sl),this.scale(El),this.setPosition(_l),this},decompose:function(){var _l,Sl;return function(Ml,Al,Pl){void 0==_l&&(_l=new Z,Sl=new K);var Ll=this.elements,wl=_l.set(Ll[0],Ll[1],Ll[2]).length(),Rl=_l.set(Ll[4],Ll[5],Ll[6]).length(),Cl=_l.set(Ll[8],Ll[9],Ll[10]).length(),Il=this.determinant();0>Il&&(wl=-wl),Ml.x=Ll[12],Ml.y=Ll[13],Ml.z=Ll[14],Sl.elements.set(this.elements);var Dl=1/wl,Gl=1/Rl,Bl=1/Cl;return Sl.elements[0]*=Dl,Sl.elements[1]*=Dl,Sl.elements[2]*=Dl,Sl.elements[4]*=Gl,Sl.elements[5]*=Gl,Sl.elements[6]*=Gl,Sl.elements[8]*=Bl,Sl.elements[9]*=Bl,Sl.elements[10]*=Bl,Al.setFromRotationMatrix(Sl),Pl.x=wl,Pl.y=Rl,Pl.z=Cl,this}}(),makeFrustum:function(_l,Sl,El,Ml,Al,Pl){var Ll=this.elements;return Ll[0]=2*Al/(Sl-_l),Ll[4]=0,Ll[8]=(Sl+_l)/(Sl-_l),Ll[12]=0,Ll[1]=0,Ll[5]=2*Al/(Ml-El),Ll[9]=(Ml+El)/(Ml-El),Ll[13]=0,Ll[2]=0,Ll[6]=0,Ll[10]=-(Pl+Al)/(Pl-Al),Ll[14]=-2*Pl*Al/(Pl-Al),Ll[3]=0,Ll[7]=0,Ll[11]=-1,Ll[15]=0,this},makePerspective:function(_l,Sl,El,Ml){var Al=El*Math.tan(0.5*(Ls.DEG2RAD*_l)),Pl=-Al;return this.makeFrustum(Pl*Sl,Al*Sl,Pl,Al,El,Ml)},makeOrthographic:function(_l,Sl,El,Ml,Al,Pl){var Ll=this.elements,wl=1/(Sl-_l),Rl=1/(El-Ml),Cl=1/(Pl-Al);return Ll[0]=2*wl,Ll[4]=0,Ll[8]=0,Ll[12]=-((Sl+_l)*wl),Ll[1]=0,Ll[5]=2*Rl,Ll[9]=0,Ll[13]=-((El+Ml)*Rl),Ll[2]=0,Ll[6]=0,Ll[10]=-2*Cl,Ll[14]=-((Pl+Al)*Cl),Ll[3]=0,Ll[7]=0,Ll[11]=0,Ll[15]=1,this},equals:function(_l){var Sl=this.elements,El=_l.elements;for(var Ml=0;16>Ml;Ml++)if(Sl[Ml]!==El[Ml])return!1;return!0},fromArray:function(_l,Sl){Sl===void 0&&(Sl=0);for(var El=0;16>El;El++)this.elements[El]=_l[El+Sl];return this},toArray:function(_l,Sl){void 0===_l&&(_l=[]),void 0===Sl&&(Sl=0);var El=this.elements;return _l[Sl]=El[0],_l[Sl+1]=El[1],_l[Sl+2]=El[2],_l[Sl+3]=El[3],_l[Sl+4]=El[4],_l[Sl+5]=El[5],_l[Sl+6]=El[6],_l[Sl+7]=El[7],_l[Sl+8]=El[8],_l[Sl+9]=El[9],_l[Sl+10]=El[10],_l[Sl+11]=El[11],_l[Sl+12]=El[12],_l[Sl+13]=El[13],_l[Sl+14]=El[14],_l[Sl+15]=El[15],_l}},Q.prototype=Object.create(O.prototype),Q.prototype.constructor=Q,Q.prototype.isCubeTexture=!0,Object.defineProperty(Q.prototype,"images",{get:function(){return this.image},set:function(_l){this.image=_l}});var Rs=new O,Cs=new Q,Is=[],Ds=[];Fe.prototype.setValue=function(_l,Sl){var El=this.seq;for(var Ml=0,Al=El.length;Ml!==Al;++Ml){var Pl=El[Ml];Pl.setValue(_l,Sl[Pl.id])}};var Gs=/([\w\d_]+)(\])?(\[|\.)?/g;He.prototype.setValue=function(_l,Sl,El){var Ml=this.map[Sl];Ml!==void 0&&Ml.setValue(_l,El,this.renderer)},He.prototype.set=function(_l,Sl,El){var Ml=this.map[El];Ml!==void 0&&Ml.setValue(_l,Sl[El],this.renderer)},He.prototype.setOptional=function(_l,Sl,El){var Ml=Sl[El];Ml!==void 0&&this.setValue(_l,El,Ml)},He.upload=function(_l,Sl,El,Ml){for(var Al=0,Pl=Sl.length;Al!==Pl;++Al){var Ll=Sl[Al],wl=El[Ll.id];!1!==wl.needsUpdate&&Ll.setValue(_l,wl.value,Ml)}},He.seqWithValue=function(_l,Sl){var El=[];for(var Ml=0,Al=_l.length;Ml!==Al;++Ml){var Pl=_l[Ml];Pl.id in Sl&&El.push(Pl)}return El};var Bs={merge:function(_l){var Sl={};for(var El=0;El<_l.length;El++){var Ml=this.clone(_l[El]);for(var Al in Ml)Sl[Al]=Ml[Al]}return Sl},clone:function(_l){var Sl={};for(var El in _l)for(var Ml in Sl[El]={},_l[El]){var Al=_l[El][Ml];Sl[El][Ml]=Al&&(Al.isColor||Al.isMatrix3||Al.isMatrix4||Al.isVector2||Al.isVector3||Al.isVector4||Al.isTexture)?Al.clone():Array.isArray(Al)?Al.slice():Al}return Sl}},Fs={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 ltcTextureCoords( const in GeometricContext geometry, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = (LUT_SIZE - 1.0)/LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5/LUT_SIZE;\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 P = geometry.position;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nvoid clipQuadToHorizon( inout vec3 L[5], out int n ) {\n\tint config = 0;\n\tif ( L[0].z > 0.0 ) config += 1;\n\tif ( L[1].z > 0.0 ) config += 2;\n\tif ( L[2].z > 0.0 ) config += 4;\n\tif ( L[3].z > 0.0 ) config += 8;\n\tn = 0;\n\tif ( config == 0 ) {\n\t} else if ( config == 1 ) {\n\t\tn = 3;\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t\tL[2] = -L[3].z * L[0] + L[0].z * L[3];\n\t} else if ( config == 2 ) {\n\t\tn = 3;\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t} else if ( config == 3 ) {\n\t\tn = 4;\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t\tL[3] = -L[3].z * L[0] + L[0].z * L[3];\n\t} else if ( config == 4 ) {\n\t\tn = 3;\n\t\tL[0] = -L[3].z * L[2] + L[2].z * L[3];\n\t\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\n\t} else if ( config == 5 ) {\n\t\tn = 0;\n\t} else if ( config == 6 ) {\n\t\tn = 4;\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\n\t} else if ( config == 7 ) {\n\t\tn = 5;\n\t\tL[4] = -L[3].z * L[0] + L[0].z * L[3];\n\t\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\n\t} else if ( config == 8 ) {\n\t\tn = 3;\n\t\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\n\t\tL[1] = -L[2].z * L[3] + L[3].z * L[2];\n\t\tL[2] =  L[3];\n\t} else if ( config == 9 ) {\n\t\tn = 4;\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t\tL[2] = -L[2].z * L[3] + L[3].z * L[2];\n\t} else if ( config == 10 ) {\n\t\tn = 0;\n\t} else if ( config == 11 ) {\n\t\tn = 5;\n\t\tL[4] = L[3];\n\t\tL[3] = -L[2].z * L[3] + L[3].z * L[2];\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t} else if ( config == 12 ) {\n\t\tn = 4;\n\t\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\n\t\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\n\t} else if ( config == 13 ) {\n\t\tn = 5;\n\t\tL[4] = L[3];\n\t\tL[3] = L[2];\n\t\tL[2] = -L[1].z * L[2] + L[2].z * L[1];\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t} else if ( config == 14 ) {\n\t\tn = 5;\n\t\tL[4] = -L[0].z * L[3] + L[3].z * L[0];\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t} else if ( config == 15 ) {\n\t\tn = 4;\n\t}\n\tif ( n == 3 )\n\t\tL[3] = L[0];\n\tif ( n == 4 )\n\t\tL[4] = L[0];\n}\nfloat integrateLtcBrdfOverRectEdge( vec3 v1, vec3 v2 ) {\n\tfloat cosTheta = dot( v1, v2 );\n\tfloat theta = acos( cosTheta );\n\tfloat res = cross( v1, v2 ).z * ( ( theta > 0.001 ) ? theta / sin( theta ) : 1.0 );\n\treturn res;\n}\nvoid initRectPoints( const in vec3 pos, const in vec3 halfWidth, const in vec3 halfHeight, out vec3 rectPoints[4] ) {\n\trectPoints[0] = pos - halfWidth - halfHeight;\n\trectPoints[1] = pos + halfWidth - halfHeight;\n\trectPoints[2] = pos + halfWidth + halfHeight;\n\trectPoints[3] = pos - halfWidth + halfHeight;\n}\nvec3 integrateLtcBrdfOverRect( const in GeometricContext geometry, const in mat3 brdfMat, const in vec3 rectPoints[4] ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 P = geometry.position;\n\tvec3 T1, T2;\n\tT1 = normalize(V - N * dot( V, N ));\n\tT2 = - cross( N, T1 );\n\tmat3 brdfWrtSurface = brdfMat * transpose( mat3( T1, T2, N ) );\n\tvec3 clippedRect[5];\n\tclippedRect[0] = brdfWrtSurface * ( rectPoints[0] - P );\n\tclippedRect[1] = brdfWrtSurface * ( rectPoints[1] - P );\n\tclippedRect[2] = brdfWrtSurface * ( rectPoints[2] - P );\n\tclippedRect[3] = brdfWrtSurface * ( rectPoints[3] - P );\n\tint n;\n\tclipQuadToHorizon(clippedRect, n);\n\tif ( n == 0 )\n\t\treturn vec3( 0, 0, 0 );\n\tclippedRect[0] = normalize( clippedRect[0] );\n\tclippedRect[1] = normalize( clippedRect[1] );\n\tclippedRect[2] = normalize( clippedRect[2] );\n\tclippedRect[3] = normalize( clippedRect[3] );\n\tclippedRect[4] = normalize( clippedRect[4] );\n\tfloat sum = 0.0;\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[0], clippedRect[1] );\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[1], clippedRect[2] );\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[2], clippedRect[3] );\n\tif (n >= 4)\n\t\tsum += integrateLtcBrdfOverRectEdge( clippedRect[3], clippedRect[4] );\n\tif (n == 5)\n\t\tsum += integrateLtcBrdfOverRectEdge( clippedRect[4], clippedRect[0] );\n\tsum = max( 0.0, sum );\n\tvec3 Lo_i = vec3( sum, sum, sum );\n\treturn Lo_i;\n}\nvec3 Rect_Area_Light_Specular_Reflectance(\n\t\tconst in GeometricContext geometry,\n\t\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight,\n\t\tconst in float roughness,\n\t\tconst in sampler2D ltcMat, const in sampler2D ltcMag ) {\n\tvec3 rectPoints[4];\n\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\n\tvec2 uv = ltcTextureCoords( geometry, roughness );\n\tvec4 brdfLtcApproxParams, t;\n\tbrdfLtcApproxParams = texture2D( ltcMat, uv );\n\tt = texture2D( ltcMat, uv );\n\tfloat brdfLtcScalar = texture2D( ltcMag, uv ).a;\n\tmat3 brdfLtcApproxMat = mat3(\n\t\tvec3(   1,   0, t.y ),\n\t\tvec3(   0, t.z,   0 ),\n\t\tvec3( t.w,   0, t.x )\n\t);\n\tvec3 specularReflectance = integrateLtcBrdfOverRect( geometry, brdfLtcApproxMat, rectPoints );\n\tspecularReflectance *= brdfLtcScalar;\n\treturn specularReflectance;\n}\nvec3 Rect_Area_Light_Diffuse_Reflectance(\n\t\tconst in GeometricContext geometry,\n\t\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight ) {\n\tvec3 rectPoints[4];\n\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\n\tmat3 diffuseBrdfMat = mat3(1);\n\tvec3 diffuseReflectance = integrateLtcBrdfOverRect( geometry, diffuseBrdfMat, rectPoints );\n\treturn diffuseReflectance;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\n#if NUM_RECT_AREA_LIGHTS > 0\n    void RE_Direct_RectArea_BlinnPhong( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n        vec3 matDiffColor = material.diffuseColor;\n        vec3 matSpecColor = material.specularColor;\n        vec3 lightColor   = rectAreaLight.color;\n        float roughness = BlinnExponentToGGXRoughness( material.specularShininess );\n        vec3 spec = Rect_Area_Light_Specular_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\n                roughness,\n                ltcMat, ltcMag );\n        vec3 diff = Rect_Area_Light_Diffuse_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\n        reflectedLight.directSpecular += lightColor * matSpecColor * spec / PI2;\n        reflectedLight.directDiffuse  += lightColor * matDiffColor * diff / PI2;\n    }\n#endif\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n    void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n        vec3 matDiffColor = material.diffuseColor;\n        vec3 matSpecColor = material.specularColor;\n        vec3 lightColor   = rectAreaLight.color;\n        float roughness = material.specularRoughness;\n        vec3 spec = Rect_Area_Light_Specular_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\n                roughness,\n                ltcMat, ltcMag );\n        vec3 diff = Rect_Area_Light_Diffuse_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\n        reflectedLight.directSpecular += lightColor * matSpecColor * spec;\n        reflectedLight.directDiffuse  += lightColor * matDiffColor * diff;\n    }\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\t\t\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_flip:"#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n    #if NUM_RECT_AREA_LIGHTS > 0\n    #endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n    #if NUM_RECT_AREA_LIGHTS > 0\n    #endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n    #if NUM_RECT_AREA_LIGHTS > 0\n    #endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",distanceRGBA_vert:"varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#include <premultiplied_alpha_fragment>\n\t#include <encodings_fragment>\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",shadow_frag:"uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"};ze.prototype={constructor:ze,isColor:!0,r:1,g:1,b:1,set:function(_l){return _l&&_l.isColor?this.copy(_l):"number"==typeof _l?this.setHex(_l):"string"==typeof _l&&this.setStyle(_l),this},setScalar:function(_l){return this.r=_l,this.g=_l,this.b=_l,this},setHex:function(_l){return _l=Math.floor(_l),this.r=(255&_l>>16)/255,this.g=(255&_l>>8)/255,this.b=(255&_l)/255,this},setRGB:function(_l,Sl,El){return this.r=_l,this.g=Sl,this.b=El,this},setHSL:function(){function _l(Sl,El,Ml){return 0>Ml&&(Ml+=1),1<Ml&&(Ml-=1),Ml<1/6?Sl+6*(El-Sl)*Ml:Ml<1/2?El:Ml<2/3?Sl+6*(El-Sl)*(2/3-Ml):Sl}return function(El,Ml,Al){if(El=Ls.euclideanModulo(El,1),Ml=Ls.clamp(Ml,0,1),Al=Ls.clamp(Al,0,1),0===Ml)this.r=this.g=this.b=Al;else{var Pl=0.5>=Al?Al*(1+Ml):Al+Ml-Al*Ml,Ll=2*Al-Pl;this.r=_l(Ll,Pl,El+1/3),this.g=_l(Ll,Pl,El),this.b=_l(Ll,Pl,El-1/3)}return this}}(),setStyle:function(_l){function Sl(Dl){Dl!==void 0&&1>parseFloat(Dl)&&console.warn("THREE.Color: Alpha component of "+_l+" will be ignored.")}var El;if(El=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(_l)){var Ml,Al=El[1],Pl=El[2];switch(Al){case"rgb":case"rgba":if(Ml=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Pl))return this.r=Math.min(255,parseInt(Ml[1],10))/255,this.g=Math.min(255,parseInt(Ml[2],10))/255,this.b=Math.min(255,parseInt(Ml[3],10))/255,Sl(Ml[5]),this;if(Ml=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Pl))return this.r=Math.min(100,parseInt(Ml[1],10))/100,this.g=Math.min(100,parseInt(Ml[2],10))/100,this.b=Math.min(100,parseInt(Ml[3],10))/100,Sl(Ml[5]),this;break;case"hsl":case"hsla":if(Ml=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Pl)){var Ll=parseFloat(Ml[1])/360,wl=parseInt(Ml[2],10)/100,Rl=parseInt(Ml[3],10)/100;return Sl(Ml[5]),this.setHSL(Ll,wl,Rl)}}}else if(El=/^\#([A-Fa-f0-9]+)$/.exec(_l)){var Cl=El[1],Il=Cl.length;if(3===Il)return this.r=parseInt(Cl.charAt(0)+Cl.charAt(0),16)/255,this.g=parseInt(Cl.charAt(1)+Cl.charAt(1),16)/255,this.b=parseInt(Cl.charAt(2)+Cl.charAt(2),16)/255,this;if(6===Il)return this.r=parseInt(Cl.charAt(0)+Cl.charAt(1),16)/255,this.g=parseInt(Cl.charAt(2)+Cl.charAt(3),16)/255,this.b=parseInt(Cl.charAt(4)+Cl.charAt(5),16)/255,this}if(_l&&0<_l.length){var Cl=Ns[_l];void 0===Cl?console.warn("THREE.Color: Unknown color "+_l):this.setHex(Cl)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(_l){return this.r=_l.r,this.g=_l.g,this.b=_l.b,this},copyGammaToLinear:function(_l,Sl){return void 0===Sl&&(Sl=2),this.r=Math.pow(_l.r,Sl),this.g=Math.pow(_l.g,Sl),this.b=Math.pow(_l.b,Sl),this},copyLinearToGamma:function(_l,Sl){void 0===Sl&&(Sl=2);var El=0<Sl?1/Sl:1;return this.r=Math.pow(_l.r,El),this.g=Math.pow(_l.g,El),this.b=Math.pow(_l.b,El),this},convertGammaToLinear:function(){var _l=this.r,Sl=this.g,El=this.b;return this.r=_l*_l,this.g=Sl*Sl,this.b=El*El,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(_l){var Sl=_l||{h:0,s:0,l:0},El=this.r,Ml=this.g,Al=this.b,Pl=Math.max(El,Ml,Al),Ll=Math.min(El,Ml,Al),Cl=(Ll+Pl)/2,wl,Rl;if(Ll===Pl)wl=0,Rl=0;else{var Il=Pl-Ll;Rl=0.5>=Cl?Il/(Pl+Ll):Il/(2-Pl-Ll),Pl===El?wl=(Ml-Al)/Il+(Ml<Al?6:0):Pl===Ml?wl=(Al-El)/Il+2:Pl===Al?wl=(El-Ml)/Il+4:void 0,wl/=6}return Sl.h=wl,Sl.s=Rl,Sl.l=Cl,Sl},getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(_l,Sl,El){var Ml=this.getHSL();return Ml.h+=_l,Ml.s+=Sl,Ml.l+=El,this.setHSL(Ml.h,Ml.s,Ml.l),this},add:function(_l){return this.r+=_l.r,this.g+=_l.g,this.b+=_l.b,this},addColors:function(_l,Sl){return this.r=_l.r+Sl.r,this.g=_l.g+Sl.g,this.b=_l.b+Sl.b,this},addScalar:function(_l){return this.r+=_l,this.g+=_l,this.b+=_l,this},sub:function(_l){return this.r=Math.max(0,this.r-_l.r),this.g=Math.max(0,this.g-_l.g),this.b=Math.max(0,this.b-_l.b),this},multiply:function(_l){return this.r*=_l.r,this.g*=_l.g,this.b*=_l.b,this},multiplyScalar:function(_l){return this.r*=_l,this.g*=_l,this.b*=_l,this},lerp:function(_l,Sl){return this.r+=(_l.r-this.r)*Sl,this.g+=(_l.g-this.g)*Sl,this.b+=(_l.b-this.b)*Sl,this},equals:function(_l){return _l.r===this.r&&_l.g===this.g&&_l.b===this.b},fromArray:function(_l,Sl){return void 0===Sl&&(Sl=0),this.r=_l[Sl],this.g=_l[Sl+1],this.b=_l[Sl+2],this},toArray:function(_l,Sl){return void 0===_l&&(_l=[]),void 0===Sl&&(Sl=0),_l[Sl]=this.r,_l[Sl+1]=this.g,_l[Sl+2]=this.b,_l},toJSON:function(){return this.getHex()}};var Ns={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Oe.prototype=Object.create(O.prototype),Oe.prototype.constructor=Oe,Oe.prototype.isDataTexture=!0;var Us={common:{diffuse:{value:new ze(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new V(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:0.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new H(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5e-4},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ze(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ze(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new V(0,0,1,1)}}},Hs={basic:{uniforms:Bs.merge([Us.common,Us.aomap,Us.lightmap,Us.fog]),vertexShader:Fs.meshbasic_vert,fragmentShader:Fs.meshbasic_frag},lambert:{uniforms:Bs.merge([Us.common,Us.aomap,Us.lightmap,Us.emissivemap,Us.fog,Us.lights,{emissive:{value:new ze(0)}}]),vertexShader:Fs.meshlambert_vert,fragmentShader:Fs.meshlambert_frag},phong:{uniforms:Bs.merge([Us.common,Us.aomap,Us.lightmap,Us.emissivemap,Us.bumpmap,Us.normalmap,Us.displacementmap,Us.gradientmap,Us.fog,Us.lights,{emissive:{value:new ze(0)},specular:{value:new ze(1118481)},shininess:{value:30}}]),vertexShader:Fs.meshphong_vert,fragmentShader:Fs.meshphong_frag},standard:{uniforms:Bs.merge([Us.common,Us.aomap,Us.lightmap,Us.emissivemap,Us.bumpmap,Us.normalmap,Us.displacementmap,Us.roughnessmap,Us.metalnessmap,Us.fog,Us.lights,{emissive:{value:new ze(0)},roughness:{value:0.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Fs.meshphysical_vert,fragmentShader:Fs.meshphysical_frag},points:{uniforms:Bs.merge([Us.points,Us.fog]),vertexShader:Fs.points_vert,fragmentShader:Fs.points_frag},dashed:{uniforms:Bs.merge([Us.common,Us.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Fs.linedashed_vert,fragmentShader:Fs.linedashed_frag},depth:{uniforms:Bs.merge([Us.common,Us.displacementmap]),vertexShader:Fs.depth_vert,fragmentShader:Fs.depth_frag},normal:{uniforms:Bs.merge([Us.common,Us.bumpmap,Us.normalmap,Us.displacementmap,{opacity:{value:1}}]),vertexShader:Fs.normal_vert,fragmentShader:Fs.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Fs.cube_vert,fragmentShader:Fs.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:Fs.equirect_vert,fragmentShader:Fs.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new Z}},vertexShader:Fs.distanceRGBA_vert,fragmentShader:Fs.distanceRGBA_frag}};Hs.physical={uniforms:Bs.merge([Hs.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Fs.meshphysical_vert,fragmentShader:Fs.meshphysical_frag},Ve.prototype={constructor:Ve,set:function(_l,Sl){return this.min.copy(_l),this.max.copy(Sl),this},setFromPoints:function(_l){this.makeEmpty();for(var Sl=0,El=_l.length;Sl<El;Sl++)this.expandByPoint(_l[Sl]);return this},setFromCenterAndSize:function(){var _l=new H;return function(El,Ml){var Al=_l.copy(Ml).multiplyScalar(0.5);return this.min.copy(El).sub(Al),this.max.copy(El).add(Al),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.min.copy(_l.min),this.max.copy(_l.max),this},makeEmpty:function(){return this.min.x=this.min.y=+(1/0),this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(_l){var Sl=_l||new H;return this.isEmpty()?Sl.set(0,0):Sl.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(_l){var Sl=_l||new H;return this.isEmpty()?Sl.set(0,0):Sl.subVectors(this.max,this.min)},expandByPoint:function(_l){return this.min.min(_l),this.max.max(_l),this},expandByVector:function(_l){return this.min.sub(_l),this.max.add(_l),this},expandByScalar:function(_l){return this.min.addScalar(-_l),this.max.addScalar(_l),this},containsPoint:function(_l){return _l.x<this.min.x||_l.x>this.max.x||_l.y<this.min.y||_l.y>this.max.y?!1:!0},containsBox:function(_l){return this.min.x<=_l.min.x&&_l.max.x<=this.max.x&&this.min.y<=_l.min.y&&_l.max.y<=this.max.y},getParameter:function(_l,Sl){var El=Sl||new H;return El.set((_l.x-this.min.x)/(this.max.x-this.min.x),(_l.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(_l){return _l.max.x<this.min.x||_l.min.x>this.max.x||_l.max.y<this.min.y||_l.min.y>this.max.y?!1:!0},clampPoint:function(_l,Sl){var El=Sl||new H;return El.copy(_l).clamp(this.min,this.max)},distanceToPoint:function(){var _l=new H;return function(El){var Ml=_l.copy(El).clamp(this.min,this.max);return Ml.sub(El).length()}}(),intersect:function(_l){return this.min.max(_l.min),this.max.min(_l.max),this},union:function(_l){return this.min.min(_l.min),this.max.max(_l.max),this},translate:function(_l){return this.min.add(_l),this.max.add(_l),this},equals:function(_l){return _l.min.equals(this.min)&&_l.max.equals(this.max)}};var zs=0;Xe.prototype={constructor:Xe,isMaterial:!0,get needsUpdate(){return this._needsUpdate},set needsUpdate(_l){!0===_l&&this.update(),this._needsUpdate=_l},setValues:function(_l){if(_l!==void 0)for(var Sl in _l){var El=_l[Sl];if(El===void 0){console.warn("THREE.Material: '"+Sl+"' parameter is undefined.");continue}var Ml=this[Sl];if(Ml===void 0){console.warn("THREE."+this.type+": '"+Sl+"' is not a property of this material.");continue}Ml&&Ml.isColor?Ml.set(El):Ml&&Ml.isVector3&&El&&El.isVector3?Ml.copy(El):"overdraw"==Sl?this[Sl]=+El:this[Sl]=El}},toJSON:function(_l){function Sl(Ll){var wl=[];for(var Rl in Ll){var Cl=Ll[Rl];delete Cl.metadata,wl.push(Cl)}return wl}var El=void 0===_l;El&&(_l={textures:{},images:{}});var Ml={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};if(Ml.uuid=this.uuid,Ml.type=this.type,""!==this.name&&(Ml.name=this.name),this.color&&this.color.isColor&&(Ml.color=this.color.getHex()),void 0!==this.roughness&&(Ml.roughness=this.roughness),void 0!==this.metalness&&(Ml.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(Ml.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(Ml.specular=this.specular.getHex()),void 0!==this.shininess&&(Ml.shininess=this.shininess),void 0!==this.clearCoat&&(Ml.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(Ml.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(Ml.map=this.map.toJSON(_l).uuid),this.alphaMap&&this.alphaMap.isTexture&&(Ml.alphaMap=this.alphaMap.toJSON(_l).uuid),this.lightMap&&this.lightMap.isTexture&&(Ml.lightMap=this.lightMap.toJSON(_l).uuid),this.bumpMap&&this.bumpMap.isTexture&&(Ml.bumpMap=this.bumpMap.toJSON(_l).uuid,Ml.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(Ml.normalMap=this.normalMap.toJSON(_l).uuid,Ml.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(Ml.displacementMap=this.displacementMap.toJSON(_l).uuid,Ml.displacementScale=this.displacementScale,Ml.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(Ml.roughnessMap=this.roughnessMap.toJSON(_l).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(Ml.metalnessMap=this.metalnessMap.toJSON(_l).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(Ml.emissiveMap=this.emissiveMap.toJSON(_l).uuid),this.specularMap&&this.specularMap.isTexture&&(Ml.specularMap=this.specularMap.toJSON(_l).uuid),this.envMap&&this.envMap.isTexture&&(Ml.envMap=this.envMap.toJSON(_l).uuid,Ml.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(Ml.gradientMap=this.gradientMap.toJSON(_l).uuid),void 0!==this.size&&(Ml.size=this.size),void 0!==this.sizeAttenuation&&(Ml.sizeAttenuation=this.sizeAttenuation),this.blending!==Mi&&(Ml.blending=this.blending),this.shading!==bi&&(Ml.shading=this.shading),this.side!==hi&&(Ml.side=this.side),this.vertexColors!==vi&&(Ml.vertexColors=this.vertexColors),1>this.opacity&&(Ml.opacity=this.opacity),!0===this.transparent&&(Ml.transparent=this.transparent),Ml.depthFunc=this.depthFunc,Ml.depthTest=this.depthTest,Ml.depthWrite=this.depthWrite,0<this.alphaTest&&(Ml.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(Ml.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(Ml.wireframe=this.wireframe),1<this.wireframeLinewidth&&(Ml.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(Ml.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(Ml.wireframeLinejoin=this.wireframeLinejoin),Ml.skinning=this.skinning,Ml.morphTargets=this.morphTargets,El){var Al=Sl(_l.textures),Pl=Sl(_l.images);0<Al.length&&(Ml.textures=Al),0<Pl.length&&(Ml.images=Pl)}return Ml},clone:function(){return new this.constructor().copy(this)},copy:function(_l){this.name=_l.name,this.fog=_l.fog,this.lights=_l.lights,this.blending=_l.blending,this.side=_l.side,this.shading=_l.shading,this.vertexColors=_l.vertexColors,this.opacity=_l.opacity,this.transparent=_l.transparent,this.blendSrc=_l.blendSrc,this.blendDst=_l.blendDst,this.blendEquation=_l.blendEquation,this.blendSrcAlpha=_l.blendSrcAlpha,this.blendDstAlpha=_l.blendDstAlpha,this.blendEquationAlpha=_l.blendEquationAlpha,this.depthFunc=_l.depthFunc,this.depthTest=_l.depthTest,this.depthWrite=_l.depthWrite,this.colorWrite=_l.colorWrite,this.precision=_l.precision,this.polygonOffset=_l.polygonOffset,this.polygonOffsetFactor=_l.polygonOffsetFactor,this.polygonOffsetUnits=_l.polygonOffsetUnits,this.alphaTest=_l.alphaTest,this.premultipliedAlpha=_l.premultipliedAlpha,this.overdraw=_l.overdraw,this.visible=_l.visible,this.clipShadows=_l.clipShadows,this.clipIntersection=_l.clipIntersection;var Sl=_l.clippingPlanes,El=null;if(null!==Sl){var Ml=Sl.length;El=Array(Ml);for(var Al=0;Al!==Ml;++Al)El[Al]=Sl[Al].clone()}return this.clippingPlanes=El,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(Xe.prototype,F.prototype),je.prototype=Object.create(Xe.prototype),je.prototype.constructor=je,je.prototype.isShaderMaterial=!0,je.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.fragmentShader=_l.fragmentShader,this.vertexShader=_l.vertexShader,this.uniforms=Bs.clone(_l.uniforms),this.defines=_l.defines,this.wireframe=_l.wireframe,this.wireframeLinewidth=_l.wireframeLinewidth,this.lights=_l.lights,this.clipping=_l.clipping,this.skinning=_l.skinning,this.morphTargets=_l.morphTargets,this.morphNormals=_l.morphNormals,this.extensions=_l.extensions,this},je.prototype.toJSON=function(_l){var Sl=Xe.prototype.toJSON.call(this,_l);return Sl.uniforms=this.uniforms,Sl.vertexShader=this.vertexShader,Sl.fragmentShader=this.fragmentShader,Sl},Ye.prototype=Object.create(Xe.prototype),Ye.prototype.constructor=Ye,Ye.prototype.isMeshDepthMaterial=!0,Ye.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.depthPacking=_l.depthPacking,this.skinning=_l.skinning,this.morphTargets=_l.morphTargets,this.map=_l.map,this.alphaMap=_l.alphaMap,this.displacementMap=_l.displacementMap,this.displacementScale=_l.displacementScale,this.displacementBias=_l.displacementBias,this.wireframe=_l.wireframe,this.wireframeLinewidth=_l.wireframeLinewidth,this},qe.prototype={constructor:qe,isBox3:!0,set:function(_l,Sl){return this.min.copy(_l),this.max.copy(Sl),this},setFromArray:function(_l){var Sl=+(1/0),El=+(1/0),Ml=+(1/0),Al=-(1/0),Pl=-(1/0),Ll=-(1/0);for(var wl=0,Rl=_l.length;wl<Rl;wl+=3){var Cl=_l[wl],Il=_l[wl+1],Dl=_l[wl+2];Cl<Sl&&(Sl=Cl),Il<El&&(El=Il),Dl<Ml&&(Ml=Dl),Cl>Al&&(Al=Cl),Il>Pl&&(Pl=Il),Dl>Ll&&(Ll=Dl)}this.min.set(Sl,El,Ml),this.max.set(Al,Pl,Ll)},setFromBufferAttribute:function(_l){var Sl=+(1/0),El=+(1/0),Ml=+(1/0),Al=-(1/0),Pl=-(1/0),Ll=-(1/0);for(var wl=0,Rl=_l.count;wl<Rl;wl++){var Cl=_l.getX(wl),Il=_l.getY(wl),Dl=_l.getZ(wl);Cl<Sl&&(Sl=Cl),Il<El&&(El=Il),Dl<Ml&&(Ml=Dl),Cl>Al&&(Al=Cl),Il>Pl&&(Pl=Il),Dl>Ll&&(Ll=Dl)}this.min.set(Sl,El,Ml),this.max.set(Al,Pl,Ll)},setFromPoints:function(_l){this.makeEmpty();for(var Sl=0,El=_l.length;Sl<El;Sl++)this.expandByPoint(_l[Sl]);return this},setFromCenterAndSize:function(){var _l=new Z;return function(El,Ml){var Al=_l.copy(Ml).multiplyScalar(0.5);return this.min.copy(El).sub(Al),this.max.copy(El).add(Al),this}}(),setFromObject:function(){var _l=new Z;return function(El){var Ml=this;return El.updateMatrixWorld(!0),this.makeEmpty(),El.traverse(function(Al){var wl=Al.geometry,Pl,Ll;if(void 0!==wl)if(wl.isGeometry){var Rl=wl.vertices;for(Pl=0,Ll=Rl.length;Pl<Ll;Pl++)_l.copy(Rl[Pl]),_l.applyMatrix4(Al.matrixWorld),Ml.expandByPoint(_l)}else if(wl.isBufferGeometry){var Cl=wl.attributes.position;if(void 0!==Cl)for(Pl=0,Ll=Cl.count;Pl<Ll;Pl++)_l.fromAttribute(Cl,Pl).applyMatrix4(Al.matrixWorld),Ml.expandByPoint(_l)}}),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.min.copy(_l.min),this.max.copy(_l.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+(1/0),this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(_l){var Sl=_l||new Z;return this.isEmpty()?Sl.set(0,0,0):Sl.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(_l){var Sl=_l||new Z;return this.isEmpty()?Sl.set(0,0,0):Sl.subVectors(this.max,this.min)},expandByPoint:function(_l){return this.min.min(_l),this.max.max(_l),this},expandByVector:function(_l){return this.min.sub(_l),this.max.add(_l),this},expandByScalar:function(_l){return this.min.addScalar(-_l),this.max.addScalar(_l),this},containsPoint:function(_l){return _l.x<this.min.x||_l.x>this.max.x||_l.y<this.min.y||_l.y>this.max.y||_l.z<this.min.z||_l.z>this.max.z?!1:!0},containsBox:function(_l){return this.min.x<=_l.min.x&&_l.max.x<=this.max.x&&this.min.y<=_l.min.y&&_l.max.y<=this.max.y&&this.min.z<=_l.min.z&&_l.max.z<=this.max.z},getParameter:function(_l,Sl){var El=Sl||new Z;return El.set((_l.x-this.min.x)/(this.max.x-this.min.x),(_l.y-this.min.y)/(this.max.y-this.min.y),(_l.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(_l){return _l.max.x<this.min.x||_l.min.x>this.max.x||_l.max.y<this.min.y||_l.min.y>this.max.y||_l.max.z<this.min.z||_l.min.z>this.max.z?!1:!0},intersectsSphere:function(){var _l;return function(El){return void 0==_l&&(_l=new Z),this.clampPoint(El.center,_l),_l.distanceToSquared(El.center)<=El.radius*El.radius}}(),intersectsPlane:function(_l){var Sl,El;return 0<_l.normal.x?(Sl=_l.normal.x*this.min.x,El=_l.normal.x*this.max.x):(Sl=_l.normal.x*this.max.x,El=_l.normal.x*this.min.x),0<_l.normal.y?(Sl+=_l.normal.y*this.min.y,El+=_l.normal.y*this.max.y):(Sl+=_l.normal.y*this.max.y,El+=_l.normal.y*this.min.y),0<_l.normal.z?(Sl+=_l.normal.z*this.min.z,El+=_l.normal.z*this.max.z):(Sl+=_l.normal.z*this.max.z,El+=_l.normal.z*this.min.z),Sl<=_l.constant&&El>=_l.constant},clampPoint:function(_l,Sl){var El=Sl||new Z;return El.copy(_l).clamp(this.min,this.max)},distanceToPoint:function(){var _l=new Z;return function(El){var Ml=_l.copy(El).clamp(this.min,this.max);return Ml.sub(El).length()}}(),getBoundingSphere:function(){var _l=new Z;return function(El){var Ml=El||new Ze;return this.getCenter(Ml.center),Ml.radius=0.5*this.getSize(_l).length(),Ml}}(),intersect:function(_l){return this.min.max(_l.min),this.max.min(_l.max),this.isEmpty()&&this.makeEmpty(),this},union:function(_l){return this.min.min(_l.min),this.max.max(_l.max),this},applyMatrix4:function(){var _l=[new Z,new Z,new Z,new Z,new Z,new Z,new Z,new Z];return function(El){return this.isEmpty()?this:(_l[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(El),_l[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(El),_l[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(El),_l[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(El),_l[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(El),_l[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(El),_l[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(El),_l[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(El),this.setFromPoints(_l),this)}}(),translate:function(_l){return this.min.add(_l),this.max.add(_l),this},equals:function(_l){return _l.min.equals(this.min)&&_l.max.equals(this.max)}},Ze.prototype={constructor:Ze,set:function(_l,Sl){return this.center.copy(_l),this.radius=Sl,this},setFromPoints:function(){var _l=new qe;return function(El,Ml){var Al=this.center;void 0===Ml?_l.setFromPoints(El).getCenter(Al):Al.copy(Ml);var Pl=0;for(var Ll=0,wl=El.length;Ll<wl;Ll++)Pl=Math.max(Pl,Al.distanceToSquared(El[Ll]));return this.radius=Math.sqrt(Pl),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.center.copy(_l.center),this.radius=_l.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(_l){return _l.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(_l){return _l.distanceTo(this.center)-this.radius},intersectsSphere:function(_l){var Sl=this.radius+_l.radius;return _l.center.distanceToSquared(this.center)<=Sl*Sl},intersectsBox:function(_l){return _l.intersectsSphere(this)},intersectsPlane:function(_l){return Math.abs(this.center.dot(_l.normal)-_l.constant)<=this.radius},clampPoint:function(_l,Sl){var El=this.center.distanceToSquared(_l),Ml=Sl||new Z;return Ml.copy(_l),El>this.radius*this.radius&&(Ml.sub(this.center).normalize(),Ml.multiplyScalar(this.radius).add(this.center)),Ml},getBoundingBox:function(_l){var Sl=_l||new qe;return Sl.set(this.center,this.center),Sl.expandByScalar(this.radius),Sl},applyMatrix4:function(_l){return this.center.applyMatrix4(_l),this.radius=this.radius*_l.getMaxScaleOnAxis(),this},translate:function(_l){return this.center.add(_l),this},equals:function(_l){return _l.center.equals(this.center)&&_l.radius===this.radius}},Ke.prototype={constructor:Ke,isMatrix3:!0,set:function(_l,Sl,El,Ml,Al,Pl,Ll,wl,Rl){var Cl=this.elements;return Cl[0]=_l,Cl[1]=Ml,Cl[2]=Ll,Cl[3]=Sl,Cl[4]=Al,Cl[5]=wl,Cl[6]=El,Cl[7]=Pl,Cl[8]=Rl,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(_l){var Sl=_l.elements;return this.set(Sl[0],Sl[3],Sl[6],Sl[1],Sl[4],Sl[7],Sl[2],Sl[5],Sl[8]),this},setFromMatrix4:function(_l){var Sl=_l.elements;return this.set(Sl[0],Sl[4],Sl[8],Sl[1],Sl[5],Sl[9],Sl[2],Sl[6],Sl[10]),this},applyToVector3Array:function(){var _l;return function(El,Ml,Al){_l==void 0&&(_l=new Z),Ml===void 0&&(Ml=0),Al===void 0&&(Al=El.length);for(var Pl=0,Ll=Ml;Pl<Al;Pl+=3,Ll+=3)_l.fromArray(El,Ll),_l.applyMatrix3(this),_l.toArray(El,Ll);return El}}(),applyToBufferAttribute:function(){var _l;return function(El){_l==void 0&&(_l=new Z);for(var Ml=0,Al=El.count;Ml<Al;Ml++)_l.x=El.getX(Ml),_l.y=El.getY(Ml),_l.z=El.getZ(Ml),_l.applyMatrix3(this),El.setXYZ(Ml,_l.x,_l.y,_l.z);return El}}(),multiplyScalar:function(_l){var Sl=this.elements;return Sl[0]*=_l,Sl[3]*=_l,Sl[6]*=_l,Sl[1]*=_l,Sl[4]*=_l,Sl[7]*=_l,Sl[2]*=_l,Sl[5]*=_l,Sl[8]*=_l,this},determinant:function(){var _l=this.elements,Sl=_l[0],El=_l[1],Ml=_l[2],Al=_l[3],Pl=_l[4],Ll=_l[5],wl=_l[6],Rl=_l[7],Cl=_l[8];return Sl*Pl*Cl-Sl*Ll*Rl-El*Al*Cl+El*Ll*wl+Ml*Al*Rl-Ml*Pl*wl},getInverse:function(_l,Sl){_l&&_l.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var El=_l.elements,Ml=this.elements,Al=El[0],Pl=El[1],Ll=El[2],wl=El[3],Rl=El[4],Cl=El[5],Il=El[6],Dl=El[7],Gl=El[8],Bl=Gl*Rl-Cl*Dl,Fl=Cl*Il-Gl*wl,Nl=Dl*wl-Rl*Il,Ul=Al*Bl+Pl*Fl+Ll*Nl;if(0==Ul){var Hl="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(!0===Sl)throw new Error(Hl);else console.warn(Hl);return this.identity()}var zl=1/Ul;return Ml[0]=Bl*zl,Ml[1]=(Ll*Dl-Gl*Pl)*zl,Ml[2]=(Cl*Pl-Ll*Rl)*zl,Ml[3]=Fl*zl,Ml[4]=(Gl*Al-Ll*Il)*zl,Ml[5]=(Ll*wl-Cl*Al)*zl,Ml[6]=Nl*zl,Ml[7]=(Pl*Il-Dl*Al)*zl,Ml[8]=(Rl*Al-Pl*wl)*zl,this},transpose:function(){var Sl=this.elements,_l;return _l=Sl[1],Sl[1]=Sl[3],Sl[3]=_l,_l=Sl[2],Sl[2]=Sl[6],Sl[6]=_l,_l=Sl[5],Sl[5]=Sl[7],Sl[7]=_l,this},getNormalMatrix:function(_l){return this.setFromMatrix4(_l).getInverse(this).transpose()},transposeIntoArray:function(_l){var Sl=this.elements;return _l[0]=Sl[0],_l[1]=Sl[3],_l[2]=Sl[6],_l[3]=Sl[1],_l[4]=Sl[4],_l[5]=Sl[7],_l[6]=Sl[2],_l[7]=Sl[5],_l[8]=Sl[8],this},fromArray:function(_l,Sl){Sl===void 0&&(Sl=0);for(var El=0;9>El;El++)this.elements[El]=_l[El+Sl];return this},toArray:function(_l,Sl){void 0===_l&&(_l=[]),void 0===Sl&&(Sl=0);var El=this.elements;return _l[Sl]=El[0],_l[Sl+1]=El[1],_l[Sl+2]=El[2],_l[Sl+3]=El[3],_l[Sl+4]=El[4],_l[Sl+5]=El[5],_l[Sl+6]=El[6],_l[Sl+7]=El[7],_l[Sl+8]=El[8],_l}},Qe.prototype={constructor:Qe,set:function(_l,Sl){return this.normal.copy(_l),this.constant=Sl,this},setComponents:function(_l,Sl,El,Ml){return this.normal.set(_l,Sl,El),this.constant=Ml,this},setFromNormalAndCoplanarPoint:function(_l,Sl){return this.normal.copy(_l),this.constant=-Sl.dot(this.normal),this},setFromCoplanarPoints:function(){var _l=new Z,Sl=new Z;return function(Ml,Al,Pl){var Ll=_l.subVectors(Pl,Al).cross(Sl.subVectors(Ml,Al)).normalize();return this.setFromNormalAndCoplanarPoint(Ll,Ml),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.normal.copy(_l.normal),this.constant=_l.constant,this},normalize:function(){var _l=1/this.normal.length();return this.normal.multiplyScalar(_l),this.constant*=_l,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(_l){return this.normal.dot(_l)+this.constant},distanceToSphere:function(_l){return this.distanceToPoint(_l.center)-_l.radius},projectPoint:function(_l,Sl){return this.orthoPoint(_l,Sl).sub(_l).negate()},orthoPoint:function(_l,Sl){var El=this.distanceToPoint(_l),Ml=Sl||new Z;return Ml.copy(this.normal).multiplyScalar(El)},intersectLine:function(){var _l=new Z;return function(El,Ml){var Al=Ml||new Z,Pl=El.delta(_l),Ll=this.normal.dot(Pl);if(0===Ll)return 0===this.distanceToPoint(El.start)?Al.copy(El.start):void 0;var wl=-(El.start.dot(this.normal)+this.constant)/Ll;return 0>wl||1<wl?void 0:Al.copy(Pl).multiplyScalar(wl).add(El.start)}}(),intersectsLine:function(_l){var Sl=this.distanceToPoint(_l.start),El=this.distanceToPoint(_l.end);return 0>Sl&&0<El||0>El&&0<Sl},intersectsBox:function(_l){return _l.intersectsPlane(this)},intersectsSphere:function(_l){return _l.intersectsPlane(this)},coplanarPoint:function(_l){var Sl=_l||new Z;return Sl.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var _l=new Z,Sl=new Ke;return function(Ml,Al){var Pl=this.coplanarPoint(_l).applyMatrix4(Ml),Ll=Al||Sl.getNormalMatrix(Ml),wl=this.normal.applyMatrix3(Ll).normalize();return this.constant=-Pl.dot(wl),this}}(),translate:function(_l){return this.constant=this.constant-_l.dot(this.normal),this},equals:function(_l){return _l.normal.equals(this.normal)&&_l.constant===this.constant}},Je.prototype={constructor:Je,set:function(_l,Sl,El,Ml,Al,Pl){var Ll=this.planes;return Ll[0].copy(_l),Ll[1].copy(Sl),Ll[2].copy(El),Ll[3].copy(Ml),Ll[4].copy(Al),Ll[5].copy(Pl),this},clone:function(){return new this.constructor().copy(this)},copy:function(_l){var Sl=this.planes;for(var El=0;6>El;El++)Sl[El].copy(_l.planes[El]);return this},setFromMatrix:function(_l){var Sl=this.planes,El=_l.elements,Ml=El[0],Al=El[1],Pl=El[2],Ll=El[3],wl=El[4],Rl=El[5],Cl=El[6],Il=El[7],Dl=El[8],Gl=El[9],Bl=El[10],Fl=El[11],Nl=El[12],Ul=El[13],Hl=El[14],zl=El[15];return Sl[0].setComponents(Ll-Ml,Il-wl,Fl-Dl,zl-Nl).normalize(),Sl[1].setComponents(Ll+Ml,Il+wl,Fl+Dl,zl+Nl).normalize(),Sl[2].setComponents(Ll+Al,Il+Rl,Fl+Gl,zl+Ul).normalize(),Sl[3].setComponents(Ll-Al,Il-Rl,Fl-Gl,zl-Ul).normalize(),Sl[4].setComponents(Ll-Pl,Il-Cl,Fl-Bl,zl-Hl).normalize(),Sl[5].setComponents(Ll+Pl,Il+Cl,Fl+Bl,zl+Hl).normalize(),this},intersectsObject:function(){var _l=new Ze;return function(El){var Ml=El.geometry;return null===Ml.boundingSphere&&Ml.computeBoundingSphere(),_l.copy(Ml.boundingSphere).applyMatrix4(El.matrixWorld),this.intersectsSphere(_l)}}(),intersectsSprite:function(){var _l=new Ze;return function(El){return _l.center.set(0,0,0),_l.radius=0.7071067811865476,_l.applyMatrix4(El.matrixWorld),this.intersectsSphere(_l)}}(),intersectsSphere:function(_l){var Sl=this.planes,El=_l.center,Ml=-_l.radius;for(var Al=0;6>Al;Al++){var Pl=Sl[Al].distanceToPoint(El);if(Pl<Ml)return!1}return!0},intersectsBox:function(){var _l=new Z,Sl=new Z;return function(Ml){var Al=this.planes;for(var Pl=0;6>Pl;Pl++){var Ll=Al[Pl];_l.x=0<Ll.normal.x?Ml.min.x:Ml.max.x,Sl.x=0<Ll.normal.x?Ml.max.x:Ml.min.x,_l.y=0<Ll.normal.y?Ml.min.y:Ml.max.y,Sl.y=0<Ll.normal.y?Ml.max.y:Ml.min.y,_l.z=0<Ll.normal.z?Ml.min.z:Ml.max.z,Sl.z=0<Ll.normal.z?Ml.max.z:Ml.min.z;var wl=Ll.distanceToPoint(_l),Rl=Ll.distanceToPoint(Sl);if(0>wl&&0>Rl)return!1}return!0}}(),containsPoint:function(_l){var Sl=this.planes;for(var El=0;6>El;El++)if(0>Sl[El].distanceToPoint(_l))return!1;return!0}},et.prototype={constructor:et,set:function(_l,Sl){return this.origin.copy(_l),this.direction.copy(Sl),this},clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.origin.copy(_l.origin),this.direction.copy(_l.direction),this},at:function(_l,Sl){var El=Sl||new Z;return El.copy(this.direction).multiplyScalar(_l).add(this.origin)},lookAt:function(_l){return this.direction.copy(_l).sub(this.origin).normalize(),this},recast:function(){var _l=new Z;return function(El){return this.origin.copy(this.at(El,_l)),this}}(),closestPointToPoint:function(_l,Sl){var El=Sl||new Z;El.subVectors(_l,this.origin);var Ml=El.dot(this.direction);return 0>Ml?El.copy(this.origin):El.copy(this.direction).multiplyScalar(Ml).add(this.origin)},distanceToPoint:function(_l){return Math.sqrt(this.distanceSqToPoint(_l))},distanceSqToPoint:function(){var _l=new Z;return function(El){var Ml=_l.subVectors(El,this.origin).dot(this.direction);return 0>Ml?this.origin.distanceToSquared(El):(_l.copy(this.direction).multiplyScalar(Ml).add(this.origin),_l.distanceToSquared(El))}}(),distanceSqToSegment:function(){var _l=new Z,Sl=new Z,El=new Z;return function(Al,Pl,Ll,wl){_l.copy(Al).add(Pl).multiplyScalar(0.5),Sl.copy(Pl).sub(Al).normalize(),El.copy(this.origin).sub(_l);var Rl=0.5*Al.distanceTo(Pl),Cl=-this.direction.dot(Sl),Il=El.dot(this.direction),Dl=-El.dot(Sl),Gl=El.lengthSq(),Bl=Math.abs(1-Cl*Cl),Fl,Nl,Ul,Hl;if(!(0<Bl))Nl=0<Cl?-Rl:Rl,Fl=Math.max(0,-(Cl*Nl+Il)),Ul=-Fl*Fl+Nl*(Nl+2*Dl)+Gl;else if(Fl=Cl*Dl-Il,Nl=Cl*Il-Dl,Hl=Rl*Bl,!(0<=Fl))Nl<=-Hl?(Fl=Math.max(0,-(-Cl*Rl+Il)),Nl=0<Fl?-Rl:Math.min(Math.max(-Rl,-Dl),Rl),Ul=-Fl*Fl+Nl*(Nl+2*Dl)+Gl):Nl<=Hl?(Fl=0,Nl=Math.min(Math.max(-Rl,-Dl),Rl),Ul=Nl*(Nl+2*Dl)+Gl):(Fl=Math.max(0,-(Cl*Rl+Il)),Nl=0<Fl?Rl:Math.min(Math.max(-Rl,-Dl),Rl),Ul=-Fl*Fl+Nl*(Nl+2*Dl)+Gl);else if(!(Nl>=-Hl))Nl=-Rl,Fl=Math.max(0,-(Cl*Nl+Il)),Ul=-Fl*Fl+Nl*(Nl+2*Dl)+Gl;else if(Nl<=Hl){var zl=1/Bl;Fl*=zl,Nl*=zl,Ul=Fl*(Fl+Cl*Nl+2*Il)+Nl*(Cl*Fl+Nl+2*Dl)+Gl}else Nl=Rl,Fl=Math.max(0,-(Cl*Nl+Il)),Ul=-Fl*Fl+Nl*(Nl+2*Dl)+Gl;return Ll&&Ll.copy(this.direction).multiplyScalar(Fl).add(this.origin),wl&&wl.copy(Sl).multiplyScalar(Nl).add(_l),Ul}}(),intersectSphere:function(){var _l=new Z;return function(El,Ml){_l.subVectors(El.center,this.origin);var Al=_l.dot(this.direction),Pl=_l.dot(_l)-Al*Al,Ll=El.radius*El.radius;if(Pl>Ll)return null;var wl=Math.sqrt(Ll-Pl),Rl=Al-wl,Cl=Al+wl;return 0>Rl&&0>Cl?null:0>Rl?this.at(Cl,Ml):this.at(Rl,Ml)}}(),intersectsSphere:function(_l){return this.distanceToPoint(_l.center)<=_l.radius},distanceToPlane:function(_l){var Sl=_l.normal.dot(this.direction);if(0===Sl)return 0===_l.distanceToPoint(this.origin)?0:null;var El=-(this.origin.dot(_l.normal)+_l.constant)/Sl;return 0<=El?El:null},intersectPlane:function(_l,Sl){var El=this.distanceToPlane(_l);return null===El?null:this.at(El,Sl)},intersectsPlane:function(_l){var Sl=_l.distanceToPoint(this.origin);if(0===Sl)return!0;var El=_l.normal.dot(this.direction);return!!(0>El*Sl)},intersectBox:function(_l,Sl){var Rl=1/this.direction.x,Cl=1/this.direction.y,Il=1/this.direction.z,Dl=this.origin,El,Ml,Al,Pl,Ll,wl;return(0<=Rl?(El=(_l.min.x-Dl.x)*Rl,Ml=(_l.max.x-Dl.x)*Rl):(El=(_l.max.x-Dl.x)*Rl,Ml=(_l.min.x-Dl.x)*Rl),0<=Cl?(Al=(_l.min.y-Dl.y)*Cl,Pl=(_l.max.y-Dl.y)*Cl):(Al=(_l.max.y-Dl.y)*Cl,Pl=(_l.min.y-Dl.y)*Cl),El>Pl||Al>Ml)?null:((Al>El||El!=El)&&(El=Al),(Pl<Ml||Ml!=Ml)&&(Ml=Pl),0<=Il?(Ll=(_l.min.z-Dl.z)*Il,wl=(_l.max.z-Dl.z)*Il):(Ll=(_l.max.z-Dl.z)*Il,wl=(_l.min.z-Dl.z)*Il),El>wl||Ll>Ml)?null:((Ll>El||El!=El)&&(El=Ll),(wl<Ml||Ml!=Ml)&&(Ml=wl),0>Ml?null:this.at(0<=El?El:Ml,Sl))},intersectsBox:function(){var _l=new Z;return function(El){return null!==this.intersectBox(El,_l)}}(),intersectTriangle:function(){var _l=new Z,Sl=new Z,El=new Z,Ml=new Z;return function(Pl,Ll,wl,Rl,Cl){Sl.subVectors(Ll,Pl),El.subVectors(wl,Pl),Ml.crossVectors(Sl,El);var Il=this.direction.dot(Ml),Dl;if(0<Il){if(Rl)return null;Dl=1}else if(0>Il)Dl=-1,Il=-Il;else return null;_l.subVectors(this.origin,Pl);var Gl=Dl*this.direction.dot(El.crossVectors(_l,El));if(0>Gl)return null;var Bl=Dl*this.direction.dot(Sl.cross(_l));if(0>Bl)return null;if(Gl+Bl>Il)return null;var Fl=-Dl*_l.dot(Ml);return 0>Fl?null:this.at(Fl/Il,Cl)}}(),applyMatrix4:function(_l){return this.direction.add(this.origin).applyMatrix4(_l),this.origin.applyMatrix4(_l),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(_l){return _l.origin.equals(this.origin)&&_l.direction.equals(this.direction)}},tt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],tt.DefaultOrder="XYZ",tt.prototype={constructor:tt,isEuler:!0,get x(){return this._x},set x(_l){this._x=_l,this.onChangeCallback()},get y(){return this._y},set y(_l){this._y=_l,this.onChangeCallback()},get z(){return this._z},set z(_l){this._z=_l,this.onChangeCallback()},get order(){return this._order},set order(_l){this._order=_l,this.onChangeCallback()},set:function(_l,Sl,El,Ml){return this._x=_l,this._y=Sl,this._z=El,this._order=Ml||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(_l){return this._x=_l._x,this._y=_l._y,this._z=_l._z,this._order=_l._order,this.onChangeCallback(),this},setFromRotationMatrix:function(_l,Sl,El){var Ml=Ls.clamp,Al=_l.elements,Pl=Al[0],Ll=Al[4],wl=Al[8],Rl=Al[1],Cl=Al[5],Il=Al[9],Dl=Al[2],Gl=Al[6],Bl=Al[10];return Sl=Sl||this._order,"XYZ"===Sl?(this._y=Math.asin(Ml(wl,-1,1)),0.99999>Math.abs(wl)?(this._x=Math.atan2(-Il,Bl),this._z=Math.atan2(-Ll,Pl)):(this._x=Math.atan2(Gl,Cl),this._z=0)):"YXZ"===Sl?(this._x=Math.asin(-Ml(Il,-1,1)),0.99999>Math.abs(Il)?(this._y=Math.atan2(wl,Bl),this._z=Math.atan2(Rl,Cl)):(this._y=Math.atan2(-Dl,Pl),this._z=0)):"ZXY"===Sl?(this._x=Math.asin(Ml(Gl,-1,1)),0.99999>Math.abs(Gl)?(this._y=Math.atan2(-Dl,Bl),this._z=Math.atan2(-Ll,Cl)):(this._y=0,this._z=Math.atan2(Rl,Pl))):"ZYX"===Sl?(this._y=Math.asin(-Ml(Dl,-1,1)),0.99999>Math.abs(Dl)?(this._x=Math.atan2(Gl,Bl),this._z=Math.atan2(Rl,Pl)):(this._x=0,this._z=Math.atan2(-Ll,Cl))):"YZX"===Sl?(this._z=Math.asin(Ml(Rl,-1,1)),0.99999>Math.abs(Rl)?(this._x=Math.atan2(-Il,Cl),this._y=Math.atan2(-Dl,Pl)):(this._x=0,this._y=Math.atan2(wl,Bl))):"XZY"===Sl?(this._z=Math.asin(-Ml(Ll,-1,1)),0.99999>Math.abs(Ll)?(this._x=Math.atan2(Gl,Cl),this._y=Math.atan2(wl,Pl)):(this._x=Math.atan2(-Il,Bl),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+Sl),this._order=Sl,!1!==El&&this.onChangeCallback(),this},setFromQuaternion:function(){var _l;return function(El,Ml,Al){return void 0==_l&&(_l=new K),_l.makeRotationFromQuaternion(El),this.setFromRotationMatrix(_l,Ml,Al)}}(),setFromVector3:function(_l,Sl){return this.set(_l.x,_l.y,_l.z,Sl||this._order)},reorder:function(){var _l=new Y;return function(El){return _l.setFromEuler(this),this.setFromQuaternion(_l,El)}}(),equals:function(_l){return _l._x===this._x&&_l._y===this._y&&_l._z===this._z&&_l._order===this._order},fromArray:function(_l){return this._x=_l[0],this._y=_l[1],this._z=_l[2],void 0!==_l[3]&&(this._order=_l[3]),this.onChangeCallback(),this},toArray:function(_l,Sl){return void 0===_l&&(_l=[]),void 0===Sl&&(Sl=0),_l[Sl]=this._x,_l[Sl+1]=this._y,_l[Sl+2]=this._z,_l[Sl+3]=this._order,_l},toVector3:function(_l){return _l?_l.set(this._x,this._y,this._z):new Z(this._x,this._y,this._z)},onChange:function(_l){return this.onChangeCallback=_l,this},onChangeCallback:function(){}},rt.prototype={constructor:rt,set:function(_l){this.mask=1<<_l},enable:function(_l){this.mask|=1<<_l},toggle:function(_l){this.mask^=1<<_l},disable:function(_l){this.mask&=~(1<<_l)},test:function(_l){return 0!=(this.mask&_l.mask)}};var Os=0;at.DefaultUp=new Z(0,1,0),at.DefaultMatrixAutoUpdate=!0,Object.assign(at.prototype,F.prototype,{isObject3D:!0,applyMatrix:function(_l){this.matrix.multiplyMatrices(_l,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(_l,Sl){this.quaternion.setFromAxisAngle(_l,Sl)},setRotationFromEuler:function(_l){this.quaternion.setFromEuler(_l,!0)},setRotationFromMatrix:function(_l){this.quaternion.setFromRotationMatrix(_l)},setRotationFromQuaternion:function(_l){this.quaternion.copy(_l)},rotateOnAxis:function(){var _l=new Y;return function(El,Ml){return _l.setFromAxisAngle(El,Ml),this.quaternion.multiply(_l),this}}(),rotateX:function(){var _l=new Z(1,0,0);return function(El){return this.rotateOnAxis(_l,El)}}(),rotateY:function(){var _l=new Z(0,1,0);return function(El){return this.rotateOnAxis(_l,El)}}(),rotateZ:function(){var _l=new Z(0,0,1);return function(El){return this.rotateOnAxis(_l,El)}}(),translateOnAxis:function(){var _l=new Z;return function(El,Ml){return _l.copy(El).applyQuaternion(this.quaternion),this.position.add(_l.multiplyScalar(Ml)),this}}(),translateX:function(){var _l=new Z(1,0,0);return function(El){return this.translateOnAxis(_l,El)}}(),translateY:function(){var _l=new Z(0,1,0);return function(El){return this.translateOnAxis(_l,El)}}(),translateZ:function(){var _l=new Z(0,0,1);return function(El){return this.translateOnAxis(_l,El)}}(),localToWorld:function(_l){return _l.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var _l=new K;return function(El){return El.applyMatrix4(_l.getInverse(this.matrixWorld))}}(),lookAt:function(){var _l=new K;return function(El){_l.lookAt(El,this.position,this.up),this.quaternion.setFromRotationMatrix(_l)}}(),add:function(_l){if(1<arguments.length){for(var Sl=0;Sl<arguments.length;Sl++)this.add(arguments[Sl]);return this}return _l===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_l),this):(_l&&_l.isObject3D?(null!==_l.parent&&_l.parent.remove(_l),_l.parent=this,_l.dispatchEvent({type:"added"}),this.children.push(_l)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_l),this)},remove:function(_l){if(1<arguments.length)for(var Sl=0;Sl<arguments.length;Sl++)this.remove(arguments[Sl]);var El=this.children.indexOf(_l);-1!==El&&(_l.parent=null,_l.dispatchEvent({type:"removed"}),this.children.splice(El,1))},getObjectById:function(_l){return this.getObjectByProperty("id",_l)},getObjectByName:function(_l){return this.getObjectByProperty("name",_l)},getObjectByProperty:function(_l,Sl){if(this[_l]===Sl)return this;for(var El=0,Ml=this.children.length;El<Ml;El++){var Al=this.children[El],Pl=Al.getObjectByProperty(_l,Sl);if(Pl!==void 0)return Pl}return void 0},getWorldPosition:function(_l){var Sl=_l||new Z;return this.updateMatrixWorld(!0),Sl.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var _l=new Z,Sl=new Z;return function(Ml){var Al=Ml||new Y;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(_l,Al,Sl),Al}}(),getWorldRotation:function(){var _l=new Y;return function(El){var Ml=El||new tt;return this.getWorldQuaternion(_l),Ml.setFromQuaternion(_l,this.rotation.order,!1)}}(),getWorldScale:function(){var _l=new Z,Sl=new Y;return function(Ml){var Al=Ml||new Z;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(_l,Sl,Al),Al}}(),getWorldDirection:function(){var _l=new Y;return function(El){var Ml=El||new Z;return this.getWorldQuaternion(_l),Ml.set(0,0,1).applyQuaternion(_l)}}(),raycast:function(){},traverse:function(_l){_l(this);var Sl=this.children;for(var El=0,Ml=Sl.length;El<Ml;El++)Sl[El].traverse(_l)},traverseVisible:function(_l){if(!1!==this.visible){_l(this);var Sl=this.children;for(var El=0,Ml=Sl.length;El<Ml;El++)Sl[El].traverseVisible(_l)}},traverseAncestors:function(_l){var Sl=this.parent;null!==Sl&&(_l(Sl),Sl.traverseAncestors(_l))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(_l){!0===this.matrixAutoUpdate&&this.updateMatrix(),(!0===this.matrixWorldNeedsUpdate||!0===_l)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,_l=!0);var Sl=this.children;for(var El=0,Ml=Sl.length;El<Ml;El++)Sl[El].updateMatrixWorld(_l)},toJSON:function(_l){function Sl(Il){var Dl=[];for(var Gl in Il){var Bl=Il[Gl];delete Bl.metadata,Dl.push(Bl)}return Dl}var El=void 0===_l||""===_l,Ml={};El&&(_l={geometries:{},materials:{},textures:{},images:{}},Ml.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var Al={};if(Al.uuid=this.uuid,Al.type=this.type,""!==this.name&&(Al.name=this.name),"{}"!==JSON.stringify(this.userData)&&(Al.userData=this.userData),!0===this.castShadow&&(Al.castShadow=!0),!0===this.receiveShadow&&(Al.receiveShadow=!0),!1===this.visible&&(Al.visible=!1),Al.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===_l.geometries[this.geometry.uuid]&&(_l.geometries[this.geometry.uuid]=this.geometry.toJSON(_l)),Al.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===_l.materials[this.material.uuid]&&(_l.materials[this.material.uuid]=this.material.toJSON(_l)),Al.material=this.material.uuid),0<this.children.length){Al.children=[];for(var Pl=0;Pl<this.children.length;Pl++)Al.children.push(this.children[Pl].toJSON(_l).object)}if(El){var Ll=Sl(_l.geometries),wl=Sl(_l.materials),Rl=Sl(_l.textures),Cl=Sl(_l.images);0<Ll.length&&(Ml.geometries=Ll),0<wl.length&&(Ml.materials=wl),0<Rl.length&&(Ml.textures=Rl),0<Cl.length&&(Ml.images=Cl)}return Ml.object=Al,Ml},clone:function(_l){return new this.constructor().copy(this,_l)},copy:function(_l,Sl){if(void 0===Sl&&(Sl=!0),this.name=_l.name,this.up.copy(_l.up),this.position.copy(_l.position),this.quaternion.copy(_l.quaternion),this.scale.copy(_l.scale),this.matrix.copy(_l.matrix),this.matrixWorld.copy(_l.matrixWorld),this.matrixAutoUpdate=_l.matrixAutoUpdate,this.matrixWorldNeedsUpdate=_l.matrixWorldNeedsUpdate,this.layers.mask=_l.layers.mask,this.visible=_l.visible,this.castShadow=_l.castShadow,this.receiveShadow=_l.receiveShadow,this.frustumCulled=_l.frustumCulled,this.renderOrder=_l.renderOrder,this.userData=JSON.parse(JSON.stringify(_l.userData)),!0===Sl)for(var El=0;El<_l.children.length;El++){var Ml=_l.children[El];this.add(Ml.clone())}return this}}),ot.prototype={constructor:ot,set:function(_l,Sl){return this.start.copy(_l),this.end.copy(Sl),this},clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.start.copy(_l.start),this.end.copy(_l.end),this},getCenter:function(_l){var Sl=_l||new Z;return Sl.addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(_l){var Sl=_l||new Z;return Sl.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(_l,Sl){var El=Sl||new Z;return this.delta(El).multiplyScalar(_l).add(this.start)},closestPointToPointParameter:function(){var _l=new Z,Sl=new Z;return function(Ml,Al){_l.subVectors(Ml,this.start),Sl.subVectors(this.end,this.start);var Pl=Sl.dot(Sl),Ll=Sl.dot(_l),wl=Ll/Pl;return Al&&(wl=Ls.clamp(wl,0,1)),wl}}(),closestPointToPoint:function(_l,Sl,El){var Ml=this.closestPointToPointParameter(_l,Sl),Al=El||new Z;return this.delta(Al).multiplyScalar(Ml).add(this.start)},applyMatrix4:function(_l){return this.start.applyMatrix4(_l),this.end.applyMatrix4(_l),this},equals:function(_l){return _l.start.equals(this.start)&&_l.end.equals(this.end)}},it.normal=function(){var _l=new Z;return function(El,Ml,Al,Pl){var Ll=Pl||new Z;Ll.subVectors(Al,Ml),_l.subVectors(El,Ml),Ll.cross(_l);var wl=Ll.lengthSq();return 0<wl?Ll.multiplyScalar(1/Math.sqrt(wl)):Ll.set(0,0,0)}}(),it.barycoordFromPoint=function(){var _l=new Z,Sl=new Z,El=new Z;return function(Al,Pl,Ll,wl,Rl){_l.subVectors(wl,Pl),Sl.subVectors(Ll,Pl),El.subVectors(Al,Pl);var Cl=_l.dot(_l),Il=_l.dot(Sl),Dl=_l.dot(El),Gl=Sl.dot(Sl),Bl=Sl.dot(El),Fl=Cl*Gl-Il*Il,Nl=Rl||new Z;if(0==Fl)return Nl.set(-2,-1,-1);var Ul=1/Fl,Hl=(Gl*Dl-Il*Bl)*Ul,zl=(Cl*Bl-Il*Dl)*Ul;return Nl.set(1-Hl-zl,zl,Hl)}}(),it.containsPoint=function(){var _l=new Z;return function(El,Ml,Al,Pl){var Ll=it.barycoordFromPoint(El,Ml,Al,Pl,_l);return 0<=Ll.x&&0<=Ll.y&&1>=Ll.x+Ll.y}}(),it.prototype={constructor:it,set:function(_l,Sl,El){return this.a.copy(_l),this.b.copy(Sl),this.c.copy(El),this},setFromPointsAndIndices:function(_l,Sl,El,Ml){return this.a.copy(_l[Sl]),this.b.copy(_l[El]),this.c.copy(_l[Ml]),this},clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.a.copy(_l.a),this.b.copy(_l.b),this.c.copy(_l.c),this},area:function(){var _l=new Z,Sl=new Z;return function(){return _l.subVectors(this.c,this.b),Sl.subVectors(this.a,this.b),0.5*_l.cross(Sl).length()}}(),midpoint:function(_l){var Sl=_l||new Z;return Sl.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(_l){return it.normal(this.a,this.b,this.c,_l)},plane:function(_l){var Sl=_l||new Qe;return Sl.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(_l,Sl){return it.barycoordFromPoint(_l,this.a,this.b,this.c,Sl)},containsPoint:function(_l){return it.containsPoint(_l,this.a,this.b,this.c)},closestPointToPoint:function(){var _l,Sl,El,Ml;return function(Pl,Ll){void 0==_l&&(_l=new Qe,Sl=[new ot,new ot,new ot],El=new Z,Ml=new Z);var wl=Ll||new Z,Rl=1/0;if(_l.setFromCoplanarPoints(this.a,this.b,this.c),_l.projectPoint(Pl,El),!0===this.containsPoint(El))wl.copy(El);else{Sl[0].set(this.a,this.b),Sl[1].set(this.b,this.c),Sl[2].set(this.c,this.a);for(var Cl=0;Cl<Sl.length;Cl++){Sl[Cl].closestPointToPoint(El,!0,Ml);var Il=El.distanceToSquared(Ml);Il<Rl&&(Rl=Il,wl.copy(Ml))}}return wl}}(),equals:function(_l){return _l.a.equals(this.a)&&_l.b.equals(this.b)&&_l.c.equals(this.c)}},nt.prototype={constructor:nt,clone:function(){return new this.constructor().copy(this)},copy:function(_l){this.a=_l.a,this.b=_l.b,this.c=_l.c,this.normal.copy(_l.normal),this.color.copy(_l.color),this.materialIndex=_l.materialIndex;for(var Sl=0,El=_l.vertexNormals.length;Sl<El;Sl++)this.vertexNormals[Sl]=_l.vertexNormals[Sl].clone();for(var Sl=0,El=_l.vertexColors.length;Sl<El;Sl++)this.vertexColors[Sl]=_l.vertexColors[Sl].clone();return this}},st.prototype=Object.create(Xe.prototype),st.prototype.constructor=st,st.prototype.isMeshBasicMaterial=!0,st.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.color.copy(_l.color),this.map=_l.map,this.lightMap=_l.lightMap,this.lightMapIntensity=_l.lightMapIntensity,this.aoMap=_l.aoMap,this.aoMapIntensity=_l.aoMapIntensity,this.specularMap=_l.specularMap,this.alphaMap=_l.alphaMap,this.envMap=_l.envMap,this.combine=_l.combine,this.reflectivity=_l.reflectivity,this.refractionRatio=_l.refractionRatio,this.wireframe=_l.wireframe,this.wireframeLinewidth=_l.wireframeLinewidth,this.wireframeLinecap=_l.wireframeLinecap,this.wireframeLinejoin=_l.wireframeLinejoin,this.skinning=_l.skinning,this.morphTargets=_l.morphTargets,this},lt.prototype={constructor:lt,isBufferAttribute:!0,set needsUpdate(_l){!0===_l&&this.version++},setArray:function(_l){if(Array.isArray(_l))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=_l===void 0?0:_l.length/this.itemSize,this.array=_l},setDynamic:function(_l){return this.dynamic=_l,this},copy:function(_l){return this.array=new _l.array.constructor(_l.array),this.itemSize=_l.itemSize,this.count=_l.count,this.normalized=_l.normalized,this.dynamic=_l.dynamic,this},copyAt:function(_l,Sl,El){_l*=this.itemSize,El*=Sl.itemSize;for(var Ml=0,Al=this.itemSize;Ml<Al;Ml++)this.array[_l+Ml]=Sl.array[El+Ml];return this},copyArray:function(_l){return this.array.set(_l),this},copyColorsArray:function(_l){var Sl=this.array,El=0;for(var Ml=0,Al=_l.length;Ml<Al;Ml++){var Pl=_l[Ml];Pl===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",Ml),Pl=new ze),Sl[El++]=Pl.r,Sl[El++]=Pl.g,Sl[El++]=Pl.b}return this},copyIndicesArray:function(_l){var Sl=this.array,El=0;for(var Ml=0,Al=_l.length;Ml<Al;Ml++){var Pl=_l[Ml];Sl[El++]=Pl.a,Sl[El++]=Pl.b,Sl[El++]=Pl.c}return this},copyVector2sArray:function(_l){var Sl=this.array,El=0;for(var Ml=0,Al=_l.length;Ml<Al;Ml++){var Pl=_l[Ml];Pl===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",Ml),Pl=new H),Sl[El++]=Pl.x,Sl[El++]=Pl.y}return this},copyVector3sArray:function(_l){var Sl=this.array,El=0;for(var Ml=0,Al=_l.length;Ml<Al;Ml++){var Pl=_l[Ml];Pl===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",Ml),Pl=new Z),Sl[El++]=Pl.x,Sl[El++]=Pl.y,Sl[El++]=Pl.z}return this},copyVector4sArray:function(_l){var Sl=this.array,El=0;for(var Ml=0,Al=_l.length;Ml<Al;Ml++){var Pl=_l[Ml];Pl===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",Ml),Pl=new V),Sl[El++]=Pl.x,Sl[El++]=Pl.y,Sl[El++]=Pl.z,Sl[El++]=Pl.w}return this},set:function(_l,Sl){return void 0===Sl&&(Sl=0),this.array.set(_l,Sl),this},getX:function(_l){return this.array[_l*this.itemSize]},setX:function(_l,Sl){return this.array[_l*this.itemSize]=Sl,this},getY:function(_l){return this.array[_l*this.itemSize+1]},setY:function(_l,Sl){return this.array[_l*this.itemSize+1]=Sl,this},getZ:function(_l){return this.array[_l*this.itemSize+2]},setZ:function(_l,Sl){return this.array[_l*this.itemSize+2]=Sl,this},getW:function(_l){return this.array[_l*this.itemSize+3]},setW:function(_l,Sl){return this.array[_l*this.itemSize+3]=Sl,this},setXY:function(_l,Sl,El){return _l*=this.itemSize,this.array[_l+0]=Sl,this.array[_l+1]=El,this},setXYZ:function(_l,Sl,El,Ml){return _l*=this.itemSize,this.array[_l+0]=Sl,this.array[_l+1]=El,this.array[_l+2]=Ml,this},setXYZW:function(_l,Sl,El,Ml,Al){return _l*=this.itemSize,this.array[_l+0]=Sl,this.array[_l+1]=El,this.array[_l+2]=Ml,this.array[_l+3]=Al,this},onUpload:function(_l){return this.onUploadCallback=_l,this},clone:function(){return new this.constructor().copy(this)}},dt.prototype=Object.create(lt.prototype),dt.prototype.constructor=dt,ct.prototype=Object.create(lt.prototype),ct.prototype.constructor=ct,ut.prototype=Object.create(lt.prototype),ut.prototype.constructor=ut,mt.prototype=Object.create(lt.prototype),mt.prototype.constructor=mt,ft.prototype=Object.create(lt.prototype),ft.prototype.constructor=ft,gt.prototype=Object.create(lt.prototype),gt.prototype.constructor=gt,ht.prototype=Object.create(lt.prototype),ht.prototype.constructor=ht,yt.prototype=Object.create(lt.prototype),yt.prototype.constructor=yt,xt.prototype=Object.create(lt.prototype),xt.prototype.constructor=xt,Object.assign(Tt.prototype,{computeGroups:function(_l){var Sl,El=[],Ml=void 0,Al=_l.faces;for(var Pl=0;Pl<Al.length;Pl++){var Ll=Al[Pl];Ll.materialIndex!==Ml&&(Ml=Ll.materialIndex,Sl!=void 0&&(Sl.count=3*Pl-Sl.start,El.push(Sl)),Sl={start:3*Pl,materialIndex:Ml})}Sl!==void 0&&(Sl.count=3*Pl-Sl.start,El.push(Sl)),this.groups=El},fromGeometry:function(_l){var Sl=_l.faces,El=_l.vertices,Ml=_l.faceVertexUvs,Al=Ml[0]&&0<Ml[0].length,Pl=Ml[1]&&0<Ml[1].length,Ll=_l.morphTargets,wl=Ll.length,Rl;if(0<wl){Rl=[];for(var Cl=0;Cl<wl;Cl++)Rl[Cl]=[];this.morphTargets.position=Rl}var Il=_l.morphNormals,Dl=Il.length,Gl;if(0<Dl){Gl=[];for(var Cl=0;Cl<Dl;Cl++)Gl[Cl]=[];this.morphTargets.normal=Gl}var Bl=_l.skinIndices,Fl=_l.skinWeights,Nl=Bl.length===El.length,Ul=Fl.length===El.length;for(var Cl=0;Cl<Sl.length;Cl++){var Hl=Sl[Cl];this.vertices.push(El[Hl.a],El[Hl.b],El[Hl.c]);var zl=Hl.vertexNormals;if(3===zl.length)this.normals.push(zl[0],zl[1],zl[2]);else{var Ol=Hl.normal;this.normals.push(Ol,Ol,Ol)}var Vl=Hl.vertexColors;if(3===Vl.length)this.colors.push(Vl[0],Vl[1],Vl[2]);else{var Wl=Hl.color;this.colors.push(Wl,Wl,Wl)}if(!0===Al){var Xl=Ml[0][Cl];void 0===Xl?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",Cl),this.uvs.push(new H,new H,new H)):this.uvs.push(Xl[0],Xl[1],Xl[2])}if(!0===Pl){var Xl=Ml[1][Cl];void 0===Xl?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",Cl),this.uvs2.push(new H,new H,new H)):this.uvs2.push(Xl[0],Xl[1],Xl[2])}for(var Yl=0;Yl<wl;Yl++){var ql=Ll[Yl].vertices;Rl[Yl].push(ql[Hl.a],ql[Hl.b],ql[Hl.c])}for(var Yl=0;Yl<Dl;Yl++){var Zl=Il[Yl].vertexNormals[Cl];Gl[Yl].push(Zl.a,Zl.b,Zl.c)}Nl&&this.skinIndices.push(Bl[Hl.a],Bl[Hl.b],Bl[Hl.c]),Ul&&this.skinWeights.push(Fl[Hl.a],Fl[Hl.b],Fl[Hl.c])}return this.computeGroups(_l),this.verticesNeedUpdate=_l.verticesNeedUpdate,this.normalsNeedUpdate=_l.normalsNeedUpdate,this.colorsNeedUpdate=_l.colorsNeedUpdate,this.uvsNeedUpdate=_l.uvsNeedUpdate,this.groupsNeedUpdate=_l.groupsNeedUpdate,this}}),Object.assign(vt.prototype,F.prototype,{isGeometry:!0,applyMatrix:function(_l){var Sl=new Ke().getNormalMatrix(_l);for(var El=0,Ml=this.vertices.length;El<Ml;El++){var Al=this.vertices[El];Al.applyMatrix4(_l)}for(var El=0,Ml=this.faces.length;El<Ml;El++){var Pl=this.faces[El];Pl.normal.applyMatrix3(Sl).normalize();for(var Ll=0,wl=Pl.vertexNormals.length;Ll<wl;Ll++)Pl.vertexNormals[Ll].applyMatrix3(Sl).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var _l;return function(El){return void 0==_l&&(_l=new K),_l.makeRotationX(El),this.applyMatrix(_l),this}}(),rotateY:function(){var _l;return function(El){return void 0==_l&&(_l=new K),_l.makeRotationY(El),this.applyMatrix(_l),this}}(),rotateZ:function(){var _l;return function(El){return void 0==_l&&(_l=new K),_l.makeRotationZ(El),this.applyMatrix(_l),this}}(),translate:function(){var _l;return function(El,Ml,Al){return void 0==_l&&(_l=new K),_l.makeTranslation(El,Ml,Al),this.applyMatrix(_l),this}}(),scale:function(){var _l;return function(El,Ml,Al){return void 0==_l&&(_l=new K),_l.makeScale(El,Ml,Al),this.applyMatrix(_l),this}}(),lookAt:function(){var _l;return function(El){_l==void 0&&(_l=new at),_l.lookAt(El),_l.updateMatrix(),this.applyMatrix(_l.matrix)}}(),fromBufferGeometry:function(_l){function Sl(Ol,Vl,Wl,Xl){var Yl=void 0===Ll?[]:[Il[Ol].clone(),Il[Vl].clone(),Il[Wl].clone()],ql=void 0===wl?[]:[El.colors[Ol].clone(),El.colors[Vl].clone(),El.colors[Wl].clone()],Zl=new nt(Ol,Vl,Wl,Yl,ql,Xl);El.faces.push(Zl),void 0!==Rl&&El.faceVertexUvs[0].push([Dl[Ol].clone(),Dl[Vl].clone(),Dl[Wl].clone()]),void 0!==Cl&&El.faceVertexUvs[1].push([Gl[Ol].clone(),Gl[Vl].clone(),Gl[Wl].clone()])}var El=this,Ml=null===_l.index?void 0:_l.index.array,Al=_l.attributes,Pl=Al.position.array,Ll=void 0===Al.normal?void 0:Al.normal.array,wl=void 0===Al.color?void 0:Al.color.array,Rl=void 0===Al.uv?void 0:Al.uv.array,Cl=void 0===Al.uv2?void 0:Al.uv2.array;void 0!==Cl&&(this.faceVertexUvs[1]=[]);var Il=[],Dl=[],Gl=[];for(var Bl=0,Fl=0;Bl<Pl.length;Bl+=3,Fl+=2)El.vertices.push(new Z(Pl[Bl],Pl[Bl+1],Pl[Bl+2])),void 0!==Ll&&Il.push(new Z(Ll[Bl],Ll[Bl+1],Ll[Bl+2])),void 0!==wl&&El.colors.push(new ze(wl[Bl],wl[Bl+1],wl[Bl+2])),void 0!==Rl&&Dl.push(new H(Rl[Fl],Rl[Fl+1])),void 0!==Cl&&Gl.push(new H(Cl[Fl],Cl[Fl+1]));if(void 0!==Ml){var Nl=_l.groups;if(0<Nl.length)for(var Bl=0;Bl<Nl.length;Bl++){var Ul=Nl[Bl],Hl=Ul.start,zl=Ul.count;for(var Fl=Hl;Fl<Hl+zl;Fl+=3)Sl(Ml[Fl],Ml[Fl+1],Ml[Fl+2],Ul.materialIndex)}else for(var Bl=0;Bl<Ml.length;Bl+=3)Sl(Ml[Bl],Ml[Bl+1],Ml[Bl+2])}else for(var Bl=0;Bl<Pl.length/3;Bl+=3)Sl(Bl,Bl+1,Bl+2);return this.computeFaceNormals(),null!==_l.boundingBox&&(this.boundingBox=_l.boundingBox.clone()),null!==_l.boundingSphere&&(this.boundingSphere=_l.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var _l=this.boundingBox.getCenter().negate();return this.translate(_l.x,_l.y,_l.z),_l},normalize:function(){this.computeBoundingSphere();var _l=this.boundingSphere.center,Sl=this.boundingSphere.radius,El=0===Sl?1:1/Sl,Ml=new K;return Ml.set(El,0,0,-El*_l.x,0,El,0,-El*_l.y,0,0,El,-El*_l.z,0,0,0,1),this.applyMatrix(Ml),this},computeFaceNormals:function(){var _l=new Z,Sl=new Z;for(var El=0,Ml=this.faces.length;El<Ml;El++){var Al=this.faces[El],Pl=this.vertices[Al.a],Ll=this.vertices[Al.b],wl=this.vertices[Al.c];_l.subVectors(wl,Ll),Sl.subVectors(Pl,Ll),_l.cross(Sl),_l.normalize(),Al.normal.copy(_l)}},computeVertexNormals:function(_l){_l===void 0&&(_l=!0);var Sl,El,Ml,Al,Pl,Ll;for(Ll=Array(this.vertices.length),Sl=0,El=this.vertices.length;Sl<El;Sl++)Ll[Sl]=new Z;if(_l){var wl,Rl,Cl,Il=new Z,Dl=new Z;for(Ml=0,Al=this.faces.length;Ml<Al;Ml++)Pl=this.faces[Ml],wl=this.vertices[Pl.a],Rl=this.vertices[Pl.b],Cl=this.vertices[Pl.c],Il.subVectors(Cl,Rl),Dl.subVectors(wl,Rl),Il.cross(Dl),Ll[Pl.a].add(Il),Ll[Pl.b].add(Il),Ll[Pl.c].add(Il)}else for(this.computeFaceNormals(),Ml=0,Al=this.faces.length;Ml<Al;Ml++)Pl=this.faces[Ml],Ll[Pl.a].add(Pl.normal),Ll[Pl.b].add(Pl.normal),Ll[Pl.c].add(Pl.normal);for(Sl=0,El=this.vertices.length;Sl<El;Sl++)Ll[Sl].normalize();for(Ml=0,Al=this.faces.length;Ml<Al;Ml++){Pl=this.faces[Ml];var Gl=Pl.vertexNormals;3===Gl.length?(Gl[0].copy(Ll[Pl.a]),Gl[1].copy(Ll[Pl.b]),Gl[2].copy(Ll[Pl.c])):(Gl[0]=Ll[Pl.a].clone(),Gl[1]=Ll[Pl.b].clone(),Gl[2]=Ll[Pl.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var _l,Sl,El;for(this.computeFaceNormals(),_l=0,Sl=this.faces.length;_l<Sl;_l++){El=this.faces[_l];var Ml=El.vertexNormals;3===Ml.length?(Ml[0].copy(El.normal),Ml[1].copy(El.normal),Ml[2].copy(El.normal)):(Ml[0]=El.normal.clone(),Ml[1]=El.normal.clone(),Ml[2]=El.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var _l,Sl,El,Ml,Al;for(El=0,Ml=this.faces.length;El<Ml;El++)for(Al=this.faces[El],Al.__originalFaceNormal?Al.__originalFaceNormal.copy(Al.normal):Al.__originalFaceNormal=Al.normal.clone(),Al.__originalVertexNormals||(Al.__originalVertexNormals=[]),(_l=0,Sl=Al.vertexNormals.length);_l<Sl;_l++)Al.__originalVertexNormals[_l]?Al.__originalVertexNormals[_l].copy(Al.vertexNormals[_l]):Al.__originalVertexNormals[_l]=Al.vertexNormals[_l].clone();var Pl=new vt;for(Pl.faces=this.faces,_l=0,Sl=this.morphTargets.length;_l<Sl;_l++){if(!this.morphNormals[_l]){this.morphNormals[_l]={},this.morphNormals[_l].faceNormals=[],this.morphNormals[_l].vertexNormals=[];var Ll=this.morphNormals[_l].faceNormals,wl=this.morphNormals[_l].vertexNormals,Rl,Cl;for(El=0,Ml=this.faces.length;El<Ml;El++)Rl=new Z,Cl={a:new Z,b:new Z,c:new Z},Ll.push(Rl),wl.push(Cl)}var Il=this.morphNormals[_l];Pl.vertices=this.morphTargets[_l].vertices,Pl.computeFaceNormals(),Pl.computeVertexNormals();var Rl,Cl;for(El=0,Ml=this.faces.length;El<Ml;El++)Al=this.faces[El],Rl=Il.faceNormals[El],Cl=Il.vertexNormals[El],Rl.copy(Al.normal),Cl.a.copy(Al.vertexNormals[0]),Cl.b.copy(Al.vertexNormals[1]),Cl.c.copy(Al.vertexNormals[2])}for(El=0,Ml=this.faces.length;El<Ml;El++)Al=this.faces[El],Al.normal=Al.__originalFaceNormal,Al.vertexNormals=Al.__originalVertexNormals},computeLineDistances:function(){var _l=0,Sl=this.vertices;for(var El=0,Ml=Sl.length;El<Ml;El++)0<El&&(_l+=Sl[El].distanceTo(Sl[El-1])),this.lineDistances[El]=_l},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new qe),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ze),this.boundingSphere.setFromPoints(this.vertices)},merge:function(_l,Sl,El){if(!1===(_l&&_l.isGeometry))return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",_l);var Al=this.vertices.length,Pl=this.vertices,Ll=_l.vertices,wl=this.faces,Rl=_l.faces,Cl=this.faceVertexUvs[0],Il=_l.faceVertexUvs[0],Dl=this.colors,Gl=_l.colors,Ml;El===void 0&&(El=0),Sl!==void 0&&(Ml=new Ke().getNormalMatrix(Sl));for(var Bl=0,Fl=Ll.length;Bl<Fl;Bl++){var Nl=Ll[Bl],Ul=Nl.clone();Sl!==void 0&&Ul.applyMatrix4(Sl),Pl.push(Ul)}for(var Bl=0,Fl=Gl.length;Bl<Fl;Bl++)Dl.push(Gl[Bl].clone());for(Bl=0,Fl=Rl.length;Bl<Fl;Bl++){var Hl=Rl[Bl],Wl=Hl.vertexNormals,Xl=Hl.vertexColors,zl,Ol,Vl;zl=new nt(Hl.a+Al,Hl.b+Al,Hl.c+Al),zl.normal.copy(Hl.normal),Ml!=void 0&&zl.normal.applyMatrix3(Ml).normalize();for(var Yl=0,ql=Wl.length;Yl<ql;Yl++)Ol=Wl[Yl].clone(),void 0!=Ml&&Ol.applyMatrix3(Ml).normalize(),zl.vertexNormals.push(Ol);zl.color.copy(Hl.color);for(var Yl=0,ql=Xl.length;Yl<ql;Yl++)Vl=Xl[Yl],zl.vertexColors.push(Vl.clone());zl.materialIndex=Hl.materialIndex+El,wl.push(zl)}for(Bl=0,Fl=Il.length;Bl<Fl;Bl++){var Zl=Il[Bl],Kl=[];if(void 0!==Zl){for(var Yl=0,ql=Zl.length;Yl<ql;Yl++)Kl.push(Zl[Yl].clone());Cl.push(Kl)}}},mergeMesh:function(_l){return!1===(_l&&_l.isMesh)?void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",_l):void(_l.matrixAutoUpdate&&_l.updateMatrix(),this.merge(_l.geometry,_l.matrix))},mergeVertices:function(){var _l={},Sl=[],El=[],Pl=Math.pow(10,4),Ml,Al,Ll,wl,Rl,Cl,Il,Dl;for(Ll=0,wl=this.vertices.length;Ll<wl;Ll++)Ml=this.vertices[Ll],Al=Math.round(Ml.x*Pl)+"_"+Math.round(Ml.y*Pl)+"_"+Math.round(Ml.z*Pl),void 0===_l[Al]?(_l[Al]=Ll,Sl.push(this.vertices[Ll]),El[Ll]=Sl.length-1):El[Ll]=El[_l[Al]];var Gl=[];for(Ll=0,wl=this.faces.length;Ll<wl;Ll++){Rl=this.faces[Ll],Rl.a=El[Rl.a],Rl.b=El[Rl.b],Rl.c=El[Rl.c],Cl=[Rl.a,Rl.b,Rl.c];for(var Bl=0;3>Bl;Bl++)if(Cl[Bl]===Cl[(Bl+1)%3]){Gl.push(Ll);break}}for(Ll=Gl.length-1;0<=Ll;Ll--){var Fl=Gl[Ll];for(this.faces.splice(Fl,1),Il=0,Dl=this.faceVertexUvs.length;Il<Dl;Il++)this.faceVertexUvs[Il].splice(Fl,1)}var Nl=this.vertices.length-Sl.length;return this.vertices=Sl,Nl},sortFacesByMaterialIndex:function(){var _l=this.faces,Sl=_l.length;for(var El=0;El<Sl;El++)_l[El]._id=El;_l.sort(function(Cl,Il){return Cl.materialIndex-Il.materialIndex});var Ml=this.faceVertexUvs[0],Al=this.faceVertexUvs[1],Pl,Ll;Ml&&Ml.length===Sl&&(Pl=[]),Al&&Al.length===Sl&&(Ll=[]);for(var El=0;El<Sl;El++){var wl=_l[El]._id;Pl&&Pl.push(Ml[wl]),Ll&&Ll.push(Al[wl])}Pl&&(this.faceVertexUvs[0]=Pl),Ll&&(this.faceVertexUvs[1]=Ll)},toJSON:function(){function _l(Ql,Jl,$l){return $l?Ql|1<<Jl:Ql&~(1<<Jl)}function Sl(Ql){var Jl=Ql.x.toString()+Ql.y.toString()+Ql.z.toString();return void 0===Gl[Jl]?(Gl[Jl]=Dl.length/3,Dl.push(Ql.x,Ql.y,Ql.z),Gl[Jl]):Gl[Jl]}function El(Ql){var Jl=Ql.r.toString()+Ql.g.toString()+Ql.b.toString();return void 0===Fl[Jl]?(Fl[Jl]=Bl.length,Bl.push(Ql.getHex()),Fl[Jl]):Fl[Jl]}function Ml(Ql){var Jl=Ql.x.toString()+Ql.y.toString();return void 0===Ul[Jl]?(Ul[Jl]=Nl.length/2,Nl.push(Ql.x,Ql.y),Ul[Jl]):Ul[Jl]}var Al={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(Al.uuid=this.uuid,Al.type=this.type,""!==this.name&&(Al.name=this.name),void 0!==this.parameters){var Pl=this.parameters;for(var Ll in Pl)void 0!==Pl[Ll]&&(Al[Ll]=Pl[Ll]);return Al}var wl=[];for(var Rl=0;Rl<this.vertices.length;Rl++){var Cl=this.vertices[Rl];wl.push(Cl.x,Cl.y,Cl.z)}var Il=[],Dl=[],Gl={},Bl=[],Fl={},Nl=[],Ul={};for(var Rl=0;Rl<this.faces.length;Rl++){var Hl=this.faces[Rl],zl=void 0!==this.faceVertexUvs[0][Rl],Ol=0<Hl.normal.length(),Vl=0<Hl.vertexNormals.length,Wl=1!==Hl.color.r||1!==Hl.color.g||1!==Hl.color.b,Xl=0<Hl.vertexColors.length,Yl=0;if(Yl=_l(Yl,0,0),Yl=_l(Yl,1,!0),Yl=_l(Yl,2,!1),Yl=_l(Yl,3,zl),Yl=_l(Yl,4,Ol),Yl=_l(Yl,5,Vl),Yl=_l(Yl,6,Wl),Yl=_l(Yl,7,Xl),Il.push(Yl),Il.push(Hl.a,Hl.b,Hl.c),Il.push(Hl.materialIndex),zl){var ql=this.faceVertexUvs[0][Rl];Il.push(Ml(ql[0]),Ml(ql[1]),Ml(ql[2]))}if(Ol&&Il.push(Sl(Hl.normal)),Vl){var Zl=Hl.vertexNormals;Il.push(Sl(Zl[0]),Sl(Zl[1]),Sl(Zl[2]))}if(Wl&&Il.push(El(Hl.color)),Xl){var Kl=Hl.vertexColors;Il.push(El(Kl[0]),El(Kl[1]),El(Kl[2]))}}return Al.data={},Al.data.vertices=wl,Al.data.normals=Dl,0<Bl.length&&(Al.data.colors=Bl),0<Nl.length&&(Al.data.uvs=[Nl]),Al.data.faces=Il,Al},clone:function(){return new vt().copy(this)},copy:function(_l){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]],this.colors=[];var Sl=_l.vertices;for(var El=0,Ml=Sl.length;El<Ml;El++)this.vertices.push(Sl[El].clone());var Al=_l.colors;for(var El=0,Ml=Al.length;El<Ml;El++)this.colors.push(Al[El].clone());var Pl=_l.faces;for(var El=0,Ml=Pl.length;El<Ml;El++)this.faces.push(Pl[El].clone());for(var El=0,Ml=_l.faceVertexUvs.length;El<Ml;El++){var Ll=_l.faceVertexUvs[El];this.faceVertexUvs[El]===void 0&&(this.faceVertexUvs[El]=[]);for(var wl=0,Rl=Ll.length;wl<Rl;wl++){var Cl=Ll[wl],Il=[];for(var Dl=0,Gl=Cl.length;Dl<Gl;Dl++){var Bl=Cl[Dl];Il.push(Bl.clone())}this.faceVertexUvs[El].push(Il)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Vs=0;Object.assign(St.prototype,F.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(_l){this.index=_l},addAttribute:function(_l,Sl){return!1===(Sl&&Sl.isBufferAttribute)&&!1===(Sl&&Sl.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(_l,new lt(arguments[1],arguments[2]))):"index"===_l?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(Sl)):(this.attributes[_l]=Sl,this)},getAttribute:function(_l){return this.attributes[_l]},removeAttribute:function(_l){return delete this.attributes[_l],this},addGroup:function(_l,Sl,El){this.groups.push({start:_l,count:Sl,materialIndex:El===void 0?0:El})},clearGroups:function(){this.groups=[]},setDrawRange:function(_l,Sl){this.drawRange.start=_l,this.drawRange.count=Sl},applyMatrix:function(_l){var Sl=this.attributes.position;void 0!==Sl&&(_l.applyToVector3Array(Sl.array),Sl.needsUpdate=!0);var El=this.attributes.normal;if(void 0!==El){var Ml=new Ke().getNormalMatrix(_l);Ml.applyToVector3Array(El.array),El.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var _l;return function(El){return void 0==_l&&(_l=new K),_l.makeRotationX(El),this.applyMatrix(_l),this}}(),rotateY:function(){var _l;return function(El){return void 0==_l&&(_l=new K),_l.makeRotationY(El),this.applyMatrix(_l),this}}(),rotateZ:function(){var _l;return function(El){return void 0==_l&&(_l=new K),_l.makeRotationZ(El),this.applyMatrix(_l),this}}(),translate:function(){var _l;return function(El,Ml,Al){return void 0==_l&&(_l=new K),_l.makeTranslation(El,Ml,Al),this.applyMatrix(_l),this}}(),scale:function(){var _l;return function(El,Ml,Al){return void 0==_l&&(_l=new K),_l.makeScale(El,Ml,Al),this.applyMatrix(_l),this}}(),lookAt:function(){var _l;return function(El){_l==void 0&&(_l=new at),_l.lookAt(El),_l.updateMatrix(),this.applyMatrix(_l.matrix)}}(),center:function(){this.computeBoundingBox();var _l=this.boundingBox.getCenter().negate();return this.translate(_l.x,_l.y,_l.z),_l},setFromObject:function(_l){var Sl=_l.geometry;if(_l.isPoints||_l.isLine){var El=new yt(3*Sl.vertices.length,3),Ml=new yt(3*Sl.colors.length,3);if(this.addAttribute("position",El.copyVector3sArray(Sl.vertices)),this.addAttribute("color",Ml.copyColorsArray(Sl.colors)),Sl.lineDistances&&Sl.lineDistances.length===Sl.vertices.length){var Al=new yt(Sl.lineDistances.length,1);this.addAttribute("lineDistance",Al.copyArray(Sl.lineDistances))}null!==Sl.boundingSphere&&(this.boundingSphere=Sl.boundingSphere.clone()),null!==Sl.boundingBox&&(this.boundingBox=Sl.boundingBox.clone())}else _l.isMesh&&Sl&&Sl.isGeometry&&this.fromGeometry(Sl);return this},updateFromObject:function(_l){var Sl=_l.geometry;if(_l.isMesh){var El=Sl.__directGeometry;if(!0===Sl.elementsNeedUpdate&&(El=void 0,Sl.elementsNeedUpdate=!1),void 0===El)return this.fromGeometry(Sl);El.verticesNeedUpdate=Sl.verticesNeedUpdate,El.normalsNeedUpdate=Sl.normalsNeedUpdate,El.colorsNeedUpdate=Sl.colorsNeedUpdate,El.uvsNeedUpdate=Sl.uvsNeedUpdate,El.groupsNeedUpdate=Sl.groupsNeedUpdate,Sl.verticesNeedUpdate=!1,Sl.normalsNeedUpdate=!1,Sl.colorsNeedUpdate=!1,Sl.uvsNeedUpdate=!1,Sl.groupsNeedUpdate=!1,Sl=El}var Ml;return!0===Sl.verticesNeedUpdate&&(Ml=this.attributes.position,void 0!=Ml&&(Ml.copyVector3sArray(Sl.vertices),Ml.needsUpdate=!0),Sl.verticesNeedUpdate=!1),!0===Sl.normalsNeedUpdate&&(Ml=this.attributes.normal,void 0!=Ml&&(Ml.copyVector3sArray(Sl.normals),Ml.needsUpdate=!0),Sl.normalsNeedUpdate=!1),!0===Sl.colorsNeedUpdate&&(Ml=this.attributes.color,void 0!=Ml&&(Ml.copyColorsArray(Sl.colors),Ml.needsUpdate=!0),Sl.colorsNeedUpdate=!1),Sl.uvsNeedUpdate&&(Ml=this.attributes.uv,void 0!=Ml&&(Ml.copyVector2sArray(Sl.uvs),Ml.needsUpdate=!0),Sl.uvsNeedUpdate=!1),Sl.lineDistancesNeedUpdate&&(Ml=this.attributes.lineDistance,void 0!=Ml&&(Ml.copyArray(Sl.lineDistances),Ml.needsUpdate=!0),Sl.lineDistancesNeedUpdate=!1),Sl.groupsNeedUpdate&&(Sl.computeGroups(_l.geometry),this.groups=Sl.groups,Sl.groupsNeedUpdate=!1),this},fromGeometry:function(_l){return _l.__directGeometry=new Tt().fromGeometry(_l),this.fromDirectGeometry(_l.__directGeometry)},fromDirectGeometry:function(_l){var Sl=new Float32Array(3*_l.vertices.length);if(this.addAttribute("position",new lt(Sl,3).copyVector3sArray(_l.vertices)),0<_l.normals.length){var El=new Float32Array(3*_l.normals.length);this.addAttribute("normal",new lt(El,3).copyVector3sArray(_l.normals))}if(0<_l.colors.length){var Ml=new Float32Array(3*_l.colors.length);this.addAttribute("color",new lt(Ml,3).copyColorsArray(_l.colors))}if(0<_l.uvs.length){var Al=new Float32Array(2*_l.uvs.length);this.addAttribute("uv",new lt(Al,2).copyVector2sArray(_l.uvs))}if(0<_l.uvs2.length){var Pl=new Float32Array(2*_l.uvs2.length);this.addAttribute("uv2",new lt(Pl,2).copyVector2sArray(_l.uvs2))}if(0<_l.indices.length){var Ll=65535<_l.vertices.length?Uint32Array:Uint16Array,wl=new Ll(3*_l.indices.length);this.setIndex(new lt(wl,1).copyIndicesArray(_l.indices))}for(var Rl in this.groups=_l.groups,_l.morphTargets){var Cl=[],Il=_l.morphTargets[Rl];for(var Dl=0,Gl=Il.length;Dl<Gl;Dl++){var Bl=Il[Dl],Fl=new yt(3*Bl.length,3);Cl.push(Fl.copyVector3sArray(Bl))}this.morphAttributes[Rl]=Cl}if(0<_l.skinIndices.length){var Nl=new yt(4*_l.skinIndices.length,4);this.addAttribute("skinIndex",Nl.copyVector4sArray(_l.skinIndices))}if(0<_l.skinWeights.length){var Ul=new yt(4*_l.skinWeights.length,4);this.addAttribute("skinWeight",Ul.copyVector4sArray(_l.skinWeights))}return null!==_l.boundingSphere&&(this.boundingSphere=_l.boundingSphere.clone()),null!==_l.boundingBox&&(this.boundingBox=_l.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new qe);var _l=this.attributes.position;_l===void 0?this.boundingBox.makeEmpty():this.boundingBox.setFromBufferAttribute(_l),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error("THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.",this)},computeBoundingSphere:function(){var _l=new qe,Sl=new Z;return function(){null===this.boundingSphere&&(this.boundingSphere=new Ze);var Ml=this.attributes.position;if(Ml){var Al=this.boundingSphere.center;_l.setFromBufferAttribute(Ml),_l.getCenter(Al);var Pl=0;for(var Ll=0,wl=Ml.count;Ll<wl;Ll++)Sl.x=Ml.getX(Ll),Sl.y=Ml.getY(Ll),Sl.z=Ml.getZ(Ll),Pl=Math.max(Pl,Al.distanceToSquared(Sl));this.boundingSphere.radius=Math.sqrt(Pl),isNaN(this.boundingSphere.radius)&&console.error("THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.",this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var _l=this.index,Sl=this.attributes,El=this.groups;if(Sl.position){var Ml=Sl.position.array;if(Sl.normal===void 0)this.addAttribute("normal",new lt(new Float32Array(Ml.length),3));else{var Al=Sl.normal.array;for(var Pl=0,Ll=Al.length;Pl<Ll;Pl++)Al[Pl]=0}var wl=Sl.normal.array,Rl,Cl,Il,Dl=new Z,Gl=new Z,Bl=new Z,Fl=new Z,Nl=new Z;if(_l){var Ul=_l.array;0===El.length&&this.addGroup(0,Ul.length);for(var Hl=0,zl=El.length;Hl<zl;++Hl){var Ol=El[Hl],Vl=Ol.start,Wl=Ol.count;for(var Pl=Vl,Ll=Vl+Wl;Pl<Ll;Pl+=3)Rl=3*Ul[Pl+0],Cl=3*Ul[Pl+1],Il=3*Ul[Pl+2],Dl.fromArray(Ml,Rl),Gl.fromArray(Ml,Cl),Bl.fromArray(Ml,Il),Fl.subVectors(Bl,Gl),Nl.subVectors(Dl,Gl),Fl.cross(Nl),wl[Rl]+=Fl.x,wl[Rl+1]+=Fl.y,wl[Rl+2]+=Fl.z,wl[Cl]+=Fl.x,wl[Cl+1]+=Fl.y,wl[Cl+2]+=Fl.z,wl[Il]+=Fl.x,wl[Il+1]+=Fl.y,wl[Il+2]+=Fl.z}}else for(var Pl=0,Ll=Ml.length;Pl<Ll;Pl+=9)Dl.fromArray(Ml,Pl),Gl.fromArray(Ml,Pl+3),Bl.fromArray(Ml,Pl+6),Fl.subVectors(Bl,Gl),Nl.subVectors(Dl,Gl),Fl.cross(Nl),wl[Pl]=Fl.x,wl[Pl+1]=Fl.y,wl[Pl+2]=Fl.z,wl[Pl+3]=Fl.x,wl[Pl+4]=Fl.y,wl[Pl+5]=Fl.z,wl[Pl+6]=Fl.x,wl[Pl+7]=Fl.y,wl[Pl+8]=Fl.z;this.normalizeNormals(),Sl.normal.needsUpdate=!0}},merge:function(_l,Sl){if(!1===(_l&&_l.isBufferGeometry))return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",_l);Sl===void 0&&(Sl=0);var El=this.attributes;for(var Ml in El)if(_l.attributes[Ml]!==void 0){var Al=El[Ml],Pl=Al.array,Ll=_l.attributes[Ml],wl=Ll.array,Rl=Ll.itemSize;for(var Cl=0,Il=Rl*Sl;Cl<wl.length;Cl++,Il++)Pl[Il]=wl[Cl]}return this},normalizeNormals:function(){var _l=this.attributes.normal.array,Sl,El,Ml,Al;for(var Pl=0,Ll=_l.length;Pl<Ll;Pl+=3)Sl=_l[Pl],El=_l[Pl+1],Ml=_l[Pl+2],Al=1/Math.sqrt(Sl*Sl+El*El+Ml*Ml),_l[Pl]*=Al,_l[Pl+1]*=Al,_l[Pl+2]*=Al},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var _l=new St,Sl=this.index.array,El=this.attributes;for(var Ml in El){var Al=El[Ml],Pl=Al.array,Ll=Al.itemSize,wl=new Pl.constructor(Sl.length*Ll),Rl=0,Cl=0;for(var Il=0,Dl=Sl.length;Il<Dl;Il++){Rl=Sl[Il]*Ll;for(var Gl=0;Gl<Ll;Gl++)wl[Cl++]=Pl[Rl++]}_l.addAttribute(Ml,new lt(wl,Ll))}return _l},toJSON:function(){var _l={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_l.uuid=this.uuid,_l.type=this.type,""!==this.name&&(_l.name=this.name),void 0!==this.parameters){var Sl=this.parameters;for(var El in Sl)void 0!==Sl[El]&&(_l[El]=Sl[El]);return _l}_l.data={attributes:{}};var Ml=this.index;if(null!==Ml){var Al=Array.prototype.slice.call(Ml.array);_l.data.index={type:Ml.array.constructor.name,array:Al}}var Pl=this.attributes;for(var El in Pl){var Ll=Pl[El],Al=Array.prototype.slice.call(Ll.array);_l.data.attributes[El]={itemSize:Ll.itemSize,type:Ll.array.constructor.name,array:Al,normalized:Ll.normalized}}var wl=this.groups;0<wl.length&&(_l.data.groups=JSON.parse(JSON.stringify(wl)));var Rl=this.boundingSphere;return null!==Rl&&(_l.data.boundingSphere={center:Rl.center.toArray(),radius:Rl.radius}),_l},clone:function(){return new St().copy(this)},copy:function(_l){var Sl=_l.index;null!==Sl&&this.setIndex(Sl.clone());var El=_l.attributes;for(var Ml in El){var Al=El[Ml];this.addAttribute(Ml,Al.clone())}var Pl=_l.groups;for(var Ll=0,wl=Pl.length;Ll<wl;Ll++){var Rl=Pl[Ll];this.addGroup(Rl.start,Rl.count,Rl.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),St.MaxIndex=65535,Et.prototype=Object.assign(Object.create(at.prototype),{constructor:Et,isMesh:!0,setDrawMode:function(_l){this.drawMode=_l},copy:function(_l){return at.prototype.copy.call(this,_l),this.drawMode=_l.drawMode,this},updateMorphTargets:function(){var _l=this.geometry.morphTargets;if(_l!==void 0&&0<_l.length){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var Sl=0,El=_l.length;Sl<El;Sl++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[_l[Sl].name]=Sl}},raycast:function(){function _l(zl,Ol,Vl,Wl,Xl,Yl,ql){return it.barycoordFromPoint(zl,Ol,Vl,Wl,Nl),Xl.multiplyScalar(Nl.x),Yl.multiplyScalar(Nl.y),ql.multiplyScalar(Nl.z),Xl.add(Yl).add(ql),Xl.clone()}function Sl(zl,Ol,Vl,Wl,Xl,Yl,ql){var Kl=zl.material,Zl;if(Zl=Kl.side===yi?Vl.intersectTriangle(Yl,Xl,Wl,!0,ql):Vl.intersectTriangle(Wl,Xl,Yl,Kl.side!==xi,ql),null===Zl)return null;Hl.copy(ql),Hl.applyMatrix4(zl.matrixWorld);var Ql=Ol.ray.origin.distanceTo(Hl);return Ql<Ol.near||Ql>Ol.far?null:{distance:Ql,point:Hl.clone(),object:zl}}function El(zl,Ol,Vl,Wl,Xl,Yl,ql,Zl){Ll.fromArray(Wl,3*Yl),wl.fromArray(Wl,3*ql),Rl.fromArray(Wl,3*Zl);var Kl=Sl(zl,Ol,Vl,Ll,wl,Rl,Ul);return Kl&&(Xl&&(Gl.fromArray(Xl,2*Yl),Bl.fromArray(Xl,2*ql),Fl.fromArray(Xl,2*Zl),Kl.uv=_l(Ul,Ll,wl,Rl,Gl,Bl,Fl)),Kl.face=new nt(Yl,ql,Zl,it.normal(Ll,wl,Rl)),Kl.faceIndex=Yl),Kl}var Ml=new K,Al=new et,Pl=new Ze,Ll=new Z,wl=new Z,Rl=new Z,Cl=new Z,Il=new Z,Dl=new Z,Gl=new H,Bl=new H,Fl=new H,Nl=new Z,Ul=new Z,Hl=new Z;return function(Ol,Vl){var Wl=this.geometry,Xl=this.material,Yl=this.matrixWorld;if(void 0!==Xl&&(null===Wl.boundingSphere&&Wl.computeBoundingSphere(),Pl.copy(Wl.boundingSphere),Pl.applyMatrix4(Yl),!1!==Ol.ray.intersectsSphere(Pl))){if(Ml.getInverse(Yl),Al.copy(Ol.ray).applyMatrix4(Ml),null!==Wl.boundingBox&&!1===Al.intersectsBox(Wl.boundingBox))return;var ql,Zl;if(Wl.isBufferGeometry){var $l=Wl.index,ed=Wl.attributes,td=ed.position.array,Kl,Ql,Jl;if(void 0!==ed.uv&&(ql=ed.uv.array),null!==$l){var rd=$l.array;for(var od=0,nd=rd.length;od<nd;od+=3)Kl=rd[od],Ql=rd[od+1],Jl=rd[od+2],Zl=El(this,Ol,Al,td,ql,Kl,Ql,Jl),Zl&&(Zl.faceIndex=Math.floor(od/3),Vl.push(Zl))}else for(var od=0,nd=td.length;od<nd;od+=9)Kl=od/3,Ql=Kl+1,Jl=Kl+2,Zl=El(this,Ol,Al,td,ql,Kl,Ql,Jl),Zl&&(Zl.index=Kl,Vl.push(Zl))}else if(Wl.isGeometry){var cd=Xl&&Xl.isMultiMaterial,ud=!0===cd?Xl.materials:null,md=Wl.vertices,fd=Wl.faces,gd=Wl.faceVertexUvs[0],sd,ld,dd;0<gd.length&&(ql=gd);for(var hd=0,yd=fd.length;hd<yd;hd++){var xd=fd[hd],Td=!0===cd?ud[xd.materialIndex]:Xl;if(void 0!==Td){if(sd=md[xd.a],ld=md[xd.b],dd=md[xd.c],!0===Td.morphTargets){var vd=Wl.morphTargets,_d=this.morphTargetInfluences;Ll.set(0,0,0),wl.set(0,0,0),Rl.set(0,0,0);for(var Sd=0,Ed=vd.length;Sd<Ed;Sd++){var Md=_d[Sd];if(0!==Md){var Ad=vd[Sd].vertices;Ll.addScaledVector(Cl.subVectors(Ad[xd.a],sd),Md),wl.addScaledVector(Il.subVectors(Ad[xd.b],ld),Md),Rl.addScaledVector(Dl.subVectors(Ad[xd.c],dd),Md)}}Ll.add(sd),wl.add(ld),Rl.add(dd),sd=Ll,ld=wl,dd=Rl}if(Zl=Sl(this,Ol,Al,sd,ld,dd,Ul),Zl){if(ql){var Pd=ql[hd];Gl.copy(Pd[0]),Bl.copy(Pd[1]),Fl.copy(Pd[2]),Zl.uv=_l(Ul,sd,ld,dd,Gl,Bl,Fl)}Zl.face=xd,Zl.faceIndex=hd,Vl.push(Zl)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Mt.prototype=Object.create(St.prototype),Mt.prototype.constructor=Mt,At.prototype=Object.create(St.prototype),At.prototype.constructor=At,Pt.prototype=Object.create(at.prototype),Pt.prototype.constructor=Pt,Pt.prototype.isCamera=!0,Pt.prototype.getWorldDirection=function(){var _l=new Y;return function(El){var Ml=El||new Z;return this.getWorldQuaternion(_l),Ml.set(0,0,-1).applyQuaternion(_l)}}(),Pt.prototype.lookAt=function(){var _l=new K;return function(El){_l.lookAt(this.position,El,this.up),this.quaternion.setFromRotationMatrix(_l)}}(),Pt.prototype.clone=function(){return new this.constructor().copy(this)},Pt.prototype.copy=function(_l){return at.prototype.copy.call(this,_l),this.matrixWorldInverse.copy(_l.matrixWorldInverse),this.projectionMatrix.copy(_l.projectionMatrix),this},Lt.prototype=Object.assign(Object.create(Pt.prototype),{constructor:Lt,isPerspectiveCamera:!0,copy:function(_l){return Pt.prototype.copy.call(this,_l),this.fov=_l.fov,this.zoom=_l.zoom,this.near=_l.near,this.far=_l.far,this.focus=_l.focus,this.aspect=_l.aspect,this.view=null===_l.view?null:Object.assign({},_l.view),this.filmGauge=_l.filmGauge,this.filmOffset=_l.filmOffset,this},setFocalLength:function(_l){var Sl=0.5*this.getFilmHeight()/_l;this.fov=2*Ls.RAD2DEG*Math.atan(Sl),this.updateProjectionMatrix()},getFocalLength:function(){var _l=Math.tan(0.5*Ls.DEG2RAD*this.fov);return 0.5*this.getFilmHeight()/_l},getEffectiveFOV:function(){return 2*Ls.RAD2DEG*Math.atan(Math.tan(0.5*Ls.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(_l,Sl,El,Ml,Al,Pl){this.aspect=_l/Sl,this.view={fullWidth:_l,fullHeight:Sl,offsetX:El,offsetY:Ml,width:Al,height:Pl},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var _l=this.near,Sl=_l*Math.tan(0.5*Ls.DEG2RAD*this.fov)/this.zoom,El=2*Sl,Ml=this.aspect*El,Al=-0.5*Ml,Pl=this.view;if(null!==Pl){var Ll=Pl.fullWidth,wl=Pl.fullHeight;Al+=Pl.offsetX*Ml/Ll,Sl-=Pl.offsetY*El/wl,Ml*=Pl.width/Ll,El*=Pl.height/wl}var Rl=this.filmOffset;0!==Rl&&(Al+=_l*Rl/this.getFilmWidth()),this.projectionMatrix.makeFrustum(Al,Al+Ml,Sl-El,Sl,_l,this.far)},toJSON:function(_l){var Sl=at.prototype.toJSON.call(this,_l);return Sl.object.fov=this.fov,Sl.object.zoom=this.zoom,Sl.object.near=this.near,Sl.object.far=this.far,Sl.object.focus=this.focus,Sl.object.aspect=this.aspect,null!==this.view&&(Sl.object.view=Object.assign({},this.view)),Sl.object.filmGauge=this.filmGauge,Sl.object.filmOffset=this.filmOffset,Sl}}),wt.prototype=Object.assign(Object.create(Pt.prototype),{constructor:wt,isOrthographicCamera:!0,copy:function(_l){return Pt.prototype.copy.call(this,_l),this.left=_l.left,this.right=_l.right,this.top=_l.top,this.bottom=_l.bottom,this.near=_l.near,this.far=_l.far,this.zoom=_l.zoom,this.view=null===_l.view?null:Object.assign({},_l.view),this},setViewOffset:function(_l,Sl,El,Ml,Al,Pl){this.view={fullWidth:_l,fullHeight:Sl,offsetX:El,offsetY:Ml,width:Al,height:Pl},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var _l=(this.right-this.left)/(2*this.zoom),Sl=(this.top-this.bottom)/(2*this.zoom),El=(this.right+this.left)/2,Ml=(this.top+this.bottom)/2,Al=El-_l,Pl=El+_l,Ll=Ml+Sl,wl=Ml-Sl;if(null!==this.view){var Rl=this.zoom/(this.view.width/this.view.fullWidth),Cl=this.zoom/(this.view.height/this.view.fullHeight),Il=(this.right-this.left)/this.view.width,Dl=(this.top-this.bottom)/this.view.height;Al+=Il*(this.view.offsetX/Rl),Pl=Al+Il*(this.view.width/Rl),Ll-=Dl*(this.view.offsetY/Cl),wl=Ll-Dl*(this.view.height/Cl)}this.projectionMatrix.makeOrthographic(Al,Pl,Ll,wl,this.near,this.far)},toJSON:function(_l){var Sl=at.prototype.toJSON.call(this,_l);return Sl.object.zoom=this.zoom,Sl.object.left=this.left,Sl.object.right=this.right,Sl.object.top=this.top,Sl.object.bottom=this.bottom,Sl.object.near=this.near,Sl.object.far=this.far,null!==this.view&&(Sl.object.view=Object.assign({},this.view)),Sl}});var ks=0;ar.prototype.isFogExp2=!0,ar.prototype.clone=function(){return new ar(this.color.getHex(),this.density)},ar.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},or.prototype.isFog=!0,or.prototype.clone=function(){return new or(this.color.getHex(),this.near,this.far)},or.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},ir.prototype=Object.create(at.prototype),ir.prototype.constructor=ir,ir.prototype.copy=function(_l,Sl){return at.prototype.copy.call(this,_l,Sl),null!==_l.background&&(this.background=_l.background.clone()),null!==_l.fog&&(this.fog=_l.fog.clone()),null!==_l.overrideMaterial&&(this.overrideMaterial=_l.overrideMaterial.clone()),this.autoUpdate=_l.autoUpdate,this.matrixAutoUpdate=_l.matrixAutoUpdate,this},ir.prototype.toJSON=function(_l){var Sl=at.prototype.toJSON.call(this,_l);return null!==this.background&&(Sl.object.background=this.background.toJSON(_l)),null!==this.fog&&(Sl.object.fog=this.fog.toJSON()),Sl},nr.prototype=Object.assign(Object.create(at.prototype),{constructor:nr,isLensFlare:!0,copy:function(_l){at.prototype.copy.call(this,_l),this.positionScreen.copy(_l.positionScreen),this.customUpdateCallback=_l.customUpdateCallback;for(var Sl=0,El=_l.lensFlares.length;Sl<El;Sl++)this.lensFlares.push(_l.lensFlares[Sl]);return this},add:function(_l,Sl,El,Ml,Al,Pl){Sl===void 0&&(Sl=-1),El===void 0&&(El=0),Pl===void 0&&(Pl=1),Al===void 0&&(Al=new ze(16777215)),Ml===void 0&&(Ml=Mi),El=Math.min(El,Math.max(0,El)),this.lensFlares.push({texture:_l,size:Sl,distance:El,x:0,y:0,z:0,scale:1,rotation:0,opacity:Pl,color:Al,blending:Ml})},updateLensFlares:function(){var Sl=this.lensFlares.length,_l,El,Ml=2*-this.positionScreen.x,Al=2*-this.positionScreen.y;for(_l=0;_l<Sl;_l++)El=this.lensFlares[_l],El.x=this.positionScreen.x+Ml*El.distance,El.y=this.positionScreen.y+Al*El.distance,El.wantedRotation=0.25*(El.x*Math.PI),El.rotation+=0.25*(El.wantedRotation-El.rotation)}}),sr.prototype=Object.create(Xe.prototype),sr.prototype.constructor=sr,sr.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.color.copy(_l.color),this.map=_l.map,this.rotation=_l.rotation,this},dr.prototype=Object.assign(Object.create(at.prototype),{constructor:dr,isSprite:!0,raycast:function(){var _l=new Z;return function(El,Ml){_l.setFromMatrixPosition(this.matrixWorld);var Al=El.ray.distanceSqToPoint(_l),Pl=this.scale.x*this.scale.y/4;Al>Pl||Ml.push({distance:Math.sqrt(Al),point:this.position,face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),pr.prototype=Object.assign(Object.create(at.prototype),{constructor:pr,copy:function(_l){at.prototype.copy.call(this,_l,!1);var Sl=_l.levels;for(var El=0,Ml=Sl.length;El<Ml;El++){var Al=Sl[El];this.addLevel(Al.object.clone(),Al.distance)}return this},addLevel:function(_l,Sl){Sl===void 0&&(Sl=0),Sl=Math.abs(Sl);var El=this.levels;for(var Ml=0;Ml<El.length&&!(Sl<El[Ml].distance);Ml++);El.splice(Ml,0,{distance:Sl,object:_l}),this.add(_l)},getObjectForDistance:function(_l){var Sl=this.levels;for(var El=1,Ml=Sl.length;El<Ml&&!(_l<Sl[El].distance);El++);return Sl[El-1].object},raycast:function(){var _l=new Z;return function(El,Ml){_l.setFromMatrixPosition(this.matrixWorld);var Al=El.ray.origin.distanceTo(_l);this.getObjectForDistance(Al).raycast(El,Ml)}}(),update:function(){var _l=new Z,Sl=new Z;return function(Ml){var Al=this.levels;if(1<Al.length){_l.setFromMatrixPosition(Ml.matrixWorld),Sl.setFromMatrixPosition(this.matrixWorld);var Pl=_l.distanceTo(Sl);Al[0].object.visible=!0;for(var Ll=1,wl=Al.length;Ll<wl&&Pl>=Al[Ll].distance;Ll++)Al[Ll-1].object.visible=!1,Al[Ll].object.visible=!0;for(;Ll<wl;Ll++)Al[Ll].object.visible=!1}}}(),toJSON:function(_l){var Sl=at.prototype.toJSON.call(this,_l);Sl.object.levels=[];var El=this.levels;for(var Ml=0,Al=El.length;Ml<Al;Ml++){var Pl=El[Ml];Sl.object.levels.push({object:Pl.object.uuid,distance:Pl.distance})}return Sl}}),Object.assign(cr.prototype,{calculateInverses:function(){this.boneInverses=[];for(var _l=0,Sl=this.bones.length;_l<Sl;_l++){var El=new K;this.bones[_l]&&El.getInverse(this.bones[_l].matrixWorld),this.boneInverses.push(El)}},pose:function(){var _l;for(var Sl=0,El=this.bones.length;Sl<El;Sl++)_l=this.bones[Sl],_l&&_l.matrixWorld.getInverse(this.boneInverses[Sl]);for(var Sl=0,El=this.bones.length;Sl<El;Sl++)_l=this.bones[Sl],_l&&(_l.parent&&_l.parent.isBone?(_l.matrix.getInverse(_l.parent.matrixWorld),_l.matrix.multiply(_l.matrixWorld)):_l.matrix.copy(_l.matrixWorld),_l.matrix.decompose(_l.position,_l.quaternion,_l.scale))},update:function(){var _l=new K;return function(){for(var El=0,Ml=this.bones.length;El<Ml;El++){var Al=this.bones[El]?this.bones[El].matrixWorld:this.identityMatrix;_l.multiplyMatrices(Al,this.boneInverses[El]),_l.toArray(this.boneMatrices,16*El)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),clone:function(){return new cr(this.bones,this.boneInverses,this.useVertexTexture)}}),ur.prototype=Object.assign(Object.create(at.prototype),{constructor:ur,isBone:!0}),mr.prototype=Object.assign(Object.create(Et.prototype),{constructor:mr,isSkinnedMesh:!0,bind:function(_l,Sl){this.skeleton=_l,Sl===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),Sl=this.matrixWorld),this.bindMatrix.copy(Sl),this.bindMatrixInverse.getInverse(Sl)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(var _l=0;_l<this.geometry.skinWeights.length;_l++){var Sl=this.geometry.skinWeights[_l],El=1/Sl.lengthManhattan();El==1/0?Sl.set(1,0,0,0):Sl.multiplyScalar(El)}else if(this.geometry&&this.geometry.isBufferGeometry){var Ml=new V,Al=this.geometry.attributes.skinWeight;for(var _l=0;_l<Al.count;_l++){Ml.x=Al.getX(_l),Ml.y=Al.getY(_l),Ml.z=Al.getZ(_l),Ml.w=Al.getW(_l);var El=1/Ml.lengthManhattan();El==1/0?Ml.set(1,0,0,0):Ml.multiplyScalar(El),Al.setXYZW(_l,Ml.x,Ml.y,Ml.z,Ml.w)}}},updateMatrixWorld:function(){Et.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),fr.prototype=Object.create(Xe.prototype),fr.prototype.constructor=fr,fr.prototype.isLineBasicMaterial=!0,fr.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.color.copy(_l.color),this.linewidth=_l.linewidth,this.linecap=_l.linecap,this.linejoin=_l.linejoin,this},gr.prototype=Object.assign(Object.create(at.prototype),{constructor:gr,isLine:!0,raycast:function(){var _l=new K,Sl=new et,El=new Ze;return function(Al,Pl){var Ll=Al.linePrecision,wl=Ll*Ll,Rl=this.geometry,Cl=this.matrixWorld;if(null===Rl.boundingSphere&&Rl.computeBoundingSphere(),El.copy(Rl.boundingSphere),El.applyMatrix4(Cl),!1!==Al.ray.intersectsSphere(El)){_l.getInverse(Cl),Sl.copy(Al.ray).applyMatrix4(_l);var Il=new Z,Dl=new Z,Gl=new Z,Bl=new Z,Fl=this&&this.isLineSegments?2:1;if(Rl.isBufferGeometry){var Nl=Rl.index,Ul=Rl.attributes,Hl=Ul.position.array;if(null!==Nl){var zl=Nl.array;for(var Ol=0,Vl=zl.length-1;Ol<Vl;Ol+=Fl){var Wl=zl[Ol],Xl=zl[Ol+1];Il.fromArray(Hl,3*Wl),Dl.fromArray(Hl,3*Xl);var Yl=Sl.distanceSqToSegment(Il,Dl,Bl,Gl);if(!(Yl>wl)){Bl.applyMatrix4(this.matrixWorld);var ql=Al.ray.origin.distanceTo(Bl);ql<Al.near||ql>Al.far||Pl.push({distance:ql,point:Gl.clone().applyMatrix4(this.matrixWorld),index:Ol,face:null,faceIndex:null,object:this})}}}else for(var Ol=0,Vl=Hl.length/3-1;Ol<Vl;Ol+=Fl){Il.fromArray(Hl,3*Ol),Dl.fromArray(Hl,3*Ol+3);var Yl=Sl.distanceSqToSegment(Il,Dl,Bl,Gl);if(!(Yl>wl)){Bl.applyMatrix4(this.matrixWorld);var ql=Al.ray.origin.distanceTo(Bl);ql<Al.near||ql>Al.far||Pl.push({distance:ql,point:Gl.clone().applyMatrix4(this.matrixWorld),index:Ol,face:null,faceIndex:null,object:this})}}}else if(Rl.isGeometry){var Zl=Rl.vertices,Kl=Zl.length;for(var Ol=0;Ol<Kl-1;Ol+=Fl){var Yl=Sl.distanceSqToSegment(Zl[Ol],Zl[Ol+1],Bl,Gl);if(!(Yl>wl)){Bl.applyMatrix4(this.matrixWorld);var ql=Al.ray.origin.distanceTo(Bl);ql<Al.near||ql>Al.far||Pl.push({distance:ql,point:Gl.clone().applyMatrix4(this.matrixWorld),index:Ol,face:null,faceIndex:null,object:this})}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),hr.prototype=Object.assign(Object.create(gr.prototype),{constructor:hr,isLineSegments:!0}),yr.prototype=Object.create(Xe.prototype),yr.prototype.constructor=yr,yr.prototype.isPointsMaterial=!0,yr.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.color.copy(_l.color),this.map=_l.map,this.size=_l.size,this.sizeAttenuation=_l.sizeAttenuation,this},xr.prototype=Object.assign(Object.create(at.prototype),{constructor:xr,isPoints:!0,raycast:function(){var _l=new K,Sl=new et,El=new Ze;return function(Al,Pl){var wl=this,Rl=this.geometry,Cl=this.matrixWorld,Il=Al.params.Points.threshold;if(null===Rl.boundingSphere&&Rl.computeBoundingSphere(),El.copy(Rl.boundingSphere),El.applyMatrix4(Cl),!1!==Al.ray.intersectsSphere(El)){function Ql(Jl,$l){var ed=Sl.distanceSqToPoint(Jl);if(ed<Dl*Dl){var td=Sl.closestPointToPoint(Jl);td.applyMatrix4(Cl);var dd=Al.ray.origin.distanceTo(td);if(dd<Al.near||dd>Al.far)return;Pl.push({distance:dd,distanceToRay:Math.sqrt(ed),point:td.clone(),index:$l,face:null,object:wl})}}_l.getInverse(Cl),Sl.copy(Al.ray).applyMatrix4(_l);var Dl=Il/((this.scale.x+this.scale.y+this.scale.z)/3),Gl=new Z;if(Rl.isBufferGeometry){var Bl=Rl.index,Fl=Rl.attributes,Nl=Fl.position.array;if(null!==Bl){var Ul=Bl.array;for(var Hl=0,zl=Ul.length;Hl<zl;Hl++){var Ol=Ul[Hl];Gl.fromArray(Nl,3*Ol),Ql(Gl,Ol)}}else for(var Hl=0,Vl=Nl.length/3;Hl<Vl;Hl++)Gl.fromArray(Nl,3*Hl),Ql(Gl,Hl)}else{var Wl=Rl.vertices;for(var Hl=0,Vl=Wl.length;Hl<Vl;Hl++)Ql(Wl[Hl],Hl)}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Tr.prototype=Object.assign(Object.create(at.prototype),{constructor:Tr}),br.prototype=Object.create(O.prototype),br.prototype.constructor=br,vr.prototype=Object.create(O.prototype),vr.prototype.constructor=vr,vr.prototype.isCompressedTexture=!0,_r.prototype=Object.create(O.prototype),_r.prototype.constructor=_r,Sr.prototype=Object.create(O.prototype),Sr.prototype.constructor=Sr,Sr.prototype.isDepthTexture=!0,Er.prototype=Object.create(St.prototype),Er.prototype.constructor=Er,Mr.prototype=Object.create(St.prototype),Mr.prototype.constructor=Mr,Ar.prototype=Object.create(vt.prototype),Ar.prototype.constructor=Ar,Pr.prototype=Object.create(St.prototype),Pr.prototype.constructor=Pr,Lr.prototype=Object.create(Pr.prototype),Lr.prototype.constructor=Lr,wr.prototype=Object.create(vt.prototype),wr.prototype.constructor=wr,Rr.prototype=Object.create(Pr.prototype),Rr.prototype.constructor=Rr,Cr.prototype=Object.create(vt.prototype),Cr.prototype.constructor=Cr,Ir.prototype=Object.create(Pr.prototype),Ir.prototype.constructor=Ir,Dr.prototype=Object.create(vt.prototype),Dr.prototype.constructor=Dr,Gr.prototype=Object.create(Pr.prototype),Gr.prototype.constructor=Gr,Br.prototype=Object.create(vt.prototype),Br.prototype.constructor=Br,Fr.prototype=Object.create(vt.prototype),Fr.prototype.constructor=Fr,Nr.prototype=Object.create(St.prototype),Nr.prototype.constructor=Nr,Ur.prototype=Object.create(vt.prototype),Ur.prototype.constructor=Ur,Hr.prototype=Object.create(St.prototype),Hr.prototype.constructor=Hr,zr.prototype=Object.create(vt.prototype),zr.prototype.constructor=zr,Or.prototype=Object.create(St.prototype),Or.prototype.constructor=Or,Vr.prototype=Object.create(vt.prototype),Vr.prototype.constructor=Vr;var Ws={area:function(_l){var Sl=_l.length,El=0;for(var Ml=Sl-1,Al=0;Al<Sl;Ml=Al++)El+=_l[Ml].x*_l[Al].y-_l[Al].x*_l[Ml].y;return 0.5*El},triangulate:function(){function _l(Sl,El,Ml,Al,Pl,Ll){var wl,Rl,Cl,Il,Dl,Gl,Bl,Fl,Nl;if(Rl=Sl[Ll[El]].x,Cl=Sl[Ll[El]].y,Il=Sl[Ll[Ml]].x,Dl=Sl[Ll[Ml]].y,Gl=Sl[Ll[Al]].x,Bl=Sl[Ll[Al]].y,0>=(Il-Rl)*(Bl-Cl)-(Dl-Cl)*(Gl-Rl))return!1;var Ul,Hl,zl,Ol,Vl,Wl,Xl,Yl,ql,Zl,Kl,Ql,Jl,$l,ed;for(Ul=Gl-Il,Hl=Bl-Dl,zl=Rl-Gl,Ol=Cl-Bl,Vl=Il-Rl,Wl=Dl-Cl,wl=0;wl<Pl;wl++)if(Fl=Sl[Ll[wl]].x,Nl=Sl[Ll[wl]].y,(Fl!=Rl||Nl!=Cl)&&(Fl!=Il||Nl!=Dl)&&(Fl!=Gl||Nl!=Bl)&&(Xl=Fl-Rl,Yl=Nl-Cl,ql=Fl-Il,Zl=Nl-Dl,Kl=Fl-Gl,Ql=Nl-Bl,ed=Ul*Zl-Hl*ql,Jl=Vl*Yl-Wl*Xl,$l=zl*Ql-Ol*Kl,ed>=-Number.EPSILON&&$l>=-Number.EPSILON&&Jl>=-Number.EPSILON))return!1;return!0}return function(El,Ml){var Al=El.length;if(3>Al)return null;var Pl=[],Ll=[],wl=[],Rl,Cl,Il;if(0<Ws.area(El))for(Cl=0;Cl<Al;Cl++)Ll[Cl]=Cl;else for(Cl=0;Cl<Al;Cl++)Ll[Cl]=Al-1-Cl;var Dl=Al,Gl=2*Dl;for(Cl=Dl-1;2<Dl;){if(0>=Gl--)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),Ml?wl:Pl;if(Rl=Cl,Dl<=Rl&&(Rl=0),Cl=Rl+1,Dl<=Cl&&(Cl=0),Il=Cl+1,Dl<=Il&&(Il=0),_l(El,Rl,Cl,Il,Dl,Ll)){var Bl,Fl,Nl,Ul,Hl;for(Bl=Ll[Rl],Fl=Ll[Cl],Nl=Ll[Il],Pl.push([El[Bl],El[Fl],El[Nl]]),wl.push([Ll[Rl],Ll[Cl],Ll[Il]]),(Ul=Cl,Hl=Cl+1);Hl<Dl;Ul++,Hl++)Ll[Ul]=Ll[Hl];Dl--,Gl=2*Dl}}return Ml?wl:Pl}}(),triangulateShape:function(_l,Sl){function El(zl){var Ol=zl.length;2<Ol&&zl[Ol-1].equals(zl[0])&&zl.pop()}function Ml(zl,Ol,Vl){if(zl.x!==Ol.x){if(zl.x<Ol.x)return zl.x<=Vl.x&&Vl.x<=Ol.x;return Ol.x<=Vl.x&&Vl.x<=zl.x}return zl.y<Ol.y?zl.y<=Vl.y&&Vl.y<=Ol.y:Ol.y<=Vl.y&&Vl.y<=zl.y}function Al(zl,Ol,Vl,Wl,Xl){var Yl=Ol.x-zl.x,ql=Ol.y-zl.y,Zl=Wl.x-Vl.x,Kl=Wl.y-Vl.y,Ql=zl.x-Vl.x,Jl=zl.y-Vl.y,$l=ql*Zl-Yl*Kl,ed=ql*Ql-Yl*Jl;if(Math.abs($l)>Number.EPSILON){var td;if(0<$l){if(0>ed||ed>$l)return[];if(td=Kl*Ql-Zl*Jl,0>td||td>$l)return[]}else{if(0<ed||ed<$l)return[];if(td=Kl*Ql-Zl*Jl,0<td||td<$l)return[]}if(0===td)return Xl&&(0==ed||ed==$l)?[]:[zl];if(td===$l)return Xl&&(0==ed||ed==$l)?[]:[Ol];if(0==ed)return[Vl];if(ed==$l)return[Wl];var rd=td/$l;return[{x:zl.x+rd*Yl,y:zl.y+rd*ql}]}if(0!=ed||Kl*Ql!=Zl*Jl)return[];var od=0==Yl&&0==ql,nd=0==Zl&&0==Kl;if(od&&nd)return zl.x!==Vl.x||zl.y!==Vl.y?[]:[zl];if(od)return Ml(Vl,Wl,zl)?[zl]:[];if(nd)return Ml(zl,Ol,Vl)?[Vl]:[];var sd,ld,dd,cd,ud,md,fd,gd;return(0==Yl?(zl.y<Ol.y?(sd=zl,dd=zl.y,ld=Ol,cd=Ol.y):(sd=Ol,dd=Ol.y,ld=zl,cd=zl.y),Vl.y<Wl.y?(ud=Vl,fd=Vl.y,md=Wl,gd=Wl.y):(ud=Wl,fd=Wl.y,md=Vl,gd=Vl.y)):(zl.x<Ol.x?(sd=zl,dd=zl.x,ld=Ol,cd=Ol.x):(sd=Ol,dd=Ol.x,ld=zl,cd=zl.x),Vl.x<Wl.x?(ud=Vl,fd=Vl.x,md=Wl,gd=Wl.x):(ud=Wl,fd=Wl.x,md=Vl,gd=Vl.x)),dd<=fd)?cd<fd?[]:cd==fd?Xl?[]:[ud]:cd<=gd?[ud,ld]:[ud,md]:dd>gd?[]:dd==gd?Xl?[]:[sd]:cd<=gd?[sd,ld]:[sd,md]}function Pl(zl,Ol,Vl,Wl){var Xl=Ol.x-zl.x,Yl=Ol.y-zl.y,ql=Vl.x-zl.x,Zl=Vl.y-zl.y,Kl=Wl.x-zl.x,Ql=Wl.y-zl.y,Jl=Xl*Zl-Yl*ql,$l=Xl*Ql-Yl*Kl;if(Math.abs(Jl)>Number.EPSILON){var ed=Kl*Zl-Ql*ql;if(0<Jl)return 0<=$l&&0<=ed;return 0<=$l||0<=ed}return 0<$l}El(_l),Sl.forEach(El);var Gl={},Ll,wl,Rl,Cl,Il,Dl,Bl=_l.concat();for(var Fl=0,Nl=Sl.length;Fl<Nl;Fl++)Array.prototype.push.apply(Bl,Sl[Fl]);for(Ll=0,wl=Bl.length;Ll<wl;Ll++)Il=Bl[Ll].x+":"+Bl[Ll].y,void 0!==Gl[Il]&&console.warn("THREE.ShapeUtils: Duplicate point",Il,Ll),Gl[Il]=Ll;var Ul=function(Ol,Vl){function Wl(hd,yd){var xd=ql.length-1,Td=hd-1;0>Td&&(Td=xd);var vd=hd+1;vd>xd&&(vd=0);var _d=Pl(ql[hd],ql[Td],ql[vd],Zl[yd]);if(!_d)return!1;var Sd=Zl.length-1,Ed=yd-1;0>Ed&&(Ed=Sd);var Md=yd+1;return Md>Sd&&(Md=0),_d=Pl(Zl[yd],Zl[Ed],Zl[Md],ql[hd]),!!_d}function Xl(hd,yd){var xd,Td,vd;for(xd=0;xd<ql.length;xd++)if(Td=xd+1,Td%=ql.length,vd=Al(hd,yd,ql[xd],ql[Td],!0),0<vd.length)return!0;return!1}function Yl(hd,yd){var xd,Td,vd,_d,Sd;for(xd=0;xd<Kl.length;xd++)for(Td=Vl[Kl[xd]],vd=0;vd<Td.length;vd++)if(_d=vd+1,_d%=Td.length,Sd=Al(hd,yd,Td[vd],Td[_d],!0),0<Sd.length)return!0;return!1}var ql=Ol.concat(),Zl,Kl=[],Ql,Jl,$l,ed,td,rd,od=[],nd,sd,ld,dd;for(var cd=0,ud=Vl.length;cd<ud;cd++)Kl.push(cd);for(var md=0,fd=2*Kl.length;0<Kl.length;){if(fd--,0>fd){console.log("Infinite Loop! Holes left:"+Kl.length+", Probably Hole outside Shape!");break}for(Jl=md;Jl<ql.length;Jl++){$l=ql[Jl],Ql=-1;for(var cd=0;cd<Kl.length;cd++)if(td=Kl[cd],rd=$l.x+":"+$l.y+":"+td,void 0===od[rd]){Zl=Vl[td];for(var gd=0;gd<Zl.length;gd++)if(ed=Zl[gd],Wl(Jl,gd)&&!Xl($l,ed)&&!Yl($l,ed)){Ql=gd,Kl.splice(cd,1),nd=ql.slice(0,Jl+1),sd=ql.slice(Jl),ld=Zl.slice(Ql),dd=Zl.slice(0,Ql+1),ql=nd.concat(ld).concat(dd).concat(sd),md=Jl;break}if(0<=Ql)break;od[rd]=!0}if(0<=Ql)break}}return ql}(_l,Sl),Hl=Ws.triangulate(Ul,!1);for(Ll=0,wl=Hl.length;Ll<wl;Ll++)for(Cl=Hl[Ll],Rl=0;3>Rl;Rl++)Il=Cl[Rl].x+":"+Cl[Rl].y,Dl=Gl[Il],void 0!=Dl&&(Cl[Rl]=Dl);return Hl.concat()},isClockWise:function(_l){return 0>Ws.area(_l)},b2:function(){function _l(Ml,Al){var Pl=1-Ml;return Pl*Pl*Al}function Sl(Ml,Al){return 2*(1-Ml)*Ml*Al}function El(Ml,Al){return Ml*Ml*Al}return function(Al,Pl,Ll,wl){return _l(Al,Pl)+Sl(Al,Ll)+El(Al,wl)}}(),b3:function(){function _l(Al,Pl){var Ll=1-Al;return Ll*Ll*Ll*Pl}function Sl(Al,Pl){var Ll=1-Al;return 3*Ll*Ll*Al*Pl}function El(Al,Pl){return 3*(1-Al)*Al*Al*Pl}function Ml(Al,Pl){return Al*Al*Al*Pl}return function(Pl,Ll,wl,Rl,Cl){return _l(Pl,Ll)+Sl(Pl,wl)+El(Pl,Rl)+Ml(Pl,Cl)}}()};kr.prototype=Object.create(vt.prototype),kr.prototype.constructor=kr,kr.prototype.addShapeList=function(_l,Sl){var El=_l.length;for(var Ml=0;Ml<El;Ml++){var Al=_l[Ml];this.addShape(Al,Sl)}},kr.prototype.addShape=function(_l,Sl){function El(Md,Ad,Pd){return Ad||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ad.clone().multiplyScalar(Pd).add(Md)}function Ml(Md,Ad,Pd){var Rd=1,Ld,wd,Cd=Md.x-Ad.x,Id=Md.y-Ad.y,Dd=Pd.x-Md.x,Gd=Pd.y-Md.y,Bd=Cd*Cd+Id*Id;if(Math.abs(Cd*Gd-Id*Dd)>Number.EPSILON){var Fd=Math.sqrt(Bd),Nd=Math.sqrt(Dd*Dd+Gd*Gd),Ud=Ad.x-Id/Fd,Hd=Ad.y+Cd/Fd,zd=Pd.x-Gd/Nd,Od=Pd.y+Dd/Nd,Vd=((zd-Ud)*Gd-(Od-Hd)*Dd)/(Cd*Gd-Id*Dd);Ld=Ud+Cd*Vd-Md.x,wd=Hd+Id*Vd-Md.y;var kd=Ld*Ld+wd*wd;if(2>=kd)return new H(Ld,wd);Rd=Math.sqrt(kd/2)}else{var Wd=!1;Cd>Number.EPSILON?Dd>Number.EPSILON&&(Wd=!0):Cd<-Number.EPSILON?Dd<-Number.EPSILON&&(Wd=!0):Math.sign(Id)===Math.sign(Gd)&&(Wd=!0),Wd?(Ld=-Id,wd=Cd,Rd=Math.sqrt(Bd)):(Ld=Cd,wd=Id,Rd=Math.sqrt(Bd/2))}return new H(Ld/Rd,wd/Rd)}function Al(Md,Ad){var Pd,Ld;for(hd=Md.length;0<=--hd;){Pd=hd,Ld=hd-1,0>Ld&&(Ld=Md.length-1);var wd=0,Rd=Fl+2*Dl;for(wd=0;wd<Rd;wd++){var Cd=ud*wd,Id=ud*(wd+1),Dd=Ad+Pd+Cd,Gd=Ad+Ld+Cd,Bd=Ad+Ld+Id,Fd=Ad+Pd+Id;wl(Dd,Gd,Bd,Fd,Md,wd,Rd,Pd,Ld)}}}function Pl(Md,Ad,Pd){Kl.vertices.push(new Z(Md,Ad,Pd))}function Ll(Md,Ad,Pd){Md+=Ql,Ad+=Ql,Pd+=Ql,Kl.faces.push(new nt(Md,Ad,Pd,null,null,0));var Ld=zl.generateTopUV(Kl,Md,Ad,Pd);Kl.faceVertexUvs[0].push(Ld)}function wl(Md,Ad,Pd,Ld){Md+=Ql,Ad+=Ql,Pd+=Ql,Ld+=Ql,Kl.faces.push(new nt(Md,Ad,Ld,null,null,1)),Kl.faces.push(new nt(Ad,Pd,Ld,null,null,1));var wd=zl.generateSideWallUV(Kl,Md,Ad,Pd,Ld);Kl.faceVertexUvs[0].push([wd[0],wd[1],wd[3]]),Kl.faceVertexUvs[0].push([wd[1],wd[2],wd[3]])}var Rl=Sl.amount===void 0?100:Sl.amount,Cl=Sl.bevelThickness===void 0?6:Sl.bevelThickness,Il=Sl.bevelSize===void 0?Cl-2:Sl.bevelSize,Dl=Sl.bevelSegments===void 0?3:Sl.bevelSegments,Gl=!(Sl.bevelEnabled!==void 0)||Sl.bevelEnabled,Bl=Sl.curveSegments===void 0?12:Sl.curveSegments,Fl=Sl.steps===void 0?1:Sl.steps,Nl=Sl.extrudePath,Ul,Hl=!1,zl=Sl.UVGenerator===void 0?kr.WorldUVGenerator:Sl.UVGenerator,Ol,Vl,Wl,Xl;Nl&&(Ul=Nl.getSpacedPoints(Fl),Hl=!0,Gl=!1,Ol=Sl.frames===void 0?Nl.computeFrenetFrames(Fl,!1):Sl.frames,Vl=new Z,Wl=new Z,Xl=new Z),Gl||(Dl=0,Cl=0,Il=0);var Yl,ql,Zl,Kl=this,Ql=this.vertices.length,Jl=_l.extractPoints(Bl),$l=Jl.shape,ed=Jl.holes,td=!Ws.isClockWise($l);if(td){for($l=$l.reverse(),ql=0,Zl=ed.length;ql<Zl;ql++)Yl=ed[ql],Ws.isClockWise(Yl)&&(ed[ql]=Yl.reverse());td=!1}var rd=Ws.triangulateShape($l,ed),od=$l;for(ql=0,Zl=ed.length;ql<Zl;ql++)Yl=ed[ql],$l=$l.concat(Yl);var ud=$l.length,fd=rd.length,nd,sd,ld,dd,cd,md,gd=[];for(var hd=0,yd=od.length,xd=yd-1,Td=hd+1;hd<yd;hd++,xd++,Td++)xd===yd&&(xd=0),Td===yd&&(Td=0),gd[hd]=Ml(od[hd],od[xd],od[Td]);var vd=[],Sd=gd.concat(),_d;for(ql=0,Zl=ed.length;ql<Zl;ql++){for(Yl=ed[ql],_d=[],(hd=0,yd=Yl.length,xd=yd-1,Td=hd+1);hd<yd;hd++,xd++,Td++)xd===yd&&(xd=0),Td===yd&&(Td=0),_d[hd]=Ml(Yl[hd],Yl[xd],Yl[Td]);vd.push(_d),Sd=Sd.concat(_d)}for(nd=0;nd<Dl;nd++){for(ld=nd/Dl,dd=Cl*Math.cos(ld*Math.PI/2),sd=Il*Math.sin(ld*Math.PI/2),(hd=0,yd=od.length);hd<yd;hd++)cd=El(od[hd],gd[hd],sd),Pl(cd.x,cd.y,-dd);for(ql=0,Zl=ed.length;ql<Zl;ql++)for(Yl=ed[ql],_d=vd[ql],(hd=0,yd=Yl.length);hd<yd;hd++)cd=El(Yl[hd],_d[hd],sd),Pl(cd.x,cd.y,-dd)}for(sd=Il,hd=0;hd<ud;hd++)cd=Gl?El($l[hd],Sd[hd],sd):$l[hd],Hl?(Wl.copy(Ol.normals[0]).multiplyScalar(cd.x),Vl.copy(Ol.binormals[0]).multiplyScalar(cd.y),Xl.copy(Ul[0]).add(Wl).add(Vl),Pl(Xl.x,Xl.y,Xl.z)):Pl(cd.x,cd.y,0);var Ed;for(Ed=1;Ed<=Fl;Ed++)for(hd=0;hd<ud;hd++)cd=Gl?El($l[hd],Sd[hd],sd):$l[hd],Hl?(Wl.copy(Ol.normals[Ed]).multiplyScalar(cd.x),Vl.copy(Ol.binormals[Ed]).multiplyScalar(cd.y),Xl.copy(Ul[Ed]).add(Wl).add(Vl),Pl(Xl.x,Xl.y,Xl.z)):Pl(cd.x,cd.y,Rl/Fl*Ed);for(nd=Dl-1;0<=nd;nd--){for(ld=nd/Dl,dd=Cl*Math.cos(ld*Math.PI/2),sd=Il*Math.sin(ld*Math.PI/2),(hd=0,yd=od.length);hd<yd;hd++)cd=El(od[hd],gd[hd],sd),Pl(cd.x,cd.y,Rl+dd);for(ql=0,Zl=ed.length;ql<Zl;ql++)for(Yl=ed[ql],_d=vd[ql],(hd=0,yd=Yl.length);hd<yd;hd++)cd=El(Yl[hd],_d[hd],sd),Hl?Pl(cd.x,cd.y+Ul[Fl-1].y,Ul[Fl-1].x+dd):Pl(cd.x,cd.y,Rl+dd)}(function(){if(Gl){var Ad=0,Pd=ud*Ad;for(hd=0;hd<fd;hd++)md=rd[hd],Ll(md[2]+Pd,md[1]+Pd,md[0]+Pd);for(Ad=Fl+2*Dl,Pd=ud*Ad,hd=0;hd<fd;hd++)md=rd[hd],Ll(md[0]+Pd,md[1]+Pd,md[2]+Pd)}else{for(hd=0;hd<fd;hd++)md=rd[hd],Ll(md[2],md[1],md[0]);for(hd=0;hd<fd;hd++)md=rd[hd],Ll(md[0]+ud*Fl,md[1]+ud*Fl,md[2]+ud*Fl)}})(),function(){var Ad=0;for(Al(od,Ad),Ad+=od.length,(ql=0,Zl=ed.length);ql<Zl;ql++)Yl=ed[ql],Al(Yl,Ad),Ad+=Yl.length}()},kr.WorldUVGenerator={generateTopUV:function(_l,Sl,El,Ml){var Al=_l.vertices,Pl=Al[Sl],Ll=Al[El],wl=Al[Ml];return[new H(Pl.x,Pl.y),new H(Ll.x,Ll.y),new H(wl.x,wl.y)]},generateSideWallUV:function(_l,Sl,El,Ml,Al){var Pl=_l.vertices,Ll=Pl[Sl],wl=Pl[El],Rl=Pl[Ml],Cl=Pl[Al];return 0.01>Math.abs(Ll.y-wl.y)?[new H(Ll.x,1-Ll.z),new H(wl.x,1-wl.z),new H(Rl.x,1-Rl.z),new H(Cl.x,1-Cl.z)]:[new H(Ll.y,1-Ll.z),new H(wl.y,1-wl.z),new H(Rl.y,1-Rl.z),new H(Cl.y,1-Cl.z)]}},Wr.prototype=Object.create(kr.prototype),Wr.prototype.constructor=Wr,Xr.prototype=Object.create(St.prototype),Xr.prototype.constructor=Xr,jr.prototype=Object.create(vt.prototype),jr.prototype.constructor=jr,Yr.prototype=Object.create(St.prototype),Yr.prototype.constructor=Yr,qr.prototype=Object.create(vt.prototype),qr.prototype.constructor=qr,Zr.prototype=Object.create(vt.prototype),Zr.prototype.constructor=Zr,Kr.prototype=Object.create(St.prototype),Kr.prototype.constructor=Kr,Qr.prototype=Object.create(vt.prototype),Qr.prototype.constructor=Qr,Jr.prototype=Object.create(St.prototype),Jr.prototype.constructor=Jr,$r.prototype=Object.create(vt.prototype),$r.prototype.constructor=$r,ea.prototype=Object.create(St.prototype),ea.prototype.constructor=ea,ta.prototype=Object.create(St.prototype),ta.prototype.constructor=ta,ra.prototype=Object.create(vt.prototype),ra.prototype.constructor=ra,oa.prototype=Object.create(ra.prototype),oa.prototype.constructor=oa,ia.prototype=Object.create(ta.prototype),ia.prototype.constructor=ia,na.prototype=Object.create(St.prototype),na.prototype.constructor=na,sa.prototype=Object.create(vt.prototype),sa.prototype.constructor=sa,la.prototype=Object.create(vt.prototype),la.prototype.constructor=la;var Xs=Object.freeze({WireframeGeometry:Er,ParametricGeometry:Ar,ParametricBufferGeometry:Mr,TetrahedronGeometry:wr,TetrahedronBufferGeometry:Lr,OctahedronGeometry:Cr,OctahedronBufferGeometry:Rr,IcosahedronGeometry:Dr,IcosahedronBufferGeometry:Ir,DodecahedronGeometry:Br,DodecahedronBufferGeometry:Gr,PolyhedronGeometry:Fr,PolyhedronBufferGeometry:Pr,TubeGeometry:Ur,TubeBufferGeometry:Nr,TorusKnotGeometry:zr,TorusKnotBufferGeometry:Hr,TorusGeometry:Vr,TorusBufferGeometry:Or,TextGeometry:Wr,SphereBufferGeometry:Xr,SphereGeometry:jr,RingGeometry:qr,RingBufferGeometry:Yr,PlaneBufferGeometry:At,PlaneGeometry:Zr,LatheGeometry:Qr,LatheBufferGeometry:Kr,ShapeGeometry:$r,ShapeBufferGeometry:Jr,ExtrudeGeometry:kr,EdgesGeometry:ea,ConeGeometry:oa,ConeBufferGeometry:ia,CylinderGeometry:ra,CylinderBufferGeometry:ta,CircleBufferGeometry:na,CircleGeometry:sa,BoxBufferGeometry:Mt,BoxGeometry:la});da.prototype=Object.create(je.prototype),da.prototype.constructor=da,da.prototype.isShadowMaterial=!0,ca.prototype=Object.create(je.prototype),ca.prototype.constructor=ca,ca.prototype.isRawShaderMaterial=!0,ma.prototype={constructor:ma,isMultiMaterial:!0,toJSON:function(_l){var Sl={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},El=this.materials;for(var Ml=0,Al=El.length;Ml<Al;Ml++){var Pl=El[Ml].toJSON(_l);delete Pl.metadata,Sl.materials.push(Pl)}return Sl.visible=this.visible,Sl},clone:function(){var _l=new this.constructor;for(var Sl=0;Sl<this.materials.length;Sl++)_l.materials.push(this.materials[Sl].clone());return _l.visible=this.visible,_l}},fa.prototype=Object.create(Xe.prototype),fa.prototype.constructor=fa,fa.prototype.isMeshStandardMaterial=!0,fa.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.defines={STANDARD:""},this.color.copy(_l.color),this.roughness=_l.roughness,this.metalness=_l.metalness,this.map=_l.map,this.lightMap=_l.lightMap,this.lightMapIntensity=_l.lightMapIntensity,this.aoMap=_l.aoMap,this.aoMapIntensity=_l.aoMapIntensity,this.emissive.copy(_l.emissive),this.emissiveMap=_l.emissiveMap,this.emissiveIntensity=_l.emissiveIntensity,this.bumpMap=_l.bumpMap,this.bumpScale=_l.bumpScale,this.normalMap=_l.normalMap,this.normalScale.copy(_l.normalScale),this.displacementMap=_l.displacementMap,this.displacementScale=_l.displacementScale,this.displacementBias=_l.displacementBias,this.roughnessMap=_l.roughnessMap,this.metalnessMap=_l.metalnessMap,this.alphaMap=_l.alphaMap,this.envMap=_l.envMap,this.envMapIntensity=_l.envMapIntensity,this.refractionRatio=_l.refractionRatio,this.wireframe=_l.wireframe,this.wireframeLinewidth=_l.wireframeLinewidth,this.wireframeLinecap=_l.wireframeLinecap,this.wireframeLinejoin=_l.wireframeLinejoin,this.skinning=_l.skinning,this.morphTargets=_l.morphTargets,this.morphNormals=_l.morphNormals,this},ga.prototype=Object.create(fa.prototype),ga.prototype.constructor=ga,ga.prototype.isMeshPhysicalMaterial=!0,ga.prototype.copy=function(_l){return fa.prototype.copy.call(this,_l),this.defines={PHYSICAL:""},this.reflectivity=_l.reflectivity,this.clearCoat=_l.clearCoat,this.clearCoatRoughness=_l.clearCoatRoughness,this},ha.prototype=Object.create(Xe.prototype),ha.prototype.constructor=ha,ha.prototype.isMeshPhongMaterial=!0,ha.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.color.copy(_l.color),this.specular.copy(_l.specular),this.shininess=_l.shininess,this.map=_l.map,this.lightMap=_l.lightMap,this.lightMapIntensity=_l.lightMapIntensity,this.aoMap=_l.aoMap,this.aoMapIntensity=_l.aoMapIntensity,this.emissive.copy(_l.emissive),this.emissiveMap=_l.emissiveMap,this.emissiveIntensity=_l.emissiveIntensity,this.bumpMap=_l.bumpMap,this.bumpScale=_l.bumpScale,this.normalMap=_l.normalMap,this.normalScale.copy(_l.normalScale),this.displacementMap=_l.displacementMap,this.displacementScale=_l.displacementScale,this.displacementBias=_l.displacementBias,this.specularMap=_l.specularMap,this.alphaMap=_l.alphaMap,this.envMap=_l.envMap,this.combine=_l.combine,this.reflectivity=_l.reflectivity,this.refractionRatio=_l.refractionRatio,this.wireframe=_l.wireframe,this.wireframeLinewidth=_l.wireframeLinewidth,this.wireframeLinecap=_l.wireframeLinecap,this.wireframeLinejoin=_l.wireframeLinejoin,this.skinning=_l.skinning,this.morphTargets=_l.morphTargets,this.morphNormals=_l.morphNormals,this},ya.prototype=Object.create(ha.prototype),ya.prototype.constructor=ya,ya.prototype.isMeshToonMaterial=!0,ya.prototype.copy=function(_l){return ha.prototype.copy.call(this,_l),this.gradientMap=_l.gradientMap,this},xa.prototype=Object.create(Xe.prototype),xa.prototype.constructor=xa,xa.prototype.isMeshNormalMaterial=!0,xa.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.bumpMap=_l.bumpMap,this.bumpScale=_l.bumpScale,this.normalMap=_l.normalMap,this.normalScale.copy(_l.normalScale),this.displacementMap=_l.displacementMap,this.displacementScale=_l.displacementScale,this.displacementBias=_l.displacementBias,this.wireframe=_l.wireframe,this.wireframeLinewidth=_l.wireframeLinewidth,this.skinning=_l.skinning,this.morphTargets=_l.morphTargets,this.morphNormals=_l.morphNormals,this},Ta.prototype=Object.create(Xe.prototype),Ta.prototype.constructor=Ta,Ta.prototype.isMeshLambertMaterial=!0,Ta.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.color.copy(_l.color),this.map=_l.map,this.lightMap=_l.lightMap,this.lightMapIntensity=_l.lightMapIntensity,this.aoMap=_l.aoMap,this.aoMapIntensity=_l.aoMapIntensity,this.emissive.copy(_l.emissive),this.emissiveMap=_l.emissiveMap,this.emissiveIntensity=_l.emissiveIntensity,this.specularMap=_l.specularMap,this.alphaMap=_l.alphaMap,this.envMap=_l.envMap,this.combine=_l.combine,this.reflectivity=_l.reflectivity,this.refractionRatio=_l.refractionRatio,this.wireframe=_l.wireframe,this.wireframeLinewidth=_l.wireframeLinewidth,this.wireframeLinecap=_l.wireframeLinecap,this.wireframeLinejoin=_l.wireframeLinejoin,this.skinning=_l.skinning,this.morphTargets=_l.morphTargets,this.morphNormals=_l.morphNormals,this},ba.prototype=Object.create(Xe.prototype),ba.prototype.constructor=ba,ba.prototype.isLineDashedMaterial=!0,ba.prototype.copy=function(_l){return Xe.prototype.copy.call(this,_l),this.color.copy(_l.color),this.linewidth=_l.linewidth,this.scale=_l.scale,this.dashSize=_l.dashSize,this.gapSize=_l.gapSize,this};var js=Object.freeze({ShadowMaterial:da,SpriteMaterial:sr,RawShaderMaterial:ca,ShaderMaterial:je,PointsMaterial:yr,MultiMaterial:ma,MeshPhysicalMaterial:ga,MeshStandardMaterial:fa,MeshPhongMaterial:ha,MeshToonMaterial:ya,MeshNormalMaterial:xa,MeshLambertMaterial:Ta,MeshDepthMaterial:Ye,MeshBasicMaterial:st,LineDashedMaterial:ba,LineBasicMaterial:fr,Material:Xe}),Ys={enabled:!1,files:{},add:function(_l,Sl){!1===this.enabled||(this.files[_l]=Sl)},get:function(_l){if(!1!==this.enabled)return this.files[_l]},remove:function(_l){delete this.files[_l]},clear:function(){this.files={}}},qs=new va;Object.assign(_a.prototype,{load:function(_l,Sl,El,Ml){void 0===_l&&(_l=""),void 0!==this.path&&(_l=this.path+_l);var Al=this,Pl=Ys.get(_l);if(void 0!==Pl)return Al.manager.itemStart(_l),setTimeout(function(){Sl&&Sl(Pl),Al.manager.itemEnd(_l)},0),Pl;var Ll=/^data:(.*?)(;base64)?,(.*)$/,wl=_l.match(Ll);if(wl){var Rl=wl[1],Cl=!!wl[2],Il=wl[3];Il=window.decodeURIComponent(Il),Cl&&(Il=window.atob(Il));try{var Gl=(this.responseType||"").toLowerCase(),Dl;switch(Gl){case"arraybuffer":case"blob":Dl=new ArrayBuffer(Il.length);var Bl=new Uint8Array(Dl);for(var Fl=0;Fl<Il.length;Fl++)Bl[Fl]=Il.charCodeAt(Fl);"blob"===Gl&&(Dl=new Blob([Dl],{type:Rl}));break;case"document":var Nl=new DOMParser;Dl=Nl.parseFromString(Il,Rl);break;case"json":Dl=JSON.parse(Il);break;default:Dl=Il;}window.setTimeout(function(){Sl&&Sl(Dl),Al.manager.itemEnd(_l)},0)}catch(Hl){window.setTimeout(function(){Ml&&Ml(Hl),Al.manager.itemError(_l)},0)}}else{var Ul=new XMLHttpRequest;Ul.open("GET",_l,!0),Ul.addEventListener("load",function(Hl){var zl=Hl.target.response;Ys.add(_l,zl),200===this.status?(Sl&&Sl(zl),Al.manager.itemEnd(_l)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),Sl&&Sl(zl),Al.manager.itemEnd(_l)):(Ml&&Ml(Hl),Al.manager.itemError(_l))},!1),void 0!==El&&Ul.addEventListener("progress",function(Hl){El(Hl)},!1),Ul.addEventListener("error",function(Hl){Ml&&Ml(Hl),Al.manager.itemError(_l)},!1),void 0!==this.responseType&&(Ul.responseType=this.responseType),void 0!==this.withCredentials&&(Ul.withCredentials=this.withCredentials),Ul.overrideMimeType&&Ul.overrideMimeType(void 0===this.mimeType?"text/plain":this.mimeType),Ul.send(null)}return Al.manager.itemStart(_l),Ul},setPath:function(_l){return this.path=_l,this},setResponseType:function(_l){return this.responseType=_l,this},setWithCredentials:function(_l){return this.withCredentials=_l,this},setMimeType:function(_l){return this.mimeType=_l,this}}),Object.assign(Sa.prototype,{load:function(_l,Sl,El,Ml){function Al(Gl){Rl.load(_l[Gl],function(Bl){var Fl=Pl._parser(Bl,!0);Ll[Gl]={width:Fl.width,height:Fl.height,format:Fl.format,mipmaps:Fl.mipmaps},Cl+=1,6===Cl&&(1===Fl.mipmapCount&&(wl.minFilter=Pn),wl.format=Fl.format,wl.needsUpdate=!0,Sl&&Sl(wl))},El,Ml)}var Pl=this,Ll=[],wl=new vr;wl.image=Ll;var Rl=new _a(this.manager);if(Rl.setPath(this.path),Rl.setResponseType("arraybuffer"),Array.isArray(_l)){var Cl=0;for(var Il=0,Dl=_l.length;Il<Dl;++Il)Al(Il)}else Rl.load(_l,function(Gl){var Bl=Pl._parser(Gl,!0);if(Bl.isCubemap){var Fl=Bl.mipmaps.length/Bl.mipmapCount;for(var Nl=0;Nl<Fl;Nl++){Ll[Nl]={mipmaps:[]};for(var Ul=0;Ul<Bl.mipmapCount;Ul++)Ll[Nl].mipmaps.push(Bl.mipmaps[Nl*Bl.mipmapCount+Ul]),Ll[Nl].format=Bl.format,Ll[Nl].width=Bl.width,Ll[Nl].height=Bl.height}}else wl.image.width=Bl.width,wl.image.height=Bl.height,wl.mipmaps=Bl.mipmaps;1===Bl.mipmapCount&&(wl.minFilter=Pn),wl.format=Bl.format,wl.needsUpdate=!0,Sl&&Sl(wl)},El,Ml);return wl},setPath:function(_l){return this.path=_l,this}}),Object.assign(Ea.prototype,{load:function(_l,Sl,El,Ml){var Al=this,Pl=new Oe,Ll=new _a(this.manager);return Ll.setResponseType("arraybuffer"),Ll.load(_l,function(wl){var Rl=Al._parser(wl);Rl&&(void 0===Rl.image?void 0!==Rl.data&&(Pl.image.width=Rl.width,Pl.image.height=Rl.height,Pl.image.data=Rl.data):Pl.image=Rl.image,Pl.wrapS=void 0===Rl.wrapS?vn:Rl.wrapS,Pl.wrapT=void 0===Rl.wrapT?vn:Rl.wrapT,Pl.magFilter=void 0===Rl.magFilter?Pn:Rl.magFilter,Pl.minFilter=void 0===Rl.minFilter?wn:Rl.minFilter,Pl.anisotropy=void 0===Rl.anisotropy?1:Rl.anisotropy,void 0!==Rl.format&&(Pl.format=Rl.format),void 0!==Rl.type&&(Pl.type=Rl.type),void 0!==Rl.mipmaps&&(Pl.mipmaps=Rl.mipmaps),1===Rl.mipmapCount&&(Pl.minFilter=Pn),Pl.needsUpdate=!0,Sl&&Sl(Pl,Rl))},El,Ml),Pl}}),Object.assign(Ma.prototype,{load:function(_l,Sl,El,Ml){var Al=this,Pl=document.createElementNS("http://www.w3.org/1999/xhtml","img");if(Pl.onload=function(){Pl.onload=null,URL.revokeObjectURL(Pl.src),Sl&&Sl(Pl),Al.manager.itemEnd(_l)},Pl.onerror=Ml,0===_l.indexOf("data:"))Pl.src=_l;else if(void 0!==this.crossOrigin)Pl.crossOrigin=this.crossOrigin,Pl.src=_l;else{var Ll=new _a;Ll.setPath(this.path),Ll.setResponseType("blob"),Ll.setWithCredentials(this.withCredentials),Ll.load(_l,function(wl){Pl.src=URL.createObjectURL(wl)},El,Ml)}return Al.manager.itemStart(_l),Pl},setCrossOrigin:function(_l){return this.crossOrigin=_l,this},setWithCredentials:function(_l){return this.withCredentials=_l,this},setPath:function(_l){return this.path=_l,this}}),Object.assign(Aa.prototype,{load:function(_l,Sl,El,Ml){function Al(Cl){Ll.load(_l[Cl],function(Il){Pl.images[Cl]=Il,wl++,6===wl&&(Pl.needsUpdate=!0,Sl&&Sl(Pl))},void 0,Ml)}var Pl=new Q,Ll=new Ma(this.manager);Ll.setCrossOrigin(this.crossOrigin),Ll.setPath(this.path);var wl=0;for(var Rl=0;Rl<_l.length;++Rl)Al(Rl);return Pl},setCrossOrigin:function(_l){return this.crossOrigin=_l,this},setPath:function(_l){return this.path=_l,this}}),Object.assign(Pa.prototype,{load:function(_l,Sl,El,Ml){var Al=new O,Pl=new Ma(this.manager);return Pl.setCrossOrigin(this.crossOrigin),Pl.setWithCredentials(this.withCredentials),Pl.setPath(this.path),Pl.load(_l,function(Ll){var wl=0<_l.search(/\.(jpg|jpeg)$/)||0===_l.search(/^data\:image\/jpeg/);Al.format=wl?Wn:Xn,Al.image=Ll,Al.needsUpdate=!0,void 0!==Sl&&Sl(Al)},El,Ml),Al},setCrossOrigin:function(_l){return this.crossOrigin=_l,this},setWithCredentials:function(_l){return this.withCredentials=_l,this},setPath:function(_l){return this.path=_l,this}}),La.prototype=Object.assign(Object.create(at.prototype),{constructor:La,isLight:!0,copy:function(_l){return at.prototype.copy.call(this,_l),this.color.copy(_l.color),this.intensity=_l.intensity,this},toJSON:function(_l){var Sl=at.prototype.toJSON.call(this,_l);return Sl.object.color=this.color.getHex(),Sl.object.intensity=this.intensity,void 0!==this.groundColor&&(Sl.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(Sl.object.distance=this.distance),void 0!==this.angle&&(Sl.object.angle=this.angle),void 0!==this.decay&&(Sl.object.decay=this.decay),void 0!==this.penumbra&&(Sl.object.penumbra=this.penumbra),void 0!==this.shadow&&(Sl.object.shadow=this.shadow.toJSON()),Sl}}),wa.prototype=Object.assign(Object.create(La.prototype),{constructor:wa,isHemisphereLight:!0,copy:function(_l){return La.prototype.copy.call(this,_l),this.groundColor.copy(_l.groundColor),this}}),Object.assign(Ra.prototype,{copy:function(_l){return this.camera=_l.camera.clone(),this.bias=_l.bias,this.radius=_l.radius,this.mapSize.copy(_l.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var _l={};return 0!==this.bias&&(_l.bias=this.bias),1!==this.radius&&(_l.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(_l.mapSize=this.mapSize.toArray()),_l.camera=this.camera.toJSON(!1).object,delete _l.camera.matrix,_l}}),Ca.prototype=Object.assign(Object.create(Ra.prototype),{constructor:Ca,isSpotLightShadow:!0,update:function(_l){var Sl=2*Ls.RAD2DEG*_l.angle,El=this.mapSize.width/this.mapSize.height,Ml=_l.distance||500,Al=this.camera;(Sl!==Al.fov||El!==Al.aspect||Ml!==Al.far)&&(Al.fov=Sl,Al.aspect=El,Al.far=Ml,Al.updateProjectionMatrix())}}),Ia.prototype=Object.assign(Object.create(La.prototype),{constructor:Ia,isSpotLight:!0,copy:function(_l){return La.prototype.copy.call(this,_l),this.distance=_l.distance,this.angle=_l.angle,this.penumbra=_l.penumbra,this.decay=_l.decay,this.target=_l.target.clone(),this.shadow=_l.shadow.clone(),this}}),Da.prototype=Object.assign(Object.create(La.prototype),{constructor:Da,isPointLight:!0,copy:function(_l){return La.prototype.copy.call(this,_l),this.distance=_l.distance,this.decay=_l.decay,this.shadow=_l.shadow.clone(),this}}),Ga.prototype=Object.assign(Object.create(Ra.prototype),{constructor:Ga}),Ba.prototype=Object.assign(Object.create(La.prototype),{constructor:Ba,isDirectionalLight:!0,copy:function(_l){return La.prototype.copy.call(this,_l),this.target=_l.target.clone(),this.shadow=_l.shadow.clone(),this}}),Fa.prototype=Object.assign(Object.create(La.prototype),{constructor:Fa,isAmbientLight:!0});var Zs={arraySlice:function(_l,Sl,El){return Zs.isTypedArray(_l)?new _l.constructor(_l.subarray(Sl,El)):_l.slice(Sl,El)},convertArray:function(_l,Sl,El){return _l&&(El||_l.constructor!==Sl)?"number"==typeof Sl.BYTES_PER_ELEMENT?new Sl(_l):Array.prototype.slice.call(_l):_l},isTypedArray:function(_l){return ArrayBuffer.isView(_l)&&!(_l instanceof DataView)},getKeyframeOrder:function(_l){var Sl=_l.length,El=Array(Sl);for(var Ml=0;Ml!==Sl;++Ml)El[Ml]=Ml;return El.sort(function(Pl,Ll){return _l[Pl]-_l[Ll]}),El},sortedArray:function(_l,Sl,El){var Ml=_l.length,Al=new _l.constructor(Ml);for(var Pl=0,Ll=0;Ll!==Ml;++Pl){var wl=El[Pl]*Sl;for(var Rl=0;Rl!==Sl;++Rl)Al[Ll++]=_l[wl+Rl]}return Al},flattenJSON:function(_l,Sl,El,Ml){for(var Al=1,Pl=_l[0];Pl!==void 0&&Pl[Ml]===void 0;)Pl=_l[Al++];if(Pl!==void 0){var Ll=Pl[Ml];if(Ll!==void 0)if(Array.isArray(Ll))do Ll=Pl[Ml],void 0!==Ll&&(Sl.push(Pl.time),El.push.apply(El,Ll)),Pl=_l[Al++];while(void 0!==Pl);else if(Ll.toArray!==void 0)do Ll=Pl[Ml],void 0!==Ll&&(Sl.push(Pl.time),Ll.toArray(El,El.length)),Pl=_l[Al++];while(void 0!==Pl);else do Ll=Pl[Ml],void 0!==Ll&&(Sl.push(Pl.time),El.push(Ll)),Pl=_l[Al++];while(void 0!==Pl)}}};Na.prototype={constructor:Na,evaluate:function(_l){var Sl=this.parameterPositions,El=this._cachedIndex,Ml=Sl[El],Al=Sl[El-1];validate_interval:{seek:{var Pl;linear_scan:{forward_scan:if(!(_l<Ml)){for(var Ll=El+2;;){if(void 0===Ml){if(_l<Al)break forward_scan;return El=Sl.length,this._cachedIndex=El,this.afterEnd_(El-1,_l,Al)}if(El===Ll)break;if(Al=Ml,Ml=Sl[++El],_l<Ml)break seek}Pl=Sl.length;break linear_scan}if(!(_l>=Al)){var wl=Sl[1];_l<wl&&(El=2,Al=wl);for(var Ll=El-2;;){if(void 0===Al)return this._cachedIndex=0,this.beforeStart_(0,_l,Ml);if(El===Ll)break;if(Ml=Al,Al=Sl[--El-1],_l>=Al)break seek}Pl=El,El=0;break linear_scan}break validate_interval}for(;El<Pl;){var Rl=El+Pl>>>1;_l<Sl[Rl]?Pl=Rl:El=Rl+1}if(Ml=Sl[El],Al=Sl[El-1],void 0===Al)return this._cachedIndex=0,this.beforeStart_(0,_l,Ml);if(void 0===Ml)return El=Sl.length,this._cachedIndex=El,this.afterEnd_(El-1,Al,_l)}this._cachedIndex=El,this.intervalChanged_(El,Al,Ml)}return this.interpolate_(El,Al,_l,Ml)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(_l){var Sl=this.resultBuffer,El=this.sampleValues,Ml=this.valueSize;for(var Al=0;Al!==Ml;++Al)Sl[Al]=El[_l*Ml+Al];return Sl},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}},Object.assign(Na.prototype,{beforeStart_:Na.prototype.copySampleValue_,afterEnd_:Na.prototype.copySampleValue_}),Ua.prototype=Object.assign(Object.create(Na.prototype),{constructor:Ua,DefaultSettings_:{endingStart:us,endingEnd:us},intervalChanged_:function(_l,Sl,El){var Ml=this.parameterPositions,Al=_l-2,Pl=_l+1,Ll=Ml[Al],wl=Ml[Pl];if(Ll===void 0)switch(this.getSettings_().endingStart){case ms:Al=_l,Ll=2*Sl-El;break;case fs:Al=Ml.length-2,Ll=Sl+Ml[Al]-Ml[Al+1];break;default:Al=_l,Ll=El;}if(void 0===wl)switch(this.getSettings_().endingEnd){case ms:Pl=_l,wl=2*El-Sl;break;case fs:Pl=1,wl=El+Ml[1]-Ml[0];break;default:Pl=_l-1,wl=Sl;}var Rl=0.5*(El-Sl),Cl=this.valueSize;this._weightPrev=Rl/(Sl-Ll),this._weightNext=Rl/(wl-El),this._offsetPrev=Al*Cl,this._offsetNext=Pl*Cl},interpolate_:function(_l,Sl,El,Ml){var Al=this.resultBuffer,Pl=this.sampleValues,Ll=this.valueSize,wl=_l*Ll,Rl=this._offsetPrev,Cl=this._offsetNext,Il=this._weightPrev,Dl=this._weightNext,Gl=(El-Sl)/(Ml-Sl),Bl=Gl*Gl,Fl=Bl*Gl;for(var Nl=0;Nl!==Ll;++Nl)Al[Nl]=(-Il*Fl+2*Il*Bl-Il*Gl)*Pl[Rl+Nl]+((1+Il)*Fl+(-1.5-2*Il)*Bl+(-0.5+Il)*Gl+1)*Pl[wl-Ll+Nl]+((-1-Dl)*Fl+(1.5+Dl)*Bl+0.5*Gl)*Pl[wl+Nl]+(Dl*Fl-Dl*Bl)*Pl[Cl+Nl];return Al}}),Ha.prototype=Object.assign(Object.create(Na.prototype),{constructor:Ha,interpolate_:function(_l,Sl,El,Ml){var Al=this.resultBuffer,Pl=this.sampleValues,Ll=this.valueSize,wl=_l*Ll,Rl=(El-Sl)/(Ml-Sl);for(var Cl=0;Cl!==Ll;++Cl)Al[Cl]=Pl[wl-Ll+Cl]*(1-Rl)+Pl[wl+Cl]*Rl;return Al}}),za.prototype=Object.assign(Object.create(Na.prototype),{constructor:za,interpolate_:function(_l){return this.copySampleValue_(_l-1)}});var Ks={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:ds,InterpolantFactoryMethodDiscrete:function(_l){return new za(this.times,this.values,this.getValueSize(),_l)},InterpolantFactoryMethodLinear:function(_l){return new Ha(this.times,this.values,this.getValueSize(),_l)},InterpolantFactoryMethodSmooth:function(_l){return new Ua(this.times,this.values,this.getValueSize(),_l)},setInterpolation:function(_l){var Sl;if(_l===ls?Sl=this.InterpolantFactoryMethodDiscrete:_l===ds?Sl=this.InterpolantFactoryMethodLinear:_l===ps?Sl=this.InterpolantFactoryMethodSmooth:void 0,void 0===Sl){var El="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(_l!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(El);return void console.warn(El)}this.createInterpolant=Sl},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ls;case this.InterpolantFactoryMethodLinear:return ds;case this.InterpolantFactoryMethodSmooth:return ps;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(_l){if(0!==_l){var Sl=this.times;for(var El=0,Ml=Sl.length;El!==Ml;++El)Sl[El]+=_l}return this},scale:function(_l){if(1!==_l){var Sl=this.times;for(var El=0,Ml=Sl.length;El!==Ml;++El)Sl[El]*=_l}return this},trim:function(_l,Sl){for(var El=this.times,Ml=El.length,Al=0,Pl=Ml-1;Al!==Ml&&El[Al]<_l;)++Al;for(;-1!=Pl&&El[Pl]>Sl;)--Pl;if(++Pl,0!==Al||Pl!==Ml){Al>=Pl&&(Pl=Math.max(Pl,1),Al=Pl-1);var Ll=this.getValueSize();this.times=Zs.arraySlice(El,Al,Pl),this.values=Zs.arraySlice(this.values,Al*Ll,Pl*Ll)}return this},validate:function(){var _l=!0,Sl=this.getValueSize();0!=Sl-Math.floor(Sl)&&(console.error("invalid value size in track",this),_l=!1);var El=this.times,Ml=this.values,Al=El.length;0===Al&&(console.error("track is empty",this),_l=!1);var Pl=null;for(var Ll=0;Ll!==Al;Ll++){var wl=El[Ll];if("number"==typeof wl&&isNaN(wl)){console.error("time is not a valid number",this,Ll,wl),_l=!1;break}if(null!=Pl&&Pl>wl){console.error("out of order keys",this,Ll,wl,Pl),_l=!1;break}Pl=wl}if(Ml!==void 0&&Zs.isTypedArray(Ml))for(var Ll=0,Rl=Ml.length;Ll!==Rl;++Ll){var Cl=Ml[Ll];if(isNaN(Cl)){console.error("value is not a valid number",this,Ll,Cl),_l=!1;break}}return _l},optimize:function(){var _l=this.times,Sl=this.values,El=this.getValueSize(),Ml=this.getInterpolation()===ps,Al=1,Pl=_l.length-1;for(var Ll=1;Ll<Pl;++Ll){var wl=!1,Rl=_l[Ll],Cl=_l[Ll+1];if(Rl!==Cl&&(1!==Ll||Rl!==Rl[0]))if(!Ml){var Il=Ll*El;for(var Dl=0;Dl!==El;++Dl){var Gl=Sl[Il+Dl];if(Gl!==Sl[Il-El+Dl]||Gl!==Sl[Il+El+Dl]){wl=!0;break}}}else wl=!0;if(wl){if(Ll!==Al){_l[Al]=_l[Ll];var Bl=Ll*El,Fl=Al*El;for(var Dl=0;Dl!==El;++Dl)Sl[Fl+Dl]=Sl[Bl+Dl]}++Al}}if(0<Pl){_l[Al]=_l[Pl];for(var Bl=Pl*El,Fl=Al*El,Dl=0;Dl!==El;++Dl)Sl[Fl+Dl]=Sl[Bl+Dl];++Al}return Al!==_l.length&&(this.times=Zs.arraySlice(_l,0,Al),this.values=Zs.arraySlice(Sl,0,Al*El)),this}};Va.prototype=Object.assign(Object.create(Ks),{constructor:Va,ValueTypeName:"vector"}),ka.prototype=Object.assign(Object.create(Na.prototype),{constructor:ka,interpolate_:function(_l,Sl,El,Ml){var Al=this.resultBuffer,Pl=this.sampleValues,Ll=this.valueSize,wl=_l*Ll;for(var Rl=wl+Ll;wl!==Rl;wl+=4)Y.slerpFlat(Al,0,Pl,wl-Ll,Pl,wl,(El-Sl)/(Ml-Sl));return Al}}),Wa.prototype=Object.assign(Object.create(Ks),{constructor:Wa,ValueTypeName:"quaternion",DefaultInterpolation:ds,InterpolantFactoryMethodLinear:function(_l){return new ka(this.times,this.values,this.getValueSize(),_l)},InterpolantFactoryMethodSmooth:void 0}),Xa.prototype=Object.assign(Object.create(Ks),{constructor:Xa,ValueTypeName:"number"}),ja.prototype=Object.assign(Object.create(Ks),{constructor:ja,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ls,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ya.prototype=Object.assign(Object.create(Ks),{constructor:Ya,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ls,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Za.prototype=Object.assign(Object.create(Ks),{constructor:Za,ValueTypeName:"color"}),Ka.prototype=Ks,Ks.constructor=Ka,Object.assign(Ka,{parse:function(_l){if(_l.type===void 0)throw new Error("track type undefined, can not parse");var Sl=Ka._getTrackTypeForValueTypeName(_l.type);if(_l.times===void 0){var El=[],Ml=[];Zs.flattenJSON(_l.keys,El,Ml,"value"),_l.times=El,_l.values=Ml}return void 0===Sl.parse?new Sl(_l.name,_l.times,_l.values,_l.interpolation):Sl.parse(_l)},toJSON:function(_l){var Sl=_l.constructor,El;if(void 0!==Sl.toJSON)El=Sl.toJSON(_l);else{El={name:_l.name,times:Zs.convertArray(_l.times,Array),values:Zs.convertArray(_l.values,Array)};var Ml=_l.getInterpolation();Ml!==_l.DefaultInterpolation&&(El.interpolation=Ml)}return El.type=_l.ValueTypeName,El},_getTrackTypeForValueTypeName:function(_l){switch(_l.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Xa;case"vector":case"vector2":case"vector3":case"vector4":return Va;case"color":return Za;case"quaternion":return Wa;case"bool":case"boolean":return Ya;case"string":return ja;}throw new Error("Unsupported typeName: "+_l)}}),Qa.prototype={constructor:Qa,resetDuration:function(){var _l=this.tracks,Sl=0;for(var El=0,Ml=_l.length;El!==Ml;++El){var Al=this.tracks[El];Sl=Math.max(Sl,Al.times[Al.times.length-1])}this.duration=Sl},trim:function(){for(var _l=0;_l<this.tracks.length;_l++)this.tracks[_l].trim(0,this.duration);return this},optimize:function(){for(var _l=0;_l<this.tracks.length;_l++)this.tracks[_l].optimize();return this}},Object.assign(Qa,{parse:function(_l){var Sl=[],El=_l.tracks,Ml=1/(_l.fps||1);for(var Al=0,Pl=El.length;Al!==Pl;++Al)Sl.push(Ka.parse(El[Al]).scale(Ml));return new Qa(_l.name,_l.duration,Sl)},toJSON:function(_l){var Sl=[],El=_l.tracks,Ml={name:_l.name,duration:_l.duration,tracks:Sl};for(var Al=0,Pl=El.length;Al!==Pl;++Al)Sl.push(Ka.toJSON(El[Al]));return Ml},CreateFromMorphTargetSequence:function(_l,Sl,El,Ml){var Al=Sl.length,Pl=[];for(var Ll=0;Ll<Al;Ll++){var wl=[],Rl=[];wl.push((Ll+Al-1)%Al,Ll,(Ll+1)%Al),Rl.push(0,1,0);var Cl=Zs.getKeyframeOrder(wl);wl=Zs.sortedArray(wl,1,Cl),Rl=Zs.sortedArray(Rl,1,Cl),Ml||0!==wl[0]||(wl.push(Al),Rl.push(Rl[0])),Pl.push(new Xa(".morphTargetInfluences["+Sl[Ll].name+"]",wl,Rl).scale(1/El))}return new Qa(_l,-1,Pl)},findByName:function(_l,Sl){var El=_l;if(!Array.isArray(_l)){var Ml=_l;El=Ml.geometry&&Ml.geometry.animations||Ml.animations}for(var Al=0;Al<El.length;Al++)if(El[Al].name===Sl)return El[Al];return null},CreateClipsFromMorphTargetSequences:function(_l,Sl,El){var Ml={},Al=/^([\w-]*?)([\d]+)$/;for(var Pl=0,Ll=_l.length;Pl<Ll;Pl++){var wl=_l[Pl],Rl=wl.name.match(Al);if(Rl&&1<Rl.length){var Cl=Rl[1],Il=Ml[Cl];Il||(Ml[Cl]=Il=[]),Il.push(wl)}}var Dl=[];for(var Cl in Ml)Dl.push(Qa.CreateFromMorphTargetSequence(Cl,Ml[Cl],Sl,El));return Dl},parseAnimation:function(_l,Sl){if(!_l)return console.error("  no animation in JSONLoader data"),null;var El=function(Ol,Vl,Wl,Xl,Yl){if(0!==Wl.length){var ql=[],Zl=[];Zs.flattenJSON(Wl,ql,Zl,Xl),0!==ql.length&&Yl.push(new Ol(Vl,ql,Zl))}},Ml=[],Al=_l.name||"default",Pl=_l.length||-1,Ll=_l.fps||30,wl=_l.hierarchy||[];for(var Rl=0;Rl<wl.length;Rl++){var Cl=wl[Rl].keys;if(Cl&&0!==Cl.length)if(Cl[0].morphTargets){var Il={};for(var Dl=0;Dl<Cl.length;Dl++)if(Cl[Dl].morphTargets)for(var Gl=0;Gl<Cl[Dl].morphTargets.length;Gl++)Il[Cl[Dl].morphTargets[Gl]]=-1;for(var Bl in Il){var Fl=[],Nl=[];for(var Gl=0;Gl!==Cl[Dl].morphTargets.length;++Gl){var Ul=Cl[Dl];Fl.push(Ul.time),Nl.push(Ul.morphTarget===Bl?1:0)}Ml.push(new Xa(".morphTargetInfluence["+Bl+"]",Fl,Nl))}Pl=Il.length*(Ll||1)}else{var Hl=".bones["+Sl[Rl].name+"]";El(Va,Hl+".position",Cl,"pos",Ml),El(Wa,Hl+".quaternion",Cl,"rot",Ml),El(Va,Hl+".scale",Cl,"scl",Ml)}}if(0===Ml.length)return null;var zl=new Qa(Al,Pl,Ml);return zl}}),Object.assign(Ja.prototype,{load:function(_l,Sl,El,Ml){var Al=this,Pl=new _a(Al.manager);Pl.load(_l,function(Ll){Sl(Al.parse(JSON.parse(Ll)))},El,Ml)},setTextures:function(_l){this.textures=_l},parse:function(_l){function Sl(wl){return void 0===El[wl]&&console.warn("THREE.MaterialLoader: Undefined texture",wl),El[wl]}var El=this.textures,Ml=new js[_l.type];if(void 0!==_l.uuid&&(Ml.uuid=_l.uuid),void 0!==_l.name&&(Ml.name=_l.name),void 0!==_l.color&&Ml.color.setHex(_l.color),void 0!==_l.roughness&&(Ml.roughness=_l.roughness),void 0!==_l.metalness&&(Ml.metalness=_l.metalness),void 0!==_l.emissive&&Ml.emissive.setHex(_l.emissive),void 0!==_l.specular&&Ml.specular.setHex(_l.specular),void 0!==_l.shininess&&(Ml.shininess=_l.shininess),void 0!==_l.clearCoat&&(Ml.clearCoat=_l.clearCoat),void 0!==_l.clearCoatRoughness&&(Ml.clearCoatRoughness=_l.clearCoatRoughness),void 0!==_l.uniforms&&(Ml.uniforms=_l.uniforms),void 0!==_l.vertexShader&&(Ml.vertexShader=_l.vertexShader),void 0!==_l.fragmentShader&&(Ml.fragmentShader=_l.fragmentShader),void 0!==_l.vertexColors&&(Ml.vertexColors=_l.vertexColors),void 0!==_l.fog&&(Ml.fog=_l.fog),void 0!==_l.shading&&(Ml.shading=_l.shading),void 0!==_l.blending&&(Ml.blending=_l.blending),void 0!==_l.side&&(Ml.side=_l.side),void 0!==_l.opacity&&(Ml.opacity=_l.opacity),void 0!==_l.transparent&&(Ml.transparent=_l.transparent),void 0!==_l.alphaTest&&(Ml.alphaTest=_l.alphaTest),void 0!==_l.depthTest&&(Ml.depthTest=_l.depthTest),void 0!==_l.depthWrite&&(Ml.depthWrite=_l.depthWrite),void 0!==_l.colorWrite&&(Ml.colorWrite=_l.colorWrite),void 0!==_l.wireframe&&(Ml.wireframe=_l.wireframe),void 0!==_l.wireframeLinewidth&&(Ml.wireframeLinewidth=_l.wireframeLinewidth),void 0!==_l.wireframeLinecap&&(Ml.wireframeLinecap=_l.wireframeLinecap),void 0!==_l.wireframeLinejoin&&(Ml.wireframeLinejoin=_l.wireframeLinejoin),void 0!==_l.skinning&&(Ml.skinning=_l.skinning),void 0!==_l.morphTargets&&(Ml.morphTargets=_l.morphTargets),void 0!==_l.size&&(Ml.size=_l.size),void 0!==_l.sizeAttenuation&&(Ml.sizeAttenuation=_l.sizeAttenuation),void 0!==_l.map&&(Ml.map=Sl(_l.map)),void 0!==_l.alphaMap&&(Ml.alphaMap=Sl(_l.alphaMap),Ml.transparent=!0),void 0!==_l.bumpMap&&(Ml.bumpMap=Sl(_l.bumpMap)),void 0!==_l.bumpScale&&(Ml.bumpScale=_l.bumpScale),void 0!==_l.normalMap&&(Ml.normalMap=Sl(_l.normalMap)),void 0!==_l.normalScale){var Al=_l.normalScale;!1===Array.isArray(Al)&&(Al=[Al,Al]),Ml.normalScale=new H().fromArray(Al)}if(void 0!==_l.displacementMap&&(Ml.displacementMap=Sl(_l.displacementMap)),void 0!==_l.displacementScale&&(Ml.displacementScale=_l.displacementScale),void 0!==_l.displacementBias&&(Ml.displacementBias=_l.displacementBias),void 0!==_l.roughnessMap&&(Ml.roughnessMap=Sl(_l.roughnessMap)),void 0!==_l.metalnessMap&&(Ml.metalnessMap=Sl(_l.metalnessMap)),void 0!==_l.emissiveMap&&(Ml.emissiveMap=Sl(_l.emissiveMap)),void 0!==_l.emissiveIntensity&&(Ml.emissiveIntensity=_l.emissiveIntensity),void 0!==_l.specularMap&&(Ml.specularMap=Sl(_l.specularMap)),void 0!==_l.envMap&&(Ml.envMap=Sl(_l.envMap)),void 0!==_l.reflectivity&&(Ml.reflectivity=_l.reflectivity),void 0!==_l.lightMap&&(Ml.lightMap=Sl(_l.lightMap)),void 0!==_l.lightMapIntensity&&(Ml.lightMapIntensity=_l.lightMapIntensity),void 0!==_l.aoMap&&(Ml.aoMap=Sl(_l.aoMap)),void 0!==_l.aoMapIntensity&&(Ml.aoMapIntensity=_l.aoMapIntensity),void 0!==_l.gradientMap&&(Ml.gradientMap=Sl(_l.gradientMap)),void 0!==_l.materials)for(var Pl=0,Ll=_l.materials.length;Pl<Ll;Pl++)Ml.materials.push(this.parse(_l.materials[Pl]));return Ml}}),Object.assign($a.prototype,{load:function(_l,Sl,El,Ml){var Al=this,Pl=new _a(Al.manager);Pl.load(_l,function(Ll){Sl(Al.parse(JSON.parse(Ll)))},El,Ml)},parse:function(_l){var Sl=new St,El=_l.data.index,Ml={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(El!==void 0){var Al=new Ml[El.type](El.array);Sl.setIndex(new lt(Al,1))}var Pl=_l.data.attributes;for(var Ll in Pl){var wl=Pl[Ll],Al=new Ml[wl.type](wl.array);Sl.addAttribute(Ll,new lt(Al,wl.itemSize,wl.normalized))}var Rl=_l.data.groups||_l.data.drawcalls||_l.data.offsets;if(Rl!==void 0)for(var Cl=0,Il=Rl.length;Cl!==Il;++Cl){var Dl=Rl[Cl];Sl.addGroup(Dl.start,Dl.count,Dl.materialIndex)}var Gl=_l.data.boundingSphere;if(Gl!==void 0){var Bl=new Z;Gl.center!==void 0&&Bl.fromArray(Gl.center),Sl.boundingSphere=new Ze(Bl,Gl.radius)}return Sl}}),eo.prototype={constructor:eo,crossOrigin:void 0,extractUrlBase:function(_l){var Sl=_l.split("/");return 1===Sl.length?"./":(Sl.pop(),Sl.join("/")+"/")},initMaterials:function(_l,Sl,El){var Ml=[];for(var Al=0;Al<_l.length;++Al)Ml[Al]=this.createMaterial(_l[Al],Sl,El);return Ml},createMaterial:function(){var _l,Sl,El;return function(Al,Pl,Ll){function wl(Gl,Bl,Fl,Nl,Ul){var Hl=Pl+Gl,zl=eo.Handlers.get(Hl),Ol;null===zl?(Sl.setCrossOrigin(Ll),Ol=Sl.load(Hl)):Ol=zl.load(Hl),void 0!==Bl&&(Ol.repeat.fromArray(Bl),1!==Bl[0]&&(Ol.wrapS=bn),1!==Bl[1]&&(Ol.wrapT=bn)),void 0!==Fl&&Ol.offset.fromArray(Fl),void 0!==Nl&&("repeat"===Nl[0]&&(Ol.wrapS=bn),"mirror"===Nl[0]&&(Ol.wrapS=_n),"repeat"===Nl[1]&&(Ol.wrapT=bn),"mirror"===Nl[1]&&(Ol.wrapT=_n)),void 0!==Ul&&(Ol.anisotropy=Ul);var Vl=Ls.generateUUID();return Rl[Vl]=Ol,Vl}void 0==_l&&(_l=new ze),void 0==Sl&&(Sl=new Pa),void 0==El&&(El=new Ja);var Rl={},Cl={uuid:Ls.generateUUID(),type:"MeshLambertMaterial"};for(var Il in Al){var Dl=Al[Il];switch(Il){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":Cl.name=Dl;break;case"blending":Cl.blending=Ri[Dl];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",Il,"is no longer supported.");break;case"colorDiffuse":Cl.color=_l.fromArray(Dl).getHex();break;case"colorSpecular":Cl.specular=_l.fromArray(Dl).getHex();break;case"colorEmissive":Cl.emissive=_l.fromArray(Dl).getHex();break;case"specularCoef":Cl.shininess=Dl;break;case"shading":"basic"===Dl.toLowerCase()&&(Cl.type="MeshBasicMaterial"),"phong"===Dl.toLowerCase()&&(Cl.type="MeshPhongMaterial"),"standard"===Dl.toLowerCase()&&(Cl.type="MeshStandardMaterial");break;case"mapDiffuse":Cl.map=wl(Dl,Al.mapDiffuseRepeat,Al.mapDiffuseOffset,Al.mapDiffuseWrap,Al.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":Cl.emissiveMap=wl(Dl,Al.mapEmissiveRepeat,Al.mapEmissiveOffset,Al.mapEmissiveWrap,Al.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":Cl.lightMap=wl(Dl,Al.mapLightRepeat,Al.mapLightOffset,Al.mapLightWrap,Al.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":Cl.aoMap=wl(Dl,Al.mapAORepeat,Al.mapAOOffset,Al.mapAOWrap,Al.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":Cl.bumpMap=wl(Dl,Al.mapBumpRepeat,Al.mapBumpOffset,Al.mapBumpWrap,Al.mapBumpAnisotropy);break;case"mapBumpScale":Cl.bumpScale=Dl;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":Cl.normalMap=wl(Dl,Al.mapNormalRepeat,Al.mapNormalOffset,Al.mapNormalWrap,Al.mapNormalAnisotropy);break;case"mapNormalFactor":Cl.normalScale=[Dl,Dl];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":Cl.specularMap=wl(Dl,Al.mapSpecularRepeat,Al.mapSpecularOffset,Al.mapSpecularWrap,Al.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":Cl.metalnessMap=wl(Dl,Al.mapMetalnessRepeat,Al.mapMetalnessOffset,Al.mapMetalnessWrap,Al.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":Cl.roughnessMap=wl(Dl,Al.mapRoughnessRepeat,Al.mapRoughnessOffset,Al.mapRoughnessWrap,Al.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":Cl.alphaMap=wl(Dl,Al.mapAlphaRepeat,Al.mapAlphaOffset,Al.mapAlphaWrap,Al.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":Cl.side=yi;break;case"doubleSided":Cl.side=xi;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),Cl.opacity=Dl;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":Cl[Il]=Dl;break;case"vertexColors":!0===Dl&&(Cl.vertexColors=Si),"face"===Dl&&(Cl.vertexColors=_i);break;default:console.error("THREE.Loader.createMaterial: Unsupported",Il,Dl);}}return"MeshBasicMaterial"===Cl.type&&delete Cl.emissive,"MeshPhongMaterial"!==Cl.type&&delete Cl.specular,1>Cl.opacity&&(Cl.transparent=!0),El.setTextures(Rl),El.parse(Cl)}}()},eo.Handlers={handlers:[],add:function(_l,Sl){this.handlers.push(_l,Sl)},get:function(_l){var Sl=this.handlers;for(var El=0,Ml=Sl.length;El<Ml;El+=2){var Al=Sl[El],Pl=Sl[El+1];if(Al.test(_l))return Pl}return null}},Object.assign(ro.prototype,{load:function(_l,Sl,El,Ml){var Al=this,Pl=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:eo.prototype.extractUrlBase(_l),Ll=new _a(this.manager);Ll.setWithCredentials(this.withCredentials),Ll.load(_l,function(wl){var Rl=JSON.parse(wl),Cl=Rl.metadata;if(Cl!==void 0){var Il=Cl.type;if(Il!==void 0){if("object"===Il.toLowerCase())return void console.error("THREE.JSONLoader: "+_l+" should be loaded with THREE.ObjectLoader instead.");if("scene"===Il.toLowerCase())return void console.error("THREE.JSONLoader: "+_l+" should be loaded with THREE.SceneLoader instead.")}}var Dl=Al.parse(Rl,Pl);Sl(Dl.geometry,Dl.materials)},El,Ml)},setTexturePath:function(_l){this.texturePath=_l},parse:function(_l,Sl){var El=new vt,Ml=void 0===_l.scale?1:1/_l.scale;if(function(Ll){function wl(md,fd){return md&1<<fd}var sd=_l.faces,ld=_l.vertices,dd=_l.normals,cd=_l.colors,ud=0,Rl,Cl,Il,Dl,Gl,Bl,Fl,Nl,Ul,Hl,zl,Ol,Vl,Wl,Xl,Yl,ql,Zl,Kl,Ql,Jl,$l,ed,td,rd,od,nd;if(void 0!==_l.uvs){for(Rl=0;Rl<_l.uvs.length;Rl++)_l.uvs[Rl].length&&ud++;for(Rl=0;Rl<ud;Rl++)El.faceVertexUvs[Rl]=[]}for(Dl=0,Gl=ld.length;Dl<Gl;)Zl=new Z,Zl.x=ld[Dl++]*Ll,Zl.y=ld[Dl++]*Ll,Zl.z=ld[Dl++]*Ll,El.vertices.push(Zl);for(Dl=0,Gl=sd.length;Dl<Gl;)if(Hl=sd[Dl++],zl=wl(Hl,0),Ol=wl(Hl,1),Vl=wl(Hl,3),Wl=wl(Hl,4),Xl=wl(Hl,5),Yl=wl(Hl,6),ql=wl(Hl,7),zl){if(Ql=new nt,Ql.a=sd[Dl],Ql.b=sd[Dl+1],Ql.c=sd[Dl+3],Jl=new nt,Jl.a=sd[Dl+1],Jl.b=sd[Dl+2],Jl.c=sd[Dl+3],Dl+=4,Ol&&(Ul=sd[Dl++],Ql.materialIndex=Ul,Jl.materialIndex=Ul),Il=El.faces.length,Vl)for(Rl=0;Rl<ud;Rl++)for(td=_l.uvs[Rl],El.faceVertexUvs[Rl][Il]=[],El.faceVertexUvs[Rl][Il+1]=[],Cl=0;4>Cl;Cl++)Nl=sd[Dl++],od=td[2*Nl],nd=td[2*Nl+1],rd=new H(od,nd),2!==Cl&&El.faceVertexUvs[Rl][Il].push(rd),0!==Cl&&El.faceVertexUvs[Rl][Il+1].push(rd);if(Wl&&(Fl=3*sd[Dl++],Ql.normal.set(dd[Fl++],dd[Fl++],dd[Fl]),Jl.normal.copy(Ql.normal)),Xl)for(Rl=0;4>Rl;Rl++)Fl=3*sd[Dl++],ed=new Z(dd[Fl++],dd[Fl++],dd[Fl]),2!==Rl&&Ql.vertexNormals.push(ed),0!==Rl&&Jl.vertexNormals.push(ed);if(Yl&&(Bl=sd[Dl++],$l=cd[Bl],Ql.color.setHex($l),Jl.color.setHex($l)),ql)for(Rl=0;4>Rl;Rl++)Bl=sd[Dl++],$l=cd[Bl],2!==Rl&&Ql.vertexColors.push(new ze($l)),0!==Rl&&Jl.vertexColors.push(new ze($l));El.faces.push(Ql),El.faces.push(Jl)}else{if(Kl=new nt,Kl.a=sd[Dl++],Kl.b=sd[Dl++],Kl.c=sd[Dl++],Ol&&(Ul=sd[Dl++],Kl.materialIndex=Ul),Il=El.faces.length,Vl)for(Rl=0;Rl<ud;Rl++)for(td=_l.uvs[Rl],El.faceVertexUvs[Rl][Il]=[],Cl=0;3>Cl;Cl++)Nl=sd[Dl++],od=td[2*Nl],nd=td[2*Nl+1],rd=new H(od,nd),El.faceVertexUvs[Rl][Il].push(rd);if(Wl&&(Fl=3*sd[Dl++],Kl.normal.set(dd[Fl++],dd[Fl++],dd[Fl])),Xl)for(Rl=0;3>Rl;Rl++)Fl=3*sd[Dl++],ed=new Z(dd[Fl++],dd[Fl++],dd[Fl]),Kl.vertexNormals.push(ed);if(Yl&&(Bl=sd[Dl++],Kl.color.setHex(cd[Bl])),ql)for(Rl=0;3>Rl;Rl++)Bl=sd[Dl++],Kl.vertexColors.push(new ze(cd[Bl]));El.faces.push(Kl)}}(Ml),function(){var Ll=void 0===_l.influencesPerVertex?2:_l.influencesPerVertex;if(_l.skinWeights)for(var wl=0,Rl=_l.skinWeights.length;wl<Rl;wl+=Ll){var Cl=_l.skinWeights[wl],Il=1<Ll?_l.skinWeights[wl+1]:0,Dl=2<Ll?_l.skinWeights[wl+2]:0,Gl=3<Ll?_l.skinWeights[wl+3]:0;El.skinWeights.push(new V(Cl,Il,Dl,Gl))}if(_l.skinIndices)for(var wl=0,Rl=_l.skinIndices.length;wl<Rl;wl+=Ll){var Bl=_l.skinIndices[wl],Fl=1<Ll?_l.skinIndices[wl+1]:0,Nl=2<Ll?_l.skinIndices[wl+2]:0,Ul=3<Ll?_l.skinIndices[wl+3]:0;El.skinIndices.push(new V(Bl,Fl,Nl,Ul))}El.bones=_l.bones,El.bones&&0<El.bones.length&&(El.skinWeights.length!==El.skinIndices.length||El.skinIndices.length!==El.vertices.length)&&console.warn("When skinning, number of vertices ("+El.vertices.length+"), skinIndices ("+El.skinIndices.length+"), and skinWeights ("+El.skinWeights.length+") should match.")}(),function(Ll){if(void 0!==_l.morphTargets)for(var wl=0,Rl=_l.morphTargets.length;wl<Rl;wl++){El.morphTargets[wl]={},El.morphTargets[wl].name=_l.morphTargets[wl].name,El.morphTargets[wl].vertices=[];var Cl=El.morphTargets[wl].vertices,Il=_l.morphTargets[wl].vertices;for(var Dl=0,Gl=Il.length;Dl<Gl;Dl+=3){var Bl=new Z;Bl.x=Il[Dl]*Ll,Bl.y=Il[Dl+1]*Ll,Bl.z=Il[Dl+2]*Ll,Cl.push(Bl)}}if(void 0!==_l.morphColors&&0<_l.morphColors.length){console.warn("THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors.");var Fl=El.faces,Nl=_l.morphColors[0].colors;for(var wl=0,Rl=Fl.length;wl<Rl;wl++)Fl[wl].color.fromArray(Nl,3*wl)}}(Ml),function(){var Ll=[],wl=[];void 0!==_l.animation&&wl.push(_l.animation),void 0!==_l.animations&&(_l.animations.length?wl=wl.concat(_l.animations):wl.push(_l.animations));for(var Rl=0;Rl<wl.length;Rl++){var Cl=Qa.parseAnimation(wl[Rl],El.bones);Cl&&Ll.push(Cl)}if(El.morphTargets){var Il=Qa.CreateClipsFromMorphTargetSequences(El.morphTargets,10);Ll=Ll.concat(Il)}0<Ll.length&&(El.animations=Ll)}(),El.computeFaceNormals(),El.computeBoundingSphere(),void 0===_l.materials||0===_l.materials.length)return{geometry:El};var Al=eo.prototype.initMaterials(_l.materials,Sl,this.crossOrigin);return{geometry:El,materials:Al}}}),Object.assign(ao.prototype,{load:function(_l,Sl,El,Ml){""===this.texturePath&&(this.texturePath=_l.substring(0,_l.lastIndexOf("/")+1));var Al=this,Pl=new _a(Al.manager);Pl.load(_l,function(Ll){var wl=null;try{wl=JSON.parse(Ll)}catch(Cl){return void console.error("THREE:ObjectLoader: Can't parse "+_l+".",Cl.message)}var Rl=wl.metadata;return void 0===Rl||void 0===Rl.type||"geometry"===Rl.type.toLowerCase()?void console.error("THREE.ObjectLoader: Can't load "+_l+". Use THREE.JSONLoader instead."):void Al.parse(wl,Sl)},El,Ml)},setTexturePath:function(_l){this.texturePath=_l},setCrossOrigin:function(_l){this.crossOrigin=_l},parse:function(_l,Sl){var El=this.parseGeometries(_l.geometries),Ml=this.parseImages(_l.images,function(){void 0!==Sl&&Sl(Ll)}),Al=this.parseTextures(_l.textures,Ml),Pl=this.parseMaterials(_l.materials,Al),Ll=this.parseObject(_l.object,El,Pl);return _l.animations&&(Ll.animations=this.parseAnimations(_l.animations)),(void 0===_l.images||0===_l.images.length)&&void 0!==Sl&&Sl(Ll),Ll},parseGeometries:function(_l){var Sl={};if(_l!==void 0){var El=new ro,Ml=new $a;for(var Al=0,Pl=_l.length;Al<Pl;Al++){var Ll,wl=_l[Al];switch(wl.type){case"PlaneGeometry":case"PlaneBufferGeometry":Ll=new Xs[wl.type](wl.width,wl.height,wl.widthSegments,wl.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":Ll=new Xs[wl.type](wl.width,wl.height,wl.depth,wl.widthSegments,wl.heightSegments,wl.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":Ll=new Xs[wl.type](wl.radius,wl.segments,wl.thetaStart,wl.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":Ll=new Xs[wl.type](wl.radiusTop,wl.radiusBottom,wl.height,wl.radialSegments,wl.heightSegments,wl.openEnded,wl.thetaStart,wl.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":Ll=new Xs[wl.type](wl.radius,wl.height,wl.radialSegments,wl.heightSegments,wl.openEnded,wl.thetaStart,wl.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":Ll=new Xs[wl.type](wl.radius,wl.widthSegments,wl.heightSegments,wl.phiStart,wl.phiLength,wl.thetaStart,wl.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":Ll=new Xs[wl.type](wl.radius,wl.detail);break;case"RingGeometry":case"RingBufferGeometry":Ll=new Xs[wl.type](wl.innerRadius,wl.outerRadius,wl.thetaSegments,wl.phiSegments,wl.thetaStart,wl.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":Ll=new Xs[wl.type](wl.radius,wl.tube,wl.radialSegments,wl.tubularSegments,wl.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":Ll=new Xs[wl.type](wl.radius,wl.tube,wl.tubularSegments,wl.radialSegments,wl.p,wl.q);break;case"LatheGeometry":case"LatheBufferGeometry":Ll=new Xs[wl.type](wl.points,wl.segments,wl.phiStart,wl.phiLength);break;case"BufferGeometry":Ll=Ml.parse(wl);break;case"Geometry":Ll=El.parse(wl.data,this.texturePath).geometry;break;default:console.warn("THREE.ObjectLoader: Unsupported geometry type \""+wl.type+"\"");continue;}Ll.uuid=wl.uuid,wl.name!==void 0&&(Ll.name=wl.name),Sl[wl.uuid]=Ll}}return Sl},parseMaterials:function(_l,Sl){var El={};if(_l!==void 0){var Ml=new Ja;Ml.setTextures(Sl);for(var Al=0,Pl=_l.length;Al<Pl;Al++){var Ll=Ml.parse(_l[Al]);El[Ll.uuid]=Ll}}return El},parseAnimations:function(_l){var Sl=[];for(var El=0;El<_l.length;El++){var Ml=Qa.parse(_l[El]);Sl.push(Ml)}return Sl},parseImages:function(_l,Sl){function El(Dl){return Ml.manager.itemStart(Dl),Ll.load(Dl,function(){Ml.manager.itemEnd(Dl)},void 0,function(){Ml.manager.itemError(Dl)})}var Ml=this,Al={};if(_l!==void 0&&0<_l.length){var Pl=new va(Sl),Ll=new Ma(Pl);Ll.setCrossOrigin(this.crossOrigin);for(var wl=0,Rl=_l.length;wl<Rl;wl++){var Cl=_l[wl],Il=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Cl.url)?Cl.url:Ml.texturePath+Cl.url;Al[Cl.uuid]=El(Il)}}return Al},parseTextures:function(_l,Sl){function El(Rl,Cl){return"number"==typeof Rl?Rl:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",Rl),Cl[Rl])}var Ml={};if(_l!==void 0)for(var Al=0,Pl=_l.length;Al<Pl;Al++){var Ll=_l[Al];void 0===Ll.image&&console.warn("THREE.ObjectLoader: No \"image\" specified for",Ll.uuid),void 0===Sl[Ll.image]&&console.warn("THREE.ObjectLoader: Undefined image",Ll.image);var wl=new O(Sl[Ll.image]);wl.needsUpdate=!0,wl.uuid=Ll.uuid,void 0!==Ll.name&&(wl.name=Ll.name),void 0!==Ll.mapping&&(wl.mapping=El(Ll.mapping,Tn)),void 0!==Ll.offset&&wl.offset.fromArray(Ll.offset),void 0!==Ll.repeat&&wl.repeat.fromArray(Ll.repeat),void 0!==Ll.wrap&&(wl.wrapS=El(Ll.wrap[0],Sn),wl.wrapT=El(Ll.wrap[1],Sn)),void 0!==Ll.minFilter&&(wl.minFilter=El(Ll.minFilter,Rn)),void 0!==Ll.magFilter&&(wl.magFilter=El(Ll.magFilter,Rn)),void 0!==Ll.anisotropy&&(wl.anisotropy=Ll.anisotropy),void 0!==Ll.flipY&&(wl.flipY=Ll.flipY),Ml[Ll.uuid]=wl}return Ml},parseObject:function(){var _l=new K;return function(El,Ml,Al){function Pl(Fl){return void 0===Ml[Fl]&&console.warn("THREE.ObjectLoader: Undefined geometry",Fl),Ml[Fl]}function Ll(Fl){return void 0===Fl?void 0:(void 0===Al[Fl]&&console.warn("THREE.ObjectLoader: Undefined material",Fl),Al[Fl])}var wl;switch(El.type){case"Scene":wl=new ir,void 0!==El.background&&Number.isInteger(El.background)&&(wl.background=new ze(El.background)),void 0!==El.fog&&("Fog"===El.fog.type?wl.fog=new or(El.fog.color,El.fog.near,El.fog.far):"FogExp2"===El.fog.type&&(wl.fog=new ar(El.fog.color,El.fog.density)));break;case"PerspectiveCamera":wl=new Lt(El.fov,El.aspect,El.near,El.far),void 0!==El.focus&&(wl.focus=El.focus),void 0!==El.zoom&&(wl.zoom=El.zoom),void 0!==El.filmGauge&&(wl.filmGauge=El.filmGauge),void 0!==El.filmOffset&&(wl.filmOffset=El.filmOffset),void 0!==El.view&&(wl.view=Object.assign({},El.view));break;case"OrthographicCamera":wl=new wt(El.left,El.right,El.top,El.bottom,El.near,El.far);break;case"AmbientLight":wl=new Fa(El.color,El.intensity);break;case"DirectionalLight":wl=new Ba(El.color,El.intensity);break;case"PointLight":wl=new Da(El.color,El.intensity,El.distance,El.decay);break;case"SpotLight":wl=new Ia(El.color,El.intensity,El.distance,El.angle,El.penumbra,El.decay);break;case"HemisphereLight":wl=new wa(El.color,El.groundColor,El.intensity);break;case"Mesh":var Rl=Pl(El.geometry),Cl=Ll(El.material);wl=Rl.bones&&0<Rl.bones.length?new mr(Rl,Cl):new Et(Rl,Cl);break;case"LOD":wl=new pr;break;case"Line":wl=new gr(Pl(El.geometry),Ll(El.material),El.mode);break;case"LineSegments":wl=new hr(Pl(El.geometry),Ll(El.material));break;case"PointCloud":case"Points":wl=new xr(Pl(El.geometry),Ll(El.material));break;case"Sprite":wl=new dr(Ll(El.material));break;case"Group":wl=new Tr;break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh type. Instantiates Object3D instead.");default:wl=new at;}if(wl.uuid=El.uuid,void 0!==El.name&&(wl.name=El.name),void 0===El.matrix?(void 0!==El.position&&wl.position.fromArray(El.position),void 0!==El.rotation&&wl.rotation.fromArray(El.rotation),void 0!==El.quaternion&&wl.quaternion.fromArray(El.quaternion),void 0!==El.scale&&wl.scale.fromArray(El.scale)):(_l.fromArray(El.matrix),_l.decompose(wl.position,wl.quaternion,wl.scale)),void 0!==El.castShadow&&(wl.castShadow=El.castShadow),void 0!==El.receiveShadow&&(wl.receiveShadow=El.receiveShadow),El.shadow&&(void 0!==El.shadow.bias&&(wl.shadow.bias=El.shadow.bias),void 0!==El.shadow.radius&&(wl.shadow.radius=El.shadow.radius),void 0!==El.shadow.mapSize&&wl.shadow.mapSize.fromArray(El.shadow.mapSize),void 0!==El.shadow.camera&&(wl.shadow.camera=this.parseObject(El.shadow.camera))),void 0!==El.visible&&(wl.visible=El.visible),void 0!==El.userData&&(wl.userData=El.userData),void 0!==El.children)for(var Il in El.children)wl.add(this.parseObject(El.children[Il],Ml,Al));if("LOD"===El.type){var Dl=El.levels;for(var Gl=0;Gl<Dl.length;Gl++){var Bl=Dl[Gl],Il=wl.getObjectByProperty("uuid",Bl.object);void 0!==Il&&wl.addLevel(Il,Bl.distance)}}return wl}}()}),oo.prototype={constructor:oo,getPoint:function(){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(_l){var Sl=this.getUtoTmapping(_l);return this.getPoint(Sl)},getPoints:function(_l){_l||(_l=5);var Sl=[];for(var El=0;El<=_l;El++)Sl.push(this.getPoint(El/_l));return Sl},getSpacedPoints:function(_l){_l||(_l=5);var Sl=[];for(var El=0;El<=_l;El++)Sl.push(this.getPointAt(El/_l));return Sl},getLength:function(){var _l=this.getLengths();return _l[_l.length-1]},getLengths:function(_l){if(_l||(_l=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===_l+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var Sl=[],Ml=this.getPoint(0),Pl=0,El,Al;for(Sl.push(0),Al=1;Al<=_l;Al++)El=this.getPoint(Al/_l),Pl+=El.distanceTo(Ml),Sl.push(Pl),Ml=El;return this.cacheArcLengths=Sl,Sl},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(_l,Sl){var El=this.getLengths(),Ml=0,Al=El.length,Pl;Pl=Sl?Sl:_l*El[Al-1];for(var Ll=0,wl=Al-1,Rl;Ll<=wl;)if(Ml=Math.floor(Ll+(wl-Ll)/2),Rl=El[Ml]-Pl,0>Rl)Ll=Ml+1;else if(0<Rl)wl=Ml-1;else{wl=Ml;break}if(Ml=wl,El[Ml]===Pl){var Cl=Ml/(Al-1);return Cl}var Il=El[Ml],Dl=El[Ml+1],Gl=(Pl-Il)/(Dl-Il),Cl=(Ml+Gl)/(Al-1);return Cl},getTangent:function(_l){var Sl=1e-4,El=_l-Sl,Ml=_l+Sl;0>El&&(El=0),1<Ml&&(Ml=1);var Al=this.getPoint(El),Pl=this.getPoint(Ml),Ll=Pl.clone().sub(Al);return Ll.normalize()},getTangentAt:function(_l){var Sl=this.getUtoTmapping(_l);return this.getTangent(Sl)},computeFrenetFrames:function(_l,Sl){var El=new Z,Ml=[],Al=[],Pl=[],Ll=new Z,wl=new K,Rl,Cl,Il;for(Rl=0;Rl<=_l;Rl++)Cl=Rl/_l,Ml[Rl]=this.getTangentAt(Cl),Ml[Rl].normalize();Al[0]=new Z,Pl[0]=new Z;var Dl=Number.MAX_VALUE,Gl=Math.abs(Ml[0].x),Bl=Math.abs(Ml[0].y),Fl=Math.abs(Ml[0].z);for(Gl<=Dl&&(Dl=Gl,El.set(1,0,0)),Bl<=Dl&&(Dl=Bl,El.set(0,1,0)),Fl<=Dl&&El.set(0,0,1),Ll.crossVectors(Ml[0],El).normalize(),Al[0].crossVectors(Ml[0],Ll),Pl[0].crossVectors(Ml[0],Al[0]),Rl=1;Rl<=_l;Rl++)Al[Rl]=Al[Rl-1].clone(),Pl[Rl]=Pl[Rl-1].clone(),Ll.crossVectors(Ml[Rl-1],Ml[Rl]),Ll.length()>Number.EPSILON&&(Ll.normalize(),Il=Math.acos(Ls.clamp(Ml[Rl-1].dot(Ml[Rl]),-1,1)),Al[Rl].applyMatrix4(wl.makeRotationAxis(Ll,Il))),Pl[Rl].crossVectors(Ml[Rl],Al[Rl]);if(!0===Sl)for(Il=Math.acos(Ls.clamp(Al[0].dot(Al[_l]),-1,1)),Il/=_l,0<Ml[0].dot(Ll.crossVectors(Al[0],Al[_l]))&&(Il=-Il),Rl=1;Rl<=_l;Rl++)Al[Rl].applyMatrix4(wl.makeRotationAxis(Ml[Rl],Il*Rl)),Pl[Rl].crossVectors(Ml[Rl],Al[Rl]);return{tangents:Ml,normals:Al,binormals:Pl}}},oo.create=function(_l,Sl){return _l.prototype=Object.create(oo.prototype),_l.prototype.constructor=_l,_l.prototype.getPoint=Sl,_l},io.prototype=Object.create(oo.prototype),io.prototype.constructor=io,io.prototype.isLineCurve=!0,io.prototype.getPoint=function(_l){if(1===_l)return this.v2.clone();var Sl=this.v2.clone().sub(this.v1);return Sl.multiplyScalar(_l).add(this.v1),Sl},io.prototype.getPointAt=function(_l){return this.getPoint(_l)},io.prototype.getTangent=function(){var _l=this.v2.clone().sub(this.v1);return _l.normalize()},no.prototype=Object.assign(Object.create(oo.prototype),{constructor:no,add:function(_l){this.curves.push(_l)},closePath:function(){var _l=this.curves[0].getPoint(0),Sl=this.curves[this.curves.length-1].getPoint(1);_l.equals(Sl)||this.curves.push(new io(Sl,_l))},getPoint:function(_l){for(var Sl=_l*this.getLength(),El=this.getCurveLengths(),Ml=0;Ml<El.length;){if(El[Ml]>=Sl){var Al=El[Ml]-Sl,Pl=this.curves[Ml],Ll=Pl.getLength(),wl=0===Ll?0:1-Al/Ll;return Pl.getPointAt(wl)}Ml++}return null},getLength:function(){var _l=this.getCurveLengths();return _l[_l.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;var _l=[],Sl=0;for(var El=0,Ml=this.curves.length;El<Ml;El++)Sl+=this.curves[El].getLength(),_l.push(Sl);return this.cacheLengths=_l,_l},getSpacedPoints:function(_l){_l||(_l=40);var Sl=[];for(var El=0;El<=_l;El++)Sl.push(this.getPoint(El/_l));return this.autoClose&&Sl.push(Sl[0]),Sl},getPoints:function(_l){_l=_l||12;var Sl=[],El;for(var Ml=0,Al=this.curves;Ml<Al.length;Ml++){var Pl=Al[Ml],Ll=Pl&&Pl.isEllipseCurve?2*_l:Pl&&Pl.isLineCurve?1:Pl&&Pl.isSplineCurve?_l*Pl.points.length:_l,wl=Pl.getPoints(Ll);for(var Rl=0;Rl<wl.length;Rl++){var Cl=wl[Rl];El&&El.equals(Cl)||(Sl.push(Cl),El=Cl)}}return this.autoClose&&1<Sl.length&&!Sl[Sl.length-1].equals(Sl[0])&&Sl.push(Sl[0]),Sl},createPointsGeometry:function(_l){var Sl=this.getPoints(_l);return this.createGeometry(Sl)},createSpacedPointsGeometry:function(_l){var Sl=this.getSpacedPoints(_l);return this.createGeometry(Sl)},createGeometry:function(_l){var Sl=new vt;for(var El=0,Ml=_l.length;El<Ml;El++){var Al=_l[El];Sl.vertices.push(new Z(Al.x,Al.y,Al.z||0))}return Sl}}),so.prototype=Object.create(oo.prototype),so.prototype.constructor=so,so.prototype.isEllipseCurve=!0,so.prototype.getPoint=function(_l){for(var Sl=2*Math.PI,El=this.aEndAngle-this.aStartAngle,Ml=Math.abs(El)<Number.EPSILON;0>El;)El+=Sl;for(;El>Sl;)El-=Sl;El<Number.EPSILON&&(Ml?El=0:El=Sl),!0!==this.aClockwise||Ml||(El===Sl?El=-Sl:El=El-Sl);var Al=this.aStartAngle+_l*El,Pl=this.aX+this.xRadius*Math.cos(Al),Ll=this.aY+this.yRadius*Math.sin(Al);if(0!==this.aRotation){var wl=Math.cos(this.aRotation),Rl=Math.sin(this.aRotation),Cl=Pl-this.aX,Il=Ll-this.aY;Pl=Cl*wl-Il*Rl+this.aX,Ll=Cl*Rl+Il*wl+this.aY}return new H(Pl,Ll)};var Qs={tangentQuadraticBezier:function(_l,Sl,El,Ml){return 2*(1-_l)*(El-Sl)+2*_l*(Ml-El)},tangentCubicBezier:function(_l,Sl,El,Ml,Al){return-3*Sl*(1-_l)*(1-_l)+3*El*(1-_l)*(1-_l)-6*_l*El*(1-_l)+6*_l*Ml*(1-_l)-3*_l*_l*Ml+3*_l*_l*Al},tangentSpline:function(_l){return 6*_l*_l-6*_l+(3*_l*_l-4*_l+1)+(-6*_l*_l+6*_l)+(3*_l*_l-2*_l)},interpolate:function(_l,Sl,El,Ml,Al){var Pl=0.5*(El-_l),Ll=0.5*(Ml-Sl),wl=Al*Al;return(2*Sl-2*El+Pl+Ll)*(Al*wl)+(-3*Sl+3*El-2*Pl-Ll)*wl+Pl*Al+Sl}};lo.prototype=Object.create(oo.prototype),lo.prototype.constructor=lo,lo.prototype.isSplineCurve=!0,lo.prototype.getPoint=function(_l){var Sl=this.points,El=(Sl.length-1)*_l,Ml=Math.floor(El),Al=El-Ml,Pl=Sl[0===Ml?Ml:Ml-1],Ll=Sl[Ml],wl=Sl[Ml>Sl.length-2?Sl.length-1:Ml+1],Rl=Sl[Ml>Sl.length-3?Sl.length-1:Ml+2],Cl=Qs.interpolate;return new H(Cl(Pl.x,Ll.x,wl.x,Rl.x,Al),Cl(Pl.y,Ll.y,wl.y,Rl.y,Al))},po.prototype=Object.create(oo.prototype),po.prototype.constructor=po,po.prototype.getPoint=function(_l){var Sl=Ws.b3;return new H(Sl(_l,this.v0.x,this.v1.x,this.v2.x,this.v3.x),Sl(_l,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},po.prototype.getTangent=function(_l){var Sl=Qs.tangentCubicBezier;return new H(Sl(_l,this.v0.x,this.v1.x,this.v2.x,this.v3.x),Sl(_l,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},co.prototype=Object.create(oo.prototype),co.prototype.constructor=co,co.prototype.getPoint=function(_l){var Sl=Ws.b2;return new H(Sl(_l,this.v0.x,this.v1.x,this.v2.x),Sl(_l,this.v0.y,this.v1.y,this.v2.y))},co.prototype.getTangent=function(_l){var Sl=Qs.tangentQuadraticBezier;return new H(Sl(_l,this.v0.x,this.v1.x,this.v2.x),Sl(_l,this.v0.y,this.v1.y,this.v2.y)).normalize()};var Js=Object.assign(Object.create(no.prototype),{fromPoints:function(_l){this.moveTo(_l[0].x,_l[0].y);for(var Sl=1,El=_l.length;Sl<El;Sl++)this.lineTo(_l[Sl].x,_l[Sl].y)},moveTo:function(_l,Sl){this.currentPoint.set(_l,Sl)},lineTo:function(_l,Sl){var El=new io(this.currentPoint.clone(),new H(_l,Sl));this.curves.push(El),this.currentPoint.set(_l,Sl)},quadraticCurveTo:function(_l,Sl,El,Ml){var Al=new co(this.currentPoint.clone(),new H(_l,Sl),new H(El,Ml));this.curves.push(Al),this.currentPoint.set(El,Ml)},bezierCurveTo:function(_l,Sl,El,Ml,Al,Pl){var Ll=new po(this.currentPoint.clone(),new H(_l,Sl),new H(El,Ml),new H(Al,Pl));this.curves.push(Ll),this.currentPoint.set(Al,Pl)},splineThru:function(_l){var Sl=[this.currentPoint.clone()].concat(_l),El=new lo(Sl);this.curves.push(El),this.currentPoint.copy(_l[_l.length-1])},arc:function(_l,Sl,El,Ml,Al,Pl){var Ll=this.currentPoint.x,wl=this.currentPoint.y;this.absarc(_l+Ll,Sl+wl,El,Ml,Al,Pl)},absarc:function(_l,Sl,El,Ml,Al,Pl){this.absellipse(_l,Sl,El,El,Ml,Al,Pl)},ellipse:function(_l,Sl,El,Ml,Al,Pl,Ll,wl){var Rl=this.currentPoint.x,Cl=this.currentPoint.y;this.absellipse(_l+Rl,Sl+Cl,El,Ml,Al,Pl,Ll,wl)},absellipse:function(_l,Sl,El,Ml,Al,Pl,Ll,wl){var Rl=new so(_l,Sl,El,Ml,Al,Pl,Ll,wl);if(0<this.curves.length){var Cl=Rl.getPoint(0);Cl.equals(this.currentPoint)||this.lineTo(Cl.x,Cl.y)}this.curves.push(Rl);var Il=Rl.getPoint(1);this.currentPoint.copy(Il)}});uo.prototype=Object.assign(Object.create(Js),{constructor:uo,getPointsHoles:function(_l){var Sl=[];for(var El=0,Ml=this.holes.length;El<Ml;El++)Sl[El]=this.holes[El].getPoints(_l);return Sl},extractAllPoints:function(_l){return{shape:this.getPoints(_l),holes:this.getPointsHoles(_l)}},extractPoints:function(_l){return this.extractAllPoints(_l)}}),mo.prototype=Js,Js.constructor=mo,fo.prototype={moveTo:function(_l,Sl){this.currentPath=new mo,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_l,Sl)},lineTo:function(_l,Sl){this.currentPath.lineTo(_l,Sl)},quadraticCurveTo:function(_l,Sl,El,Ml){this.currentPath.quadraticCurveTo(_l,Sl,El,Ml)},bezierCurveTo:function(_l,Sl,El,Ml,Al,Pl){this.currentPath.bezierCurveTo(_l,Sl,El,Ml,Al,Pl)},splineThru:function(_l){this.currentPath.splineThru(_l)},toShapes:function(_l,Sl){function El(td){var rd=[];for(var od=0,nd=td.length;od<nd;od++){var sd=td[od],ld=new uo;ld.curves=sd.curves,rd.push(ld)}return rd}function Ml(td,rd){var od=rd.length,nd=!1;for(var sd=od-1,ld=0;ld<od;sd=ld++){var dd=rd[sd],cd=rd[ld],ud=cd.x-dd.x,md=cd.y-dd.y;if(Math.abs(md)>Number.EPSILON){if(0>md&&(dd=rd[ld],ud=-ud,cd=rd[sd],md=-md),td.y<dd.y||td.y>cd.y)continue;if(td.y!==dd.y){var fd=md*(td.x-dd.x)-ud*(td.y-dd.y);if(0==fd)return!0;if(0>fd)continue;nd=!nd}else if(td.x===dd.x)return!0}else{if(td.y!==dd.y)continue;if(cd.x<=td.x&&td.x<=dd.x||dd.x<=td.x&&td.x<=cd.x)return!0}}return nd}var Al=Ws.isClockWise,Pl=this.subPaths;if(0===Pl.length)return[];if(!0===Sl)return El(Pl);var Cl=[],Ll,wl,Rl;if(1===Pl.length)return wl=Pl[0],Rl=new uo,Rl.curves=wl.curves,Cl.push(Rl),Cl;var Il=!Al(Pl[0].getPoints());Il=_l?!Il:Il;var Dl=[],Gl=[],Bl=[],Fl=0,Nl;Gl[Fl]=void 0,Bl[Fl]=[];for(var Ul=0,Hl=Pl.length;Ul<Hl;Ul++)wl=Pl[Ul],Nl=wl.getPoints(),Ll=Al(Nl),Ll=_l?!Ll:Ll,Ll?(!Il&&Gl[Fl]&&Fl++,Gl[Fl]={s:new uo,p:Nl},Gl[Fl].s.curves=wl.curves,Il&&Fl++,Bl[Fl]=[]):Bl[Fl].push({h:wl,p:Nl[0]});if(!Gl[0])return El(Pl);if(1<Gl.length){var zl=!1,Ol=[];for(var Vl=0,Wl=Gl.length;Vl<Wl;Vl++)Dl[Vl]=[];for(var Vl=0,Wl=Gl.length;Vl<Wl;Vl++){var Xl=Bl[Vl];for(var Yl=0;Yl<Xl.length;Yl++){var ql=Xl[Yl],Zl=!0;for(var Kl=0;Kl<Gl.length;Kl++)Ml(ql.p,Gl[Kl].p)&&(Vl!==Kl&&Ol.push({froms:Vl,tos:Kl,hole:Yl}),Zl?(Zl=!1,Dl[Kl].push(ql)):zl=!0);Zl&&Dl[Vl].push(ql)}}0<Ol.length&&!zl&&(Bl=Dl)}var Ql;for(var Ul=0,Jl=Gl.length;Ul<Jl;Ul++){Rl=Gl[Ul].s,Cl.push(Rl),Ql=Bl[Ul];for(var $l=0,ed=Ql.length;$l<ed;$l++)Rl.holes.push(Ql[$l].h)}return Cl}},Object.assign(go.prototype,{isFont:!0,generateShapes:function(_l,Sl,El){function Ml(Cl,Il,Dl){var Gl=Al.glyphs[Cl]||Al.glyphs["?"];if(Gl){var Bl=new fo,Fl=[],Nl=Ws.b2,Ul=Ws.b3,Hl,zl,Ol,Vl,Wl,Xl,Yl,ql,Zl,Kl,Ql;if(Gl.o){var Jl=Gl._cachedOutline||(Gl._cachedOutline=Gl.o.split(" "));for(var $l=0,ed=Jl.length;$l<ed;){var td=Jl[$l++];switch(td){case"m":Hl=Jl[$l++]*Il+Dl,zl=Jl[$l++]*Il,Bl.moveTo(Hl,zl);break;case"l":Hl=Jl[$l++]*Il+Dl,zl=Jl[$l++]*Il,Bl.lineTo(Hl,zl);break;case"q":if(Ol=Jl[$l++]*Il+Dl,Vl=Jl[$l++]*Il,Yl=Jl[$l++]*Il+Dl,ql=Jl[$l++]*Il,Bl.quadraticCurveTo(Yl,ql,Ol,Vl),Ql=Fl[Fl.length-1],Ql){Wl=Ql.x,Xl=Ql.y;for(var rd=1;rd<=El;rd++){var od=rd/El;Nl(od,Wl,Yl,Ol),Nl(od,Xl,ql,Vl)}}break;case"b":if(Ol=Jl[$l++]*Il+Dl,Vl=Jl[$l++]*Il,Yl=Jl[$l++]*Il+Dl,ql=Jl[$l++]*Il,Zl=Jl[$l++]*Il+Dl,Kl=Jl[$l++]*Il,Bl.bezierCurveTo(Yl,ql,Zl,Kl,Ol,Vl),Ql=Fl[Fl.length-1],Ql){Wl=Ql.x,Xl=Ql.y;for(var rd=1;rd<=El;rd++){var od=rd/El;Ul(od,Wl,Yl,Zl,Ol),Ul(od,Xl,ql,Kl,Vl)}}}}}return{offset:Gl.ha*Il,path:Bl}}}Sl===void 0&&(Sl=100),El===void 0&&(El=4);var Al=this.data,Pl=function(Il){var Dl=(Il+"").split(""),Gl=Sl/Al.resolution,Bl=0,Fl=[];for(var Nl=0;Nl<Dl.length;Nl++){var Ul=Ml(Dl[Nl],Gl,Bl);Bl+=Ul.offset,Fl.push(Ul.path)}return Fl}(_l),Ll=[];for(var wl=0,Rl=Pl.length;wl<Rl;wl++)Array.prototype.push.apply(Ll,Pl[wl].toShapes());return Ll}}),Object.assign(yo.prototype,{load:function(_l,Sl,El,Ml){var Al=this,Pl=new _a(this.manager);Pl.load(_l,function(Ll){var wl;try{wl=JSON.parse(Ll)}catch(Cl){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),wl=JSON.parse(Ll.substring(65,Ll.length-2))}var Rl=Al.parse(wl);Sl&&Sl(Rl)},El,Ml)},parse:function(_l){return new go(_l)}});var $s,el={getContext:function(){return void 0==$s&&($s=new(window.AudioContext||window.webkitAudioContext)),$s},setContext:function(_l){$s=_l}};Object.assign(xo.prototype,{load:function(_l,Sl,El,Ml){var Al=new _a(this.manager);Al.setResponseType("arraybuffer"),Al.load(_l,function(Pl){var Ll=el.getContext();Ll.decodeAudioData(Pl,function(wl){Sl(wl)})},El,Ml)}}),To.prototype=Object.assign(Object.create(La.prototype),{constructor:To,isRectAreaLight:!0,copy:function(_l){return La.prototype.copy.call(this,_l),this.width=_l.width,this.height=_l.height,this}}),Object.assign(bo.prototype,{update:function(){var _l,Sl,El,Ml,Al,Pl,Ll,wl=new K,Rl=new K;return function(Il){var Dl=_l!==this||Sl!==Il.focus||El!==Il.fov||Ml!==Il.aspect*this.aspect||Al!==Il.near||Pl!==Il.far||Ll!==Il.zoom;if(Dl){_l=this,Sl=Il.focus,El=Il.fov,Ml=Il.aspect*this.aspect,Al=Il.near,Pl=Il.far,Ll=Il.zoom;var Gl=Il.projectionMatrix.clone(),Bl=this.eyeSep/2,Fl=Bl*Al/Sl,Nl=Al*Math.tan(0.5*(Ls.DEG2RAD*El))/Ll,Ul,Hl;Rl.elements[12]=-Bl,wl.elements[12]=Bl,Ul=-Nl*Ml+Fl,Hl=Nl*Ml+Fl,Gl.elements[0]=2*Al/(Hl-Ul),Gl.elements[8]=(Hl+Ul)/(Hl-Ul),this.cameraL.projectionMatrix.copy(Gl),Ul=-Nl*Ml-Fl,Hl=Nl*Ml-Fl,Gl.elements[0]=2*Al/(Hl-Ul),Gl.elements[8]=(Hl+Ul)/(Hl-Ul),this.cameraR.projectionMatrix.copy(Gl)}this.cameraL.matrixWorld.copy(Il.matrixWorld).multiply(Rl),this.cameraR.matrixWorld.copy(Il.matrixWorld).multiply(wl)}}()}),vo.prototype=Object.create(at.prototype),vo.prototype.constructor=vo,_o.prototype=Object.assign(Object.create(at.prototype),{constructor:_o,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(_l){null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=_l,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(_l){this.gain.gain.value=_l},updateMatrixWorld:function(){var _l=new Z,Sl=new Y,El=new Z,Ml=new Z;return function(Pl){at.prototype.updateMatrixWorld.call(this,Pl);var Ll=this.context.listener,wl=this.up;this.matrixWorld.decompose(_l,Sl,El),Ml.set(0,0,-1).applyQuaternion(Sl),Ll.positionX?(Ll.positionX.setValueAtTime(_l.x,this.context.currentTime),Ll.positionY.setValueAtTime(_l.y,this.context.currentTime),Ll.positionZ.setValueAtTime(_l.z,this.context.currentTime),Ll.forwardX.setValueAtTime(Ml.x,this.context.currentTime),Ll.forwardY.setValueAtTime(Ml.y,this.context.currentTime),Ll.forwardZ.setValueAtTime(Ml.z,this.context.currentTime),Ll.upX.setValueAtTime(wl.x,this.context.currentTime),Ll.upY.setValueAtTime(wl.y,this.context.currentTime),Ll.upZ.setValueAtTime(wl.z,this.context.currentTime)):(Ll.setPosition(_l.x,_l.y,_l.z),Ll.setOrientation(Ml.x,Ml.y,Ml.z,wl.x,wl.y,wl.z))}}()}),So.prototype=Object.assign(Object.create(at.prototype),{constructor:So,getOutput:function(){return this.gain},setNodeSource:function(_l){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_l,this.connect(),this},setBuffer:function(_l){return this.buffer=_l,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");var _l=this.context.createBufferSource();return _l.buffer=this.buffer,_l.loop=this.loop,_l.onended=this.onEnded.bind(this),_l.playbackRate.setValueAtTime(this.playbackRate,this.startTime),_l.start(0,this.startTime),this.isPlaying=!0,this.source=_l,this.connect()},pause:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var _l=1,Sl=this.filters.length;_l<Sl;_l++)this.filters[_l-1].connect(this.filters[_l]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var _l=1,Sl=this.filters.length;_l<Sl;_l++)this.filters[_l-1].disconnect(this.filters[_l]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(_l){return _l||(_l=[]),!0===this.isPlaying?(this.disconnect(),this.filters=_l,this.connect()):this.filters=_l,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(_l){return this.setFilters(_l?[_l]:[])},setPlaybackRate:function(_l){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=_l,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(_l){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=_l,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(_l){return this.gain.gain.value=_l,this}}),Eo.prototype=Object.assign(Object.create(So.prototype),{constructor:Eo,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(_l){this.panner.refDistance=_l},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(_l){this.panner.rolloffFactor=_l},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(_l){this.panner.distanceModel=_l},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(_l){this.panner.maxDistance=_l},updateMatrixWorld:function(){var _l=new Z;return function(El){at.prototype.updateMatrixWorld.call(this,El),_l.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(_l.x,_l.y,_l.z)}}()}),Object.assign(Mo.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){var _l=0,Sl=this.getFrequencyData();for(var El=0;El<Sl.length;El++)_l+=Sl[El];return _l/Sl.length}}),Ao.prototype={constructor:Ao,accumulate:function(_l,Sl){var El=this.buffer,Ml=this.valueSize,Al=_l*Ml+Ml,Pl=this.cumulativeWeight;if(0===Pl){for(var Ll=0;Ll!==Ml;++Ll)El[Al+Ll]=El[Ll];Pl=Sl}else{Pl+=Sl;var wl=Sl/Pl;this._mixBufferRegion(El,Al,0,wl,Ml)}this.cumulativeWeight=Pl},apply:function(_l){var Sl=this.valueSize,El=this.buffer,Ml=_l*Sl+Sl,Al=this.cumulativeWeight,Pl=this.binding;this.cumulativeWeight=0,1>Al&&this._mixBufferRegion(El,Ml,3*Sl,1-Al,Sl);for(var Ll=Sl;Ll!==Sl+Sl;++Ll)if(El[Ll]!==El[Ll+Sl]){Pl.setValue(El,Ml);break}},saveOriginalState:function(){var _l=this.binding,Sl=this.buffer,El=this.valueSize,Ml=3*El;_l.getValue(Sl,Ml);for(var Al=El;Al!==Ml;++Al)Sl[Al]=Sl[Ml+Al%El];this.cumulativeWeight=0},restoreOriginalState:function(){var _l=3*this.valueSize;this.binding.setValue(this.buffer,_l)},_select:function(_l,Sl,El,Ml,Al){if(0.5<=Ml)for(var Pl=0;Pl!==Al;++Pl)_l[Sl+Pl]=_l[El+Pl]},_slerp:function(_l,Sl,El,Ml){Y.slerpFlat(_l,Sl,_l,Sl,_l,El,Ml)},_lerp:function(_l,Sl,El,Ml,Al){for(var Pl=0;Pl!==Al;++Pl){var Ll=Sl+Pl;_l[Ll]=_l[Ll]*(1-Ml)+_l[El+Pl]*Ml}}},Po.prototype={constructor:Po,getValue:function(Sl,El){this.bind(),this.getValue(Sl,El)},setValue:function(Sl,El){this.bind(),this.setValue(Sl,El)},bind:function(){var _l=this.node,Sl=this.parsedPath,El=Sl.objectName,Ml=Sl.propertyName,Al=Sl.propertyIndex;if(_l||(_l=Po.findNode(this.rootNode,Sl.nodeName)||this.rootNode,this.node=_l),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_l)return void console.error("  trying to update node for track: "+this.path+" but it wasn't found.");if(El){var Pl=Sl.objectIndex;switch(El){case"materials":if(!_l.material)return void console.error("  can not bind to material as node does not have a material",this);if(!_l.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);_l=_l.material.materials;break;case"bones":if(!_l.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);_l=_l.skeleton.bones;for(var Ll=0;Ll<_l.length;Ll++)if(_l[Ll].name===Pl){Pl=Ll;break}break;default:if(void 0===_l[El])return void console.error("  can not bind to objectName of node, undefined",this);_l=_l[El];}if(void 0!==Pl){if(void 0===_l[Pl])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,_l);_l=_l[Pl]}}var wl=_l[Ml];if(void 0===wl){var Rl=Sl.nodeName;return void console.error("  trying to update property for track: "+Rl+"."+Ml+" but it wasn't found.",_l)}var Cl=this.Versioning.None;void 0===_l.needsUpdate?void 0!==_l.matrixWorldNeedsUpdate&&(Cl=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=_l):(Cl=this.Versioning.NeedsUpdate,this.targetObject=_l);var Il=this.BindingType.Direct;if(void 0!==Al){if("morphTargetInfluences"===Ml){if(!_l.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!_l.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(var Ll=0;Ll<this.node.geometry.morphTargets.length;Ll++)if(_l.geometry.morphTargets[Ll].name===Al){Al=Ll;break}}Il=this.BindingType.ArrayElement,this.resolvedProperty=wl,this.propertyIndex=Al}else void 0!==wl.fromArray&&void 0!==wl.toArray?(Il=this.BindingType.HasFromToArray,this.resolvedProperty=wl):void 0===wl.length?this.propertyName=Ml:(Il=this.BindingType.EntireArray,this.resolvedProperty=wl);this.getValue=this.GetterByBindingType[Il],this.setValue=this.SetterByBindingTypeAndVersioning[Il][Cl]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(Po.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:Po.prototype.getValue,_setValue_unbound:Po.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(Sl,El){Sl[El]=this.node[this.propertyName]},function(Sl,El){var Ml=this.resolvedProperty;for(var Al=0,Pl=Ml.length;Al!==Pl;++Al)Sl[El++]=Ml[Al]},function(Sl,El){Sl[El]=this.resolvedProperty[this.propertyIndex]},function(Sl,El){this.resolvedProperty.toArray(Sl,El)}],SetterByBindingTypeAndVersioning:[[function(Sl,El){this.node[this.propertyName]=Sl[El]},function(Sl,El){this.node[this.propertyName]=Sl[El],this.targetObject.needsUpdate=!0},function(Sl,El){this.node[this.propertyName]=Sl[El],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Sl,El){var Ml=this.resolvedProperty;for(var Al=0,Pl=Ml.length;Al!==Pl;++Al)Ml[Al]=Sl[El++]},function(Sl,El){var Ml=this.resolvedProperty;for(var Al=0,Pl=Ml.length;Al!==Pl;++Al)Ml[Al]=Sl[El++];this.targetObject.needsUpdate=!0},function(Sl,El){var Ml=this.resolvedProperty;for(var Al=0,Pl=Ml.length;Al!==Pl;++Al)Ml[Al]=Sl[El++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Sl,El){this.resolvedProperty[this.propertyIndex]=Sl[El]},function(Sl,El){this.resolvedProperty[this.propertyIndex]=Sl[El],this.targetObject.needsUpdate=!0},function(Sl,El){this.resolvedProperty[this.propertyIndex]=Sl[El],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Sl,El){this.resolvedProperty.fromArray(Sl,El)},function(Sl,El){this.resolvedProperty.fromArray(Sl,El),this.targetObject.needsUpdate=!0},function(Sl,El){this.resolvedProperty.fromArray(Sl,El),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),Po.Composite=function(_l,Sl,El){var Ml=El||Po.parseTrackName(Sl);this._targetGroup=_l,this._bindings=_l.subscribe_(Sl,Ml)},Po.Composite.prototype={constructor:Po.Composite,getValue:function(_l,Sl){this.bind();var El=this._targetGroup.nCachedObjects_,Ml=this._bindings[El];Ml!==void 0&&Ml.getValue(_l,Sl)},setValue:function(_l,Sl){var El=this._bindings;for(var Ml=this._targetGroup.nCachedObjects_,Al=El.length;Ml!==Al;++Ml)El[Ml].setValue(_l,Sl)},bind:function(){var _l=this._bindings;for(var Sl=this._targetGroup.nCachedObjects_,El=_l.length;Sl!==El;++Sl)_l[Sl].bind()},unbind:function(){var _l=this._bindings;for(var Sl=this._targetGroup.nCachedObjects_,El=_l.length;Sl!==El;++Sl)_l[Sl].unbind()}},Po.create=function(_l,Sl,El){return _l&&_l.isAnimationObjectGroup?new Po.Composite(_l,Sl,El):new Po(_l,Sl,El)},Po.parseTrackName=function(_l){var Sl=/^((?:[\w-]+[\/:])*)([\w-]+)?(?:\.([\w-]+)(?:\[(.+)\])?)?\.([\w-]+)(?:\[(.+)\])?$/,El=Sl.exec(_l);if(!El)throw new Error("cannot parse trackName at all: "+_l);var Ml={nodeName:El[2],objectName:El[3],objectIndex:El[4],propertyName:El[5],propertyIndex:El[6]};if(null===Ml.propertyName||0===Ml.propertyName.length)throw new Error("can not parse propertyName from trackName: "+_l);return Ml},Po.findNode=function(_l,Sl){if(!Sl||""===Sl||"root"===Sl||"."===Sl||-1===Sl||Sl===_l.name||Sl===_l.uuid)return _l;if(_l.skeleton){var El=function(Ll){for(var wl=0;wl<Ll.bones.length;wl++){var Rl=Ll.bones[wl];if(Rl.name===Sl)return Rl}return null},Ml=El(_l.skeleton);if(Ml)return Ml}if(_l.children){var Al=function(Ll){for(var wl=0;wl<Ll.length;wl++){var Rl=Ll[wl];if(Rl.name===Sl||Rl.uuid===Sl)return Rl;var Cl=Al(Rl.children);if(Cl)return Cl}return null},Pl=Al(_l.children);if(Pl)return Pl}return null},Lo.prototype={constructor:Lo,isAnimationObjectGroup:!0,add:function(){var _l=this._objects,Sl=_l.length,El=this.nCachedObjects_,Ml=this._indicesByUUID,Al=this._paths,Pl=this._parsedPaths,Ll=this._bindings,wl=Ll.length;for(var Rl=0,Cl=arguments.length;Rl!==Cl;++Rl){var Il=arguments[Rl],Dl=Il.uuid,Gl=Ml[Dl],Bl=void 0;if(Gl===void 0){Gl=Sl++,Ml[Dl]=Gl,_l.push(Il);for(var Fl=0,Nl=wl;Fl!==Nl;++Fl)Ll[Fl].push(new Po(Il,Al[Fl],Pl[Fl]))}else if(Gl<El){Bl=_l[Gl];var Ul=--El,Hl=_l[Ul];Ml[Hl.uuid]=Gl,_l[Gl]=Hl,Ml[Dl]=Ul,_l[Ul]=Il;for(var Fl=0,Nl=wl;Fl!==Nl;++Fl){var zl=Ll[Fl],Ol=zl[Ul],Vl=zl[Gl];zl[Gl]=Ol,Vl===void 0&&(Vl=new Po(Il,Al[Fl],Pl[Fl])),zl[Ul]=Vl}}else _l[Gl]!==Bl&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=El},remove:function(){var _l=this._objects,Sl=this.nCachedObjects_,El=this._indicesByUUID,Ml=this._bindings,Al=Ml.length;for(var Pl=0,Ll=arguments.length;Pl!==Ll;++Pl){var wl=arguments[Pl],Rl=wl.uuid,Cl=El[Rl];if(Cl!==void 0&&Cl>=Sl){var Il=Sl++,Dl=_l[Il];El[Dl.uuid]=Cl,_l[Cl]=Dl,El[Rl]=Il,_l[Il]=wl;for(var Gl=0;Gl!==Al;++Gl){var Bl=Ml[Gl],Fl=Bl[Il],Nl=Bl[Cl];Bl[Cl]=Fl,Bl[Il]=Nl}}}this.nCachedObjects_=Sl},uncache:function(){var _l=this._objects,Sl=_l.length,El=this.nCachedObjects_,Ml=this._indicesByUUID,Al=this._bindings,Pl=Al.length;for(var Ll=0,wl=arguments.length;Ll!==wl;++Ll){var Rl=arguments[Ll],Cl=Rl.uuid,Il=Ml[Cl];if(void 0!==Il)if(delete Ml[Cl],Il<El){var Dl=--El,Gl=_l[Dl],Bl=--Sl,Fl=_l[Bl];Ml[Gl.uuid]=Il,_l[Il]=Gl,Ml[Fl.uuid]=Dl,_l[Dl]=Fl,_l.pop();for(var Nl=0,Ul=Pl;Nl!==Ul;++Nl){var Hl=Al[Nl],zl=Hl[Dl],Ol=Hl[Bl];Hl[Il]=zl,Hl[Dl]=Ol,Hl.pop()}}else{var Bl=--Sl,Fl=_l[Bl];Ml[Fl.uuid]=Il,_l[Il]=Fl,_l.pop();for(var Nl=0,Ul=Pl;Nl!==Ul;++Nl){var Hl=Al[Nl];Hl[Il]=Hl[Bl],Hl.pop()}}}this.nCachedObjects_=El},subscribe_:function(_l,Sl){var El=this._bindingsIndicesByPath,Ml=El[_l],Al=this._bindings;if(Ml!==void 0)return Al[Ml];var Pl=this._paths,Ll=this._parsedPaths,wl=this._objects,Rl=wl.length,Cl=this.nCachedObjects_,Il=Array(Rl);Ml=Al.length,El[_l]=Ml,Pl.push(_l),Ll.push(Sl),Al.push(Il);for(var Dl=Cl,Gl=wl.length;Dl!==Gl;++Dl){var Bl=wl[Dl];Il[Dl]=new Po(Bl,_l,Sl)}return Il},unsubscribe_:function(_l){var Sl=this._bindingsIndicesByPath,El=Sl[_l];if(El!==void 0){var Ml=this._paths,Al=this._parsedPaths,Pl=this._bindings,Ll=Pl.length-1,wl=Pl[Ll],Rl=_l[Ll];Sl[Rl]=El,Pl[El]=wl,Pl.pop(),Al[El]=Al[Ll],Al.pop(),Ml[El]=Ml[Ll],Ml.pop()}}},wo.prototype={constructor:wo,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(_l){return this._startTime=_l,this},setLoop:function(_l,Sl){return this.loop=_l,this.repetitions=Sl,this},setEffectiveWeight:function(_l){return this.weight=_l,this._effectiveWeight=this.enabled?_l:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(_l){return this._scheduleFading(_l,0,1)},fadeOut:function(_l){return this._scheduleFading(_l,1,0)},crossFadeFrom:function(_l,Sl,El){if(_l.fadeOut(Sl),this.fadeIn(Sl),El){var Ml=this._clip.duration,Al=_l._clip.duration;_l.warp(1,Al/Ml,Sl),this.warp(Ml/Al,1,Sl)}return this},crossFadeTo:function(_l,Sl,El){return _l.crossFadeFrom(this,Sl,El)},stopFading:function(){var _l=this._weightInterpolant;return null!==_l&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_l)),this},setEffectiveTimeScale:function(_l){return this.timeScale=_l,this._effectiveTimeScale=this.paused?0:_l,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(_l){return this.timeScale=this._clip.duration/_l,this.stopWarping()},syncWith:function(_l){return this.time=_l.time,this.timeScale=_l.timeScale,this.stopWarping()},halt:function(_l){return this.warp(this._effectiveTimeScale,0,_l)},warp:function(_l,Sl,El){var Ml=this._mixer,Al=Ml.time,Pl=this._timeScaleInterpolant,Ll=this.timeScale;null===Pl&&(Pl=Ml._lendControlInterpolant(),this._timeScaleInterpolant=Pl);var wl=Pl.parameterPositions,Rl=Pl.sampleValues;return wl[0]=Al,wl[1]=Al+El,Rl[0]=_l/Ll,Rl[1]=Sl/Ll,this},stopWarping:function(){var _l=this._timeScaleInterpolant;return null!==_l&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_l)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(_l,Sl,El,Ml){var Al=this._startTime;if(null!==Al){var Pl=(_l-Al)*El;if(0>Pl||0===El)return;this._startTime=null,Sl=El*Pl}Sl*=this._updateTimeScale(_l);var Ll=this._updateTime(Sl),wl=this._updateWeight(_l);if(0<wl){var Rl=this._interpolants,Cl=this._propertyBindings;for(var Il=0,Dl=Rl.length;Il!==Dl;++Il)Rl[Il].evaluate(Ll),Cl[Il].accumulate(Ml,wl)}},_updateWeight:function(_l){var Sl=0;if(this.enabled){Sl=this.weight;var El=this._weightInterpolant;if(null!==El){var Ml=El.evaluate(_l)[0];Sl*=Ml,_l>El.parameterPositions[1]&&(this.stopFading(),0===Ml&&(this.enabled=!1))}}return this._effectiveWeight=Sl,Sl},_updateTimeScale:function(_l){var Sl=0;if(!this.paused){Sl=this.timeScale;var El=this._timeScaleInterpolant;if(null!==El){var Ml=El.evaluate(_l)[0];Sl*=Ml,_l>El.parameterPositions[1]&&(this.stopWarping(),0==Sl?this.paused=!0:this.timeScale=Sl)}}return this._effectiveTimeScale=Sl,Sl},_updateTime:function(_l){var Sl=this.time+_l;if(0===_l)return Sl;var El=this._clip.duration,Ml=this.loop,Al=this._loopCount;if(Ml===is){-1===Al&&(this._loopCount=0,this._setEndings(!0,!0,!1));handle_stop:{if(Sl>=El)Sl=El;else if(0>Sl)Sl=0;else break handle_stop;this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>_l?-1:1})}}else{var Pl=Ml===ss;if(-1===Al&&(0<=_l?(Al=0,this._setEndings(!0,0===this.repetitions,Pl)):this._setEndings(0===this.repetitions,!0,Pl)),Sl>=El||0>Sl){var Ll=Math.floor(Sl/El);Sl-=El*Ll,Al+=Math.abs(Ll);var wl=this.repetitions-Al;if(0>wl)this.clampWhenFinished?this.paused=!0:this.enabled=!1,Sl=0<_l?El:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<_l?1:-1});else{if(0==wl){var Rl=0>_l;this._setEndings(Rl,!Rl,Pl)}else this._setEndings(!1,!1,Pl);this._loopCount=Al,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:Ll})}}if(Pl&&1==(1&Al))return this.time=Sl,El-Sl}return this.time=Sl,Sl},_setEndings:function(_l,Sl,El){var Ml=this._interpolantSettings;El?(Ml.endingStart=ms,Ml.endingEnd=ms):(Ml.endingStart=_l?this.zeroSlopeAtStart?ms:us:fs,Ml.endingEnd=Sl?this.zeroSlopeAtEnd?ms:us:fs)},_scheduleFading:function(_l,Sl,El){var Ml=this._mixer,Al=Ml.time,Pl=this._weightInterpolant;null===Pl&&(Pl=Ml._lendControlInterpolant(),this._weightInterpolant=Pl);var Ll=Pl.parameterPositions,wl=Pl.sampleValues;return Ll[0]=Al,wl[0]=Sl,Ll[1]=Al+_l,wl[1]=El,this}},Object.assign(Ro.prototype,F.prototype,{clipAction:function(_l,Sl){var El=Sl||this._root,Ml=El.uuid,Al="string"==typeof _l?Qa.findByName(El,_l):_l,Pl=null===Al?_l:Al.uuid,Ll=this._actionsByClip[Pl],wl=null;if(void 0!==Ll){var Rl=Ll.actionByRoot[Ml];if(void 0!==Rl)return Rl;wl=Ll.knownActions[0],null===Al&&(Al=wl._clip)}if(null===Al)return null;var Cl=new wo(this,Al,Sl);return this._bindAction(Cl,wl),this._addInactiveAction(Cl,Pl,Ml),Cl},existingAction:function(_l,Sl){var El=Sl||this._root,Ml=El.uuid,Al="string"==typeof _l?Qa.findByName(El,_l):_l,Pl=Al?Al.uuid:_l,Ll=this._actionsByClip[Pl];return void 0===Ll?null:Ll.actionByRoot[Ml]||null},stopAllAction:function(){var _l=this._actions,Sl=this._nActiveActions,El=this._bindings,Ml=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var Al=0;Al!==Sl;++Al)_l[Al].reset();for(var Al=0;Al!==Ml;++Al)El[Al].useCount=0;return this},update:function(_l){_l*=this.timeScale;var Sl=this._actions,El=this._nActiveActions,Ml=this.time+=_l,Al=Math.sign(_l),Pl=this._accuIndex^=1;for(var Ll=0;Ll!==El;++Ll){var wl=Sl[Ll];wl.enabled&&wl._update(Ml,_l,Al,Pl)}var Rl=this._bindings,Cl=this._nActiveBindings;for(var Ll=0;Ll!==Cl;++Ll)Rl[Ll].apply(Pl);return this},getRoot:function(){return this._root},uncacheClip:function(_l){var Sl=this._actions,El=_l.uuid,Ml=this._actionsByClip,Al=Ml[El];if(Al!==void 0){var Pl=Al.knownActions;for(var Ll=0,wl=Pl.length;Ll!==wl;++Ll){var Rl=Pl[Ll];this._deactivateAction(Rl);var Cl=Rl._cacheIndex,Il=Sl[Sl.length-1];Rl._cacheIndex=null,Rl._byClipCacheIndex=null,Il._cacheIndex=Cl,Sl[Cl]=Il,Sl.pop(),this._removeInactiveBindingsForAction(Rl)}delete Ml[El]}},uncacheRoot:function(_l){var Sl=_l.uuid,El=this._actionsByClip;for(var Ml in El){var Al=El[Ml].actionByRoot,Pl=Al[Sl];Pl!==void 0&&(this._deactivateAction(Pl),this._removeInactiveAction(Pl))}var Ll=this._bindingsByRootAndName,wl=Ll[Sl];if(wl!==void 0)for(var Rl in wl){var Cl=wl[Rl];Cl.restoreOriginalState(),this._removeInactiveBinding(Cl)}},uncacheAction:function(_l,Sl){var El=this.existingAction(_l,Sl);null!==El&&(this._deactivateAction(El),this._removeInactiveAction(El))}}),Object.assign(Ro.prototype,{_bindAction:function(_l,Sl){var El=_l._localRoot||this._root,Ml=_l._clip.tracks,Al=Ml.length,Pl=_l._propertyBindings,Ll=_l._interpolants,wl=El.uuid,Rl=this._bindingsByRootAndName,Cl=Rl[wl];Cl===void 0&&(Cl={},Rl[wl]=Cl);for(var Il=0;Il!==Al;++Il){var Dl=Ml[Il],Gl=Dl.name,Bl=Cl[Gl];if(void 0!==Bl)Pl[Il]=Bl;else{if(Bl=Pl[Il],void 0!==Bl){null===Bl._cacheIndex&&(++Bl.referenceCount,this._addInactiveBinding(Bl,wl,Gl));continue}var Fl=Sl&&Sl._propertyBindings[Il].binding.parsedPath;Bl=new Ao(Po.create(El,Gl,Fl),Dl.ValueTypeName,Dl.getValueSize()),++Bl.referenceCount,this._addInactiveBinding(Bl,wl,Gl),Pl[Il]=Bl}Ll[Il].resultBuffer=Bl.buffer}},_activateAction:function(_l){if(!this._isActiveAction(_l)){if(null===_l._cacheIndex){var Sl=(_l._localRoot||this._root).uuid,El=_l._clip.uuid,Ml=this._actionsByClip[El];this._bindAction(_l,Ml&&Ml.knownActions[0]),this._addInactiveAction(_l,El,Sl)}var Al=_l._propertyBindings;for(var Pl=0,Ll=Al.length;Pl!==Ll;++Pl){var wl=Al[Pl];0==wl.useCount++&&(this._lendBinding(wl),wl.saveOriginalState())}this._lendAction(_l)}},_deactivateAction:function(_l){if(this._isActiveAction(_l)){var Sl=_l._propertyBindings;for(var El=0,Ml=Sl.length;El!==Ml;++El){var Al=Sl[El];0==--Al.useCount&&(Al.restoreOriginalState(),this._takeBackBinding(Al))}this._takeBackAction(_l)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var _l=this;this.stats={actions:{get total(){return _l._actions.length},get inUse(){return _l._nActiveActions}},bindings:{get total(){return _l._bindings.length},get inUse(){return _l._nActiveBindings}},controlInterpolants:{get total(){return _l._controlInterpolants.length},get inUse(){return _l._nActiveControlInterpolants}}}},_isActiveAction:function(_l){var Sl=_l._cacheIndex;return null!==Sl&&Sl<this._nActiveActions},_addInactiveAction:function(_l,Sl,El){var Ml=this._actions,Al=this._actionsByClip,Pl=Al[Sl];if(Pl===void 0)Pl={knownActions:[_l],actionByRoot:{}},_l._byClipCacheIndex=0,Al[Sl]=Pl;else{var Ll=Pl.knownActions;_l._byClipCacheIndex=Ll.length,Ll.push(_l)}_l._cacheIndex=Ml.length,Ml.push(_l),Pl.actionByRoot[El]=_l},_removeInactiveAction:function(_l){var Sl=this._actions,El=Sl[Sl.length-1],Ml=_l._cacheIndex;El._cacheIndex=Ml,Sl[Ml]=El,Sl.pop(),_l._cacheIndex=null;var Al=_l._clip.uuid,Pl=this._actionsByClip,Ll=Pl[Al],wl=Ll.knownActions,Rl=wl[wl.length-1],Cl=_l._byClipCacheIndex;Rl._byClipCacheIndex=Cl,wl[Cl]=Rl,wl.pop(),_l._byClipCacheIndex=null;var Il=Ll.actionByRoot,Dl=(Sl._localRoot||this._root).uuid;delete Il[Dl],0===wl.length&&delete Pl[Al],this._removeInactiveBindingsForAction(_l)},_removeInactiveBindingsForAction:function(_l){var Sl=_l._propertyBindings;for(var El=0,Ml=Sl.length;El!==Ml;++El){var Al=Sl[El];0==--Al.referenceCount&&this._removeInactiveBinding(Al)}},_lendAction:function(_l){var Sl=this._actions,El=_l._cacheIndex,Ml=this._nActiveActions++,Al=Sl[Ml];_l._cacheIndex=Ml,Sl[Ml]=_l,Al._cacheIndex=El,Sl[El]=Al},_takeBackAction:function(_l){var Sl=this._actions,El=_l._cacheIndex,Ml=--this._nActiveActions,Al=Sl[Ml];_l._cacheIndex=Ml,Sl[Ml]=_l,Al._cacheIndex=El,Sl[El]=Al},_addInactiveBinding:function(_l,Sl,El){var Ml=this._bindingsByRootAndName,Al=Ml[Sl],Pl=this._bindings;Al===void 0&&(Al={},Ml[Sl]=Al),Al[El]=_l,_l._cacheIndex=Pl.length,Pl.push(_l)},_removeInactiveBinding:function(_l){var Sl=this._bindings,El=_l.binding,Ml=El.rootNode.uuid,Al=El.path,Pl=this._bindingsByRootAndName,Ll=Pl[Ml],wl=Sl[Sl.length-1],Rl=_l._cacheIndex;wl._cacheIndex=Rl,Sl[Rl]=wl,Sl.pop(),delete Ll[Al];remove_empty_map:{for(var Cl in Ll)break remove_empty_map;delete Pl[Ml]}},_lendBinding:function(_l){var Sl=this._bindings,El=_l._cacheIndex,Ml=this._nActiveBindings++,Al=Sl[Ml];_l._cacheIndex=Ml,Sl[Ml]=_l,Al._cacheIndex=El,Sl[El]=Al},_takeBackBinding:function(_l){var Sl=this._bindings,El=_l._cacheIndex,Ml=--this._nActiveBindings,Al=Sl[Ml];_l._cacheIndex=Ml,Sl[Ml]=_l,Al._cacheIndex=El,Sl[El]=Al},_lendControlInterpolant:function(){var _l=this._controlInterpolants,Sl=this._nActiveControlInterpolants++,El=_l[Sl];return void 0===El&&(El=new Ha(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),El.__cacheIndex=Sl,_l[Sl]=El),El},_takeBackControlInterpolant:function(_l){var Sl=this._controlInterpolants,El=_l.__cacheIndex,Ml=--this._nActiveControlInterpolants,Al=Sl[Ml];_l.__cacheIndex=Ml,Sl[Ml]=_l,Al.__cacheIndex=El,Sl[El]=Al},_controlInterpolantsResultBuffer:new Float32Array(1)}),Co.prototype.clone=function(){return new Co(this.value.clone===void 0?this.value:this.value.clone())},Io.prototype=Object.create(St.prototype),Io.prototype.constructor=Io,Io.prototype.isInstancedBufferGeometry=!0,Io.prototype.addGroup=function(_l,Sl,El){this.groups.push({start:_l,count:Sl,materialIndex:El})},Io.prototype.copy=function(_l){var Sl=_l.index;null!==Sl&&this.setIndex(Sl.clone());var El=_l.attributes;for(var Ml in El){var Al=El[Ml];this.addAttribute(Ml,Al.clone())}var Pl=_l.groups;for(var Ll=0,wl=Pl.length;Ll<wl;Ll++){var Rl=Pl[Ll];this.addGroup(Rl.start,Rl.count,Rl.materialIndex)}return this},Do.prototype={constructor:Do,isInterleavedBufferAttribute:!0,get count(){return this.data.count},get array(){return this.data.array},setX:function(_l,Sl){return this.data.array[_l*this.data.stride+this.offset]=Sl,this},setY:function(_l,Sl){return this.data.array[_l*this.data.stride+this.offset+1]=Sl,this},setZ:function(_l,Sl){return this.data.array[_l*this.data.stride+this.offset+2]=Sl,this},setW:function(_l,Sl){return this.data.array[_l*this.data.stride+this.offset+3]=Sl,this},getX:function(_l){return this.data.array[_l*this.data.stride+this.offset]},getY:function(_l){return this.data.array[_l*this.data.stride+this.offset+1]},getZ:function(_l){return this.data.array[_l*this.data.stride+this.offset+2]},getW:function(_l){return this.data.array[_l*this.data.stride+this.offset+3]},setXY:function(_l,Sl,El){return _l=_l*this.data.stride+this.offset,this.data.array[_l+0]=Sl,this.data.array[_l+1]=El,this},setXYZ:function(_l,Sl,El,Ml){return _l=_l*this.data.stride+this.offset,this.data.array[_l+0]=Sl,this.data.array[_l+1]=El,this.data.array[_l+2]=Ml,this},setXYZW:function(_l,Sl,El,Ml,Al){return _l=_l*this.data.stride+this.offset,this.data.array[_l+0]=Sl,this.data.array[_l+1]=El,this.data.array[_l+2]=Ml,this.data.array[_l+3]=Al,this}},Go.prototype={constructor:Go,isInterleavedBuffer:!0,set needsUpdate(_l){!0===_l&&this.version++},setArray:function(_l){if(Array.isArray(_l))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=_l===void 0?0:_l.length/this.stride,this.array=_l},setDynamic:function(_l){return this.dynamic=_l,this},copy:function(_l){return this.array=new _l.array.constructor(_l.array),this.count=_l.count,this.stride=_l.stride,this.dynamic=_l.dynamic,this},copyAt:function(_l,Sl,El){_l*=this.stride,El*=Sl.stride;for(var Ml=0,Al=this.stride;Ml<Al;Ml++)this.array[_l+Ml]=Sl.array[El+Ml];return this},set:function(_l,Sl){return void 0===Sl&&(Sl=0),this.array.set(_l,Sl),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(_l){return this.onUploadCallback=_l,this}},Bo.prototype=Object.create(Go.prototype),Bo.prototype.constructor=Bo,Bo.prototype.isInstancedInterleavedBuffer=!0,Bo.prototype.copy=function(_l){return Go.prototype.copy.call(this,_l),this.meshPerAttribute=_l.meshPerAttribute,this},Fo.prototype=Object.create(lt.prototype),Fo.prototype.constructor=Fo,Fo.prototype.isInstancedBufferAttribute=!0,Fo.prototype.copy=function(_l){return lt.prototype.copy.call(this,_l),this.meshPerAttribute=_l.meshPerAttribute,this},No.prototype={constructor:No,linePrecision:1,set:function(_l,Sl){this.ray.set(_l,Sl)},setFromCamera:function(_l,Sl){Sl&&Sl.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(Sl.matrixWorld),this.ray.direction.set(_l.x,_l.y,0.5).unproject(Sl).sub(this.ray.origin).normalize()):Sl&&Sl.isOrthographicCamera?(this.ray.origin.set(_l.x,_l.y,(Sl.near+Sl.far)/(Sl.near-Sl.far)).unproject(Sl),this.ray.direction.set(0,0,-1).transformDirection(Sl.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(_l,Sl){var El=[];return Ho(_l,this,El,Sl),El.sort(Uo),El},intersectObjects:function(_l,Sl){var El=[];if(!1===Array.isArray(_l))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),El;for(var Ml=0,Al=_l.length;Ml<Al;Ml++)Ho(_l[Ml],this,El,Sl);return El.sort(Uo),El}},zo.prototype={constructor:zo,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var _l=0;if(this.autoStart&&!this.running&&this.start(),this.running){var Sl=(performance||Date).now();_l=(Sl-this.oldTime)/1e3,this.oldTime=Sl,this.elapsedTime+=_l}return _l}},Oo.prototype={constructor:Oo,set:function(_l,Sl,El){return this.radius=_l,this.phi=Sl,this.theta=El,this},clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.radius=_l.radius,this.phi=_l.phi,this.theta=_l.theta,this},makeSafe:function(){var _l=1e-6;return this.phi=Math.max(_l,Math.min(Math.PI-_l,this.phi)),this},setFromVector3:function(_l){return this.radius=_l.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_l.x,_l.z),this.phi=Math.acos(Ls.clamp(_l.y/this.radius,-1,1))),this}},Vo.prototype={constructor:Vo,set:function(_l,Sl,El){return this.radius=_l,this.theta=Sl,this.y=El,this},clone:function(){return new this.constructor().copy(this)},copy:function(_l){return this.radius=_l.radius,this.theta=_l.theta,this.y=_l.y,this},setFromVector3:function(_l){return this.radius=Math.sqrt(_l.x*_l.x+_l.z*_l.z),this.theta=Math.atan2(_l.x,_l.z),this.y=_l.y,this}},ko.prototype=Object.create(Et.prototype),ko.prototype.constructor=ko,ko.prototype.createAnimation=function(_l,Sl,El,Ml){var Al={start:Sl,end:El,length:El-Sl+1,fps:Ml,duration:(El-Sl)/Ml,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[_l]=Al,this.animationsList.push(Al)},ko.prototype.autoCreateAnimations=function(_l){var Sl=/([a-z]+)_?(\d+)/i,El,Ml={},Al=this.geometry;for(var Pl=0,Ll=Al.morphTargets.length;Pl<Ll;Pl++){var wl=Al.morphTargets[Pl],Rl=wl.name.match(Sl);if(Rl&&1<Rl.length){var Cl=Rl[1];Ml[Cl]||(Ml[Cl]={start:1/0,end:-(1/0)});var Il=Ml[Cl];Pl<Il.start&&(Il.start=Pl),Pl>Il.end&&(Il.end=Pl),El||(El=Cl)}}for(var Cl in Ml){var Il=Ml[Cl];this.createAnimation(Cl,Il.start,Il.end,_l)}this.firstAnimation=El},ko.prototype.setAnimationDirectionForward=function(_l){var Sl=this.animationsMap[_l];Sl&&(Sl.direction=1,Sl.directionBackwards=!1)},ko.prototype.setAnimationDirectionBackward=function(_l){var Sl=this.animationsMap[_l];Sl&&(Sl.direction=-1,Sl.directionBackwards=!0)},ko.prototype.setAnimationFPS=function(_l,Sl){var El=this.animationsMap[_l];El&&(El.fps=Sl,El.duration=(El.end-El.start)/El.fps)},ko.prototype.setAnimationDuration=function(_l,Sl){var El=this.animationsMap[_l];El&&(El.duration=Sl,El.fps=(El.end-El.start)/El.duration)},ko.prototype.setAnimationWeight=function(_l,Sl){var El=this.animationsMap[_l];El&&(El.weight=Sl)},ko.prototype.setAnimationTime=function(_l,Sl){var El=this.animationsMap[_l];El&&(El.time=Sl)},ko.prototype.getAnimationTime=function(_l){var Sl=0,El=this.animationsMap[_l];return El&&(Sl=El.time),Sl},ko.prototype.getAnimationDuration=function(_l){var Sl=-1,El=this.animationsMap[_l];return El&&(Sl=El.duration),Sl},ko.prototype.playAnimation=function(_l){var Sl=this.animationsMap[_l];Sl?(Sl.time=0,Sl.active=!0):console.warn("THREE.MorphBlendMesh: animation["+_l+"] undefined in .playAnimation()")},ko.prototype.stopAnimation=function(_l){var Sl=this.animationsMap[_l];Sl&&(Sl.active=!1)},ko.prototype.update=function(_l){for(var Sl=0,El=this.animationsList.length;Sl<El;Sl++){var Ml=this.animationsList[Sl];if(Ml.active){var Al=Ml.duration/Ml.length;Ml.time+=Ml.direction*_l,Ml.mirroredLoop?(Ml.time>Ml.duration||0>Ml.time)&&(Ml.direction*=-1,Ml.time>Ml.duration&&(Ml.time=Ml.duration,Ml.directionBackwards=!0),0>Ml.time&&(Ml.time=0,Ml.directionBackwards=!1)):(Ml.time=Ml.time%Ml.duration,0>Ml.time&&(Ml.time+=Ml.duration));var Pl=Ml.start+Ls.clamp(Math.floor(Ml.time/Al),0,Ml.length-1),Ll=Ml.weight;Pl!==Ml.currentFrame&&(this.morphTargetInfluences[Ml.lastFrame]=0,this.morphTargetInfluences[Ml.currentFrame]=1*Ll,this.morphTargetInfluences[Pl]=0,Ml.lastFrame=Ml.currentFrame,Ml.currentFrame=Pl);var wl=Ml.time%Al/Al;Ml.directionBackwards&&(wl=1-wl),Ml.currentFrame===Ml.lastFrame?this.morphTargetInfluences[Ml.currentFrame]=Ll:(this.morphTargetInfluences[Ml.currentFrame]=wl*Ll,this.morphTargetInfluences[Ml.lastFrame]=(1-wl)*Ll)}}},Wo.prototype=Object.create(at.prototype),Wo.prototype.constructor=Wo,Wo.prototype.isImmediateRenderObject=!0,Xo.prototype=Object.create(hr.prototype),Xo.prototype.constructor=Xo,Xo.prototype.update=function(){var _l=new Z,Sl=new Z,El=new Ke;return function(){var Al=["a","b","c"];this.object.updateMatrixWorld(!0),El.getNormalMatrix(this.object.matrixWorld);var Pl=this.object.matrixWorld,Ll=this.geometry.attributes.position,wl=this.object.geometry;if(wl&&wl.isGeometry){var Rl=wl.vertices,Cl=wl.faces,Il=0;for(var Dl=0,Gl=Cl.length;Dl<Gl;Dl++){var Bl=Cl[Dl];for(var Fl=0,Nl=Bl.vertexNormals.length;Fl<Nl;Fl++){var Ul=Rl[Bl[Al[Fl]]],Hl=Bl.vertexNormals[Fl];_l.copy(Ul).applyMatrix4(Pl),Sl.copy(Hl).applyMatrix3(El).normalize().multiplyScalar(this.size).add(_l),Ll.setXYZ(Il,_l.x,_l.y,_l.z),Il=Il+1,Ll.setXYZ(Il,Sl.x,Sl.y,Sl.z),Il=Il+1}}}else if(wl&&wl.isBufferGeometry){var zl=wl.attributes.position,Ol=wl.attributes.normal,Il=0;for(var Fl=0,Nl=zl.count;Fl<Nl;Fl++)_l.set(zl.getX(Fl),zl.getY(Fl),zl.getZ(Fl)).applyMatrix4(Pl),Sl.set(Ol.getX(Fl),Ol.getY(Fl),Ol.getZ(Fl)),Sl.applyMatrix3(El).normalize().multiplyScalar(this.size).add(_l),Ll.setXYZ(Il,_l.x,_l.y,_l.z),Il=Il+1,Ll.setXYZ(Il,Sl.x,Sl.y,Sl.z),Il=Il+1}return Ll.needsUpdate=!0,this}}(),jo.prototype=Object.create(at.prototype),jo.prototype.constructor=jo,jo.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},jo.prototype.update=function(){var _l=new Z,Sl=new Z;return function(){var Ml=this.light.distance?this.light.distance:1e3,Al=Ml*Math.tan(this.light.angle);this.cone.scale.set(Al,Al,Ml),_l.setFromMatrixPosition(this.light.matrixWorld),Sl.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Sl.sub(_l)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),Yo.prototype=Object.create(hr.prototype),Yo.prototype.constructor=Yo,Yo.prototype.getBoneList=function(_l){var Sl=[];_l&&_l.isBone&&Sl.push(_l);for(var El=0;El<_l.children.length;El++)Sl.push.apply(Sl,this.getBoneList(_l.children[El]));return Sl},Yo.prototype.update=function(){var _l=new Z,Sl=new K,El=new K;return function(){var Al=this.geometry,Pl=Al.getAttribute("position");El.getInverse(this.root.matrixWorld);for(var Ll=0,wl=0;Ll<this.bones.length;Ll++){var Rl=this.bones[Ll];Rl.parent&&Rl.parent.isBone&&(Sl.multiplyMatrices(El,Rl.matrixWorld),_l.setFromMatrixPosition(Sl),Pl.setXYZ(wl,_l.x,_l.y,_l.z),Sl.multiplyMatrices(El,Rl.parent.matrixWorld),_l.setFromMatrixPosition(Sl),Pl.setXYZ(wl+1,_l.x,_l.y,_l.z),wl+=2)}Al.getAttribute("position").needsUpdate=!0}}(),qo.prototype=Object.create(Et.prototype),qo.prototype.constructor=qo,qo.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},qo.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},Zo.prototype=Object.create(at.prototype),Zo.prototype.constructor=Zo,Zo.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose(),this.children[1].geometry.dispose(),this.children[1].material.dispose()},Zo.prototype.update=function(){var _l=new Z,Sl=new Z;return function(){var Ml=this.children[0],Al=this.children[1];if(this.light.target){_l.setFromMatrixPosition(this.light.matrixWorld),Sl.setFromMatrixPosition(this.light.target.matrixWorld);var Pl=Sl.clone().sub(_l);Ml.lookAt(Pl),Al.lookAt(Pl)}Ml.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),Al.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var Ll=0.5*this.light.width,wl=0.5*this.light.height,Rl=Ml.geometry.getAttribute("position"),Cl=Rl.array;Cl[0]=Ll,Cl[1]=-wl,Cl[2]=0,Cl[3]=Ll,Cl[4]=wl,Cl[5]=0,Cl[6]=-Ll,Cl[7]=wl,Cl[8]=0,Cl[9]=-Ll,Cl[10]=wl,Cl[11]=0,Cl[12]=-Ll,Cl[13]=-wl,Cl[14]=0,Cl[15]=Ll,Cl[16]=-wl,Cl[17]=0,Rl.needsUpdate=!0}}(),Ko.prototype=Object.create(at.prototype),Ko.prototype.constructor=Ko,Ko.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Ko.prototype.update=function(){var _l=new Z,Sl=new ze,El=new ze;return function(){var Al=this.children[0],Pl=Al.geometry.getAttribute("color");Sl.copy(this.light.color).multiplyScalar(this.light.intensity),El.copy(this.light.groundColor).multiplyScalar(this.light.intensity);for(var Ll=0,wl=Pl.count;Ll<wl;Ll++){var Rl=Ll<wl/2?Sl:El;Pl.setXYZ(Ll,Rl.r,Rl.g,Rl.b)}Al.lookAt(_l.setFromMatrixPosition(this.light.matrixWorld).negate()),Pl.needsUpdate=!0}}(),Qo.prototype=Object.create(hr.prototype),Qo.prototype.constructor=Qo,Jo.prototype=Object.create(hr.prototype),Jo.prototype.constructor=Jo,$o.prototype=Object.create(hr.prototype),$o.prototype.constructor=$o,$o.prototype.update=function(){var _l=new Z,Sl=new Z,El=new Ke;return function(){this.object.updateMatrixWorld(!0),El.getNormalMatrix(this.object.matrixWorld);var Al=this.object.matrixWorld,Pl=this.geometry.attributes.position,Ll=this.object.geometry,wl=Ll.vertices,Rl=Ll.faces,Cl=0;for(var Il=0,Dl=Rl.length;Il<Dl;Il++){var Gl=Rl[Il],Bl=Gl.normal;_l.copy(wl[Gl.a]).add(wl[Gl.b]).add(wl[Gl.c]).divideScalar(3).applyMatrix4(Al),Sl.copy(Bl).applyMatrix3(El).normalize().multiplyScalar(this.size).add(_l),Pl.setXYZ(Cl,_l.x,_l.y,_l.z),Cl=Cl+1,Pl.setXYZ(Cl,Sl.x,Sl.y,Sl.z),Cl=Cl+1}return Pl.needsUpdate=!0,this}}(),ei.prototype=Object.create(at.prototype),ei.prototype.constructor=ei,ei.prototype.dispose=function(){var _l=this.children[0],Sl=this.children[1];_l.geometry.dispose(),_l.material.dispose(),Sl.geometry.dispose(),Sl.material.dispose()},ei.prototype.update=function(){var _l=new Z,Sl=new Z,El=new Z;return function(){_l.setFromMatrixPosition(this.light.matrixWorld),Sl.setFromMatrixPosition(this.light.target.matrixWorld),El.subVectors(Sl,_l);var Al=this.children[0],Pl=this.children[1];Al.lookAt(El),Al.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),Pl.lookAt(El),Pl.scale.z=El.length()}}(),ti.prototype=Object.create(hr.prototype),ti.prototype.constructor=ti,ti.prototype.update=function(){function _l(Pl,Ll,wl,Rl){Ml.set(Ll,wl,Rl).unproject(Al);var Cl=El[Pl];if(Cl!==void 0){var Il=Sl.getAttribute("position");for(var Dl=0,Gl=Cl.length;Dl<Gl;Dl++)Il.setXYZ(Cl[Dl],Ml.x,Ml.y,Ml.z)}}var Sl,El,Ml=new Z,Al=new Pt;return function(){Sl=this.geometry,El=this.pointMap;var Ll=1,wl=1;Al.projectionMatrix.copy(this.camera.projectionMatrix),_l("c",0,0,-1),_l("t",0,0,1),_l("n1",-Ll,-wl,-1),_l("n2",Ll,-wl,-1),_l("n3",-Ll,wl,-1),_l("n4",Ll,wl,-1),_l("f1",-Ll,-wl,1),_l("f2",Ll,-wl,1),_l("f3",-Ll,wl,1),_l("f4",Ll,wl,1),_l("u1",0.7*Ll,1.1*wl,-1),_l("u2",0.7*-Ll,1.1*wl,-1),_l("u3",0,2*wl,-1),_l("cf1",-Ll,0,1),_l("cf2",Ll,0,1),_l("cf3",0,-wl,1),_l("cf4",0,wl,1),_l("cn1",-Ll,0,-1),_l("cn2",Ll,0,-1),_l("cn3",0,-wl,-1),_l("cn4",0,wl,-1),Sl.getAttribute("position").needsUpdate=!0}}(),ri.prototype=Object.create(hr.prototype),ri.prototype.constructor=ri,ri.prototype.update=function(){var _l=new qe;return function(El){if(El&&El.isBox3?_l.copy(El):_l.setFromObject(El),!_l.isEmpty()){var Ml=_l.min,Al=_l.max,Pl=this.geometry.attributes.position,Ll=Pl.array;Ll[0]=Al.x,Ll[1]=Al.y,Ll[2]=Al.z,Ll[3]=Ml.x,Ll[4]=Al.y,Ll[5]=Al.z,Ll[6]=Ml.x,Ll[7]=Ml.y,Ll[8]=Al.z,Ll[9]=Al.x,Ll[10]=Ml.y,Ll[11]=Al.z,Ll[12]=Al.x,Ll[13]=Al.y,Ll[14]=Ml.z,Ll[15]=Ml.x,Ll[16]=Al.y,Ll[17]=Ml.z,Ll[18]=Ml.x,Ll[19]=Ml.y,Ll[20]=Ml.z,Ll[21]=Al.x,Ll[22]=Ml.y,Ll[23]=Ml.z,Pl.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}();var al=new St;al.addAttribute("position",new yt([0,0,0,0,1,0],3));var nl=new ta(0,0.5,1,5,1);nl.translate(0,-0.5,0),ai.prototype=Object.create(at.prototype),ai.prototype.constructor=ai,ai.prototype.setDirection=function(){var _l=new Z,Sl;return function(Ml){0.99999<Ml.y?this.quaternion.set(0,0,0,1):-0.99999>Ml.y?this.quaternion.set(1,0,0,0):(_l.set(Ml.z,0,-Ml.x).normalize(),Sl=Math.acos(Ml.y),this.quaternion.setFromAxisAngle(_l,Sl))}}(),ai.prototype.setLength=function(_l,Sl,El){Sl===void 0&&(Sl=0.2*_l),El===void 0&&(El=0.2*Sl),this.line.scale.set(1,Math.max(0,_l-Sl),1),this.line.updateMatrix(),this.cone.scale.set(El,Sl,El),this.cone.position.y=_l,this.cone.updateMatrix()},ai.prototype.setColor=function(_l){this.line.material.color.copy(_l),this.cone.material.color.copy(_l)},oi.prototype=Object.create(hr.prototype),oi.prototype.constructor=oi;var dl=function(){function _l(){}var Sl=new Z,El=new _l,Ml=new _l,Al=new _l;return _l.prototype.init=function(Pl,Ll,wl,Rl){this.c0=Pl,this.c1=wl,this.c2=-3*Pl+3*Ll-2*wl-Rl,this.c3=2*Pl-2*Ll+wl+Rl},_l.prototype.initNonuniformCatmullRom=function(Pl,Ll,wl,Rl,Cl,Il,Dl){var Gl=(Ll-Pl)/Cl-(wl-Pl)/(Cl+Il)+(wl-Ll)/Il,Bl=(wl-Ll)/Il-(Rl-Ll)/(Il+Dl)+(Rl-wl)/Dl;Gl*=Il,Bl*=Il,this.init(Ll,wl,Gl,Bl)},_l.prototype.initCatmullRom=function(Pl,Ll,wl,Rl,Cl){this.init(Ll,wl,Cl*(wl-Pl),Cl*(Rl-Ll))},_l.prototype.calc=function(Pl){var Ll=Pl*Pl;return this.c0+this.c1*Pl+this.c2*Ll+this.c3*(Ll*Pl)},oo.create(function(Pl){this.points=Pl||[],this.closed=!1},function(Pl){var Ll=this.points,wl,Rl,Cl,Il;Il=Ll.length,2>Il&&console.log("duh, you need at least 2 points"),wl=(Il-(this.closed?0:1))*Pl,Rl=Math.floor(wl),Cl=wl-Rl,this.closed?Rl+=0<Rl?0:(Math.floor(Math.abs(Rl)/Ll.length)+1)*Ll.length:0===Cl&&Rl===Il-1&&(Rl=Il-2,Cl=1);var Dl,Gl,Bl,Fl;if(this.closed||0<Rl?Dl=Ll[(Rl-1)%Il]:(Sl.subVectors(Ll[0],Ll[1]).add(Ll[0]),Dl=Sl),Gl=Ll[Rl%Il],Bl=Ll[(Rl+1)%Il],this.closed||Rl+2<Il?Fl=Ll[(Rl+2)%Il]:(Sl.subVectors(Ll[Il-1],Ll[Il-2]).add(Ll[Il-1]),Fl=Sl),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var Nl="chordal"===this.type?0.5:0.25,Ul=Math.pow(Dl.distanceToSquared(Gl),Nl),Hl=Math.pow(Gl.distanceToSquared(Bl),Nl),zl=Math.pow(Bl.distanceToSquared(Fl),Nl);1e-4>Hl&&(Hl=1),1e-4>Ul&&(Ul=Hl),1e-4>zl&&(zl=Hl),El.initNonuniformCatmullRom(Dl.x,Gl.x,Bl.x,Fl.x,Ul,Hl,zl),Ml.initNonuniformCatmullRom(Dl.y,Gl.y,Bl.y,Fl.y,Ul,Hl,zl),Al.initNonuniformCatmullRom(Dl.z,Gl.z,Bl.z,Fl.z,Ul,Hl,zl)}else if("catmullrom"===this.type){var Ol=void 0===this.tension?0.5:this.tension;El.initCatmullRom(Dl.x,Gl.x,Bl.x,Fl.x,Ol),Ml.initCatmullRom(Dl.y,Gl.y,Bl.y,Fl.y,Ol),Al.initCatmullRom(Dl.z,Gl.z,Bl.z,Fl.z,Ol)}var Vl=new Z(El.calc(Cl),Ml.calc(Cl),Al.calc(Cl));return Vl})}(),cl=oo.create(function(_l){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=_l===void 0?[]:_l},function(_l){var Sl=this.points,El=(Sl.length-1)*_l,Ml=Math.floor(El),Al=El-Ml,Pl=Sl[0==Ml?Ml:Ml-1],Ll=Sl[Ml],wl=Sl[Ml>Sl.length-2?Sl.length-1:Ml+1],Rl=Sl[Ml>Sl.length-3?Sl.length-1:Ml+2],Cl=Qs.interpolate;return new Z(Cl(Pl.x,Ll.x,wl.x,Rl.x,Al),Cl(Pl.y,Ll.y,wl.y,Rl.y,Al),Cl(Pl.z,Ll.z,wl.z,Rl.z,Al))}),ul=oo.create(function(_l,Sl,El,Ml){this.v0=_l,this.v1=Sl,this.v2=El,this.v3=Ml},function(_l){var Sl=Ws.b3;return new Z(Sl(_l,this.v0.x,this.v1.x,this.v2.x,this.v3.x),Sl(_l,this.v0.y,this.v1.y,this.v2.y,this.v3.y),Sl(_l,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),yl=oo.create(function(_l,Sl,El){this.v0=_l,this.v1=Sl,this.v2=El},function(_l){var Sl=Ws.b2;return new Z(Sl(_l,this.v0.x,this.v1.x,this.v2.x),Sl(_l,this.v0.y,this.v1.y,this.v2.y),Sl(_l,this.v0.z,this.v1.z,this.v2.z))}),xl=oo.create(function(_l,Sl){this.v1=_l,this.v2=Sl},function(_l){if(1===_l)return this.v2.clone();var Sl=new Z;return Sl.subVectors(this.v2,this.v1),Sl.multiplyScalar(_l),Sl.add(this.v1),Sl});ni.prototype=Object.create(so.prototype),ni.prototype.constructor=ni,si.prototype=Object.create(dl.prototype),Qo.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Object.assign(Ve.prototype,{center:function(_l){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(_l)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(_l){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(_l)},size:function(_l){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(_l)}}),Object.assign(qe.prototype,{center:function(_l){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(_l)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(_l){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(_l)},isIntersectionSphere:function(_l){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(_l)},size:function(_l){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(_l)}}),ot.prototype.center=function(_l){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(_l)},Ls.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(Ke.prototype,{flattenToArrayOffset:function(_l,Sl){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(_l,Sl)},multiplyVector3:function(_l){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),_l.applyMatrix3(this)},multiplyVector3Array:function(_l){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(_l)},applyToBuffer:function(_l){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(_l)}}),Object.assign(K.prototype,{extractPosition:function(_l){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(_l)},flattenToArrayOffset:function(_l,Sl){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(_l,Sl)},getPosition:function(){var _l;return function(){return void 0==_l&&(_l=new Z),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),_l.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(_l){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(_l)},multiplyVector3:function(_l){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),_l.applyProjection(this)},multiplyVector4:function(_l){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),_l.applyMatrix4(this)},multiplyVector3Array:function(_l){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(_l)},rotateAxis:function(_l){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),_l.transformDirection(this)},crossVector:function(_l){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),_l.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(_l){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(_l)}}),Qe.prototype.isIntersectionLine=function(_l){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(_l)},Y.prototype.multiplyVector3=function(_l){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),_l.applyQuaternion(this)},Object.assign(et.prototype,{isIntersectionBox:function(_l){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(_l)},isIntersectionPlane:function(_l){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(_l)},isIntersectionSphere:function(_l){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(_l)}}),Object.assign(uo.prototype,{extrude:function(_l){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new kr(this,_l)},makeGeometry:function(_l){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new $r(this,_l)}}),Object.assign(Z.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(_l){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(_l)},getScaleFromMatrix:function(_l){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(_l)},getColumnFromMatrix:function(_l,Sl){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(Sl,_l)}}),vt.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(at.prototype,{getChildByName:function(_l){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(_l)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(_l,Sl){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(Sl,_l)}}),Object.defineProperties(at.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(_l){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=_l}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(pr.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Lt.prototype.setLens=function(_l,Sl){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),Sl!==void 0&&(this.filmGauge=Sl),this.setFocalLength(_l)},Object.defineProperties(La.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(_l){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=_l}},shadowCameraLeft:{set:function(_l){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=_l}},shadowCameraRight:{set:function(_l){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=_l}},shadowCameraTop:{set:function(_l){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=_l}},shadowCameraBottom:{set:function(_l){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=_l}},shadowCameraNear:{set:function(_l){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=_l}},shadowCameraFar:{set:function(_l){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=_l}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(_l){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=_l}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(_l){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=_l}},shadowMapHeight:{set:function(_l){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=_l}}}),Object.defineProperties(lt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(St.prototype,{addIndex:function(_l){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(_l)},addDrawCall:function(_l,Sl,El){El!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(_l,Sl)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(St.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Co.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Xe.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new ze}}}),Object.defineProperties(ha.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(je.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(_l){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=_l}}}),F.prototype=Object.assign(Object.create({constructor:F,apply:function(_l){console.warn("THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in."),Object.assign(_l,this)}}),F.prototype),Object.assign(rr.prototype,{supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(_l){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(_l)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(rr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(_l){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=_l}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(_l){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=_l}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(_l){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=_l}}}),Object.defineProperties($e.prototype,{cullFace:{get:function(){return this.renderReverseSided?ci:pi},set:function(_l){var Sl=_l!==pi;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+Sl+"."),this.renderReverseSided=Sl}}}),Object.defineProperties(W.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(_l){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=_l}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(_l){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=_l}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(_l){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=_l}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(_l){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=_l}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(_l){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=_l}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(_l){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=_l}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(_l){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=_l}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(_l){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=_l}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(_l){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=_l}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(_l){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=_l}}}),So.prototype.load=function(_l){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var Sl=this,El=new xo;return El.load(_l,function(Ml){Sl.setBuffer(Ml)}),this},Mo.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};var Tl={crossOrigin:void 0,loadTexture:function(_l,Sl,El,Ml){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var Al=new Pa;Al.setCrossOrigin(this.crossOrigin);var Pl=Al.load(_l,El,void 0,Ml);return Sl&&(Pl.mapping=Sl),Pl},loadTextureCube:function(_l,Sl,El,Ml){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var Al=new Aa;Al.setCrossOrigin(this.crossOrigin);var Pl=Al.load(_l,El,void 0,Ml);return Sl&&(Pl.mapping=Sl),Pl},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};G.WebGLRenderTargetCube=X,G.WebGLRenderTarget=W,G.WebGLRenderer=rr,G.ShaderLib=Hs,G.UniformsLib=Us,G.UniformsUtils=Bs,G.ShaderChunk=Fs,G.FogExp2=ar,G.Fog=or,G.Scene=ir,G.LensFlare=nr,G.Sprite=dr,G.LOD=pr,G.SkinnedMesh=mr,G.Skeleton=cr,G.Bone=ur,G.Mesh=Et,G.LineSegments=hr,G.Line=gr,G.Points=xr,G.Group=Tr,G.VideoTexture=br,G.DataTexture=Oe,G.CompressedTexture=vr,G.CubeTexture=Q,G.CanvasTexture=_r,G.DepthTexture=Sr,G.Texture=O,G.CompressedTextureLoader=Sa,G.BinaryTextureLoader=Ea,G.DataTextureLoader=Ea,G.CubeTextureLoader=Aa,G.TextureLoader=Pa,G.ObjectLoader=ao,G.MaterialLoader=Ja,G.BufferGeometryLoader=$a,G.DefaultLoadingManager=qs,G.LoadingManager=va,G.JSONLoader=ro,G.ImageLoader=Ma,G.FontLoader=yo,G.FileLoader=_a,G.Loader=eo,G.Cache=Ys,G.AudioLoader=xo,G.SpotLightShadow=Ca,G.SpotLight=Ia,G.PointLight=Da,G.RectAreaLight=To,G.HemisphereLight=wa,G.DirectionalLightShadow=Ga,G.DirectionalLight=Ba,G.AmbientLight=Fa,G.LightShadow=Ra,G.Light=La,G.StereoCamera=bo,G.PerspectiveCamera=Lt,G.OrthographicCamera=wt,G.CubeCamera=vo,G.Camera=Pt,G.AudioListener=_o,G.PositionalAudio=Eo,G.AudioContext=el,G.AudioAnalyser=Mo,G.Audio=So,G.VectorKeyframeTrack=Va,G.StringKeyframeTrack=ja,G.QuaternionKeyframeTrack=Wa,G.NumberKeyframeTrack=Xa,G.ColorKeyframeTrack=Za,G.BooleanKeyframeTrack=Ya,G.PropertyMixer=Ao,G.PropertyBinding=Po,G.KeyframeTrack=Ka,G.AnimationUtils=Zs,G.AnimationObjectGroup=Lo,G.AnimationMixer=Ro,G.AnimationClip=Qa,G.Uniform=Co,G.InstancedBufferGeometry=Io,G.BufferGeometry=St,G.GeometryIdCount=_t,G.Geometry=vt,G.InterleavedBufferAttribute=Do,G.InstancedInterleavedBuffer=Bo,G.InterleavedBuffer=Go,G.InstancedBufferAttribute=Fo,G.Face3=nt,G.Object3D=at,G.Raycaster=No,G.Layers=rt,G.EventDispatcher=F,G.Clock=zo,G.QuaternionLinearInterpolant=ka,G.LinearInterpolant=Ha,G.DiscreteInterpolant=za,G.CubicInterpolant=Ua,G.Interpolant=Na,G.Triangle=it,G.Spline=function(Sl){function El(Fl,Nl,Ul,Hl,zl,Ol,Vl){var Wl=0.5*(Ul-Fl),Xl=0.5*(Hl-Nl);return(2*(Nl-Ul)+Wl+Xl)*Vl+(-3*(Nl-Ul)-2*Wl-Xl)*Ol+Wl*zl+Nl}this.points=Sl;var Ml=[],Al={x:0,y:0,z:0},Pl,Ll,wl,Rl,Cl,Il,Dl,Gl,Bl;this.initFromArray=function(Fl){this.points=[];for(var Nl=0;Nl<Fl.length;Nl++)this.points[Nl]={x:Fl[Nl][0],y:Fl[Nl][1],z:Fl[Nl][2]}},this.getPoint=function(Fl){return Pl=(this.points.length-1)*Fl,Ll=Math.floor(Pl),wl=Pl-Ll,Ml[0]=0===Ll?Ll:Ll-1,Ml[1]=Ll,Ml[2]=Ll>this.points.length-2?this.points.length-1:Ll+1,Ml[3]=Ll>this.points.length-3?this.points.length-1:Ll+2,Il=this.points[Ml[0]],Dl=this.points[Ml[1]],Gl=this.points[Ml[2]],Bl=this.points[Ml[3]],Rl=wl*wl,Cl=wl*Rl,Al.x=El(Il.x,Dl.x,Gl.x,Bl.x,wl,Rl,Cl),Al.y=El(Il.y,Dl.y,Gl.y,Bl.y,wl,Rl,Cl),Al.z=El(Il.z,Dl.z,Gl.z,Bl.z,wl,Rl,Cl),Al},this.getControlPointsArray=function(){var Ul=this.points.length,Hl=[],Fl,Nl;for(Fl=0;Fl<Ul;Fl++)Nl=this.points[Fl],Hl[Fl]=[Nl.x,Nl.y,Nl.z];return Hl},this.getLength=function(Fl){var Ol=0,Vl=0,Wl=0,Xl=new Z,Yl=new Z,ql=[],Zl=0,Nl,Ul,Hl,zl;for(ql[0]=0,Fl||(Fl=100),Hl=this.points.length*Fl,Xl.copy(this.points[0]),Nl=1;Nl<Hl;Nl++)Ul=Nl/Hl,zl=this.getPoint(Ul),Yl.copy(zl),Zl+=Yl.distanceTo(Xl),Xl.copy(zl),Ol=(this.points.length-1)*Ul,Vl=Math.floor(Ol),Vl!=Wl&&(ql[Vl]=Zl,Wl=Vl);return ql[ql.length]=Zl,{chunks:ql,total:Zl}},this.reparametrizeByArcLength=function(Fl){var Yl=[],ql=new Z,Zl=this.getLength(),Nl,Ul,Hl,zl,Ol,Vl,Wl,Xl;for(Yl.push(ql.copy(this.points[0]).clone()),Nl=1;Nl<this.points.length;Nl++){for(Vl=Zl.chunks[Nl]-Zl.chunks[Nl-1],Wl=Math.ceil(Fl*Vl/Zl.total),zl=(Nl-1)/(this.points.length-1),Ol=Nl/(this.points.length-1),Ul=1;Ul<Wl-1;Ul++)Hl=zl+Ul*(1/Wl)*(Ol-zl),Xl=this.getPoint(Hl),Yl.push(ql.copy(Xl).clone());Yl.push(ql.copy(this.points[Nl]).clone())}this.points=Yl}},G.Math=Ls,G.Spherical=Oo,G.Cylindrical=Vo,G.Plane=Qe,G.Frustum=Je,G.Sphere=Ze,G.Ray=et,G.Matrix4=K,G.Matrix3=Ke,G.Box3=qe,G.Box2=Ve,G.Line3=ot,G.Euler=tt,G.Vector4=V,G.Vector3=Z,G.Vector2=H,G.Quaternion=Y,G.Color=ze,G.MorphBlendMesh=ko,G.ImmediateRenderObject=Wo,G.VertexNormalsHelper=Xo,G.SpotLightHelper=jo,G.SkeletonHelper=Yo,G.PointLightHelper=qo,G.RectAreaLightHelper=Zo,G.HemisphereLightHelper=Ko,G.GridHelper=Qo,G.PolarGridHelper=Jo,G.FaceNormalsHelper=$o,G.DirectionalLightHelper=ei,G.CameraHelper=ti,G.BoxHelper=ri,G.ArrowHelper=ai,G.AxisHelper=oi,G.CatmullRomCurve3=dl,G.SplineCurve3=cl,G.CubicBezierCurve3=ul,G.QuadraticBezierCurve3=yl,G.LineCurve3=xl,G.ArcCurve=ni,G.EllipseCurve=so,G.SplineCurve=lo,G.CubicBezierCurve=po,G.QuadraticBezierCurve=co,G.LineCurve=io,G.Shape=uo,G.ShapePath=fo,G.Path=mo,G.Font=go,G.CurvePath=no,G.Curve=oo,G.ShapeUtils=Ws,G.SceneUtils={createMultiMaterialObject:function(_l,Sl){var El=new Tr;for(var Ml=0,Al=Sl.length;Ml<Al;Ml++)El.add(new Et(_l,Sl[Ml]));return El},detach:function(_l,Sl,El){_l.applyMatrix(Sl.matrixWorld),Sl.remove(_l),El.add(_l)},attach:function(_l,Sl,El){var Ml=new K;Ml.getInverse(El.matrixWorld),_l.applyMatrix(Ml),Sl.remove(_l),El.add(_l)}},G.CurveUtils=Qs,G.WireframeGeometry=Er,G.ParametricGeometry=Ar,G.ParametricBufferGeometry=Mr,G.TetrahedronGeometry=wr,G.TetrahedronBufferGeometry=Lr,G.OctahedronGeometry=Cr,G.OctahedronBufferGeometry=Rr,G.IcosahedronGeometry=Dr,G.IcosahedronBufferGeometry=Ir,G.DodecahedronGeometry=Br,G.DodecahedronBufferGeometry=Gr,G.PolyhedronGeometry=Fr,G.PolyhedronBufferGeometry=Pr,G.TubeGeometry=Ur,G.TubeBufferGeometry=Nr,G.TorusKnotGeometry=zr,G.TorusKnotBufferGeometry=Hr,G.TorusGeometry=Vr,G.TorusBufferGeometry=Or,G.TextGeometry=Wr,G.SphereBufferGeometry=Xr,G.SphereGeometry=jr,G.RingGeometry=qr,G.RingBufferGeometry=Yr,G.PlaneBufferGeometry=At,G.PlaneGeometry=Zr,G.LatheGeometry=Qr,G.LatheBufferGeometry=Kr,G.ShapeGeometry=$r,G.ShapeBufferGeometry=Jr,G.ExtrudeGeometry=kr,G.EdgesGeometry=ea,G.ConeGeometry=oa,G.ConeBufferGeometry=ia,G.CylinderGeometry=ra,G.CylinderBufferGeometry=ta,G.CircleBufferGeometry=na,G.CircleGeometry=sa,G.BoxBufferGeometry=Mt,G.BoxGeometry=la,G.ShadowMaterial=da,G.SpriteMaterial=sr,G.RawShaderMaterial=ca,G.ShaderMaterial=je,G.PointsMaterial=yr,G.MultiMaterial=ma,G.MeshPhysicalMaterial=ga,G.MeshStandardMaterial=fa,G.MeshPhongMaterial=ha,G.MeshToonMaterial=ya,G.MeshNormalMaterial=xa,G.MeshLambertMaterial=Ta,G.MeshDepthMaterial=Ye,G.MeshBasicMaterial=st,G.LineDashedMaterial=ba,G.LineBasicMaterial=fr,G.Material=Xe,G.Float64BufferAttribute=xt,G.Float32BufferAttribute=yt,G.Uint32BufferAttribute=ht,G.Int32BufferAttribute=gt,G.Uint16BufferAttribute=ft,G.Int16BufferAttribute=mt,G.Uint8ClampedBufferAttribute=ut,G.Uint8BufferAttribute=ct,G.Int8BufferAttribute=dt,G.BufferAttribute=lt,G.REVISION=li,G.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},G.CullFaceNone=di,G.CullFaceBack=pi,G.CullFaceFront=ci,G.CullFaceFrontBack=3,G.FrontFaceDirectionCW=ui,G.FrontFaceDirectionCCW=1,G.BasicShadowMap=0,G.PCFShadowMap=mi,G.PCFSoftShadowMap=gi,G.FrontSide=hi,G.BackSide=yi,G.DoubleSide=xi,G.FlatShading=Ti,G.SmoothShading=bi,G.NoColors=vi,G.FaceColors=_i,G.VertexColors=Si,G.NoBlending=Ei,G.NormalBlending=Mi,G.AdditiveBlending=Ai,G.SubtractiveBlending=Pi,G.MultiplyBlending=Li,G.CustomBlending=wi,G.BlendingMode=Ri,G.AddEquation=Ci,G.SubtractEquation=Ii,G.ReverseSubtractEquation=Di,G.MinEquation=Gi,G.MaxEquation=Bi,G.ZeroFactor=Fi,G.OneFactor=Ni,G.SrcColorFactor=Ui,G.OneMinusSrcColorFactor=Hi,G.SrcAlphaFactor=zi,G.OneMinusSrcAlphaFactor=Oi,G.DstAlphaFactor=Vi,G.OneMinusDstAlphaFactor=ki,G.DstColorFactor=Wi,G.OneMinusDstColorFactor=Xi,G.SrcAlphaSaturateFactor=ji,G.NeverDepth=Yi,G.AlwaysDepth=qi,G.LessDepth=Zi,G.LessEqualDepth=Ki,G.EqualDepth=Qi,G.GreaterEqualDepth=Ji,G.GreaterDepth=$i,G.NotEqualDepth=en,G.MultiplyOperation=tn,G.MixOperation=rn,G.AddOperation=an,G.NoToneMapping=on,G.LinearToneMapping=nn,G.ReinhardToneMapping=sn,G.Uncharted2ToneMapping=ln,G.CineonToneMapping=dn,G.UVMapping=pn,G.CubeReflectionMapping=cn,G.CubeRefractionMapping=un,G.EquirectangularReflectionMapping=mn,G.EquirectangularRefractionMapping=gn,G.SphericalReflectionMapping=hn,G.CubeUVReflectionMapping=yn,G.CubeUVRefractionMapping=xn,G.TextureMapping=Tn,G.RepeatWrapping=bn,G.ClampToEdgeWrapping=vn,G.MirroredRepeatWrapping=_n,G.TextureWrapping=Sn,G.NearestFilter=En,G.NearestMipMapNearestFilter=Mn,G.NearestMipMapLinearFilter=An,G.LinearFilter=Pn,G.LinearMipMapNearestFilter=Ln,G.LinearMipMapLinearFilter=wn,G.TextureFilter=Rn,G.UnsignedByteType=Cn,G.ByteType=In,G.ShortType=Dn,G.UnsignedShortType=Gn,G.IntType=Bn,G.UnsignedIntType=Fn,G.FloatType=Nn,G.HalfFloatType=Un,G.UnsignedShort4444Type=Hn,G.UnsignedShort5551Type=zn,G.UnsignedShort565Type=On,G.UnsignedInt248Type=Vn,G.AlphaFormat=kn,G.RGBFormat=Wn,G.RGBAFormat=Xn,G.LuminanceFormat=jn,G.LuminanceAlphaFormat=Yn,G.RGBEFormat=Xn,G.DepthFormat=qn,G.DepthStencilFormat=Zn,G.RGB_S3TC_DXT1_Format=Kn,G.RGBA_S3TC_DXT1_Format=Qn,G.RGBA_S3TC_DXT3_Format=Jn,G.RGBA_S3TC_DXT5_Format=$n,G.RGB_PVRTC_4BPPV1_Format=es,G.RGB_PVRTC_2BPPV1_Format=ts,G.RGBA_PVRTC_4BPPV1_Format=rs,G.RGBA_PVRTC_2BPPV1_Format=as,G.RGB_ETC1_Format=os,G.LoopOnce=is,G.LoopRepeat=ns,G.LoopPingPong=ss,G.InterpolateDiscrete=ls,G.InterpolateLinear=ds,G.InterpolateSmooth=ps,G.ZeroCurvatureEnding=us,G.ZeroSlopeEnding=ms,G.WrapAroundEnding=fs,G.TrianglesDrawMode=gs,G.TriangleStripDrawMode=hs,G.TriangleFanDrawMode=ys,G.LinearEncoding=xs,G.sRGBEncoding=Ts,G.GammaEncoding=vs,G.RGBEEncoding=_s,G.LogLuvEncoding=3003,G.RGBM7Encoding=Ss,G.RGBM16Encoding=Es,G.RGBDEncoding=Ms,G.BasicDepthPacking=As,G.RGBADepthPacking=Ps,G.CubeGeometry=la,G.Face4=function(Sl,El,Ml,Al,Pl,Ll,wl){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new nt(Sl,El,Ml,Pl,Ll,wl)},G.LineStrip=0,G.LinePieces=1,G.MeshFaceMaterial=function(Sl){return console.warn("THREE.MeshFaceMaterial has been renamed to THREE.MultiMaterial."),new ma(Sl)},G.PointCloud=function(Sl,El){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new xr(Sl,El)},G.Particle=function(Sl){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new dr(Sl)},G.ParticleSystem=function(Sl,El){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new xr(Sl,El)},G.PointCloudMaterial=function(Sl){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new yr(Sl)},G.ParticleBasicMaterial=function(Sl){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new yr(Sl)},G.ParticleSystemMaterial=function(Sl){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new yr(Sl)},G.Vertex=function(Sl,El,Ml){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Z(Sl,El,Ml)},G.DynamicBufferAttribute=function(Sl,El){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new lt(Sl,El).setDynamic(!0)},G.Int8Attribute=function(Sl,El){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new dt(Sl,El)},G.Uint8Attribute=function(Sl,El){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new ct(Sl,El)},G.Uint8ClampedAttribute=function(Sl,El){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ut(Sl,El)},G.Int16Attribute=function(Sl,El){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new mt(Sl,El)},G.Uint16Attribute=function(Sl,El){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new ft(Sl,El)},G.Int32Attribute=function(Sl,El){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new gt(Sl,El)},G.Uint32Attribute=function(Sl,El){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new ht(Sl,El)},G.Float32Attribute=function(Sl,El){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new yt(Sl,El)},G.Float64Attribute=function(Sl,El){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new xt(Sl,El)},G.ClosedSplineCurve3=si,G.BoundingBoxHelper=function(Sl,El){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new ri(Sl,El)},G.EdgesHelper=function(Sl,El){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new hr(new ea(Sl.geometry),new fr({color:void 0===El?16777215:El}))},G.WireframeHelper=function(Sl,El){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new hr(new Er(Sl.geometry),new fr({color:void 0===El?16777215:El}))},G.XHRLoader=function(Sl){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new _a(Sl)},G.GeometryUtils={merge:function(_l,Sl,El){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var Ml;Sl.isMesh&&(Sl.matrixAutoUpdate&&Sl.updateMatrix(),Ml=Sl.matrix,Sl=Sl.geometry),_l.merge(Sl,Ml,El)},center:function(_l){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),_l.center()}},G.ImageUtils=Tl,G.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(Sl,El){console.warn("THREE.Projector: .projectVector() is now vector.project()."),Sl.project(El)},this.unprojectVector=function(Sl,El){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),Sl.unproject(El)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},G.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(G,"__esModule",{value:!0})})}(),E.registerDynamic("4",[],!1,function(C,G,F){var H=E.get("@@global-helpers").prepareGlobal(F.id,null,null);return function(){(function(O){"use strict";function V(Te){if("string"!=typeof Te&&(Te=Te+""),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(Te))throw new TypeError("Invalid character in header field name");return Te.toLowerCase()}function W(Te){return"string"!=typeof Te&&(Te=Te+""),Te}// Build a destructive iterator for the value list
function X(Te){var ve={next:function(){var Se=Te.shift();return{done:void 0===Se,value:Se}}};return ue.iterable&&(ve[Symbol.iterator]=function(){return ve}),ve}function Y(Te){this.map={},Te instanceof Y?Te.forEach(function(ve,Se){this.append(Se,ve)},this):Te&&Object.getOwnPropertyNames(Te).forEach(function(ve){this.append(ve,Te[ve])},this)}function Z(Te){return Te.bodyUsed?Promise.reject(new TypeError("Already read")):void(Te.bodyUsed=!0)}function K(Te){return new Promise(function(ve,Se){Te.onload=function(){ve(Te.result)},Te.onerror=function(){Se(Te.error)}})}function Q(Te){var ve=new FileReader,Se=K(ve);return ve.readAsArrayBuffer(Te),Se}function J(Te){var ve=new FileReader,Se=K(ve);return ve.readAsText(Te),Se}function $(Te){var ve=new Uint8Array(Te),Se=Array(ve.length);for(var Ee=0;Ee<ve.length;Ee++)Se[Ee]=String.fromCharCode(ve[Ee]);return Se.join("")}function ee(Te){if(Te.slice)return Te.slice(0);var ve=new Uint8Array(Te.byteLength);return ve.set(new Uint8Array(Te)),ve.buffer}function oe(){return this.bodyUsed=!1,this._initBody=function(Te){if(this._bodyInit=Te,!Te)this._bodyText="";else if("string"==typeof Te)this._bodyText=Te;else if(ue.blob&&Blob.prototype.isPrototypeOf(Te))this._bodyBlob=Te;else if(ue.formData&&FormData.prototype.isPrototypeOf(Te))this._bodyFormData=Te;else if(ue.searchParams&&URLSearchParams.prototype.isPrototypeOf(Te))this._bodyText=Te.toString();else if(ue.arrayBuffer&&ue.blob&&ge(Te))this._bodyArrayBuffer=ee(Te.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(ue.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(Te)||he(Te)))this._bodyArrayBuffer=ee(Te);else throw new Error("unsupported BodyInit type");this.headers.get("content-type")||("string"==typeof Te?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):ue.searchParams&&URLSearchParams.prototype.isPrototypeOf(Te)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},ue.blob&&(this.blob=function(){var Te=Z(this);if(Te)return Te;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Z(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Q)}),this.text=function(){var Te=Z(this);if(Te)return Te;if(this._bodyBlob)return J(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve($(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");else return Promise.resolve(this._bodyText)},ue.formData&&(this.formData=function(){return this.text().then(se)}),this.json=function(){return this.text().then(JSON.parse)},this}// HTTP methods whose capitalization should be normalized
function ie(Te){var ve=Te.toUpperCase();return-1<ye.indexOf(ve)?ve:Te}function ne(Te,ve){ve=ve||{};var Se=ve.body;if("string"==typeof Te)this.url=Te;else{if(Te.bodyUsed)throw new TypeError("Already read");this.url=Te.url,this.credentials=Te.credentials,ve.headers||(this.headers=new Y(Te.headers)),this.method=Te.method,this.mode=Te.mode,Se||null==Te._bodyInit||(Se=Te._bodyInit,Te.bodyUsed=!0)}if(this.credentials=ve.credentials||this.credentials||"omit",(ve.headers||!this.headers)&&(this.headers=new Y(ve.headers)),this.method=ie(ve.method||this.method||"GET"),this.mode=ve.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&Se)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Se)}function se(Te){var ve=new FormData;return Te.trim().split("&").forEach(function(Se){if(Se){var Ee=Se.split("="),Me=Ee.shift().replace(/\+/g," "),Ae=Ee.join("=").replace(/\+/g," ");ve.append(decodeURIComponent(Me),decodeURIComponent(Ae))}}),ve}function le(Te){var ve=new Y;return Te.split("\r\n").forEach(function(Se){var Ee=Se.split(":"),Me=Ee.shift().trim();if(Me){var Ae=Ee.join(":").trim();ve.append(Me,Ae)}}),ve}function pe(Te,ve){ve||(ve={}),this.type="default",this.status="status"in ve?ve.status:200,this.ok=200<=this.status&&300>this.status,this.statusText="statusText"in ve?ve.statusText:"OK",this.headers=new Y(ve.headers),this.url=ve.url||"",this._initBody(Te)}if(!O.fetch){var ue={searchParams:"URLSearchParams"in O,iterable:"Symbol"in O&&"iterator"in Symbol,blob:"FileReader"in O&&"Blob"in O&&function(){try{return new Blob,!0}catch(Te){return!1}}(),formData:"FormData"in O,arrayBuffer:"ArrayBuffer"in O};if(ue.arrayBuffer)var fe=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],ge=function(Te){return Te&&DataView.prototype.isPrototypeOf(Te)},he=ArrayBuffer.isView||function(Te){return Te&&-1<fe.indexOf(Object.prototype.toString.call(Te))};Y.prototype.append=function(Te,ve){Te=V(Te),ve=W(ve);var Se=this.map[Te];Se||(Se=[],this.map[Te]=Se),Se.push(ve)},Y.prototype["delete"]=function(Te){delete this.map[V(Te)]},Y.prototype.get=function(Te){var ve=this.map[V(Te)];return ve?ve[0]:null},Y.prototype.getAll=function(Te){return this.map[V(Te)]||[]},Y.prototype.has=function(Te){return this.map.hasOwnProperty(V(Te))},Y.prototype.set=function(Te,ve){this.map[V(Te)]=[W(ve)]},Y.prototype.forEach=function(Te,ve){Object.getOwnPropertyNames(this.map).forEach(function(Se){this.map[Se].forEach(function(Ee){Te.call(ve,Ee,Se,this)},this)},this)},Y.prototype.keys=function(){var Te=[];return this.forEach(function(ve,Se){Te.push(Se)}),X(Te)},Y.prototype.values=function(){var Te=[];return this.forEach(function(ve){Te.push(ve)}),X(Te)},Y.prototype.entries=function(){var Te=[];return this.forEach(function(ve,Se){Te.push([Se,ve])}),X(Te)},ue.iterable&&(Y.prototype[Symbol.iterator]=Y.prototype.entries);var ye=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];ne.prototype.clone=function(){return new ne(this,{body:this._bodyInit})},oe.call(ne.prototype),oe.call(pe.prototype),pe.prototype.clone=function(){return new pe(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Y(this.headers),url:this.url})},pe.error=function(){var Te=new pe(null,{status:0,statusText:""});return Te.type="error",Te};var xe=[301,302,303,307,308];pe.redirect=function(Te,ve){if(-1===xe.indexOf(ve))throw new RangeError("Invalid status code");return new pe(null,{status:ve,headers:{location:Te}})},O.Headers=Y,O.Request=ne,O.Response=pe,O.fetch=function(Te,ve){return new Promise(function(Se,Ee){var Me=new ne(Te,ve),Ae=new XMLHttpRequest;Ae.onload=function(){var Pe={status:Ae.status,statusText:Ae.statusText,headers:le(Ae.getAllResponseHeaders()||"")};Pe.url="responseURL"in Ae?Ae.responseURL:Pe.headers.get("X-Request-URL");var Le="response"in Ae?Ae.response:Ae.responseText;Se(new pe(Le,Pe))},Ae.onerror=function(){Ee(new TypeError("Network request failed"))},Ae.ontimeout=function(){Ee(new TypeError("Network request failed"))},Ae.open(Me.method,Me.url,!0),"include"===Me.credentials&&(Ae.withCredentials=!0),"responseType"in Ae&&ue.blob&&(Ae.responseType="blob"),Me.headers.forEach(function(Pe,Le){Ae.setRequestHeader(Le,Pe)}),Ae.send("undefined"==typeof Me._bodyInit?null:Me._bodyInit)})},O.fetch.polyfill=!0}})("undefined"==typeof self?this:self)}(this),H()}),E.registerDynamic("5",["6"],!0,function(C,G,F){var H=this||self,O=C("6"),V={};/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE. *//**
     * @class 2x2 Matrix
     * @name mat2
     *//**
     * Creates a new identity mat2
     *
     * @returns {mat2} a new 2x2 matrix
     */return V.create=function(){var W=new O.ARRAY_TYPE(4);return W[0]=1,W[1]=0,W[2]=0,W[3]=1,W},V.clone=function(W){var X=new O.ARRAY_TYPE(4);return X[0]=W[0],X[1]=W[1],X[2]=W[2],X[3]=W[3],X},V.copy=function(W,X){return W[0]=X[0],W[1]=X[1],W[2]=X[2],W[3]=X[3],W},V.identity=function(W){return W[0]=1,W[1]=0,W[2]=0,W[3]=1,W},V.fromValues=function(W,X,Y,Z){var K=new O.ARRAY_TYPE(4);return K[0]=W,K[1]=X,K[2]=Y,K[3]=Z,K},V.set=function(W,X,Y,Z,K){return W[0]=X,W[1]=Y,W[2]=Z,W[3]=K,W},V.transpose=function(W,X){// If we are transposing ourselves we can skip a few steps but have to cache some values
if(W===X){var Y=X[1];W[1]=X[2],W[2]=Y}else W[0]=X[0],W[1]=X[2],W[2]=X[1],W[3]=X[3];return W},V.invert=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],// Calculate the determinant
J=Y*Q-K*Z;return J?(J=1/J,W[0]=Q*J,W[1]=-Z*J,W[2]=-K*J,W[3]=Y*J,W):null},V.adjoint=function(W,X){// Caching this value is nessecary if out == a
var Y=X[0];return W[0]=X[3],W[1]=-X[1],W[2]=-X[2],W[3]=Y,W},V.determinant=function(W){return W[0]*W[3]-W[2]*W[1]},V.multiply=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=Y[0],ee=Y[1],oe=Y[2],ie=Y[3];return W[0]=Z*$+Q*ee,W[1]=K*$+J*ee,W[2]=Z*oe+Q*ie,W[3]=K*oe+J*ie,W},V.mul=V.multiply,V.rotate=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=Math.sin(Y),ee=Math.cos(Y);return W[0]=Z*ee+Q*$,W[1]=K*ee+J*$,W[2]=Z*-$+Q*ee,W[3]=K*-$+J*ee,W},V.scale=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=Y[0],ee=Y[1];return W[0]=Z*$,W[1]=K*$,W[2]=Q*ee,W[3]=J*ee,W},V.fromRotation=function(W,X){var Y=Math.sin(X),Z=Math.cos(X);return W[0]=Z,W[1]=Y,W[2]=-Y,W[3]=Z,W},V.fromScaling=function(W,X){return W[0]=X[0],W[1]=0,W[2]=0,W[3]=X[1],W},V.str=function(W){return"mat2("+W[0]+", "+W[1]+", "+W[2]+", "+W[3]+")"},V.frob=function(W){return Math.sqrt(Math.pow(W[0],2)+Math.pow(W[1],2)+Math.pow(W[2],2)+Math.pow(W[3],2))},V.LDU=function(W,X,Y,Z){return W[2]=Z[2]/Z[0],Y[0]=Z[0],Y[1]=Z[1],Y[3]=Z[3]-W[2]*Y[1],[W,X,Y]},V.add=function(W,X,Y){return W[0]=X[0]+Y[0],W[1]=X[1]+Y[1],W[2]=X[2]+Y[2],W[3]=X[3]+Y[3],W},V.subtract=function(W,X,Y){return W[0]=X[0]-Y[0],W[1]=X[1]-Y[1],W[2]=X[2]-Y[2],W[3]=X[3]-Y[3],W},V.sub=V.subtract,V.exactEquals=function(W,X){return W[0]===X[0]&&W[1]===X[1]&&W[2]===X[2]&&W[3]===X[3]},V.equals=function(W,X){var Y=W[0],Z=W[1],K=W[2],Q=W[3],J=X[0],$=X[1],ee=X[2],oe=X[3];return Math.abs(Y-J)<=O.EPSILON*Math.max(1,Math.abs(Y),Math.abs(J))&&Math.abs(Z-$)<=O.EPSILON*Math.max(1,Math.abs(Z),Math.abs($))&&Math.abs(K-ee)<=O.EPSILON*Math.max(1,Math.abs(K),Math.abs(ee))&&Math.abs(Q-oe)<=O.EPSILON*Math.max(1,Math.abs(Q),Math.abs(oe))},V.multiplyScalar=function(W,X,Y){return W[0]=X[0]*Y,W[1]=X[1]*Y,W[2]=X[2]*Y,W[3]=X[3]*Y,W},V.multiplyScalarAndAdd=function(W,X,Y,Z){return W[0]=X[0]+Y[0]*Z,W[1]=X[1]+Y[1]*Z,W[2]=X[2]+Y[2]*Z,W[3]=X[3]+Y[3]*Z,W},F.exports=V,F.exports}),E.registerDynamic("7",["6"],!0,function(C,G,F){var H=this||self,O=C("6"),V={};/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE. *//**
     * @class 2x3 Matrix
     * @name mat2d
     * 
     * @description 
     * A mat2d contains six elements defined as:
     * <pre>
     * [a, c, tx,
     *  b, d, ty]
     * </pre>
     * This is a short form for the 3x3 matrix:
     * <pre>
     * [a, c, tx,
     *  b, d, ty,
     *  0, 0, 1]
     * </pre>
     * The last row is ignored so the array is shorter and operations are faster.
     *//**
     * Creates a new identity mat2d
     *
     * @returns {mat2d} a new 2x3 matrix
     */return V.create=function(){var W=new O.ARRAY_TYPE(6);return W[0]=1,W[1]=0,W[2]=0,W[3]=1,W[4]=0,W[5]=0,W},V.clone=function(W){var X=new O.ARRAY_TYPE(6);return X[0]=W[0],X[1]=W[1],X[2]=W[2],X[3]=W[3],X[4]=W[4],X[5]=W[5],X},V.copy=function(W,X){return W[0]=X[0],W[1]=X[1],W[2]=X[2],W[3]=X[3],W[4]=X[4],W[5]=X[5],W},V.identity=function(W){return W[0]=1,W[1]=0,W[2]=0,W[3]=1,W[4]=0,W[5]=0,W},V.fromValues=function(W,X,Y,Z,K,Q){var J=new O.ARRAY_TYPE(6);return J[0]=W,J[1]=X,J[2]=Y,J[3]=Z,J[4]=K,J[5]=Q,J},V.set=function(W,X,Y,Z,K,Q,J){return W[0]=X,W[1]=Y,W[2]=Z,W[3]=K,W[4]=Q,W[5]=J,W},V.invert=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],J=X[4],$=X[5],ee=Y*Q-Z*K;return ee?(ee=1/ee,W[0]=Q*ee,W[1]=-Z*ee,W[2]=-K*ee,W[3]=Y*ee,W[4]=(K*$-Q*J)*ee,W[5]=(Z*J-Y*$)*ee,W):null},V.determinant=function(W){return W[0]*W[3]-W[1]*W[2]},V.multiply=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=X[4],ee=X[5],oe=Y[0],ie=Y[1],ne=Y[2],se=Y[3],le=Y[4],pe=Y[5];return W[0]=Z*oe+Q*ie,W[1]=K*oe+J*ie,W[2]=Z*ne+Q*se,W[3]=K*ne+J*se,W[4]=Z*le+Q*pe+$,W[5]=K*le+J*pe+ee,W},V.mul=V.multiply,V.rotate=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=X[4],ee=X[5],oe=Math.sin(Y),ie=Math.cos(Y);return W[0]=Z*ie+Q*oe,W[1]=K*ie+J*oe,W[2]=Z*-oe+Q*ie,W[3]=K*-oe+J*ie,W[4]=$,W[5]=ee,W},V.scale=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=X[4],ee=X[5],oe=Y[0],ie=Y[1];return W[0]=Z*oe,W[1]=K*oe,W[2]=Q*ie,W[3]=J*ie,W[4]=$,W[5]=ee,W},V.translate=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=X[4],ee=X[5],oe=Y[0],ie=Y[1];return W[0]=Z,W[1]=K,W[2]=Q,W[3]=J,W[4]=Z*oe+Q*ie+$,W[5]=K*oe+J*ie+ee,W},V.fromRotation=function(W,X){var Y=Math.sin(X),Z=Math.cos(X);return W[0]=Z,W[1]=Y,W[2]=-Y,W[3]=Z,W[4]=0,W[5]=0,W},V.fromScaling=function(W,X){return W[0]=X[0],W[1]=0,W[2]=0,W[3]=X[1],W[4]=0,W[5]=0,W},V.fromTranslation=function(W,X){return W[0]=1,W[1]=0,W[2]=0,W[3]=1,W[4]=X[0],W[5]=X[1],W},V.str=function(W){return"mat2d("+W[0]+", "+W[1]+", "+W[2]+", "+W[3]+", "+W[4]+", "+W[5]+")"},V.frob=function(W){return Math.sqrt(Math.pow(W[0],2)+Math.pow(W[1],2)+Math.pow(W[2],2)+Math.pow(W[3],2)+Math.pow(W[4],2)+Math.pow(W[5],2)+1)},V.add=function(W,X,Y){return W[0]=X[0]+Y[0],W[1]=X[1]+Y[1],W[2]=X[2]+Y[2],W[3]=X[3]+Y[3],W[4]=X[4]+Y[4],W[5]=X[5]+Y[5],W},V.subtract=function(W,X,Y){return W[0]=X[0]-Y[0],W[1]=X[1]-Y[1],W[2]=X[2]-Y[2],W[3]=X[3]-Y[3],W[4]=X[4]-Y[4],W[5]=X[5]-Y[5],W},V.sub=V.subtract,V.multiplyScalar=function(W,X,Y){return W[0]=X[0]*Y,W[1]=X[1]*Y,W[2]=X[2]*Y,W[3]=X[3]*Y,W[4]=X[4]*Y,W[5]=X[5]*Y,W},V.multiplyScalarAndAdd=function(W,X,Y,Z){return W[0]=X[0]+Y[0]*Z,W[1]=X[1]+Y[1]*Z,W[2]=X[2]+Y[2]*Z,W[3]=X[3]+Y[3]*Z,W[4]=X[4]+Y[4]*Z,W[5]=X[5]+Y[5]*Z,W},V.exactEquals=function(W,X){return W[0]===X[0]&&W[1]===X[1]&&W[2]===X[2]&&W[3]===X[3]&&W[4]===X[4]&&W[5]===X[5]},V.equals=function(W,X){var Y=W[0],Z=W[1],K=W[2],Q=W[3],J=W[4],$=W[5],ee=X[0],oe=X[1],ie=X[2],ne=X[3],se=X[4],le=X[5];return Math.abs(Y-ee)<=O.EPSILON*Math.max(1,Math.abs(Y),Math.abs(ee))&&Math.abs(Z-oe)<=O.EPSILON*Math.max(1,Math.abs(Z),Math.abs(oe))&&Math.abs(K-ie)<=O.EPSILON*Math.max(1,Math.abs(K),Math.abs(ie))&&Math.abs(Q-ne)<=O.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ne))&&Math.abs(J-se)<=O.EPSILON*Math.max(1,Math.abs(J),Math.abs(se))&&Math.abs($-le)<=O.EPSILON*Math.max(1,Math.abs($),Math.abs(le))},F.exports=V,F.exports}),E.registerDynamic("8",["6"],!0,function(C,G,F){var H=this||self,O=C("6"),V={scalar:{},SIMD:{}};/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE. *//**
     * @class 4x4 Matrix
     * @name mat4
     *//**
     * Creates a new identity mat4
     *
     * @returns {mat4} a new 4x4 matrix
     */return V.create=function(){var W=new O.ARRAY_TYPE(16);return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=1,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=1,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},V.clone=function(W){var X=new O.ARRAY_TYPE(16);return X[0]=W[0],X[1]=W[1],X[2]=W[2],X[3]=W[3],X[4]=W[4],X[5]=W[5],X[6]=W[6],X[7]=W[7],X[8]=W[8],X[9]=W[9],X[10]=W[10],X[11]=W[11],X[12]=W[12],X[13]=W[13],X[14]=W[14],X[15]=W[15],X},V.copy=function(W,X){return W[0]=X[0],W[1]=X[1],W[2]=X[2],W[3]=X[3],W[4]=X[4],W[5]=X[5],W[6]=X[6],W[7]=X[7],W[8]=X[8],W[9]=X[9],W[10]=X[10],W[11]=X[11],W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15],W},V.fromValues=function(W,X,Y,Z,K,Q,J,$,ee,oe,ie,ne,se,le,pe,ue){var fe=new O.ARRAY_TYPE(16);return fe[0]=W,fe[1]=X,fe[2]=Y,fe[3]=Z,fe[4]=K,fe[5]=Q,fe[6]=J,fe[7]=$,fe[8]=ee,fe[9]=oe,fe[10]=ie,fe[11]=ne,fe[12]=se,fe[13]=le,fe[14]=pe,fe[15]=ue,fe},V.set=function(W,X,Y,Z,K,Q,J,$,ee,oe,ie,ne,se,le,pe,ue,fe){return W[0]=X,W[1]=Y,W[2]=Z,W[3]=K,W[4]=Q,W[5]=J,W[6]=$,W[7]=ee,W[8]=oe,W[9]=ie,W[10]=ne,W[11]=se,W[12]=le,W[13]=pe,W[14]=ue,W[15]=fe,W},V.identity=function(W){return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=1,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=1,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},V.scalar.transpose=function(W,X){// If we are transposing ourselves we can skip a few steps but have to cache some values
if(W===X){var Y=X[1],Z=X[2],K=X[3],Q=X[6],J=X[7],$=X[11];W[1]=X[4],W[2]=X[8],W[3]=X[12],W[4]=Y,W[6]=X[9],W[7]=X[13],W[8]=Z,W[9]=Q,W[11]=X[14],W[12]=K,W[13]=J,W[14]=$}else W[0]=X[0],W[1]=X[4],W[2]=X[8],W[3]=X[12],W[4]=X[1],W[5]=X[5],W[6]=X[9],W[7]=X[13],W[8]=X[2],W[9]=X[6],W[10]=X[10],W[11]=X[14],W[12]=X[3],W[13]=X[7],W[14]=X[11],W[15]=X[15];return W},V.SIMD.transpose=function(W,X){var Y,Z,K,Q,J,$,ee,oe,ie,ne;return Y=SIMD.Float32x4.load(X,0),Z=SIMD.Float32x4.load(X,4),K=SIMD.Float32x4.load(X,8),Q=SIMD.Float32x4.load(X,12),J=SIMD.Float32x4.shuffle(Y,Z,0,1,4,5),$=SIMD.Float32x4.shuffle(K,Q,0,1,4,5),ee=SIMD.Float32x4.shuffle(J,$,0,2,4,6),oe=SIMD.Float32x4.shuffle(J,$,1,3,5,7),SIMD.Float32x4.store(W,0,ee),SIMD.Float32x4.store(W,4,oe),J=SIMD.Float32x4.shuffle(Y,Z,2,3,6,7),$=SIMD.Float32x4.shuffle(K,Q,2,3,6,7),ie=SIMD.Float32x4.shuffle(J,$,0,2,4,6),ne=SIMD.Float32x4.shuffle(J,$,1,3,5,7),SIMD.Float32x4.store(W,8,ie),SIMD.Float32x4.store(W,12,ne),W},V.transpose=O.USE_SIMD?V.SIMD.transpose:V.scalar.transpose,V.scalar.invert=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],J=X[4],$=X[5],ee=X[6],oe=X[7],ie=X[8],ne=X[9],se=X[10],le=X[11],pe=X[12],ue=X[13],fe=X[14],ge=X[15],he=Y*$-Z*J,ye=Y*ee-K*J,xe=Y*oe-Q*J,Te=Z*ee-K*$,ve=Z*oe-Q*$,Se=K*oe-Q*ee,Ee=ie*ue-ne*pe,Me=ie*fe-se*pe,Ae=ie*ge-le*pe,Pe=ne*fe-se*ue,Le=ne*ge-le*ue,we=se*ge-le*fe,// Calculate the determinant
Re=he*we-ye*Le+xe*Pe+Te*Ae-ve*Me+Se*Ee;return Re?(Re=1/Re,W[0]=($*we-ee*Le+oe*Pe)*Re,W[1]=(K*Le-Z*we-Q*Pe)*Re,W[2]=(ue*Se-fe*ve+ge*Te)*Re,W[3]=(se*ve-ne*Se-le*Te)*Re,W[4]=(ee*Ae-J*we-oe*Me)*Re,W[5]=(Y*we-K*Ae+Q*Me)*Re,W[6]=(fe*xe-pe*Se-ge*ye)*Re,W[7]=(ie*Se-se*xe+le*ye)*Re,W[8]=(J*Le-$*Ae+oe*Ee)*Re,W[9]=(Z*Ae-Y*Le-Q*Ee)*Re,W[10]=(pe*ve-ue*xe+ge*he)*Re,W[11]=(ne*xe-ie*ve-le*he)*Re,W[12]=($*Me-J*Pe-ee*Ee)*Re,W[13]=(Y*Pe-Z*Me+K*Ee)*Re,W[14]=(ue*ye-pe*Te-fe*he)*Re,W[15]=(ie*Te-ne*ye+se*he)*Re,W):null},V.SIMD.invert=function(W,X){var se=SIMD.Float32x4.load(X,0),le=SIMD.Float32x4.load(X,4),pe=SIMD.Float32x4.load(X,8),ue=SIMD.Float32x4.load(X,12),Y,Z,K,Q,J,$,ee,oe,ie,ne;// Compute matrix adjugate
return(J=SIMD.Float32x4.shuffle(se,le,0,1,4,5),Z=SIMD.Float32x4.shuffle(pe,ue,0,1,4,5),Y=SIMD.Float32x4.shuffle(J,Z,0,2,4,6),Z=SIMD.Float32x4.shuffle(Z,J,1,3,5,7),J=SIMD.Float32x4.shuffle(se,le,2,3,6,7),Q=SIMD.Float32x4.shuffle(pe,ue,2,3,6,7),K=SIMD.Float32x4.shuffle(J,Q,0,2,4,6),Q=SIMD.Float32x4.shuffle(Q,J,1,3,5,7),J=SIMD.Float32x4.mul(K,Q),J=SIMD.Float32x4.swizzle(J,1,0,3,2),$=SIMD.Float32x4.mul(Z,J),ee=SIMD.Float32x4.mul(Y,J),J=SIMD.Float32x4.swizzle(J,2,3,0,1),$=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Z,J),$),ee=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Y,J),ee),ee=SIMD.Float32x4.swizzle(ee,2,3,0,1),J=SIMD.Float32x4.mul(Z,K),J=SIMD.Float32x4.swizzle(J,1,0,3,2),$=SIMD.Float32x4.add(SIMD.Float32x4.mul(Q,J),$),ie=SIMD.Float32x4.mul(Y,J),J=SIMD.Float32x4.swizzle(J,2,3,0,1),$=SIMD.Float32x4.sub($,SIMD.Float32x4.mul(Q,J)),ie=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Y,J),ie),ie=SIMD.Float32x4.swizzle(ie,2,3,0,1),J=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Z,2,3,0,1),Q),J=SIMD.Float32x4.swizzle(J,1,0,3,2),K=SIMD.Float32x4.swizzle(K,2,3,0,1),$=SIMD.Float32x4.add(SIMD.Float32x4.mul(K,J),$),oe=SIMD.Float32x4.mul(Y,J),J=SIMD.Float32x4.swizzle(J,2,3,0,1),$=SIMD.Float32x4.sub($,SIMD.Float32x4.mul(K,J)),oe=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Y,J),oe),oe=SIMD.Float32x4.swizzle(oe,2,3,0,1),J=SIMD.Float32x4.mul(Y,Z),J=SIMD.Float32x4.swizzle(J,1,0,3,2),oe=SIMD.Float32x4.add(SIMD.Float32x4.mul(Q,J),oe),ie=SIMD.Float32x4.sub(SIMD.Float32x4.mul(K,J),ie),J=SIMD.Float32x4.swizzle(J,2,3,0,1),oe=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Q,J),oe),ie=SIMD.Float32x4.sub(ie,SIMD.Float32x4.mul(K,J)),J=SIMD.Float32x4.mul(Y,Q),J=SIMD.Float32x4.swizzle(J,1,0,3,2),ee=SIMD.Float32x4.sub(ee,SIMD.Float32x4.mul(K,J)),oe=SIMD.Float32x4.add(SIMD.Float32x4.mul(Z,J),oe),J=SIMD.Float32x4.swizzle(J,2,3,0,1),ee=SIMD.Float32x4.add(SIMD.Float32x4.mul(K,J),ee),oe=SIMD.Float32x4.sub(oe,SIMD.Float32x4.mul(Z,J)),J=SIMD.Float32x4.mul(Y,K),J=SIMD.Float32x4.swizzle(J,1,0,3,2),ee=SIMD.Float32x4.add(SIMD.Float32x4.mul(Q,J),ee),ie=SIMD.Float32x4.sub(ie,SIMD.Float32x4.mul(Z,J)),J=SIMD.Float32x4.swizzle(J,2,3,0,1),ee=SIMD.Float32x4.sub(ee,SIMD.Float32x4.mul(Q,J)),ie=SIMD.Float32x4.add(SIMD.Float32x4.mul(Z,J),ie),ne=SIMD.Float32x4.mul(Y,$),ne=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(ne,2,3,0,1),ne),ne=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(ne,1,0,3,2),ne),J=SIMD.Float32x4.reciprocalApproximation(ne),ne=SIMD.Float32x4.sub(SIMD.Float32x4.add(J,J),SIMD.Float32x4.mul(ne,SIMD.Float32x4.mul(J,J))),ne=SIMD.Float32x4.swizzle(ne,0,0,0,0),!ne)?null:(SIMD.Float32x4.store(W,0,SIMD.Float32x4.mul(ne,$)),SIMD.Float32x4.store(W,4,SIMD.Float32x4.mul(ne,ee)),SIMD.Float32x4.store(W,8,SIMD.Float32x4.mul(ne,oe)),SIMD.Float32x4.store(W,12,SIMD.Float32x4.mul(ne,ie)),W);// Compute matrix inverse
},V.invert=O.USE_SIMD?V.SIMD.invert:V.scalar.invert,V.scalar.adjoint=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],J=X[4],$=X[5],ee=X[6],oe=X[7],ie=X[8],ne=X[9],se=X[10],le=X[11],pe=X[12],ue=X[13],fe=X[14],ge=X[15];return W[0]=$*(se*ge-le*fe)-ne*(ee*ge-oe*fe)+ue*(ee*le-oe*se),W[1]=-(Z*(se*ge-le*fe)-ne*(K*ge-Q*fe)+ue*(K*le-Q*se)),W[2]=Z*(ee*ge-oe*fe)-$*(K*ge-Q*fe)+ue*(K*oe-Q*ee),W[3]=-(Z*(ee*le-oe*se)-$*(K*le-Q*se)+ne*(K*oe-Q*ee)),W[4]=-(J*(se*ge-le*fe)-ie*(ee*ge-oe*fe)+pe*(ee*le-oe*se)),W[5]=Y*(se*ge-le*fe)-ie*(K*ge-Q*fe)+pe*(K*le-Q*se),W[6]=-(Y*(ee*ge-oe*fe)-J*(K*ge-Q*fe)+pe*(K*oe-Q*ee)),W[7]=Y*(ee*le-oe*se)-J*(K*le-Q*se)+ie*(K*oe-Q*ee),W[8]=J*(ne*ge-le*ue)-ie*($*ge-oe*ue)+pe*($*le-oe*ne),W[9]=-(Y*(ne*ge-le*ue)-ie*(Z*ge-Q*ue)+pe*(Z*le-Q*ne)),W[10]=Y*($*ge-oe*ue)-J*(Z*ge-Q*ue)+pe*(Z*oe-Q*$),W[11]=-(Y*($*le-oe*ne)-J*(Z*le-Q*ne)+ie*(Z*oe-Q*$)),W[12]=-(J*(ne*fe-se*ue)-ie*($*fe-ee*ue)+pe*($*se-ee*ne)),W[13]=Y*(ne*fe-se*ue)-ie*(Z*fe-K*ue)+pe*(Z*se-K*ne),W[14]=-(Y*($*fe-ee*ue)-J*(Z*fe-K*ue)+pe*(Z*ee-K*$)),W[15]=Y*($*se-ee*ne)-J*(Z*se-K*ne)+ie*(Z*ee-K*$),W},V.SIMD.adjoint=function(W,X){var Y=SIMD.Float32x4.load(X,0),Z=SIMD.Float32x4.load(X,4),K=SIMD.Float32x4.load(X,8),Q=SIMD.Float32x4.load(X,12),Y,Z,K,Q,J,$,ee,oe,ie,ne,se,le,pe;// Transpose the source matrix.  Sort of.  Not a true transpose operation
return ie=SIMD.Float32x4.shuffle(Y,Z,0,1,4,5),$=SIMD.Float32x4.shuffle(K,Q,0,1,4,5),J=SIMD.Float32x4.shuffle(ie,$,0,2,4,6),$=SIMD.Float32x4.shuffle($,ie,1,3,5,7),ie=SIMD.Float32x4.shuffle(Y,Z,2,3,6,7),oe=SIMD.Float32x4.shuffle(K,Q,2,3,6,7),ee=SIMD.Float32x4.shuffle(ie,oe,0,2,4,6),oe=SIMD.Float32x4.shuffle(oe,ie,1,3,5,7),ie=SIMD.Float32x4.mul(ee,oe),ie=SIMD.Float32x4.swizzle(ie,1,0,3,2),ne=SIMD.Float32x4.mul($,ie),se=SIMD.Float32x4.mul(J,ie),ie=SIMD.Float32x4.swizzle(ie,2,3,0,1),ne=SIMD.Float32x4.sub(SIMD.Float32x4.mul($,ie),ne),se=SIMD.Float32x4.sub(SIMD.Float32x4.mul(J,ie),se),se=SIMD.Float32x4.swizzle(se,2,3,0,1),ie=SIMD.Float32x4.mul($,ee),ie=SIMD.Float32x4.swizzle(ie,1,0,3,2),ne=SIMD.Float32x4.add(SIMD.Float32x4.mul(oe,ie),ne),pe=SIMD.Float32x4.mul(J,ie),ie=SIMD.Float32x4.swizzle(ie,2,3,0,1),ne=SIMD.Float32x4.sub(ne,SIMD.Float32x4.mul(oe,ie)),pe=SIMD.Float32x4.sub(SIMD.Float32x4.mul(J,ie),pe),pe=SIMD.Float32x4.swizzle(pe,2,3,0,1),ie=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle($,2,3,0,1),oe),ie=SIMD.Float32x4.swizzle(ie,1,0,3,2),ee=SIMD.Float32x4.swizzle(ee,2,3,0,1),ne=SIMD.Float32x4.add(SIMD.Float32x4.mul(ee,ie),ne),le=SIMD.Float32x4.mul(J,ie),ie=SIMD.Float32x4.swizzle(ie,2,3,0,1),ne=SIMD.Float32x4.sub(ne,SIMD.Float32x4.mul(ee,ie)),le=SIMD.Float32x4.sub(SIMD.Float32x4.mul(J,ie),le),le=SIMD.Float32x4.swizzle(le,2,3,0,1),ie=SIMD.Float32x4.mul(J,$),ie=SIMD.Float32x4.swizzle(ie,1,0,3,2),le=SIMD.Float32x4.add(SIMD.Float32x4.mul(oe,ie),le),pe=SIMD.Float32x4.sub(SIMD.Float32x4.mul(ee,ie),pe),ie=SIMD.Float32x4.swizzle(ie,2,3,0,1),le=SIMD.Float32x4.sub(SIMD.Float32x4.mul(oe,ie),le),pe=SIMD.Float32x4.sub(pe,SIMD.Float32x4.mul(ee,ie)),ie=SIMD.Float32x4.mul(J,oe),ie=SIMD.Float32x4.swizzle(ie,1,0,3,2),se=SIMD.Float32x4.sub(se,SIMD.Float32x4.mul(ee,ie)),le=SIMD.Float32x4.add(SIMD.Float32x4.mul($,ie),le),ie=SIMD.Float32x4.swizzle(ie,2,3,0,1),se=SIMD.Float32x4.add(SIMD.Float32x4.mul(ee,ie),se),le=SIMD.Float32x4.sub(le,SIMD.Float32x4.mul($,ie)),ie=SIMD.Float32x4.mul(J,ee),ie=SIMD.Float32x4.swizzle(ie,1,0,3,2),se=SIMD.Float32x4.add(SIMD.Float32x4.mul(oe,ie),se),pe=SIMD.Float32x4.sub(pe,SIMD.Float32x4.mul($,ie)),ie=SIMD.Float32x4.swizzle(ie,2,3,0,1),se=SIMD.Float32x4.sub(se,SIMD.Float32x4.mul(oe,ie)),pe=SIMD.Float32x4.add(SIMD.Float32x4.mul($,ie),pe),SIMD.Float32x4.store(W,0,ne),SIMD.Float32x4.store(W,4,se),SIMD.Float32x4.store(W,8,le),SIMD.Float32x4.store(W,12,pe),W},V.adjoint=O.USE_SIMD?V.SIMD.adjoint:V.scalar.adjoint,V.determinant=function(W){var X=W[0],Y=W[1],Z=W[2],K=W[3],Q=W[4],J=W[5],$=W[6],ee=W[7],oe=W[8],ie=W[9],ne=W[10],se=W[11],le=W[12],pe=W[13],ue=W[14],fe=W[15];// Calculate the determinant
return(X*J-Y*Q)*(ne*fe-se*ue)-(X*$-Z*Q)*(ie*fe-se*pe)+(X*ee-K*Q)*(ie*ue-ne*pe)+(Y*$-Z*J)*(oe*fe-se*le)-(Y*ee-K*J)*(oe*ue-ne*le)+(Z*ee-K*$)*(oe*pe-ie*le)},V.SIMD.multiply=function(W,X,Y){var Z=SIMD.Float32x4.load(X,0),K=SIMD.Float32x4.load(X,4),Q=SIMD.Float32x4.load(X,8),J=SIMD.Float32x4.load(X,12),$=SIMD.Float32x4.load(Y,0),ee=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle($,0,0,0,0),Z),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle($,1,1,1,1),K),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle($,2,2,2,2),Q),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle($,3,3,3,3),J))));SIMD.Float32x4.store(W,0,ee);var oe=SIMD.Float32x4.load(Y,4),ie=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(oe,0,0,0,0),Z),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(oe,1,1,1,1),K),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(oe,2,2,2,2),Q),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(oe,3,3,3,3),J))));SIMD.Float32x4.store(W,4,ie);var ne=SIMD.Float32x4.load(Y,8),se=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(ne,0,0,0,0),Z),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(ne,1,1,1,1),K),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(ne,2,2,2,2),Q),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(ne,3,3,3,3),J))));SIMD.Float32x4.store(W,8,se);var le=SIMD.Float32x4.load(Y,12),pe=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(le,0,0,0,0),Z),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(le,1,1,1,1),K),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(le,2,2,2,2),Q),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(le,3,3,3,3),J))));return SIMD.Float32x4.store(W,12,pe),W},V.scalar.multiply=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=X[4],ee=X[5],oe=X[6],ie=X[7],ne=X[8],se=X[9],le=X[10],pe=X[11],ue=X[12],fe=X[13],ge=X[14],he=X[15],ye=Y[0],xe=Y[1],Te=Y[2],ve=Y[3];// Cache only the current line of the second matrix
return W[0]=ye*Z+xe*$+Te*ne+ve*ue,W[1]=ye*K+xe*ee+Te*se+ve*fe,W[2]=ye*Q+xe*oe+Te*le+ve*ge,W[3]=ye*J+xe*ie+Te*pe+ve*he,ye=Y[4],xe=Y[5],Te=Y[6],ve=Y[7],W[4]=ye*Z+xe*$+Te*ne+ve*ue,W[5]=ye*K+xe*ee+Te*se+ve*fe,W[6]=ye*Q+xe*oe+Te*le+ve*ge,W[7]=ye*J+xe*ie+Te*pe+ve*he,ye=Y[8],xe=Y[9],Te=Y[10],ve=Y[11],W[8]=ye*Z+xe*$+Te*ne+ve*ue,W[9]=ye*K+xe*ee+Te*se+ve*fe,W[10]=ye*Q+xe*oe+Te*le+ve*ge,W[11]=ye*J+xe*ie+Te*pe+ve*he,ye=Y[12],xe=Y[13],Te=Y[14],ve=Y[15],W[12]=ye*Z+xe*$+Te*ne+ve*ue,W[13]=ye*K+xe*ee+Te*se+ve*fe,W[14]=ye*Q+xe*oe+Te*le+ve*ge,W[15]=ye*J+xe*ie+Te*pe+ve*he,W},V.multiply=O.USE_SIMD?V.SIMD.multiply:V.scalar.multiply,V.mul=V.multiply,V.scalar.translate=function(W,X,Y){var Z=Y[0],K=Y[1],Q=Y[2],J,$,ee,oe,ie,ne,se,le,pe,ue,fe,ge;return X===W?(W[12]=X[0]*Z+X[4]*K+X[8]*Q+X[12],W[13]=X[1]*Z+X[5]*K+X[9]*Q+X[13],W[14]=X[2]*Z+X[6]*K+X[10]*Q+X[14],W[15]=X[3]*Z+X[7]*K+X[11]*Q+X[15]):(J=X[0],$=X[1],ee=X[2],oe=X[3],ie=X[4],ne=X[5],se=X[6],le=X[7],pe=X[8],ue=X[9],fe=X[10],ge=X[11],W[0]=J,W[1]=$,W[2]=ee,W[3]=oe,W[4]=ie,W[5]=ne,W[6]=se,W[7]=le,W[8]=pe,W[9]=ue,W[10]=fe,W[11]=ge,W[12]=J*Z+ie*K+pe*Q+X[12],W[13]=$*Z+ne*K+ue*Q+X[13],W[14]=ee*Z+se*K+fe*Q+X[14],W[15]=oe*Z+le*K+ge*Q+X[15]),W},V.SIMD.translate=function(W,X,Y){var Z=SIMD.Float32x4.load(X,0),K=SIMD.Float32x4.load(X,4),Q=SIMD.Float32x4.load(X,8),J=SIMD.Float32x4.load(X,12),$=SIMD.Float32x4(Y[0],Y[1],Y[2],0);X!==W&&(W[0]=X[0],W[1]=X[1],W[2]=X[2],W[3]=X[3],W[4]=X[4],W[5]=X[5],W[6]=X[6],W[7]=X[7],W[8]=X[8],W[9]=X[9],W[10]=X[10],W[11]=X[11]),Z=SIMD.Float32x4.mul(Z,SIMD.Float32x4.swizzle($,0,0,0,0)),K=SIMD.Float32x4.mul(K,SIMD.Float32x4.swizzle($,1,1,1,1)),Q=SIMD.Float32x4.mul(Q,SIMD.Float32x4.swizzle($,2,2,2,2));var ee=SIMD.Float32x4.add(Z,SIMD.Float32x4.add(K,SIMD.Float32x4.add(Q,J)));return SIMD.Float32x4.store(W,12,ee),W},V.translate=O.USE_SIMD?V.SIMD.translate:V.scalar.translate,V.scalar.scale=function(W,X,Y){var Z=Y[0],K=Y[1],Q=Y[2];return W[0]=X[0]*Z,W[1]=X[1]*Z,W[2]=X[2]*Z,W[3]=X[3]*Z,W[4]=X[4]*K,W[5]=X[5]*K,W[6]=X[6]*K,W[7]=X[7]*K,W[8]=X[8]*Q,W[9]=X[9]*Q,W[10]=X[10]*Q,W[11]=X[11]*Q,W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15],W},V.SIMD.scale=function(W,X,Y){var J=SIMD.Float32x4(Y[0],Y[1],Y[2],0),Z,K,Q;return Z=SIMD.Float32x4.load(X,0),SIMD.Float32x4.store(W,0,SIMD.Float32x4.mul(Z,SIMD.Float32x4.swizzle(J,0,0,0,0))),K=SIMD.Float32x4.load(X,4),SIMD.Float32x4.store(W,4,SIMD.Float32x4.mul(K,SIMD.Float32x4.swizzle(J,1,1,1,1))),Q=SIMD.Float32x4.load(X,8),SIMD.Float32x4.store(W,8,SIMD.Float32x4.mul(Q,SIMD.Float32x4.swizzle(J,2,2,2,2))),W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15],W},V.scale=O.USE_SIMD?V.SIMD.scale:V.scalar.scale,V.rotate=function(W,X,Y,Z){var K=Z[0],Q=Z[1],J=Z[2],$=Math.sqrt(K*K+Q*Q+J*J),ee,oe,ie,ne,se,le,pe,ue,fe,ge,he,ye,xe,Te,ve,Se,Ee,Me,Ae,Pe,Le,we,Re,Ce;return Math.abs($)<O.EPSILON?null:($=1/$,K*=$,Q*=$,J*=$,ee=Math.sin(Y),oe=Math.cos(Y),ie=1-oe,ne=X[0],se=X[1],le=X[2],pe=X[3],ue=X[4],fe=X[5],ge=X[6],he=X[7],ye=X[8],xe=X[9],Te=X[10],ve=X[11],Se=K*K*ie+oe,Ee=Q*K*ie+J*ee,Me=J*K*ie-Q*ee,Ae=K*Q*ie-J*ee,Pe=Q*Q*ie+oe,Le=J*Q*ie+K*ee,we=K*J*ie+Q*ee,Re=Q*J*ie-K*ee,Ce=J*J*ie+oe,W[0]=ne*Se+ue*Ee+ye*Me,W[1]=se*Se+fe*Ee+xe*Me,W[2]=le*Se+ge*Ee+Te*Me,W[3]=pe*Se+he*Ee+ve*Me,W[4]=ne*Ae+ue*Pe+ye*Le,W[5]=se*Ae+fe*Pe+xe*Le,W[6]=le*Ae+ge*Pe+Te*Le,W[7]=pe*Ae+he*Pe+ve*Le,W[8]=ne*we+ue*Re+ye*Ce,W[9]=se*we+fe*Re+xe*Ce,W[10]=le*we+ge*Re+Te*Ce,W[11]=pe*we+he*Re+ve*Ce,X!==W&&(W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15]),W)},V.scalar.rotateX=function(W,X,Y){var Z=Math.sin(Y),K=Math.cos(Y),Q=X[4],J=X[5],$=X[6],ee=X[7],oe=X[8],ie=X[9],ne=X[10],se=X[11];return X!==W&&(W[0]=X[0],W[1]=X[1],W[2]=X[2],W[3]=X[3],W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15]),W[4]=Q*K+oe*Z,W[5]=J*K+ie*Z,W[6]=$*K+ne*Z,W[7]=ee*K+se*Z,W[8]=oe*K-Q*Z,W[9]=ie*K-J*Z,W[10]=ne*K-$*Z,W[11]=se*K-ee*Z,W},V.SIMD.rotateX=function(W,X,Y){var Z=SIMD.Float32x4.splat(Math.sin(Y)),K=SIMD.Float32x4.splat(Math.cos(Y));X!==W&&(W[0]=X[0],W[1]=X[1],W[2]=X[2],W[3]=X[3],W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15]);// Perform axis-specific matrix multiplication
var Q=SIMD.Float32x4.load(X,4),J=SIMD.Float32x4.load(X,8);return SIMD.Float32x4.store(W,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(Q,K),SIMD.Float32x4.mul(J,Z))),SIMD.Float32x4.store(W,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(J,K),SIMD.Float32x4.mul(Q,Z))),W},V.rotateX=O.USE_SIMD?V.SIMD.rotateX:V.scalar.rotateX,V.scalar.rotateY=function(W,X,Y){var Z=Math.sin(Y),K=Math.cos(Y),Q=X[0],J=X[1],$=X[2],ee=X[3],oe=X[8],ie=X[9],ne=X[10],se=X[11];return X!==W&&(W[4]=X[4],W[5]=X[5],W[6]=X[6],W[7]=X[7],W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15]),W[0]=Q*K-oe*Z,W[1]=J*K-ie*Z,W[2]=$*K-ne*Z,W[3]=ee*K-se*Z,W[8]=Q*Z+oe*K,W[9]=J*Z+ie*K,W[10]=$*Z+ne*K,W[11]=ee*Z+se*K,W},V.SIMD.rotateY=function(W,X,Y){var Z=SIMD.Float32x4.splat(Math.sin(Y)),K=SIMD.Float32x4.splat(Math.cos(Y));X!==W&&(W[4]=X[4],W[5]=X[5],W[6]=X[6],W[7]=X[7],W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15]);// Perform axis-specific matrix multiplication
var Q=SIMD.Float32x4.load(X,0),J=SIMD.Float32x4.load(X,8);return SIMD.Float32x4.store(W,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(Q,K),SIMD.Float32x4.mul(J,Z))),SIMD.Float32x4.store(W,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(Q,Z),SIMD.Float32x4.mul(J,K))),W},V.rotateY=O.USE_SIMD?V.SIMD.rotateY:V.scalar.rotateY,V.scalar.rotateZ=function(W,X,Y){var Z=Math.sin(Y),K=Math.cos(Y),Q=X[0],J=X[1],$=X[2],ee=X[3],oe=X[4],ie=X[5],ne=X[6],se=X[7];return X!==W&&(W[8]=X[8],W[9]=X[9],W[10]=X[10],W[11]=X[11],W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15]),W[0]=Q*K+oe*Z,W[1]=J*K+ie*Z,W[2]=$*K+ne*Z,W[3]=ee*K+se*Z,W[4]=oe*K-Q*Z,W[5]=ie*K-J*Z,W[6]=ne*K-$*Z,W[7]=se*K-ee*Z,W},V.SIMD.rotateZ=function(W,X,Y){var Z=SIMD.Float32x4.splat(Math.sin(Y)),K=SIMD.Float32x4.splat(Math.cos(Y));X!==W&&(W[8]=X[8],W[9]=X[9],W[10]=X[10],W[11]=X[11],W[12]=X[12],W[13]=X[13],W[14]=X[14],W[15]=X[15]);// Perform axis-specific matrix multiplication
var Q=SIMD.Float32x4.load(X,0),J=SIMD.Float32x4.load(X,4);return SIMD.Float32x4.store(W,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(Q,K),SIMD.Float32x4.mul(J,Z))),SIMD.Float32x4.store(W,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(J,K),SIMD.Float32x4.mul(Q,Z))),W},V.rotateZ=O.USE_SIMD?V.SIMD.rotateZ:V.scalar.rotateZ,V.fromTranslation=function(W,X){return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=1,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=1,W[11]=0,W[12]=X[0],W[13]=X[1],W[14]=X[2],W[15]=1,W},V.fromScaling=function(W,X){return W[0]=X[0],W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=X[1],W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=X[2],W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},V.fromRotation=function(W,X,Y){var Z=Y[0],K=Y[1],Q=Y[2],J=Math.sqrt(Z*Z+K*K+Q*Q),$,ee,oe;return Math.abs(J)<O.EPSILON?null:(J=1/J,Z*=J,K*=J,Q*=J,$=Math.sin(X),ee=Math.cos(X),oe=1-ee,W[0]=Z*Z*oe+ee,W[1]=K*Z*oe+Q*$,W[2]=Q*Z*oe-K*$,W[3]=0,W[4]=Z*K*oe-Q*$,W[5]=K*K*oe+ee,W[6]=Q*K*oe+Z*$,W[7]=0,W[8]=Z*Q*oe+K*$,W[9]=K*Q*oe-Z*$,W[10]=Q*Q*oe+ee,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W)},V.fromXRotation=function(W,X){var Y=Math.sin(X),Z=Math.cos(X);// Perform axis-specific matrix multiplication
return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=Z,W[6]=Y,W[7]=0,W[8]=0,W[9]=-Y,W[10]=Z,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},V.fromYRotation=function(W,X){var Y=Math.sin(X),Z=Math.cos(X);// Perform axis-specific matrix multiplication
return W[0]=Z,W[1]=0,W[2]=-Y,W[3]=0,W[4]=0,W[5]=1,W[6]=0,W[7]=0,W[8]=Y,W[9]=0,W[10]=Z,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},V.fromZRotation=function(W,X){var Y=Math.sin(X),Z=Math.cos(X);// Perform axis-specific matrix multiplication
return W[0]=Z,W[1]=Y,W[2]=0,W[3]=0,W[4]=-Y,W[5]=Z,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=1,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},V.fromRotationTranslation=function(W,X,Y){// Quaternion math
var Z=X[0],K=X[1],Q=X[2],J=X[3],$=Z+Z,ee=K+K,oe=Q+Q,ie=Z*$,ne=Z*ee,se=Z*oe,le=K*ee,pe=K*oe,ue=Q*oe,fe=J*$,ge=J*ee,he=J*oe;return W[0]=1-(le+ue),W[1]=ne+he,W[2]=se-ge,W[3]=0,W[4]=ne-he,W[5]=1-(ie+ue),W[6]=pe+fe,W[7]=0,W[8]=se+ge,W[9]=pe-fe,W[10]=1-(ie+le),W[11]=0,W[12]=Y[0],W[13]=Y[1],W[14]=Y[2],W[15]=1,W},V.getTranslation=function(W,X){return W[0]=X[12],W[1]=X[13],W[2]=X[14],W},V.getRotation=function(W,X){// Algorithm taken from http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm
var Y=X[0]+X[5]+X[10],Z=0;return 0<Y?(Z=2*Math.sqrt(Y+1),W[3]=0.25*Z,W[0]=(X[6]-X[9])/Z,W[1]=(X[8]-X[2])/Z,W[2]=(X[1]-X[4])/Z):X[0]>X[5]&X[0]>X[10]?(Z=2*Math.sqrt(1+X[0]-X[5]-X[10]),W[3]=(X[6]-X[9])/Z,W[0]=0.25*Z,W[1]=(X[1]+X[4])/Z,W[2]=(X[8]+X[2])/Z):X[5]>X[10]?(Z=2*Math.sqrt(1+X[5]-X[0]-X[10]),W[3]=(X[8]-X[2])/Z,W[0]=(X[1]+X[4])/Z,W[1]=0.25*Z,W[2]=(X[6]+X[9])/Z):(Z=2*Math.sqrt(1+X[10]-X[0]-X[5]),W[3]=(X[1]-X[4])/Z,W[0]=(X[8]+X[2])/Z,W[1]=(X[6]+X[9])/Z,W[2]=0.25*Z),W},V.fromRotationTranslationScale=function(W,X,Y,Z){// Quaternion math
var K=X[0],Q=X[1],J=X[2],$=X[3],ee=K+K,oe=Q+Q,ie=J+J,ne=K*ee,se=K*oe,le=K*ie,pe=Q*oe,ue=Q*ie,fe=J*ie,ge=$*ee,he=$*oe,ye=$*ie,xe=Z[0],Te=Z[1],ve=Z[2];return W[0]=(1-(pe+fe))*xe,W[1]=(se+ye)*xe,W[2]=(le-he)*xe,W[3]=0,W[4]=(se-ye)*Te,W[5]=(1-(ne+fe))*Te,W[6]=(ue+ge)*Te,W[7]=0,W[8]=(le+he)*ve,W[9]=(ue-ge)*ve,W[10]=(1-(ne+pe))*ve,W[11]=0,W[12]=Y[0],W[13]=Y[1],W[14]=Y[2],W[15]=1,W},V.fromRotationTranslationScaleOrigin=function(W,X,Y,Z,K){// Quaternion math
var Q=X[0],J=X[1],$=X[2],ee=X[3],oe=Q+Q,ie=J+J,ne=$+$,se=Q*oe,le=Q*ie,pe=Q*ne,ue=J*ie,fe=J*ne,ge=$*ne,he=ee*oe,ye=ee*ie,xe=ee*ne,Te=Z[0],ve=Z[1],Se=Z[2],Ee=K[0],Me=K[1],Ae=K[2];return W[0]=(1-(ue+ge))*Te,W[1]=(le+xe)*Te,W[2]=(pe-ye)*Te,W[3]=0,W[4]=(le-xe)*ve,W[5]=(1-(se+ge))*ve,W[6]=(fe+he)*ve,W[7]=0,W[8]=(pe+ye)*Se,W[9]=(fe-he)*Se,W[10]=(1-(se+ue))*Se,W[11]=0,W[12]=Y[0]+Ee-(W[0]*Ee+W[4]*Me+W[8]*Ae),W[13]=Y[1]+Me-(W[1]*Ee+W[5]*Me+W[9]*Ae),W[14]=Y[2]+Ae-(W[2]*Ee+W[6]*Me+W[10]*Ae),W[15]=1,W},V.fromQuat=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],J=Y+Y,$=Z+Z,ee=K+K,oe=Y*J,ie=Z*J,ne=Z*$,se=K*J,le=K*$,pe=K*ee,ue=Q*J,fe=Q*$,ge=Q*ee;return W[0]=1-ne-pe,W[1]=ie+ge,W[2]=se-fe,W[3]=0,W[4]=ie-ge,W[5]=1-oe-pe,W[6]=le+ue,W[7]=0,W[8]=se+fe,W[9]=le-ue,W[10]=1-oe-ne,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},V.frustum=function(W,X,Y,Z,K,Q,J){var $=1/(Y-X),ee=1/(K-Z),oe=1/(Q-J);return W[0]=2*Q*$,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=2*Q*ee,W[6]=0,W[7]=0,W[8]=(Y+X)*$,W[9]=(K+Z)*ee,W[10]=(J+Q)*oe,W[11]=-1,W[12]=0,W[13]=0,W[14]=2*(J*Q)*oe,W[15]=0,W},V.perspective=function(W,X,Y,Z,K){var Q=1/Math.tan(X/2),J=1/(Z-K);return W[0]=Q/Y,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=Q,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=(K+Z)*J,W[11]=-1,W[12]=0,W[13]=0,W[14]=2*K*Z*J,W[15]=0,W},V.perspectiveFromFieldOfView=function(W,X,Y,Z){var K=Math.tan(X.upDegrees*Math.PI/180),Q=Math.tan(X.downDegrees*Math.PI/180),J=Math.tan(X.leftDegrees*Math.PI/180),$=Math.tan(X.rightDegrees*Math.PI/180),ee=2/(J+$),oe=2/(K+Q);return W[0]=ee,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=oe,W[6]=0,W[7]=0,W[8]=-(0.5*((J-$)*ee)),W[9]=0.5*((K-Q)*oe),W[10]=Z/(Y-Z),W[11]=-1,W[12]=0,W[13]=0,W[14]=Z*Y/(Y-Z),W[15]=0,W},V.ortho=function(W,X,Y,Z,K,Q,J){var $=1/(X-Y),ee=1/(Z-K),oe=1/(Q-J);return W[0]=-2*$,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=-2*ee,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=2*oe,W[11]=0,W[12]=(X+Y)*$,W[13]=(K+Z)*ee,W[14]=(J+Q)*oe,W[15]=1,W},V.lookAt=function(W,X,Y,Z){var pe=X[0],ue=X[1],fe=X[2],ge=Z[0],he=Z[1],ye=Z[2],xe=Y[0],Te=Y[1],ve=Y[2],K,Q,J,$,ee,oe,ie,ne,se,le;return Math.abs(pe-xe)<O.EPSILON&&Math.abs(ue-Te)<O.EPSILON&&Math.abs(fe-ve)<O.EPSILON?V.identity(W):(ie=pe-xe,ne=ue-Te,se=fe-ve,le=1/Math.sqrt(ie*ie+ne*ne+se*se),ie*=le,ne*=le,se*=le,K=he*se-ye*ne,Q=ye*ie-ge*se,J=ge*ne-he*ie,le=Math.sqrt(K*K+Q*Q+J*J),le?(le=1/le,K*=le,Q*=le,J*=le):(K=0,Q=0,J=0),$=ne*J-se*Q,ee=se*K-ie*J,oe=ie*Q-ne*K,le=Math.sqrt($*$+ee*ee+oe*oe),le?(le=1/le,$*=le,ee*=le,oe*=le):($=0,ee=0,oe=0),W[0]=K,W[1]=$,W[2]=ie,W[3]=0,W[4]=Q,W[5]=ee,W[6]=ne,W[7]=0,W[8]=J,W[9]=oe,W[10]=se,W[11]=0,W[12]=-(K*pe+Q*ue+J*fe),W[13]=-($*pe+ee*ue+oe*fe),W[14]=-(ie*pe+ne*ue+se*fe),W[15]=1,W)},V.str=function(W){return"mat4("+W[0]+", "+W[1]+", "+W[2]+", "+W[3]+", "+W[4]+", "+W[5]+", "+W[6]+", "+W[7]+", "+W[8]+", "+W[9]+", "+W[10]+", "+W[11]+", "+W[12]+", "+W[13]+", "+W[14]+", "+W[15]+")"},V.frob=function(W){return Math.sqrt(Math.pow(W[0],2)+Math.pow(W[1],2)+Math.pow(W[2],2)+Math.pow(W[3],2)+Math.pow(W[4],2)+Math.pow(W[5],2)+Math.pow(W[6],2)+Math.pow(W[7],2)+Math.pow(W[8],2)+Math.pow(W[9],2)+Math.pow(W[10],2)+Math.pow(W[11],2)+Math.pow(W[12],2)+Math.pow(W[13],2)+Math.pow(W[14],2)+Math.pow(W[15],2))},V.add=function(W,X,Y){return W[0]=X[0]+Y[0],W[1]=X[1]+Y[1],W[2]=X[2]+Y[2],W[3]=X[3]+Y[3],W[4]=X[4]+Y[4],W[5]=X[5]+Y[5],W[6]=X[6]+Y[6],W[7]=X[7]+Y[7],W[8]=X[8]+Y[8],W[9]=X[9]+Y[9],W[10]=X[10]+Y[10],W[11]=X[11]+Y[11],W[12]=X[12]+Y[12],W[13]=X[13]+Y[13],W[14]=X[14]+Y[14],W[15]=X[15]+Y[15],W},V.subtract=function(W,X,Y){return W[0]=X[0]-Y[0],W[1]=X[1]-Y[1],W[2]=X[2]-Y[2],W[3]=X[3]-Y[3],W[4]=X[4]-Y[4],W[5]=X[5]-Y[5],W[6]=X[6]-Y[6],W[7]=X[7]-Y[7],W[8]=X[8]-Y[8],W[9]=X[9]-Y[9],W[10]=X[10]-Y[10],W[11]=X[11]-Y[11],W[12]=X[12]-Y[12],W[13]=X[13]-Y[13],W[14]=X[14]-Y[14],W[15]=X[15]-Y[15],W},V.sub=V.subtract,V.multiplyScalar=function(W,X,Y){return W[0]=X[0]*Y,W[1]=X[1]*Y,W[2]=X[2]*Y,W[3]=X[3]*Y,W[4]=X[4]*Y,W[5]=X[5]*Y,W[6]=X[6]*Y,W[7]=X[7]*Y,W[8]=X[8]*Y,W[9]=X[9]*Y,W[10]=X[10]*Y,W[11]=X[11]*Y,W[12]=X[12]*Y,W[13]=X[13]*Y,W[14]=X[14]*Y,W[15]=X[15]*Y,W},V.multiplyScalarAndAdd=function(W,X,Y,Z){return W[0]=X[0]+Y[0]*Z,W[1]=X[1]+Y[1]*Z,W[2]=X[2]+Y[2]*Z,W[3]=X[3]+Y[3]*Z,W[4]=X[4]+Y[4]*Z,W[5]=X[5]+Y[5]*Z,W[6]=X[6]+Y[6]*Z,W[7]=X[7]+Y[7]*Z,W[8]=X[8]+Y[8]*Z,W[9]=X[9]+Y[9]*Z,W[10]=X[10]+Y[10]*Z,W[11]=X[11]+Y[11]*Z,W[12]=X[12]+Y[12]*Z,W[13]=X[13]+Y[13]*Z,W[14]=X[14]+Y[14]*Z,W[15]=X[15]+Y[15]*Z,W},V.exactEquals=function(W,X){return W[0]===X[0]&&W[1]===X[1]&&W[2]===X[2]&&W[3]===X[3]&&W[4]===X[4]&&W[5]===X[5]&&W[6]===X[6]&&W[7]===X[7]&&W[8]===X[8]&&W[9]===X[9]&&W[10]===X[10]&&W[11]===X[11]&&W[12]===X[12]&&W[13]===X[13]&&W[14]===X[14]&&W[15]===X[15]},V.equals=function(W,X){var Y=W[0],Z=W[1],K=W[2],Q=W[3],J=W[4],$=W[5],ee=W[6],oe=W[7],ie=W[8],ne=W[9],se=W[10],le=W[11],pe=W[12],ue=W[13],fe=W[14],ge=W[15],he=X[0],ye=X[1],xe=X[2],Te=X[3],ve=X[4],Se=X[5],Ee=X[6],Me=X[7],Ae=X[8],Pe=X[9],Le=X[10],we=X[11],Re=X[12],Ce=X[13],Ie=X[14],De=X[15];return Math.abs(Y-he)<=O.EPSILON*Math.max(1,Math.abs(Y),Math.abs(he))&&Math.abs(Z-ye)<=O.EPSILON*Math.max(1,Math.abs(Z),Math.abs(ye))&&Math.abs(K-xe)<=O.EPSILON*Math.max(1,Math.abs(K),Math.abs(xe))&&Math.abs(Q-Te)<=O.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Te))&&Math.abs(J-ve)<=O.EPSILON*Math.max(1,Math.abs(J),Math.abs(ve))&&Math.abs($-Se)<=O.EPSILON*Math.max(1,Math.abs($),Math.abs(Se))&&Math.abs(ee-Ee)<=O.EPSILON*Math.max(1,Math.abs(ee),Math.abs(Ee))&&Math.abs(oe-Me)<=O.EPSILON*Math.max(1,Math.abs(oe),Math.abs(Me))&&Math.abs(ie-Ae)<=O.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Ae))&&Math.abs(ne-Pe)<=O.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Pe))&&Math.abs(se-Le)<=O.EPSILON*Math.max(1,Math.abs(se),Math.abs(Le))&&Math.abs(le-we)<=O.EPSILON*Math.max(1,Math.abs(le),Math.abs(we))&&Math.abs(pe-Re)<=O.EPSILON*Math.max(1,Math.abs(pe),Math.abs(Re))&&Math.abs(ue-Ce)<=O.EPSILON*Math.max(1,Math.abs(ue),Math.abs(Ce))&&Math.abs(fe-Ie)<=O.EPSILON*Math.max(1,Math.abs(fe),Math.abs(Ie))&&Math.abs(ge-De)<=O.EPSILON*Math.max(1,Math.abs(ge),Math.abs(De))},F.exports=V,F.exports}),E.registerDynamic("9",["6"],!0,function(C,G,F){var H=this||self,O=C("6"),V={};/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE. *//**
     * @class 3x3 Matrix
     * @name mat3
     *//**
     * Creates a new identity mat3
     *
     * @returns {mat3} a new 3x3 matrix
     */return V.create=function(){var W=new O.ARRAY_TYPE(9);return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=1,W[5]=0,W[6]=0,W[7]=0,W[8]=1,W},V.fromMat4=function(W,X){return W[0]=X[0],W[1]=X[1],W[2]=X[2],W[3]=X[4],W[4]=X[5],W[5]=X[6],W[6]=X[8],W[7]=X[9],W[8]=X[10],W},V.clone=function(W){var X=new O.ARRAY_TYPE(9);return X[0]=W[0],X[1]=W[1],X[2]=W[2],X[3]=W[3],X[4]=W[4],X[5]=W[5],X[6]=W[6],X[7]=W[7],X[8]=W[8],X},V.copy=function(W,X){return W[0]=X[0],W[1]=X[1],W[2]=X[2],W[3]=X[3],W[4]=X[4],W[5]=X[5],W[6]=X[6],W[7]=X[7],W[8]=X[8],W},V.fromValues=function(W,X,Y,Z,K,Q,J,$,ee){var oe=new O.ARRAY_TYPE(9);return oe[0]=W,oe[1]=X,oe[2]=Y,oe[3]=Z,oe[4]=K,oe[5]=Q,oe[6]=J,oe[7]=$,oe[8]=ee,oe},V.set=function(W,X,Y,Z,K,Q,J,$,ee,oe){return W[0]=X,W[1]=Y,W[2]=Z,W[3]=K,W[4]=Q,W[5]=J,W[6]=$,W[7]=ee,W[8]=oe,W},V.identity=function(W){return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=1,W[5]=0,W[6]=0,W[7]=0,W[8]=1,W},V.transpose=function(W,X){// If we are transposing ourselves we can skip a few steps but have to cache some values
if(W===X){var Y=X[1],Z=X[2],K=X[5];W[1]=X[3],W[2]=X[6],W[3]=Y,W[5]=X[7],W[6]=Z,W[7]=K}else W[0]=X[0],W[1]=X[3],W[2]=X[6],W[3]=X[1],W[4]=X[4],W[5]=X[7],W[6]=X[2],W[7]=X[5],W[8]=X[8];return W},V.invert=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],J=X[4],$=X[5],ee=X[6],oe=X[7],ie=X[8],ne=ie*J-$*oe,se=-ie*Q+$*ee,le=oe*Q-J*ee,// Calculate the determinant
pe=Y*ne+Z*se+K*le;return pe?(pe=1/pe,W[0]=ne*pe,W[1]=(-ie*Z+K*oe)*pe,W[2]=($*Z-K*J)*pe,W[3]=se*pe,W[4]=(ie*Y-K*ee)*pe,W[5]=(-$*Y+K*Q)*pe,W[6]=le*pe,W[7]=(-oe*Y+Z*ee)*pe,W[8]=(J*Y-Z*Q)*pe,W):null},V.adjoint=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],J=X[4],$=X[5],ee=X[6],oe=X[7],ie=X[8];return W[0]=J*ie-$*oe,W[1]=K*oe-Z*ie,W[2]=Z*$-K*J,W[3]=$*ee-Q*ie,W[4]=Y*ie-K*ee,W[5]=K*Q-Y*$,W[6]=Q*oe-J*ee,W[7]=Z*ee-Y*oe,W[8]=Y*J-Z*Q,W},V.determinant=function(W){var X=W[0],Y=W[1],Z=W[2],K=W[3],Q=W[4],J=W[5],$=W[6],ee=W[7],oe=W[8];return X*(oe*Q-J*ee)+Y*(-oe*K+J*$)+Z*(ee*K-Q*$)},V.multiply=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=X[4],ee=X[5],oe=X[6],ie=X[7],ne=X[8],se=Y[0],le=Y[1],pe=Y[2],ue=Y[3],fe=Y[4],ge=Y[5],he=Y[6],ye=Y[7],xe=Y[8];return W[0]=se*Z+le*J+pe*oe,W[1]=se*K+le*$+pe*ie,W[2]=se*Q+le*ee+pe*ne,W[3]=ue*Z+fe*J+ge*oe,W[4]=ue*K+fe*$+ge*ie,W[5]=ue*Q+fe*ee+ge*ne,W[6]=he*Z+ye*J+xe*oe,W[7]=he*K+ye*$+xe*ie,W[8]=he*Q+ye*ee+xe*ne,W},V.mul=V.multiply,V.translate=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=X[4],ee=X[5],oe=X[6],ie=X[7],ne=X[8],se=Y[0],le=Y[1];return W[0]=Z,W[1]=K,W[2]=Q,W[3]=J,W[4]=$,W[5]=ee,W[6]=se*Z+le*J+oe,W[7]=se*K+le*$+ie,W[8]=se*Q+le*ee+ne,W},V.rotate=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3],$=X[4],ee=X[5],oe=X[6],ie=X[7],ne=X[8],se=Math.sin(Y),le=Math.cos(Y);return W[0]=le*Z+se*J,W[1]=le*K+se*$,W[2]=le*Q+se*ee,W[3]=le*J-se*Z,W[4]=le*$-se*K,W[5]=le*ee-se*Q,W[6]=oe,W[7]=ie,W[8]=ne,W},V.scale=function(W,X,Y){var Z=Y[0],K=Y[1];return W[0]=Z*X[0],W[1]=Z*X[1],W[2]=Z*X[2],W[3]=K*X[3],W[4]=K*X[4],W[5]=K*X[5],W[6]=X[6],W[7]=X[7],W[8]=X[8],W},V.fromTranslation=function(W,X){return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=1,W[5]=0,W[6]=X[0],W[7]=X[1],W[8]=1,W},V.fromRotation=function(W,X){var Y=Math.sin(X),Z=Math.cos(X);return W[0]=Z,W[1]=Y,W[2]=0,W[3]=-Y,W[4]=Z,W[5]=0,W[6]=0,W[7]=0,W[8]=1,W},V.fromScaling=function(W,X){return W[0]=X[0],W[1]=0,W[2]=0,W[3]=0,W[4]=X[1],W[5]=0,W[6]=0,W[7]=0,W[8]=1,W},V.fromMat2d=function(W,X){return W[0]=X[0],W[1]=X[1],W[2]=0,W[3]=X[2],W[4]=X[3],W[5]=0,W[6]=X[4],W[7]=X[5],W[8]=1,W},V.fromQuat=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],J=Y+Y,$=Z+Z,ee=K+K,oe=Y*J,ie=Z*J,ne=Z*$,se=K*J,le=K*$,pe=K*ee,ue=Q*J,fe=Q*$,ge=Q*ee;return W[0]=1-ne-pe,W[3]=ie-ge,W[6]=se+fe,W[1]=ie+ge,W[4]=1-oe-pe,W[7]=le-ue,W[2]=se-fe,W[5]=le+ue,W[8]=1-oe-ne,W},V.normalFromMat4=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],J=X[4],$=X[5],ee=X[6],oe=X[7],ie=X[8],ne=X[9],se=X[10],le=X[11],pe=X[12],ue=X[13],fe=X[14],ge=X[15],he=Y*$-Z*J,ye=Y*ee-K*J,xe=Y*oe-Q*J,Te=Z*ee-K*$,ve=Z*oe-Q*$,Se=K*oe-Q*ee,Ee=ie*ue-ne*pe,Me=ie*fe-se*pe,Ae=ie*ge-le*pe,Pe=ne*fe-se*ue,Le=ne*ge-le*ue,we=se*ge-le*fe,// Calculate the determinant
Re=he*we-ye*Le+xe*Pe+Te*Ae-ve*Me+Se*Ee;return Re?(Re=1/Re,W[0]=($*we-ee*Le+oe*Pe)*Re,W[1]=(ee*Ae-J*we-oe*Me)*Re,W[2]=(J*Le-$*Ae+oe*Ee)*Re,W[3]=(K*Le-Z*we-Q*Pe)*Re,W[4]=(Y*we-K*Ae+Q*Me)*Re,W[5]=(Z*Ae-Y*Le-Q*Ee)*Re,W[6]=(ue*Se-fe*ve+ge*Te)*Re,W[7]=(fe*xe-pe*Se-ge*ye)*Re,W[8]=(pe*ve-ue*xe+ge*he)*Re,W):null},V.str=function(W){return"mat3("+W[0]+", "+W[1]+", "+W[2]+", "+W[3]+", "+W[4]+", "+W[5]+", "+W[6]+", "+W[7]+", "+W[8]+")"},V.frob=function(W){return Math.sqrt(Math.pow(W[0],2)+Math.pow(W[1],2)+Math.pow(W[2],2)+Math.pow(W[3],2)+Math.pow(W[4],2)+Math.pow(W[5],2)+Math.pow(W[6],2)+Math.pow(W[7],2)+Math.pow(W[8],2))},V.add=function(W,X,Y){return W[0]=X[0]+Y[0],W[1]=X[1]+Y[1],W[2]=X[2]+Y[2],W[3]=X[3]+Y[3],W[4]=X[4]+Y[4],W[5]=X[5]+Y[5],W[6]=X[6]+Y[6],W[7]=X[7]+Y[7],W[8]=X[8]+Y[8],W},V.subtract=function(W,X,Y){return W[0]=X[0]-Y[0],W[1]=X[1]-Y[1],W[2]=X[2]-Y[2],W[3]=X[3]-Y[3],W[4]=X[4]-Y[4],W[5]=X[5]-Y[5],W[6]=X[6]-Y[6],W[7]=X[7]-Y[7],W[8]=X[8]-Y[8],W},V.sub=V.subtract,V.multiplyScalar=function(W,X,Y){return W[0]=X[0]*Y,W[1]=X[1]*Y,W[2]=X[2]*Y,W[3]=X[3]*Y,W[4]=X[4]*Y,W[5]=X[5]*Y,W[6]=X[6]*Y,W[7]=X[7]*Y,W[8]=X[8]*Y,W},V.multiplyScalarAndAdd=function(W,X,Y,Z){return W[0]=X[0]+Y[0]*Z,W[1]=X[1]+Y[1]*Z,W[2]=X[2]+Y[2]*Z,W[3]=X[3]+Y[3]*Z,W[4]=X[4]+Y[4]*Z,W[5]=X[5]+Y[5]*Z,W[6]=X[6]+Y[6]*Z,W[7]=X[7]+Y[7]*Z,W[8]=X[8]+Y[8]*Z,W},V.exactEquals=function(W,X){return W[0]===X[0]&&W[1]===X[1]&&W[2]===X[2]&&W[3]===X[3]&&W[4]===X[4]&&W[5]===X[5]&&W[6]===X[6]&&W[7]===X[7]&&W[8]===X[8]},V.equals=function(W,X){var Y=W[0],Z=W[1],K=W[2],Q=W[3],J=W[4],$=W[5],ee=W[6],oe=W[7],ie=W[8],ne=X[0],se=X[1],le=X[2],pe=X[3],ue=X[4],fe=X[5],ge=W[6],he=X[7],ye=X[8];return Math.abs(Y-ne)<=O.EPSILON*Math.max(1,Math.abs(Y),Math.abs(ne))&&Math.abs(Z-se)<=O.EPSILON*Math.max(1,Math.abs(Z),Math.abs(se))&&Math.abs(K-le)<=O.EPSILON*Math.max(1,Math.abs(K),Math.abs(le))&&Math.abs(Q-pe)<=O.EPSILON*Math.max(1,Math.abs(Q),Math.abs(pe))&&Math.abs(J-ue)<=O.EPSILON*Math.max(1,Math.abs(J),Math.abs(ue))&&Math.abs($-fe)<=O.EPSILON*Math.max(1,Math.abs($),Math.abs(fe))&&Math.abs(ee-ge)<=O.EPSILON*Math.max(1,Math.abs(ee),Math.abs(ge))&&Math.abs(oe-he)<=O.EPSILON*Math.max(1,Math.abs(oe),Math.abs(he))&&Math.abs(ie-ye)<=O.EPSILON*Math.max(1,Math.abs(ie),Math.abs(ye))},F.exports=V,F.exports}),E.registerDynamic("a",["6","9","b","c"],!0,function(C,G,F){var H=this||self,O=C("6"),V=C("9"),W=C("b"),X=C("c"),Y={};/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE. *//**
     * @class Quaternion
     * @name quat
     *//**
     * Creates a new identity quat
     *
     * @returns {quat} a new quaternion
     */return Y.create=function(){var Z=new O.ARRAY_TYPE(4);return Z[0]=0,Z[1]=0,Z[2]=0,Z[3]=1,Z},Y.rotationTo=function(){var Z=W.create(),K=W.fromValues(1,0,0),Q=W.fromValues(0,1,0);return function(J,$,ee){var oe=W.dot($,ee);return-0.999999>oe?(W.cross(Z,K,$),1e-6>W.length(Z)&&W.cross(Z,Q,$),W.normalize(Z,Z),Y.setAxisAngle(J,Z,Math.PI),J):0.999999<oe?(J[0]=0,J[1]=0,J[2]=0,J[3]=1,J):(W.cross(Z,$,ee),J[0]=Z[0],J[1]=Z[1],J[2]=Z[2],J[3]=1+oe,Y.normalize(J,J))}}(),Y.setAxes=function(){var Z=V.create();return function(K,Q,J,$){return Z[0]=J[0],Z[3]=J[1],Z[6]=J[2],Z[1]=$[0],Z[4]=$[1],Z[7]=$[2],Z[2]=-Q[0],Z[5]=-Q[1],Z[8]=-Q[2],Y.normalize(K,Y.fromMat3(K,Z))}}(),Y.clone=X.clone,Y.fromValues=X.fromValues,Y.copy=X.copy,Y.set=X.set,Y.identity=function(Z){return Z[0]=0,Z[1]=0,Z[2]=0,Z[3]=1,Z},Y.setAxisAngle=function(Z,K,Q){Q=0.5*Q;var J=Math.sin(Q);return Z[0]=J*K[0],Z[1]=J*K[1],Z[2]=J*K[2],Z[3]=Math.cos(Q),Z},Y.getAxisAngle=function(Z,K){var Q=2*Math.acos(K[3]),J=Math.sin(Q/2);return 0==J?(Z[0]=1,Z[1]=0,Z[2]=0):(Z[0]=K[0]/J,Z[1]=K[1]/J,Z[2]=K[2]/J),Q},Y.add=X.add,Y.multiply=function(Z,K,Q){var J=K[0],$=K[1],ee=K[2],oe=K[3],ie=Q[0],ne=Q[1],se=Q[2],le=Q[3];return Z[0]=J*le+oe*ie+$*se-ee*ne,Z[1]=$*le+oe*ne+ee*ie-J*se,Z[2]=ee*le+oe*se+J*ne-$*ie,Z[3]=oe*le-J*ie-$*ne-ee*se,Z},Y.mul=Y.multiply,Y.scale=X.scale,Y.rotateX=function(Z,K,Q){Q*=0.5;var J=K[0],$=K[1],ee=K[2],oe=K[3],ie=Math.sin(Q),ne=Math.cos(Q);return Z[0]=J*ne+oe*ie,Z[1]=$*ne+ee*ie,Z[2]=ee*ne-$*ie,Z[3]=oe*ne-J*ie,Z},Y.rotateY=function(Z,K,Q){Q*=0.5;var J=K[0],$=K[1],ee=K[2],oe=K[3],ie=Math.sin(Q),ne=Math.cos(Q);return Z[0]=J*ne-ee*ie,Z[1]=$*ne+oe*ie,Z[2]=ee*ne+J*ie,Z[3]=oe*ne-$*ie,Z},Y.rotateZ=function(Z,K,Q){Q*=0.5;var J=K[0],$=K[1],ee=K[2],oe=K[3],ie=Math.sin(Q),ne=Math.cos(Q);return Z[0]=J*ne+$*ie,Z[1]=$*ne-J*ie,Z[2]=ee*ne+oe*ie,Z[3]=oe*ne-ee*ie,Z},Y.calculateW=function(Z,K){var Q=K[0],J=K[1],$=K[2];return Z[0]=Q,Z[1]=J,Z[2]=$,Z[3]=Math.sqrt(Math.abs(1-Q*Q-J*J-$*$)),Z},Y.dot=X.dot,Y.lerp=X.lerp,Y.slerp=function(Z,K,Q,J){// benchmarks:
//    http://jsperf.com/quaternion-slerp-implementations
var $=K[0],ee=K[1],oe=K[2],ie=K[3],ne=Q[0],se=Q[1],le=Q[2],pe=Q[3],ue,fe,ge,he,ye;// calc cosine
return fe=$*ne+ee*se+oe*le+ie*pe,0>fe&&(fe=-fe,ne=-ne,se=-se,le=-le,pe=-pe),1e-6<1-fe?(ue=Math.acos(fe),ge=Math.sin(ue),he=Math.sin((1-J)*ue)/ge,ye=Math.sin(J*ue)/ge):(he=1-J,ye=J),Z[0]=he*$+ye*ne,Z[1]=he*ee+ye*se,Z[2]=he*oe+ye*le,Z[3]=he*ie+ye*pe,Z},Y.sqlerp=function(){var Z=Y.create(),K=Y.create();return function(Q,J,$,ee,oe,ie){return Y.slerp(Z,J,oe,ie),Y.slerp(K,$,ee,ie),Y.slerp(Q,Z,K,2*ie*(1-ie)),Q}}(),Y.invert=function(Z,K){var Q=K[0],J=K[1],$=K[2],ee=K[3],oe=Q*Q+J*J+$*$+ee*ee,ie=oe?1/oe:0;// TODO: Would be faster to return [0,0,0,0] immediately if dot == 0
return Z[0]=-Q*ie,Z[1]=-J*ie,Z[2]=-$*ie,Z[3]=ee*ie,Z},Y.conjugate=function(Z,K){return Z[0]=-K[0],Z[1]=-K[1],Z[2]=-K[2],Z[3]=K[3],Z},Y.length=X.length,Y.len=Y.length,Y.squaredLength=X.squaredLength,Y.sqrLen=Y.squaredLength,Y.normalize=X.normalize,Y.fromMat3=function(Z,K){// Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes
// article "Quaternion Calculus and Fast Animation".
var Q=K[0]+K[4]+K[8],J;if(0<Q)J=Math.sqrt(Q+1),Z[3]=0.5*J,J=0.5/J,Z[0]=(K[5]-K[7])*J,Z[1]=(K[6]-K[2])*J,Z[2]=(K[1]-K[3])*J;else{// |w| <= 1/2
var $=0;K[4]>K[0]&&($=1),K[8]>K[3*$+$]&&($=2);var ee=($+1)%3,oe=($+2)%3;J=Math.sqrt(K[3*$+$]-K[3*ee+ee]-K[3*oe+oe]+1),Z[$]=0.5*J,J=0.5/J,Z[3]=(K[3*ee+oe]-K[3*oe+ee])*J,Z[ee]=(K[3*ee+$]+K[3*$+ee])*J,Z[oe]=(K[3*oe+$]+K[3*$+oe])*J}return Z},Y.str=function(Z){return"quat("+Z[0]+", "+Z[1]+", "+Z[2]+", "+Z[3]+")"},Y.exactEquals=X.exactEquals,Y.equals=X.equals,F.exports=Y,F.exports}),E.registerDynamic("d",["6"],!0,function(C,G,F){var H=this||self,O=C("6"),V={};/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE. *//**
     * @class 2 Dimensional Vector
     * @name vec2
     *//**
     * Creates a new, empty vec2
     *
     * @returns {vec2} a new 2D vector
     */return V.create=function(){var W=new O.ARRAY_TYPE(2);return W[0]=0,W[1]=0,W},V.clone=function(W){var X=new O.ARRAY_TYPE(2);return X[0]=W[0],X[1]=W[1],X},V.fromValues=function(W,X){var Y=new O.ARRAY_TYPE(2);return Y[0]=W,Y[1]=X,Y},V.copy=function(W,X){return W[0]=X[0],W[1]=X[1],W},V.set=function(W,X,Y){return W[0]=X,W[1]=Y,W},V.add=function(W,X,Y){return W[0]=X[0]+Y[0],W[1]=X[1]+Y[1],W},V.subtract=function(W,X,Y){return W[0]=X[0]-Y[0],W[1]=X[1]-Y[1],W},V.sub=V.subtract,V.multiply=function(W,X,Y){return W[0]=X[0]*Y[0],W[1]=X[1]*Y[1],W},V.mul=V.multiply,V.divide=function(W,X,Y){return W[0]=X[0]/Y[0],W[1]=X[1]/Y[1],W},V.div=V.divide,V.ceil=function(W,X){return W[0]=Math.ceil(X[0]),W[1]=Math.ceil(X[1]),W},V.floor=function(W,X){return W[0]=Math.floor(X[0]),W[1]=Math.floor(X[1]),W},V.min=function(W,X,Y){return W[0]=Math.min(X[0],Y[0]),W[1]=Math.min(X[1],Y[1]),W},V.max=function(W,X,Y){return W[0]=Math.max(X[0],Y[0]),W[1]=Math.max(X[1],Y[1]),W},V.round=function(W,X){return W[0]=Math.round(X[0]),W[1]=Math.round(X[1]),W},V.scale=function(W,X,Y){return W[0]=X[0]*Y,W[1]=X[1]*Y,W},V.scaleAndAdd=function(W,X,Y,Z){return W[0]=X[0]+Y[0]*Z,W[1]=X[1]+Y[1]*Z,W},V.distance=function(W,X){var Y=X[0]-W[0],Z=X[1]-W[1];return Math.sqrt(Y*Y+Z*Z)},V.dist=V.distance,V.squaredDistance=function(W,X){var Y=X[0]-W[0],Z=X[1]-W[1];return Y*Y+Z*Z},V.sqrDist=V.squaredDistance,V.length=function(W){var X=W[0],Y=W[1];return Math.sqrt(X*X+Y*Y)},V.len=V.length,V.squaredLength=function(W){var X=W[0],Y=W[1];return X*X+Y*Y},V.sqrLen=V.squaredLength,V.negate=function(W,X){return W[0]=-X[0],W[1]=-X[1],W},V.inverse=function(W,X){return W[0]=1/X[0],W[1]=1/X[1],W},V.normalize=function(W,X){var Y=X[0],Z=X[1],K=Y*Y+Z*Z;return 0<K&&(K=1/Math.sqrt(K),W[0]=X[0]*K,W[1]=X[1]*K),W},V.dot=function(W,X){return W[0]*X[0]+W[1]*X[1]},V.cross=function(W,X,Y){var Z=X[0]*Y[1]-X[1]*Y[0];return W[0]=W[1]=0,W[2]=Z,W},V.lerp=function(W,X,Y,Z){var K=X[0],Q=X[1];return W[0]=K+Z*(Y[0]-K),W[1]=Q+Z*(Y[1]-Q),W},V.random=function(W,X){X=X||1;var Y=2*O.RANDOM()*Math.PI;return W[0]=Math.cos(Y)*X,W[1]=Math.sin(Y)*X,W},V.transformMat2=function(W,X,Y){var Z=X[0],K=X[1];return W[0]=Y[0]*Z+Y[2]*K,W[1]=Y[1]*Z+Y[3]*K,W},V.transformMat2d=function(W,X,Y){var Z=X[0],K=X[1];return W[0]=Y[0]*Z+Y[2]*K+Y[4],W[1]=Y[1]*Z+Y[3]*K+Y[5],W},V.transformMat3=function(W,X,Y){var Z=X[0],K=X[1];return W[0]=Y[0]*Z+Y[3]*K+Y[6],W[1]=Y[1]*Z+Y[4]*K+Y[7],W},V.transformMat4=function(W,X,Y){var Z=X[0],K=X[1];return W[0]=Y[0]*Z+Y[4]*K+Y[12],W[1]=Y[1]*Z+Y[5]*K+Y[13],W},V.forEach=function(){var W=V.create();return function(X,Y,Z,K,Q,J){var $,ee;for(Y||(Y=2),Z||(Z=0),ee=K?Math.min(K*Y+Z,X.length):X.length,$=Z;$<ee;$+=Y)W[0]=X[$],W[1]=X[$+1],Q(W,W,J),X[$]=W[0],X[$+1]=W[1];return X}}(),V.str=function(W){return"vec2("+W[0]+", "+W[1]+")"},V.exactEquals=function(W,X){return W[0]===X[0]&&W[1]===X[1]},V.equals=function(W,X){var Y=W[0],Z=W[1],K=X[0],Q=X[1];return Math.abs(Y-K)<=O.EPSILON*Math.max(1,Math.abs(Y),Math.abs(K))&&Math.abs(Z-Q)<=O.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Q))},F.exports=V,F.exports}),E.registerDynamic("b",["6"],!0,function(C,G,F){var H=this||self,O=C("6"),V={};/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE. *//**
     * @class 3 Dimensional Vector
     * @name vec3
     *//**
     * Creates a new, empty vec3
     *
     * @returns {vec3} a new 3D vector
     */return V.create=function(){var W=new O.ARRAY_TYPE(3);return W[0]=0,W[1]=0,W[2]=0,W},V.clone=function(W){var X=new O.ARRAY_TYPE(3);return X[0]=W[0],X[1]=W[1],X[2]=W[2],X},V.fromValues=function(W,X,Y){var Z=new O.ARRAY_TYPE(3);return Z[0]=W,Z[1]=X,Z[2]=Y,Z},V.copy=function(W,X){return W[0]=X[0],W[1]=X[1],W[2]=X[2],W},V.set=function(W,X,Y,Z){return W[0]=X,W[1]=Y,W[2]=Z,W},V.add=function(W,X,Y){return W[0]=X[0]+Y[0],W[1]=X[1]+Y[1],W[2]=X[2]+Y[2],W},V.subtract=function(W,X,Y){return W[0]=X[0]-Y[0],W[1]=X[1]-Y[1],W[2]=X[2]-Y[2],W},V.sub=V.subtract,V.multiply=function(W,X,Y){return W[0]=X[0]*Y[0],W[1]=X[1]*Y[1],W[2]=X[2]*Y[2],W},V.mul=V.multiply,V.divide=function(W,X,Y){return W[0]=X[0]/Y[0],W[1]=X[1]/Y[1],W[2]=X[2]/Y[2],W},V.div=V.divide,V.ceil=function(W,X){return W[0]=Math.ceil(X[0]),W[1]=Math.ceil(X[1]),W[2]=Math.ceil(X[2]),W},V.floor=function(W,X){return W[0]=Math.floor(X[0]),W[1]=Math.floor(X[1]),W[2]=Math.floor(X[2]),W},V.min=function(W,X,Y){return W[0]=Math.min(X[0],Y[0]),W[1]=Math.min(X[1],Y[1]),W[2]=Math.min(X[2],Y[2]),W},V.max=function(W,X,Y){return W[0]=Math.max(X[0],Y[0]),W[1]=Math.max(X[1],Y[1]),W[2]=Math.max(X[2],Y[2]),W},V.round=function(W,X){return W[0]=Math.round(X[0]),W[1]=Math.round(X[1]),W[2]=Math.round(X[2]),W},V.scale=function(W,X,Y){return W[0]=X[0]*Y,W[1]=X[1]*Y,W[2]=X[2]*Y,W},V.scaleAndAdd=function(W,X,Y,Z){return W[0]=X[0]+Y[0]*Z,W[1]=X[1]+Y[1]*Z,W[2]=X[2]+Y[2]*Z,W},V.distance=function(W,X){var Y=X[0]-W[0],Z=X[1]-W[1],K=X[2]-W[2];return Math.sqrt(Y*Y+Z*Z+K*K)},V.dist=V.distance,V.squaredDistance=function(W,X){var Y=X[0]-W[0],Z=X[1]-W[1],K=X[2]-W[2];return Y*Y+Z*Z+K*K},V.sqrDist=V.squaredDistance,V.length=function(W){var X=W[0],Y=W[1],Z=W[2];return Math.sqrt(X*X+Y*Y+Z*Z)},V.len=V.length,V.squaredLength=function(W){var X=W[0],Y=W[1],Z=W[2];return X*X+Y*Y+Z*Z},V.sqrLen=V.squaredLength,V.negate=function(W,X){return W[0]=-X[0],W[1]=-X[1],W[2]=-X[2],W},V.inverse=function(W,X){return W[0]=1/X[0],W[1]=1/X[1],W[2]=1/X[2],W},V.normalize=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=Y*Y+Z*Z+K*K;return 0<Q&&(Q=1/Math.sqrt(Q),W[0]=X[0]*Q,W[1]=X[1]*Q,W[2]=X[2]*Q),W},V.dot=function(W,X){return W[0]*X[0]+W[1]*X[1]+W[2]*X[2]},V.cross=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=Y[0],$=Y[1],ee=Y[2];return W[0]=K*ee-Q*$,W[1]=Q*J-Z*ee,W[2]=Z*$-K*J,W},V.lerp=function(W,X,Y,Z){var K=X[0],Q=X[1],J=X[2];return W[0]=K+Z*(Y[0]-K),W[1]=Q+Z*(Y[1]-Q),W[2]=J+Z*(Y[2]-J),W},V.hermite=function(W,X,Y,Z,K,Q){var J=Q*Q,$=J*(2*Q-3)+1,ee=J*(Q-2)+Q,oe=J*(Q-1),ie=J*(3-2*Q);return W[0]=X[0]*$+Y[0]*ee+Z[0]*oe+K[0]*ie,W[1]=X[1]*$+Y[1]*ee+Z[1]*oe+K[1]*ie,W[2]=X[2]*$+Y[2]*ee+Z[2]*oe+K[2]*ie,W},V.bezier=function(W,X,Y,Z,K,Q){var J=1-Q,$=J*J,ee=Q*Q,oe=$*J,ie=3*Q*$,ne=3*ee*J,se=ee*Q;return W[0]=X[0]*oe+Y[0]*ie+Z[0]*ne+K[0]*se,W[1]=X[1]*oe+Y[1]*ie+Z[1]*ne+K[1]*se,W[2]=X[2]*oe+Y[2]*ie+Z[2]*ne+K[2]*se,W},V.random=function(W,X){X=X||1;var Y=2*O.RANDOM()*Math.PI,Z=2*O.RANDOM()-1,K=Math.sqrt(1-Z*Z)*X;return W[0]=Math.cos(Y)*K,W[1]=Math.sin(Y)*K,W[2]=Z*X,W},V.transformMat4=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=Y[3]*Z+Y[7]*K+Y[11]*Q+Y[15];return J=J||1,W[0]=(Y[0]*Z+Y[4]*K+Y[8]*Q+Y[12])/J,W[1]=(Y[1]*Z+Y[5]*K+Y[9]*Q+Y[13])/J,W[2]=(Y[2]*Z+Y[6]*K+Y[10]*Q+Y[14])/J,W},V.transformMat3=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2];return W[0]=Z*Y[0]+K*Y[3]+Q*Y[6],W[1]=Z*Y[1]+K*Y[4]+Q*Y[7],W[2]=Z*Y[2]+K*Y[5]+Q*Y[8],W},V.transformQuat=function(W,X,Y){// benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations
var Z=X[0],K=X[1],Q=X[2],J=Y[0],$=Y[1],ee=Y[2],oe=Y[3],// calculate quat * vec
ie=oe*Z+$*Q-ee*K,ne=oe*K+ee*Z-J*Q,se=oe*Q+J*K-$*Z,le=-J*Z-$*K-ee*Q;// calculate result * inverse quat
return W[0]=ie*oe+le*-J+ne*-ee-se*-$,W[1]=ne*oe+le*-$+se*-J-ie*-ee,W[2]=se*oe+le*-ee+ie*-$-ne*-J,W},V.rotateX=function(W,X,Y,Z){var K=[],Q=[];//Translate point to the origin
return K[0]=X[0]-Y[0],K[1]=X[1]-Y[1],K[2]=X[2]-Y[2],Q[0]=K[0],Q[1]=K[1]*Math.cos(Z)-K[2]*Math.sin(Z),Q[2]=K[1]*Math.sin(Z)+K[2]*Math.cos(Z),W[0]=Q[0]+Y[0],W[1]=Q[1]+Y[1],W[2]=Q[2]+Y[2],W},V.rotateY=function(W,X,Y,Z){var K=[],Q=[];//Translate point to the origin
return K[0]=X[0]-Y[0],K[1]=X[1]-Y[1],K[2]=X[2]-Y[2],Q[0]=K[2]*Math.sin(Z)+K[0]*Math.cos(Z),Q[1]=K[1],Q[2]=K[2]*Math.cos(Z)-K[0]*Math.sin(Z),W[0]=Q[0]+Y[0],W[1]=Q[1]+Y[1],W[2]=Q[2]+Y[2],W},V.rotateZ=function(W,X,Y,Z){var K=[],Q=[];//Translate point to the origin
return K[0]=X[0]-Y[0],K[1]=X[1]-Y[1],K[2]=X[2]-Y[2],Q[0]=K[0]*Math.cos(Z)-K[1]*Math.sin(Z),Q[1]=K[0]*Math.sin(Z)+K[1]*Math.cos(Z),Q[2]=K[2],W[0]=Q[0]+Y[0],W[1]=Q[1]+Y[1],W[2]=Q[2]+Y[2],W},V.forEach=function(){var W=V.create();return function(X,Y,Z,K,Q,J){var $,ee;for(Y||(Y=3),Z||(Z=0),ee=K?Math.min(K*Y+Z,X.length):X.length,$=Z;$<ee;$+=Y)W[0]=X[$],W[1]=X[$+1],W[2]=X[$+2],Q(W,W,J),X[$]=W[0],X[$+1]=W[1],X[$+2]=W[2];return X}}(),V.angle=function(W,X){var Y=V.fromValues(W[0],W[1],W[2]),Z=V.fromValues(X[0],X[1],X[2]);V.normalize(Y,Y),V.normalize(Z,Z);var K=V.dot(Y,Z);return 1<K?0:Math.acos(K)},V.str=function(W){return"vec3("+W[0]+", "+W[1]+", "+W[2]+")"},V.exactEquals=function(W,X){return W[0]===X[0]&&W[1]===X[1]&&W[2]===X[2]},V.equals=function(W,X){var Y=W[0],Z=W[1],K=W[2],Q=X[0],J=X[1],$=X[2];return Math.abs(Y-Q)<=O.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Q))&&Math.abs(Z-J)<=O.EPSILON*Math.max(1,Math.abs(Z),Math.abs(J))&&Math.abs(K-$)<=O.EPSILON*Math.max(1,Math.abs(K),Math.abs($))},F.exports=V,F.exports}),E.registerDynamic("6",[],!0,function(C,G,F){var H=this||self,O={};/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
  
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE. *//**
   * @class Common utilities
   * @name glMatrix
   */O.EPSILON=1e-6,O.ARRAY_TYPE="undefined"==typeof Float32Array?Array:Float32Array,O.RANDOM=Math.random,O.ENABLE_SIMD=!1,O.SIMD_AVAILABLE=O.ARRAY_TYPE===Float32Array&&"SIMD"in this,O.USE_SIMD=O.ENABLE_SIMD&&O.SIMD_AVAILABLE,O.setMatrixArrayType=function(W){O.ARRAY_TYPE=W};var V=Math.PI/180;/**
  * Convert Degree To Radian
  *
  * @param {Number} Angle in Degrees
  */return O.toRadian=function(W){return W*V},O.equals=function(W,X){return Math.abs(W-X)<=O.EPSILON*Math.max(1,Math.abs(W),Math.abs(X))},F.exports=O,F.exports}),E.registerDynamic("c",["6"],!0,function(C,G,F){var H=this||self,O=C("6"),V={};/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE. *//**
     * @class 4 Dimensional Vector
     * @name vec4
     *//**
     * Creates a new, empty vec4
     *
     * @returns {vec4} a new 4D vector
     */return V.create=function(){var W=new O.ARRAY_TYPE(4);return W[0]=0,W[1]=0,W[2]=0,W[3]=0,W},V.clone=function(W){var X=new O.ARRAY_TYPE(4);return X[0]=W[0],X[1]=W[1],X[2]=W[2],X[3]=W[3],X},V.fromValues=function(W,X,Y,Z){var K=new O.ARRAY_TYPE(4);return K[0]=W,K[1]=X,K[2]=Y,K[3]=Z,K},V.copy=function(W,X){return W[0]=X[0],W[1]=X[1],W[2]=X[2],W[3]=X[3],W},V.set=function(W,X,Y,Z,K){return W[0]=X,W[1]=Y,W[2]=Z,W[3]=K,W},V.add=function(W,X,Y){return W[0]=X[0]+Y[0],W[1]=X[1]+Y[1],W[2]=X[2]+Y[2],W[3]=X[3]+Y[3],W},V.subtract=function(W,X,Y){return W[0]=X[0]-Y[0],W[1]=X[1]-Y[1],W[2]=X[2]-Y[2],W[3]=X[3]-Y[3],W},V.sub=V.subtract,V.multiply=function(W,X,Y){return W[0]=X[0]*Y[0],W[1]=X[1]*Y[1],W[2]=X[2]*Y[2],W[3]=X[3]*Y[3],W},V.mul=V.multiply,V.divide=function(W,X,Y){return W[0]=X[0]/Y[0],W[1]=X[1]/Y[1],W[2]=X[2]/Y[2],W[3]=X[3]/Y[3],W},V.div=V.divide,V.ceil=function(W,X){return W[0]=Math.ceil(X[0]),W[1]=Math.ceil(X[1]),W[2]=Math.ceil(X[2]),W[3]=Math.ceil(X[3]),W},V.floor=function(W,X){return W[0]=Math.floor(X[0]),W[1]=Math.floor(X[1]),W[2]=Math.floor(X[2]),W[3]=Math.floor(X[3]),W},V.min=function(W,X,Y){return W[0]=Math.min(X[0],Y[0]),W[1]=Math.min(X[1],Y[1]),W[2]=Math.min(X[2],Y[2]),W[3]=Math.min(X[3],Y[3]),W},V.max=function(W,X,Y){return W[0]=Math.max(X[0],Y[0]),W[1]=Math.max(X[1],Y[1]),W[2]=Math.max(X[2],Y[2]),W[3]=Math.max(X[3],Y[3]),W},V.round=function(W,X){return W[0]=Math.round(X[0]),W[1]=Math.round(X[1]),W[2]=Math.round(X[2]),W[3]=Math.round(X[3]),W},V.scale=function(W,X,Y){return W[0]=X[0]*Y,W[1]=X[1]*Y,W[2]=X[2]*Y,W[3]=X[3]*Y,W},V.scaleAndAdd=function(W,X,Y,Z){return W[0]=X[0]+Y[0]*Z,W[1]=X[1]+Y[1]*Z,W[2]=X[2]+Y[2]*Z,W[3]=X[3]+Y[3]*Z,W},V.distance=function(W,X){var Y=X[0]-W[0],Z=X[1]-W[1],K=X[2]-W[2],Q=X[3]-W[3];return Math.sqrt(Y*Y+Z*Z+K*K+Q*Q)},V.dist=V.distance,V.squaredDistance=function(W,X){var Y=X[0]-W[0],Z=X[1]-W[1],K=X[2]-W[2],Q=X[3]-W[3];return Y*Y+Z*Z+K*K+Q*Q},V.sqrDist=V.squaredDistance,V.length=function(W){var X=W[0],Y=W[1],Z=W[2],K=W[3];return Math.sqrt(X*X+Y*Y+Z*Z+K*K)},V.len=V.length,V.squaredLength=function(W){var X=W[0],Y=W[1],Z=W[2],K=W[3];return X*X+Y*Y+Z*Z+K*K},V.sqrLen=V.squaredLength,V.negate=function(W,X){return W[0]=-X[0],W[1]=-X[1],W[2]=-X[2],W[3]=-X[3],W},V.inverse=function(W,X){return W[0]=1/X[0],W[1]=1/X[1],W[2]=1/X[2],W[3]=1/X[3],W},V.normalize=function(W,X){var Y=X[0],Z=X[1],K=X[2],Q=X[3],J=Y*Y+Z*Z+K*K+Q*Q;return 0<J&&(J=1/Math.sqrt(J),W[0]=Y*J,W[1]=Z*J,W[2]=K*J,W[3]=Q*J),W},V.dot=function(W,X){return W[0]*X[0]+W[1]*X[1]+W[2]*X[2]+W[3]*X[3]},V.lerp=function(W,X,Y,Z){var K=X[0],Q=X[1],J=X[2],$=X[3];return W[0]=K+Z*(Y[0]-K),W[1]=Q+Z*(Y[1]-Q),W[2]=J+Z*(Y[2]-J),W[3]=$+Z*(Y[3]-$),W},V.random=function(W,X){return X=X||1,W[0]=O.RANDOM(),W[1]=O.RANDOM(),W[2]=O.RANDOM(),W[3]=O.RANDOM(),V.normalize(W,W),V.scale(W,W,X),W},V.transformMat4=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=X[3];return W[0]=Y[0]*Z+Y[4]*K+Y[8]*Q+Y[12]*J,W[1]=Y[1]*Z+Y[5]*K+Y[9]*Q+Y[13]*J,W[2]=Y[2]*Z+Y[6]*K+Y[10]*Q+Y[14]*J,W[3]=Y[3]*Z+Y[7]*K+Y[11]*Q+Y[15]*J,W},V.transformQuat=function(W,X,Y){var Z=X[0],K=X[1],Q=X[2],J=Y[0],$=Y[1],ee=Y[2],oe=Y[3],// calculate quat * vec
ie=oe*Z+$*Q-ee*K,ne=oe*K+ee*Z-J*Q,se=oe*Q+J*K-$*Z,le=-J*Z-$*K-ee*Q;// calculate result * inverse quat
return W[0]=ie*oe+le*-J+ne*-ee-se*-$,W[1]=ne*oe+le*-$+se*-J-ie*-ee,W[2]=se*oe+le*-ee+ie*-$-ne*-J,W[3]=X[3],W},V.forEach=function(){var W=V.create();return function(X,Y,Z,K,Q,J){var $,ee;for(Y||(Y=4),Z||(Z=0),ee=K?Math.min(K*Y+Z,X.length):X.length,$=Z;$<ee;$+=Y)W[0]=X[$],W[1]=X[$+1],W[2]=X[$+2],W[3]=X[$+3],Q(W,W,J),X[$]=W[0],X[$+1]=W[1],X[$+2]=W[2],X[$+3]=W[3];return X}}(),V.str=function(W){return"vec4("+W[0]+", "+W[1]+", "+W[2]+", "+W[3]+")"},V.exactEquals=function(W,X){return W[0]===X[0]&&W[1]===X[1]&&W[2]===X[2]&&W[3]===X[3]},V.equals=function(W,X){var Y=W[0],Z=W[1],K=W[2],Q=W[3],J=X[0],$=X[1],ee=X[2],oe=X[3];return Math.abs(Y-J)<=O.EPSILON*Math.max(1,Math.abs(Y),Math.abs(J))&&Math.abs(Z-$)<=O.EPSILON*Math.max(1,Math.abs(Z),Math.abs($))&&Math.abs(K-ee)<=O.EPSILON*Math.max(1,Math.abs(K),Math.abs(ee))&&Math.abs(Q-oe)<=O.EPSILON*Math.max(1,Math.abs(Q),Math.abs(oe))},F.exports=V,F.exports}),E.registerDynamic("e",["6","5","7","9","8","a","d","b","c"],!0,function(C,G,F){var H=this||self;/**
   * @fileoverview gl-matrix - High performance matrix and vector operations
   * @author Brandon Jones
   * @author Colin MacKenzie IV
   * @version 2.3.2
   *//* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
  
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE. */// END HEADER
return G.glMatrix=C("6"),G.mat2=C("5"),G.mat2d=C("7"),G.mat3=C("9"),G.mat4=C("8"),G.quat=C("a"),G.vec2=C("d"),G.vec3=C("b"),G.vec4=C("c"),F.exports}),function(){var C=E.amdDefine;(function(G,F){G("f",[],function(){"use strict";function H(K,Q){return null!=K&&null!=Q&&K.toLowerCase()===Q.toLowerCase()}function O(K,Q){var ee=K.length,J,$;if(!ee||!Q)return!1;for(J=Q.toLowerCase(),$=0;$<ee;++$)if(J===K[$].toLowerCase())return!0;return!1}function V(K){for(var Q in K)Y.call(K,Q)&&(K[Q]=new RegExp(K[Q],"i"))}function W(K,Q){this.ua=K||"",this._cache={},this.maxPhoneWidth=Q||600}var X={};X.mobileDetectRules={phones:{iPhone:"\\biPhone\\b|\\biPod\\b",BlackBerry:"BlackBerry|\\bBB10\\b|rim[0-9]+",HTC:"HTC|HTC.*(Sensation|Evo|Vision|Explorer|6800|8100|8900|A7272|S510e|C110e|Legend|Desire|T8282)|APX515CKT|Qtek9090|APA9292KT|HD_mini|Sensation.*Z710e|PG86100|Z715e|Desire.*(A8181|HD)|ADR6200|ADR6400L|ADR6425|001HT|Inspire 4G|Android.*\\bEVO\\b|T-Mobile G1|Z520m",Nexus:"Nexus One|Nexus S|Galaxy.*Nexus|Android.*Nexus.*Mobile|Nexus 4|Nexus 5|Nexus 6",Dell:"Dell.*Streak|Dell.*Aero|Dell.*Venue|DELL.*Venue Pro|Dell Flash|Dell Smoke|Dell Mini 3iX|XCD28|XCD35|\\b001DL\\b|\\b101DL\\b|\\bGS01\\b",Motorola:"Motorola|DROIDX|DROID BIONIC|\\bDroid\\b.*Build|Android.*Xoom|HRI39|MOT-|A1260|A1680|A555|A853|A855|A953|A955|A956|Motorola.*ELECTRIFY|Motorola.*i1|i867|i940|MB200|MB300|MB501|MB502|MB508|MB511|MB520|MB525|MB526|MB611|MB612|MB632|MB810|MB855|MB860|MB861|MB865|MB870|ME501|ME502|ME511|ME525|ME600|ME632|ME722|ME811|ME860|ME863|ME865|MT620|MT710|MT716|MT720|MT810|MT870|MT917|Motorola.*TITANIUM|WX435|WX445|XT300|XT301|XT311|XT316|XT317|XT319|XT320|XT390|XT502|XT530|XT531|XT532|XT535|XT603|XT610|XT611|XT615|XT681|XT701|XT702|XT711|XT720|XT800|XT806|XT860|XT862|XT875|XT882|XT883|XT894|XT901|XT907|XT909|XT910|XT912|XT928|XT926|XT915|XT919|XT925|XT1021|\\bMoto E\\b",Samsung:"\\bSamsung\\b|SM-G9250|GT-19300|SGH-I337|BGT-S5230|GT-B2100|GT-B2700|GT-B2710|GT-B3210|GT-B3310|GT-B3410|GT-B3730|GT-B3740|GT-B5510|GT-B5512|GT-B5722|GT-B6520|GT-B7300|GT-B7320|GT-B7330|GT-B7350|GT-B7510|GT-B7722|GT-B7800|GT-C3010|GT-C3011|GT-C3060|GT-C3200|GT-C3212|GT-C3212I|GT-C3262|GT-C3222|GT-C3300|GT-C3300K|GT-C3303|GT-C3303K|GT-C3310|GT-C3322|GT-C3330|GT-C3350|GT-C3500|GT-C3510|GT-C3530|GT-C3630|GT-C3780|GT-C5010|GT-C5212|GT-C6620|GT-C6625|GT-C6712|GT-E1050|GT-E1070|GT-E1075|GT-E1080|GT-E1081|GT-E1085|GT-E1087|GT-E1100|GT-E1107|GT-E1110|GT-E1120|GT-E1125|GT-E1130|GT-E1160|GT-E1170|GT-E1175|GT-E1180|GT-E1182|GT-E1200|GT-E1210|GT-E1225|GT-E1230|GT-E1390|GT-E2100|GT-E2120|GT-E2121|GT-E2152|GT-E2220|GT-E2222|GT-E2230|GT-E2232|GT-E2250|GT-E2370|GT-E2550|GT-E2652|GT-E3210|GT-E3213|GT-I5500|GT-I5503|GT-I5700|GT-I5800|GT-I5801|GT-I6410|GT-I6420|GT-I7110|GT-I7410|GT-I7500|GT-I8000|GT-I8150|GT-I8160|GT-I8190|GT-I8320|GT-I8330|GT-I8350|GT-I8530|GT-I8700|GT-I8703|GT-I8910|GT-I9000|GT-I9001|GT-I9003|GT-I9010|GT-I9020|GT-I9023|GT-I9070|GT-I9082|GT-I9100|GT-I9103|GT-I9220|GT-I9250|GT-I9300|GT-I9305|GT-I9500|GT-I9505|GT-M3510|GT-M5650|GT-M7500|GT-M7600|GT-M7603|GT-M8800|GT-M8910|GT-N7000|GT-S3110|GT-S3310|GT-S3350|GT-S3353|GT-S3370|GT-S3650|GT-S3653|GT-S3770|GT-S3850|GT-S5210|GT-S5220|GT-S5229|GT-S5230|GT-S5233|GT-S5250|GT-S5253|GT-S5260|GT-S5263|GT-S5270|GT-S5300|GT-S5330|GT-S5350|GT-S5360|GT-S5363|GT-S5369|GT-S5380|GT-S5380D|GT-S5560|GT-S5570|GT-S5600|GT-S5603|GT-S5610|GT-S5620|GT-S5660|GT-S5670|GT-S5690|GT-S5750|GT-S5780|GT-S5830|GT-S5839|GT-S6102|GT-S6500|GT-S7070|GT-S7200|GT-S7220|GT-S7230|GT-S7233|GT-S7250|GT-S7500|GT-S7530|GT-S7550|GT-S7562|GT-S7710|GT-S8000|GT-S8003|GT-S8500|GT-S8530|GT-S8600|SCH-A310|SCH-A530|SCH-A570|SCH-A610|SCH-A630|SCH-A650|SCH-A790|SCH-A795|SCH-A850|SCH-A870|SCH-A890|SCH-A930|SCH-A950|SCH-A970|SCH-A990|SCH-I100|SCH-I110|SCH-I400|SCH-I405|SCH-I500|SCH-I510|SCH-I515|SCH-I600|SCH-I730|SCH-I760|SCH-I770|SCH-I830|SCH-I910|SCH-I920|SCH-I959|SCH-LC11|SCH-N150|SCH-N300|SCH-R100|SCH-R300|SCH-R351|SCH-R400|SCH-R410|SCH-T300|SCH-U310|SCH-U320|SCH-U350|SCH-U360|SCH-U365|SCH-U370|SCH-U380|SCH-U410|SCH-U430|SCH-U450|SCH-U460|SCH-U470|SCH-U490|SCH-U540|SCH-U550|SCH-U620|SCH-U640|SCH-U650|SCH-U660|SCH-U700|SCH-U740|SCH-U750|SCH-U810|SCH-U820|SCH-U900|SCH-U940|SCH-U960|SCS-26UC|SGH-A107|SGH-A117|SGH-A127|SGH-A137|SGH-A157|SGH-A167|SGH-A177|SGH-A187|SGH-A197|SGH-A227|SGH-A237|SGH-A257|SGH-A437|SGH-A517|SGH-A597|SGH-A637|SGH-A657|SGH-A667|SGH-A687|SGH-A697|SGH-A707|SGH-A717|SGH-A727|SGH-A737|SGH-A747|SGH-A767|SGH-A777|SGH-A797|SGH-A817|SGH-A827|SGH-A837|SGH-A847|SGH-A867|SGH-A877|SGH-A887|SGH-A897|SGH-A927|SGH-B100|SGH-B130|SGH-B200|SGH-B220|SGH-C100|SGH-C110|SGH-C120|SGH-C130|SGH-C140|SGH-C160|SGH-C170|SGH-C180|SGH-C200|SGH-C207|SGH-C210|SGH-C225|SGH-C230|SGH-C417|SGH-C450|SGH-D307|SGH-D347|SGH-D357|SGH-D407|SGH-D415|SGH-D780|SGH-D807|SGH-D980|SGH-E105|SGH-E200|SGH-E315|SGH-E316|SGH-E317|SGH-E335|SGH-E590|SGH-E635|SGH-E715|SGH-E890|SGH-F300|SGH-F480|SGH-I200|SGH-I300|SGH-I320|SGH-I550|SGH-I577|SGH-I600|SGH-I607|SGH-I617|SGH-I627|SGH-I637|SGH-I677|SGH-I700|SGH-I717|SGH-I727|SGH-i747M|SGH-I777|SGH-I780|SGH-I827|SGH-I847|SGH-I857|SGH-I896|SGH-I897|SGH-I900|SGH-I907|SGH-I917|SGH-I927|SGH-I937|SGH-I997|SGH-J150|SGH-J200|SGH-L170|SGH-L700|SGH-M110|SGH-M150|SGH-M200|SGH-N105|SGH-N500|SGH-N600|SGH-N620|SGH-N625|SGH-N700|SGH-N710|SGH-P107|SGH-P207|SGH-P300|SGH-P310|SGH-P520|SGH-P735|SGH-P777|SGH-Q105|SGH-R210|SGH-R220|SGH-R225|SGH-S105|SGH-S307|SGH-T109|SGH-T119|SGH-T139|SGH-T209|SGH-T219|SGH-T229|SGH-T239|SGH-T249|SGH-T259|SGH-T309|SGH-T319|SGH-T329|SGH-T339|SGH-T349|SGH-T359|SGH-T369|SGH-T379|SGH-T409|SGH-T429|SGH-T439|SGH-T459|SGH-T469|SGH-T479|SGH-T499|SGH-T509|SGH-T519|SGH-T539|SGH-T559|SGH-T589|SGH-T609|SGH-T619|SGH-T629|SGH-T639|SGH-T659|SGH-T669|SGH-T679|SGH-T709|SGH-T719|SGH-T729|SGH-T739|SGH-T746|SGH-T749|SGH-T759|SGH-T769|SGH-T809|SGH-T819|SGH-T839|SGH-T919|SGH-T929|SGH-T939|SGH-T959|SGH-T989|SGH-U100|SGH-U200|SGH-U800|SGH-V205|SGH-V206|SGH-X100|SGH-X105|SGH-X120|SGH-X140|SGH-X426|SGH-X427|SGH-X475|SGH-X495|SGH-X497|SGH-X507|SGH-X600|SGH-X610|SGH-X620|SGH-X630|SGH-X700|SGH-X820|SGH-X890|SGH-Z130|SGH-Z150|SGH-Z170|SGH-ZX10|SGH-ZX20|SHW-M110|SPH-A120|SPH-A400|SPH-A420|SPH-A460|SPH-A500|SPH-A560|SPH-A600|SPH-A620|SPH-A660|SPH-A700|SPH-A740|SPH-A760|SPH-A790|SPH-A800|SPH-A820|SPH-A840|SPH-A880|SPH-A900|SPH-A940|SPH-A960|SPH-D600|SPH-D700|SPH-D710|SPH-D720|SPH-I300|SPH-I325|SPH-I330|SPH-I350|SPH-I500|SPH-I600|SPH-I700|SPH-L700|SPH-M100|SPH-M220|SPH-M240|SPH-M300|SPH-M305|SPH-M320|SPH-M330|SPH-M350|SPH-M360|SPH-M370|SPH-M380|SPH-M510|SPH-M540|SPH-M550|SPH-M560|SPH-M570|SPH-M580|SPH-M610|SPH-M620|SPH-M630|SPH-M800|SPH-M810|SPH-M850|SPH-M900|SPH-M910|SPH-M920|SPH-M930|SPH-N100|SPH-N200|SPH-N240|SPH-N300|SPH-N400|SPH-Z400|SWC-E100|SCH-i909|GT-N7100|GT-N7105|SCH-I535|SM-N900A|SGH-I317|SGH-T999L|GT-S5360B|GT-I8262|GT-S6802|GT-S6312|GT-S6310|GT-S5312|GT-S5310|GT-I9105|GT-I8510|GT-S6790N|SM-G7105|SM-N9005|GT-S5301|GT-I9295|GT-I9195|SM-C101|GT-S7392|GT-S7560|GT-B7610|GT-I5510|GT-S7582|GT-S7530E|GT-I8750|SM-G9006V|SM-G9008V|SM-G9009D|SM-G900A|SM-G900D|SM-G900F|SM-G900H|SM-G900I|SM-G900J|SM-G900K|SM-G900L|SM-G900M|SM-G900P|SM-G900R4|SM-G900S|SM-G900T|SM-G900V|SM-G900W8|SHV-E160K|SCH-P709|SCH-P729|SM-T2558|GT-I9205|SM-G9350|SM-J120F",LG:"\\bLG\\b;|LG[- ]?(C800|C900|E400|E610|E900|E-900|F160|F180K|F180L|F180S|730|855|L160|LS740|LS840|LS970|LU6200|MS690|MS695|MS770|MS840|MS870|MS910|P500|P700|P705|VM696|AS680|AS695|AX840|C729|E970|GS505|272|C395|E739BK|E960|L55C|L75C|LS696|LS860|P769BK|P350|P500|P509|P870|UN272|US730|VS840|VS950|LN272|LN510|LS670|LS855|LW690|MN270|MN510|P509|P769|P930|UN200|UN270|UN510|UN610|US670|US740|US760|UX265|UX840|VN271|VN530|VS660|VS700|VS740|VS750|VS910|VS920|VS930|VX9200|VX11000|AX840A|LW770|P506|P925|P999|E612|D955|D802|MS323)",Sony:"SonyST|SonyLT|SonyEricsson|SonyEricssonLT15iv|LT18i|E10i|LT28h|LT26w|SonyEricssonMT27i|C5303|C6902|C6903|C6906|C6943|D2533",Asus:"Asus.*Galaxy|PadFone.*Mobile",NokiaLumia:"Lumia [0-9]{3,4}",Micromax:"Micromax.*\\b(A210|A92|A88|A72|A111|A110Q|A115|A116|A110|A90S|A26|A51|A35|A54|A25|A27|A89|A68|A65|A57|A90)\\b",Palm:"PalmSource|Palm",Vertu:"Vertu|Vertu.*Ltd|Vertu.*Ascent|Vertu.*Ayxta|Vertu.*Constellation(F|Quest)?|Vertu.*Monika|Vertu.*Signature",Pantech:"PANTECH|IM-A850S|IM-A840S|IM-A830L|IM-A830K|IM-A830S|IM-A820L|IM-A810K|IM-A810S|IM-A800S|IM-T100K|IM-A725L|IM-A780L|IM-A775C|IM-A770K|IM-A760S|IM-A750K|IM-A740S|IM-A730S|IM-A720L|IM-A710K|IM-A690L|IM-A690S|IM-A650S|IM-A630K|IM-A600S|VEGA PTL21|PT003|P8010|ADR910L|P6030|P6020|P9070|P4100|P9060|P5000|CDM8992|TXT8045|ADR8995|IS11PT|P2030|P6010|P8000|PT002|IS06|CDM8999|P9050|PT001|TXT8040|P2020|P9020|P2000|P7040|P7000|C790",Fly:"IQ230|IQ444|IQ450|IQ440|IQ442|IQ441|IQ245|IQ256|IQ236|IQ255|IQ235|IQ245|IQ275|IQ240|IQ285|IQ280|IQ270|IQ260|IQ250",Wiko:"KITE 4G|HIGHWAY|GETAWAY|STAIRWAY|DARKSIDE|DARKFULL|DARKNIGHT|DARKMOON|SLIDE|WAX 4G|RAINBOW|BLOOM|SUNSET|GOA(?!nna)|LENNY|BARRY|IGGY|OZZY|CINK FIVE|CINK PEAX|CINK PEAX 2|CINK SLIM|CINK SLIM 2|CINK +|CINK KING|CINK PEAX|CINK SLIM|SUBLIM",iMobile:"i-mobile (IQ|i-STYLE|idea|ZAA|Hitz)",SimValley:"\\b(SP-80|XT-930|SX-340|XT-930|SX-310|SP-360|SP60|SPT-800|SP-120|SPT-800|SP-140|SPX-5|SPX-8|SP-100|SPX-8|SPX-12)\\b",Wolfgang:"AT-B24D|AT-AS50HD|AT-AS40W|AT-AS55HD|AT-AS45q2|AT-B26D|AT-AS50Q",Alcatel:"Alcatel",Nintendo:"Nintendo 3DS",Amoi:"Amoi",INQ:"INQ",GenericPhone:"Tapatalk|PDA;|SAGEM|\\bmmp\\b|pocket|\\bpsp\\b|symbian|Smartphone|smartfon|treo|up.browser|up.link|vodafone|\\bwap\\b|nokia|Series40|Series60|S60|SonyEricsson|N900|MAUI.*WAP.*Browser"},tablets:{iPad:"iPad|iPad.*Mobile",NexusTablet:"Android.*Nexus[\\s]+(7|9|10)",SamsungTablet:"SAMSUNG.*Tablet|Galaxy.*Tab|SC-01C|GT-P1000|GT-P1003|GT-P1010|GT-P3105|GT-P6210|GT-P6800|GT-P6810|GT-P7100|GT-P7300|GT-P7310|GT-P7500|GT-P7510|SCH-I800|SCH-I815|SCH-I905|SGH-I957|SGH-I987|SGH-T849|SGH-T859|SGH-T869|SPH-P100|GT-P3100|GT-P3108|GT-P3110|GT-P5100|GT-P5110|GT-P6200|GT-P7320|GT-P7511|GT-N8000|GT-P8510|SGH-I497|SPH-P500|SGH-T779|SCH-I705|SCH-I915|GT-N8013|GT-P3113|GT-P5113|GT-P8110|GT-N8010|GT-N8005|GT-N8020|GT-P1013|GT-P6201|GT-P7501|GT-N5100|GT-N5105|GT-N5110|SHV-E140K|SHV-E140L|SHV-E140S|SHV-E150S|SHV-E230K|SHV-E230L|SHV-E230S|SHW-M180K|SHW-M180L|SHW-M180S|SHW-M180W|SHW-M300W|SHW-M305W|SHW-M380K|SHW-M380S|SHW-M380W|SHW-M430W|SHW-M480K|SHW-M480S|SHW-M480W|SHW-M485W|SHW-M486W|SHW-M500W|GT-I9228|SCH-P739|SCH-I925|GT-I9200|GT-P5200|GT-P5210|GT-P5210X|SM-T311|SM-T310|SM-T310X|SM-T210|SM-T210R|SM-T211|SM-P600|SM-P601|SM-P605|SM-P900|SM-P901|SM-T217|SM-T217A|SM-T217S|SM-P6000|SM-T3100|SGH-I467|XE500|SM-T110|GT-P5220|GT-I9200X|GT-N5110X|GT-N5120|SM-P905|SM-T111|SM-T2105|SM-T315|SM-T320|SM-T320X|SM-T321|SM-T520|SM-T525|SM-T530NU|SM-T230NU|SM-T330NU|SM-T900|XE500T1C|SM-P605V|SM-P905V|SM-T337V|SM-T537V|SM-T707V|SM-T807V|SM-P600X|SM-P900X|SM-T210X|SM-T230|SM-T230X|SM-T325|GT-P7503|SM-T531|SM-T330|SM-T530|SM-T705|SM-T705C|SM-T535|SM-T331|SM-T800|SM-T700|SM-T537|SM-T807|SM-P907A|SM-T337A|SM-T537A|SM-T707A|SM-T807A|SM-T237|SM-T807P|SM-P607T|SM-T217T|SM-T337T|SM-T807T|SM-T116NQ|SM-P550|SM-T350|SM-T550|SM-T9000|SM-P9000|SM-T705Y|SM-T805|GT-P3113|SM-T710|SM-T810|SM-T815|SM-T360|SM-T533|SM-T113|SM-T335|SM-T715|SM-T560|SM-T670|SM-T677|SM-T377|SM-T567|SM-T357T|SM-T555|SM-T561|SM-T713|SM-T719|SM-T813|SM-T819|SM-T580|SM-T355Y|SM-T280",Kindle:"Kindle|Silk.*Accelerated|Android.*\\b(KFOT|KFTT|KFJWI|KFJWA|KFOTE|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|WFJWAE|KFSAWA|KFSAWI|KFASWI|KFARWI)\\b",SurfaceTablet:"Windows NT [0-9.]+; ARM;.*(Tablet|ARMBJS)",HPTablet:"HP Slate (7|8|10)|HP ElitePad 900|hp-tablet|EliteBook.*Touch|HP 8|Slate 21|HP SlateBook 10",AsusTablet:"^.*PadFone((?!Mobile).)*$|Transformer|TF101|TF101G|TF300T|TF300TG|TF300TL|TF700T|TF700KL|TF701T|TF810C|ME171|ME301T|ME302C|ME371MG|ME370T|ME372MG|ME172V|ME173X|ME400C|Slider SL101|\\bK00F\\b|\\bK00C\\b|\\bK00E\\b|\\bK00L\\b|TX201LA|ME176C|ME102A|\\bM80TA\\b|ME372CL|ME560CG|ME372CG|ME302KL| K010 | K011 | K017 | K01E |ME572C|ME103K|ME170C|ME171C|\\bME70C\\b|ME581C|ME581CL|ME8510C|ME181C|P01Y|PO1MA|P01Z",BlackBerryTablet:"PlayBook|RIM Tablet",HTCtablet:"HTC_Flyer_P512|HTC Flyer|HTC Jetstream|HTC-P715a|HTC EVO View 4G|PG41200|PG09410",MotorolaTablet:"xoom|sholest|MZ615|MZ605|MZ505|MZ601|MZ602|MZ603|MZ604|MZ606|MZ607|MZ608|MZ609|MZ615|MZ616|MZ617",NookTablet:"Android.*Nook|NookColor|nook browser|BNRV200|BNRV200A|BNTV250|BNTV250A|BNTV400|BNTV600|LogicPD Zoom2",AcerTablet:"Android.*; \\b(A100|A101|A110|A200|A210|A211|A500|A501|A510|A511|A700|A701|W500|W500P|W501|W501P|W510|W511|W700|G100|G100W|B1-A71|B1-710|B1-711|A1-810|A1-811|A1-830)\\b|W3-810|\\bA3-A10\\b|\\bA3-A11\\b|\\bA3-A20\\b|\\bA3-A30",ToshibaTablet:"Android.*(AT100|AT105|AT200|AT205|AT270|AT275|AT300|AT305|AT1S5|AT500|AT570|AT700|AT830)|TOSHIBA.*FOLIO",LGTablet:"\\bL-06C|LG-V909|LG-V900|LG-V700|LG-V510|LG-V500|LG-V410|LG-V400|LG-VK810\\b",FujitsuTablet:"Android.*\\b(F-01D|F-02F|F-05E|F-10D|M532|Q572)\\b",PrestigioTablet:"PMP3170B|PMP3270B|PMP3470B|PMP7170B|PMP3370B|PMP3570C|PMP5870C|PMP3670B|PMP5570C|PMP5770D|PMP3970B|PMP3870C|PMP5580C|PMP5880D|PMP5780D|PMP5588C|PMP7280C|PMP7280C3G|PMP7280|PMP7880D|PMP5597D|PMP5597|PMP7100D|PER3464|PER3274|PER3574|PER3884|PER5274|PER5474|PMP5097CPRO|PMP5097|PMP7380D|PMP5297C|PMP5297C_QUAD|PMP812E|PMP812E3G|PMP812F|PMP810E|PMP880TD|PMT3017|PMT3037|PMT3047|PMT3057|PMT7008|PMT5887|PMT5001|PMT5002",LenovoTablet:"Lenovo TAB|Idea(Tab|Pad)( A1|A10| K1|)|ThinkPad([ ]+)?Tablet|YT3-X90L|YT3-X90F|YT3-X90X|Lenovo.*(S2109|S2110|S5000|S6000|K3011|A3000|A3500|A1000|A2107|A2109|A1107|A5500|A7600|B6000|B8000|B8080)(-|)(FL|F|HV|H|)",DellTablet:"Venue 11|Venue 8|Venue 7|Dell Streak 10|Dell Streak 7",YarvikTablet:"Android.*\\b(TAB210|TAB211|TAB224|TAB250|TAB260|TAB264|TAB310|TAB360|TAB364|TAB410|TAB411|TAB420|TAB424|TAB450|TAB460|TAB461|TAB464|TAB465|TAB467|TAB468|TAB07-100|TAB07-101|TAB07-150|TAB07-151|TAB07-152|TAB07-200|TAB07-201-3G|TAB07-210|TAB07-211|TAB07-212|TAB07-214|TAB07-220|TAB07-400|TAB07-485|TAB08-150|TAB08-200|TAB08-201-3G|TAB08-201-30|TAB09-100|TAB09-211|TAB09-410|TAB10-150|TAB10-201|TAB10-211|TAB10-400|TAB10-410|TAB13-201|TAB274EUK|TAB275EUK|TAB374EUK|TAB462EUK|TAB474EUK|TAB9-200)\\b",MedionTablet:"Android.*\\bOYO\\b|LIFE.*(P9212|P9514|P9516|S9512)|LIFETAB",ArnovaTablet:"97G4|AN10G2|AN7bG3|AN7fG3|AN8G3|AN8cG3|AN7G3|AN9G3|AN7dG3|AN7dG3ST|AN7dG3ChildPad|AN10bG3|AN10bG3DT|AN9G2",IntensoTablet:"INM8002KP|INM1010FP|INM805ND|Intenso Tab|TAB1004",IRUTablet:"M702pro",MegafonTablet:"MegaFon V9|\\bZTE V9\\b|Android.*\\bMT7A\\b",EbodaTablet:"E-Boda (Supreme|Impresspeed|Izzycomm|Essential)",AllViewTablet:"Allview.*(Viva|Alldro|City|Speed|All TV|Frenzy|Quasar|Shine|TX1|AX1|AX2)",ArchosTablet:"\\b(101G9|80G9|A101IT)\\b|Qilive 97R|Archos5|\\bARCHOS (70|79|80|90|97|101|FAMILYPAD|)(b|)(G10| Cobalt| TITANIUM(HD|)| Xenon| Neon|XSK| 2| XS 2| PLATINUM| CARBON|GAMEPAD)\\b",AinolTablet:"NOVO7|NOVO8|NOVO10|Novo7Aurora|Novo7Basic|NOVO7PALADIN|novo9-Spark",NokiaLumiaTablet:"Lumia 2520",SonyTablet:"Sony.*Tablet|Xperia Tablet|Sony Tablet S|SO-03E|SGPT12|SGPT13|SGPT114|SGPT121|SGPT122|SGPT123|SGPT111|SGPT112|SGPT113|SGPT131|SGPT132|SGPT133|SGPT211|SGPT212|SGPT213|SGP311|SGP312|SGP321|EBRD1101|EBRD1102|EBRD1201|SGP351|SGP341|SGP511|SGP512|SGP521|SGP541|SGP551|SGP621|SGP612|SOT31",PhilipsTablet:"\\b(PI2010|PI3000|PI3100|PI3105|PI3110|PI3205|PI3210|PI3900|PI4010|PI7000|PI7100)\\b",CubeTablet:"Android.*(K8GT|U9GT|U10GT|U16GT|U17GT|U18GT|U19GT|U20GT|U23GT|U30GT)|CUBE U8GT",CobyTablet:"MID1042|MID1045|MID1125|MID1126|MID7012|MID7014|MID7015|MID7034|MID7035|MID7036|MID7042|MID7048|MID7127|MID8042|MID8048|MID8127|MID9042|MID9740|MID9742|MID7022|MID7010",MIDTablet:"M9701|M9000|M9100|M806|M1052|M806|T703|MID701|MID713|MID710|MID727|MID760|MID830|MID728|MID933|MID125|MID810|MID732|MID120|MID930|MID800|MID731|MID900|MID100|MID820|MID735|MID980|MID130|MID833|MID737|MID960|MID135|MID860|MID736|MID140|MID930|MID835|MID733|MID4X10",MSITablet:"MSI \\b(Primo 73K|Primo 73L|Primo 81L|Primo 77|Primo 93|Primo 75|Primo 76|Primo 73|Primo 81|Primo 91|Primo 90|Enjoy 71|Enjoy 7|Enjoy 10)\\b",SMiTTablet:"Android.*(\\bMID\\b|MID-560|MTV-T1200|MTV-PND531|MTV-P1101|MTV-PND530)",RockChipTablet:"Android.*(RK2818|RK2808A|RK2918|RK3066)|RK2738|RK2808A",FlyTablet:"IQ310|Fly Vision",bqTablet:"Android.*(bq)?.*(Elcano|Curie|Edison|Maxwell|Kepler|Pascal|Tesla|Hypatia|Platon|Newton|Livingstone|Cervantes|Avant|Aquaris [E|M]10)|Maxwell.*Lite|Maxwell.*Plus",HuaweiTablet:"MediaPad|MediaPad 7 Youth|IDEOS S7|S7-201c|S7-202u|S7-101|S7-103|S7-104|S7-105|S7-106|S7-201|S7-Slim",NecTablet:"\\bN-06D|\\bN-08D",PantechTablet:"Pantech.*P4100",BronchoTablet:"Broncho.*(N701|N708|N802|a710)",VersusTablet:"TOUCHPAD.*[78910]|\\bTOUCHTAB\\b",ZyncTablet:"z1000|Z99 2G|z99|z930|z999|z990|z909|Z919|z900",PositivoTablet:"TB07STA|TB10STA|TB07FTA|TB10FTA",NabiTablet:"Android.*\\bNabi",KoboTablet:"Kobo Touch|\\bK080\\b|\\bVox\\b Build|\\bArc\\b Build",DanewTablet:"DSlide.*\\b(700|701R|702|703R|704|802|970|971|972|973|974|1010|1012)\\b",TexetTablet:"NaviPad|TB-772A|TM-7045|TM-7055|TM-9750|TM-7016|TM-7024|TM-7026|TM-7041|TM-7043|TM-7047|TM-8041|TM-9741|TM-9747|TM-9748|TM-9751|TM-7022|TM-7021|TM-7020|TM-7011|TM-7010|TM-7023|TM-7025|TM-7037W|TM-7038W|TM-7027W|TM-9720|TM-9725|TM-9737W|TM-1020|TM-9738W|TM-9740|TM-9743W|TB-807A|TB-771A|TB-727A|TB-725A|TB-719A|TB-823A|TB-805A|TB-723A|TB-715A|TB-707A|TB-705A|TB-709A|TB-711A|TB-890HD|TB-880HD|TB-790HD|TB-780HD|TB-770HD|TB-721HD|TB-710HD|TB-434HD|TB-860HD|TB-840HD|TB-760HD|TB-750HD|TB-740HD|TB-730HD|TB-722HD|TB-720HD|TB-700HD|TB-500HD|TB-470HD|TB-431HD|TB-430HD|TB-506|TB-504|TB-446|TB-436|TB-416|TB-146SE|TB-126SE",PlaystationTablet:"Playstation.*(Portable|Vita)",TrekstorTablet:"ST10416-1|VT10416-1|ST70408-1|ST702xx-1|ST702xx-2|ST80208|ST97216|ST70104-2|VT10416-2|ST10216-2A|SurfTab",PyleAudioTablet:"\\b(PTBL10CEU|PTBL10C|PTBL72BC|PTBL72BCEU|PTBL7CEU|PTBL7C|PTBL92BC|PTBL92BCEU|PTBL9CEU|PTBL9CUK|PTBL9C)\\b",AdvanTablet:"Android.* \\b(E3A|T3X|T5C|T5B|T3E|T3C|T3B|T1J|T1F|T2A|T1H|T1i|E1C|T1-E|T5-A|T4|E1-B|T2Ci|T1-B|T1-D|O1-A|E1-A|T1-A|T3A|T4i)\\b ",DanyTechTablet:"Genius Tab G3|Genius Tab S2|Genius Tab Q3|Genius Tab G4|Genius Tab Q4|Genius Tab G-II|Genius TAB GII|Genius TAB GIII|Genius Tab S1",GalapadTablet:"Android.*\\bG1\\b",MicromaxTablet:"Funbook|Micromax.*\\b(P250|P560|P360|P362|P600|P300|P350|P500|P275)\\b",KarbonnTablet:"Android.*\\b(A39|A37|A34|ST8|ST10|ST7|Smart Tab3|Smart Tab2)\\b",AllFineTablet:"Fine7 Genius|Fine7 Shine|Fine7 Air|Fine8 Style|Fine9 More|Fine10 Joy|Fine11 Wide",PROSCANTablet:"\\b(PEM63|PLT1023G|PLT1041|PLT1044|PLT1044G|PLT1091|PLT4311|PLT4311PL|PLT4315|PLT7030|PLT7033|PLT7033D|PLT7035|PLT7035D|PLT7044K|PLT7045K|PLT7045KB|PLT7071KG|PLT7072|PLT7223G|PLT7225G|PLT7777G|PLT7810K|PLT7849G|PLT7851G|PLT7852G|PLT8015|PLT8031|PLT8034|PLT8036|PLT8080K|PLT8082|PLT8088|PLT8223G|PLT8234G|PLT8235G|PLT8816K|PLT9011|PLT9045K|PLT9233G|PLT9735|PLT9760G|PLT9770G)\\b",YONESTablet:"BQ1078|BC1003|BC1077|RK9702|BC9730|BC9001|IT9001|BC7008|BC7010|BC708|BC728|BC7012|BC7030|BC7027|BC7026",ChangJiaTablet:"TPC7102|TPC7103|TPC7105|TPC7106|TPC7107|TPC7201|TPC7203|TPC7205|TPC7210|TPC7708|TPC7709|TPC7712|TPC7110|TPC8101|TPC8103|TPC8105|TPC8106|TPC8203|TPC8205|TPC8503|TPC9106|TPC9701|TPC97101|TPC97103|TPC97105|TPC97106|TPC97111|TPC97113|TPC97203|TPC97603|TPC97809|TPC97205|TPC10101|TPC10103|TPC10106|TPC10111|TPC10203|TPC10205|TPC10503",GUTablet:"TX-A1301|TX-M9002|Q702|kf026",PointOfViewTablet:"TAB-P506|TAB-navi-7-3G-M|TAB-P517|TAB-P-527|TAB-P701|TAB-P703|TAB-P721|TAB-P731N|TAB-P741|TAB-P825|TAB-P905|TAB-P925|TAB-PR945|TAB-PL1015|TAB-P1025|TAB-PI1045|TAB-P1325|TAB-PROTAB[0-9]+|TAB-PROTAB25|TAB-PROTAB26|TAB-PROTAB27|TAB-PROTAB26XL|TAB-PROTAB2-IPS9|TAB-PROTAB30-IPS9|TAB-PROTAB25XXL|TAB-PROTAB26-IPS10|TAB-PROTAB30-IPS10",OvermaxTablet:"OV-(SteelCore|NewBase|Basecore|Baseone|Exellen|Quattor|EduTab|Solution|ACTION|BasicTab|TeddyTab|MagicTab|Stream|TB-08|TB-09)",HCLTablet:"HCL.*Tablet|Connect-3G-2.0|Connect-2G-2.0|ME Tablet U1|ME Tablet U2|ME Tablet G1|ME Tablet X1|ME Tablet Y2|ME Tablet Sync",DPSTablet:"DPS Dream 9|DPS Dual 7",VistureTablet:"V97 HD|i75 3G|Visture V4( HD)?|Visture V5( HD)?|Visture V10",CrestaTablet:"CTP(-)?810|CTP(-)?818|CTP(-)?828|CTP(-)?838|CTP(-)?888|CTP(-)?978|CTP(-)?980|CTP(-)?987|CTP(-)?988|CTP(-)?989",MediatekTablet:"\\bMT8125|MT8389|MT8135|MT8377\\b",ConcordeTablet:"Concorde([ ]+)?Tab|ConCorde ReadMan",GoCleverTablet:"GOCLEVER TAB|A7GOCLEVER|M1042|M7841|M742|R1042BK|R1041|TAB A975|TAB A7842|TAB A741|TAB A741L|TAB M723G|TAB M721|TAB A1021|TAB I921|TAB R721|TAB I720|TAB T76|TAB R70|TAB R76.2|TAB R106|TAB R83.2|TAB M813G|TAB I721|GCTA722|TAB I70|TAB I71|TAB S73|TAB R73|TAB R74|TAB R93|TAB R75|TAB R76.1|TAB A73|TAB A93|TAB A93.2|TAB T72|TAB R83|TAB R974|TAB R973|TAB A101|TAB A103|TAB A104|TAB A104.2|R105BK|M713G|A972BK|TAB A971|TAB R974.2|TAB R104|TAB R83.3|TAB A1042",ModecomTablet:"FreeTAB 9000|FreeTAB 7.4|FreeTAB 7004|FreeTAB 7800|FreeTAB 2096|FreeTAB 7.5|FreeTAB 1014|FreeTAB 1001 |FreeTAB 8001|FreeTAB 9706|FreeTAB 9702|FreeTAB 7003|FreeTAB 7002|FreeTAB 1002|FreeTAB 7801|FreeTAB 1331|FreeTAB 1004|FreeTAB 8002|FreeTAB 8014|FreeTAB 9704|FreeTAB 1003",VoninoTablet:"\\b(Argus[ _]?S|Diamond[ _]?79HD|Emerald[ _]?78E|Luna[ _]?70C|Onyx[ _]?S|Onyx[ _]?Z|Orin[ _]?HD|Orin[ _]?S|Otis[ _]?S|SpeedStar[ _]?S|Magnet[ _]?M9|Primus[ _]?94[ _]?3G|Primus[ _]?94HD|Primus[ _]?QS|Android.*\\bQ8\\b|Sirius[ _]?EVO[ _]?QS|Sirius[ _]?QS|Spirit[ _]?S)\\b",ECSTablet:"V07OT2|TM105A|S10OT1|TR10CS1",StorexTablet:"eZee[_']?(Tab|Go)[0-9]+|TabLC7|Looney Tunes Tab",VodafoneTablet:"SmartTab([ ]+)?[0-9]+|SmartTabII10|SmartTabII7|VF-1497",EssentielBTablet:"Smart[ ']?TAB[ ]+?[0-9]+|Family[ ']?TAB2",RossMoorTablet:"RM-790|RM-997|RMD-878G|RMD-974R|RMT-705A|RMT-701|RME-601|RMT-501|RMT-711",iMobileTablet:"i-mobile i-note",TolinoTablet:"tolino tab [0-9.]+|tolino shine",AudioSonicTablet:"\\bC-22Q|T7-QC|T-17B|T-17P\\b",AMPETablet:"Android.* A78 ",SkkTablet:"Android.* (SKYPAD|PHOENIX|CYCLOPS)",TecnoTablet:"TECNO P9",JXDTablet:"Android.* \\b(F3000|A3300|JXD5000|JXD3000|JXD2000|JXD300B|JXD300|S5800|S7800|S602b|S5110b|S7300|S5300|S602|S603|S5100|S5110|S601|S7100a|P3000F|P3000s|P101|P200s|P1000m|P200m|P9100|P1000s|S6600b|S908|P1000|P300|S18|S6600|S9100)\\b",iJoyTablet:"Tablet (Spirit 7|Essentia|Galatea|Fusion|Onix 7|Landa|Titan|Scooby|Deox|Stella|Themis|Argon|Unique 7|Sygnus|Hexen|Finity 7|Cream|Cream X2|Jade|Neon 7|Neron 7|Kandy|Scape|Saphyr 7|Rebel|Biox|Rebel|Rebel 8GB|Myst|Draco 7|Myst|Tab7-004|Myst|Tadeo Jones|Tablet Boing|Arrow|Draco Dual Cam|Aurix|Mint|Amity|Revolution|Finity 9|Neon 9|T9w|Amity 4GB Dual Cam|Stone 4GB|Stone 8GB|Andromeda|Silken|X2|Andromeda II|Halley|Flame|Saphyr 9,7|Touch 8|Planet|Triton|Unique 10|Hexen 10|Memphis 4GB|Memphis 8GB|Onix 10)",FX2Tablet:"FX2 PAD7|FX2 PAD10",XoroTablet:"KidsPAD 701|PAD[ ]?712|PAD[ ]?714|PAD[ ]?716|PAD[ ]?717|PAD[ ]?718|PAD[ ]?720|PAD[ ]?721|PAD[ ]?722|PAD[ ]?790|PAD[ ]?792|PAD[ ]?900|PAD[ ]?9715D|PAD[ ]?9716DR|PAD[ ]?9718DR|PAD[ ]?9719QR|PAD[ ]?9720QR|TelePAD1030|Telepad1032|TelePAD730|TelePAD731|TelePAD732|TelePAD735Q|TelePAD830|TelePAD9730|TelePAD795|MegaPAD 1331|MegaPAD 1851|MegaPAD 2151",ViewsonicTablet:"ViewPad 10pi|ViewPad 10e|ViewPad 10s|ViewPad E72|ViewPad7|ViewPad E100|ViewPad 7e|ViewSonic VB733|VB100a",OdysTablet:"LOOX|XENO10|ODYS[ -](Space|EVO|Xpress|NOON)|\\bXELIO\\b|Xelio10Pro|XELIO7PHONETAB|XELIO10EXTREME|XELIOPT2|NEO_QUAD10",CaptivaTablet:"CAPTIVA PAD",IconbitTablet:"NetTAB|NT-3702|NT-3702S|NT-3702S|NT-3603P|NT-3603P|NT-0704S|NT-0704S|NT-3805C|NT-3805C|NT-0806C|NT-0806C|NT-0909T|NT-0909T|NT-0907S|NT-0907S|NT-0902S|NT-0902S",TeclastTablet:"T98 4G|\\bP80\\b|\\bX90HD\\b|X98 Air|X98 Air 3G|\\bX89\\b|P80 3G|\\bX80h\\b|P98 Air|\\bX89HD\\b|P98 3G|\\bP90HD\\b|P89 3G|X98 3G|\\bP70h\\b|P79HD 3G|G18d 3G|\\bP79HD\\b|\\bP89s\\b|\\bA88\\b|\\bP10HD\\b|\\bP19HD\\b|G18 3G|\\bP78HD\\b|\\bA78\\b|\\bP75\\b|G17s 3G|G17h 3G|\\bP85t\\b|\\bP90\\b|\\bP11\\b|\\bP98t\\b|\\bP98HD\\b|\\bG18d\\b|\\bP85s\\b|\\bP11HD\\b|\\bP88s\\b|\\bA80HD\\b|\\bA80se\\b|\\bA10h\\b|\\bP89\\b|\\bP78s\\b|\\bG18\\b|\\bP85\\b|\\bA70h\\b|\\bA70\\b|\\bG17\\b|\\bP18\\b|\\bA80s\\b|\\bA11s\\b|\\bP88HD\\b|\\bA80h\\b|\\bP76s\\b|\\bP76h\\b|\\bP98\\b|\\bA10HD\\b|\\bP78\\b|\\bP88\\b|\\bA11\\b|\\bA10t\\b|\\bP76a\\b|\\bP76t\\b|\\bP76e\\b|\\bP85HD\\b|\\bP85a\\b|\\bP86\\b|\\bP75HD\\b|\\bP76v\\b|\\bA12\\b|\\bP75a\\b|\\bA15\\b|\\bP76Ti\\b|\\bP81HD\\b|\\bA10\\b|\\bT760VE\\b|\\bT720HD\\b|\\bP76\\b|\\bP73\\b|\\bP71\\b|\\bP72\\b|\\bT720SE\\b|\\bC520Ti\\b|\\bT760\\b|\\bT720VE\\b|T720-3GE|T720-WiFi",OndaTablet:"\\b(V975i|Vi30|VX530|V701|Vi60|V701s|Vi50|V801s|V719|Vx610w|VX610W|V819i|Vi10|VX580W|Vi10|V711s|V813|V811|V820w|V820|Vi20|V711|VI30W|V712|V891w|V972|V819w|V820w|Vi60|V820w|V711|V813s|V801|V819|V975s|V801|V819|V819|V818|V811|V712|V975m|V101w|V961w|V812|V818|V971|V971s|V919|V989|V116w|V102w|V973|Vi40)\\b[\\s]+",JaytechTablet:"TPC-PA762",BlaupunktTablet:"Endeavour 800NG|Endeavour 1010",DigmaTablet:"\\b(iDx10|iDx9|iDx8|iDx7|iDxD7|iDxD8|iDsQ8|iDsQ7|iDsQ8|iDsD10|iDnD7|3TS804H|iDsQ11|iDj7|iDs10)\\b",EvolioTablet:"ARIA_Mini_wifi|Aria[ _]Mini|Evolio X10|Evolio X7|Evolio X8|\\bEvotab\\b|\\bNeura\\b",LavaTablet:"QPAD E704|\\bIvoryS\\b|E-TAB IVORY|\\bE-TAB\\b",AocTablet:"MW0811|MW0812|MW0922|MTK8382|MW1031|MW0831|MW0821|MW0931|MW0712",MpmanTablet:"MP11 OCTA|MP10 OCTA|MPQC1114|MPQC1004|MPQC994|MPQC974|MPQC973|MPQC804|MPQC784|MPQC780|\\bMPG7\\b|MPDCG75|MPDCG71|MPDC1006|MP101DC|MPDC9000|MPDC905|MPDC706HD|MPDC706|MPDC705|MPDC110|MPDC100|MPDC99|MPDC97|MPDC88|MPDC8|MPDC77|MP709|MID701|MID711|MID170|MPDC703|MPQC1010",CelkonTablet:"CT695|CT888|CT[\\s]?910|CT7 Tab|CT9 Tab|CT3 Tab|CT2 Tab|CT1 Tab|C820|C720|\\bCT-1\\b",WolderTablet:"miTab \\b(DIAMOND|SPACE|BROOKLYN|NEO|FLY|MANHATTAN|FUNK|EVOLUTION|SKY|GOCAR|IRON|GENIUS|POP|MINT|EPSILON|BROADWAY|JUMP|HOP|LEGEND|NEW AGE|LINE|ADVANCE|FEEL|FOLLOW|LIKE|LINK|LIVE|THINK|FREEDOM|CHICAGO|CLEVELAND|BALTIMORE-GH|IOWA|BOSTON|SEATTLE|PHOENIX|DALLAS|IN 101|MasterChef)\\b",MiTablet:"\\bMI PAD\\b|\\bHM NOTE 1W\\b",NibiruTablet:"Nibiru M1|Nibiru Jupiter One",NexoTablet:"NEXO NOVA|NEXO 10|NEXO AVIO|NEXO FREE|NEXO GO|NEXO EVO|NEXO 3G|NEXO SMART|NEXO KIDDO|NEXO MOBI",LeaderTablet:"TBLT10Q|TBLT10I|TBL-10WDKB|TBL-10WDKBO2013|TBL-W230V2|TBL-W450|TBL-W500|SV572|TBLT7I|TBA-AC7-8G|TBLT79|TBL-8W16|TBL-10W32|TBL-10WKB|TBL-W100",UbislateTablet:"UbiSlate[\\s]?7C",PocketBookTablet:"Pocketbook",KocasoTablet:"\\b(TB-1207)\\b",HisenseTablet:"\\b(F5281|E2371)\\b",Hudl:"Hudl HT7S3|Hudl 2",TelstraTablet:"T-Hub2",GenericTablet:"Android.*\\b97D\\b|Tablet(?!.*PC)|BNTV250A|MID-WCDMA|LogicPD Zoom2|\\bA7EB\\b|CatNova8|A1_07|CT704|CT1002|\\bM721\\b|rk30sdk|\\bEVOTAB\\b|M758A|ET904|ALUMIUM10|Smartfren Tab|Endeavour 1010|Tablet-PC-4|Tagi Tab|\\bM6pro\\b|CT1020W|arc 10HD|\\bTP750\\b"},oss:{AndroidOS:"Android",BlackBerryOS:"blackberry|\\bBB10\\b|rim tablet os",PalmOS:"PalmOS|avantgo|blazer|elaine|hiptop|palm|plucker|xiino",SymbianOS:"Symbian|SymbOS|Series60|Series40|SYB-[0-9]+|\\bS60\\b",WindowsMobileOS:"Windows CE.*(PPC|Smartphone|Mobile|[0-9]{3}x[0-9]{3})|Window Mobile|Windows Phone [0-9.]+|WCE;",WindowsPhoneOS:"Windows Phone 10.0|Windows Phone 8.1|Windows Phone 8.0|Windows Phone OS|XBLWP7|ZuneWP7|Windows NT 6.[23]; ARM;",iOS:"\\biPhone.*Mobile|\\biPod|\\biPad",MeeGoOS:"MeeGo",MaemoOS:"Maemo",JavaOS:"J2ME/|\\bMIDP\\b|\\bCLDC\\b",webOS:"webOS|hpwOS",badaOS:"\\bBada\\b",BREWOS:"BREW"},uas:{Chrome:"\\bCrMo\\b|CriOS|Android.*Chrome/[.0-9]* (Mobile)?",Dolfin:"\\bDolfin\\b",Opera:"Opera.*Mini|Opera.*Mobi|Android.*Opera|Mobile.*OPR/[0-9.]+|Coast/[0-9.]+",Skyfire:"Skyfire",Edge:"Mobile Safari/[.0-9]* Edge",IE:"IEMobile|MSIEMobile",Firefox:"fennec|firefox.*maemo|(Mobile|Tablet).*Firefox|Firefox.*Mobile|FxiOS",Bolt:"bolt",TeaShark:"teashark",Blazer:"Blazer",Safari:"Version.*Mobile.*Safari|Safari.*Mobile|MobileSafari",UCBrowser:"UC.*Browser|UCWEB",baiduboxapp:"baiduboxapp",baidubrowser:"baidubrowser",DiigoBrowser:"DiigoBrowser",Puffin:"Puffin",Mercury:"\\bMercury\\b",ObigoBrowser:"Obigo",NetFront:"NF-Browser",GenericBrowser:"NokiaBrowser|OviBrowser|OneBrowser|TwonkyBeamBrowser|SEMC.*Browser|FlyFlow|Minimo|NetFront|Novarra-Vision|MQQBrowser|MicroMessenger",PaleMoon:"Android.*PaleMoon|Mobile.*PaleMoon"},props:{Mobile:"Mobile/[VER]",Build:"Build/[VER]",Version:"Version/[VER]",VendorID:"VendorID/[VER]",iPad:"iPad.*CPU[a-z ]+[VER]",iPhone:"iPhone.*CPU[a-z ]+[VER]",iPod:"iPod.*CPU[a-z ]+[VER]",Kindle:"Kindle/[VER]",Chrome:["Chrome/[VER]","CriOS/[VER]","CrMo/[VER]"],Coast:["Coast/[VER]"],Dolfin:"Dolfin/[VER]",Firefox:["Firefox/[VER]","FxiOS/[VER]"],Fennec:"Fennec/[VER]",Edge:"Edge/[VER]",IE:["IEMobile/[VER];","IEMobile [VER]","MSIE [VER];","Trident/[0-9.]+;.*rv:[VER]"],NetFront:"NetFront/[VER]",NokiaBrowser:"NokiaBrowser/[VER]",Opera:[" OPR/[VER]","Opera Mini/[VER]","Version/[VER]"],"Opera Mini":"Opera Mini/[VER]","Opera Mobi":"Version/[VER]","UC Browser":"UC Browser[VER]",MQQBrowser:"MQQBrowser/[VER]",MicroMessenger:"MicroMessenger/[VER]",baiduboxapp:"baiduboxapp/[VER]",baidubrowser:"baidubrowser/[VER]",SamsungBrowser:"SamsungBrowser/[VER]",Iron:"Iron/[VER]",Safari:["Version/[VER]","Safari/[VER]"],Skyfire:"Skyfire/[VER]",Tizen:"Tizen/[VER]",Webkit:"webkit[ /][VER]",PaleMoon:"PaleMoon/[VER]",Gecko:"Gecko/[VER]",Trident:"Trident/[VER]",Presto:"Presto/[VER]",Goanna:"Goanna/[VER]",iOS:" \\bi?OS\\b [VER][ ;]{1}",Android:"Android [VER]",BlackBerry:["BlackBerry[\\w]+/[VER]","BlackBerry.*Version/[VER]","Version/[VER]"],BREW:"BREW [VER]",Java:"Java/[VER]","Windows Phone OS":["Windows Phone OS [VER]","Windows Phone [VER]"],"Windows Phone":"Windows Phone [VER]","Windows CE":"Windows CE/[VER]","Windows NT":"Windows NT [VER]",Symbian:["SymbianOS/[VER]","Symbian/[VER]"],webOS:["webOS/[VER]","hpwOS/[VER];"]},utils:{Bot:"Googlebot|facebookexternalhit|AdsBot-Google|Google Keyword Suggestion|Facebot|YandexBot|YandexMobileBot|bingbot|ia_archiver|AhrefsBot|Ezooms|GSLFbot|WBSearchBot|Twitterbot|TweetmemeBot|Twikle|PaperLiBot|Wotbox|UnwindFetchor|Exabot|MJ12bot|YandexImages|TurnitinBot|Pingdom",MobileBot:"Googlebot-Mobile|AdsBot-Google-Mobile|YahooSeeker/M1A1-R2D2",DesktopMode:"WPDesktop",TV:"SonyDTV|HbbTV",WebKit:"(webkit)[ /]([\\w.]+)",Console:"\\b(Nintendo|Nintendo WiiU|Nintendo 3DS|PLAYSTATION|Xbox)\\b",Watch:"SM-V700"}},X.detectMobileBrowsers={fullPattern:/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,shortPattern:/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,tabletPattern:/android|ipad|playbook|silk/i};var Y=Object.prototype.hasOwnProperty,Z;return X.FALLBACK_PHONE="UnknownPhone",X.FALLBACK_TABLET="UnknownTablet",X.FALLBACK_MOBILE="UnknownMobile",Z="isArray"in Array?Array.isArray:function(K){return"[object Array]"===Object.prototype.toString.call(K)},function(){var ne=X.mobileDetectRules,Q,J,$,ee,oe,ie;for(Q in ne.props)if(Y.call(ne.props,Q)){for(J=ne.props[Q],Z(J)||(J=[J]),oe=J.length,ee=0;ee<oe;++ee)$=J[ee],ie=$.indexOf("[VER]"),0<=ie&&($=$.substring(0,ie)+"([\\w._\\+]+)"+$.substring(ie+5)),J[ee]=new RegExp($,"i");ne.props[Q]=J}V(ne.oss),V(ne.phones),V(ne.tablets),V(ne.uas),V(ne.utils),ne.oss0={WindowsPhoneOS:ne.oss.WindowsPhoneOS,WindowsMobileOS:ne.oss.WindowsMobileOS}}(),X.findMatch=function(K,Q){for(var J in K)if(Y.call(K,J)&&K[J].test(Q))return J;return null},X.findMatches=function(K,Q){var J=[];for(var $ in K)Y.call(K,$)&&K[$].test(Q)&&J.push($);return J},X.getVersionStr=function(K,Q){var J=X.mobileDetectRules.props,$,ee,oe,ie;if(Y.call(J,K))for($=J[K],oe=$.length,ee=0;ee<oe;++ee)if(ie=$[ee].exec(Q),null!==ie)return ie[1];return null},X.getVersion=function(K,Q){var J=X.getVersionStr(K,Q);return J?X.prepareVersionNo(J):NaN},X.prepareVersionNo=function(K){var Q=K.split(/[a-z._ \/\-]/i);return 1===Q.length&&(K=Q[0]),1<Q.length&&(K=Q[0]+".",Q.shift(),K+=Q.join("")),+K},X.isMobileFallback=function(K){return X.detectMobileBrowsers.fullPattern.test(K)||X.detectMobileBrowsers.shortPattern.test(K.substr(0,4))},X.isTabletFallback=function(K){return X.detectMobileBrowsers.tabletPattern.test(K)},X.prepareDetectionCache=function(K,Q,J){if(K.mobile===F){var $,ee,oe;return(ee=X.findMatch(X.mobileDetectRules.tablets,Q),ee)?(K.mobile=K.tablet=ee,void(K.phone=null)):($=X.findMatch(X.mobileDetectRules.phones,Q),$?(K.mobile=K.phone=$,void(K.tablet=null)):void(X.isMobileFallback(Q)?(oe=W.isPhoneSized(J),oe===F?(K.mobile=X.FALLBACK_MOBILE,K.tablet=K.phone=null):oe?(K.mobile=K.phone=X.FALLBACK_PHONE,K.tablet=null):(K.mobile=K.tablet=X.FALLBACK_TABLET,K.phone=null)):X.isTabletFallback(Q)?(K.mobile=K.tablet=X.FALLBACK_TABLET,K.phone=null):K.mobile=K.tablet=K.phone=null))}},X.mobileGrade=function(K){var Q=null!==K.mobile();return K.os("iOS")&&4.3<=K.version("iPad")||K.os("iOS")&&3.1<=K.version("iPhone")||K.os("iOS")&&3.1<=K.version("iPod")||2.1<K.version("Android")&&K.is("Webkit")||7<=K.version("Windows Phone OS")||K.is("BlackBerry")&&6<=K.version("BlackBerry")||K.match("Playbook.*Tablet")||1.4<=K.version("webOS")&&K.match("Palm|Pre|Pixi")||K.match("hp.*TouchPad")||K.is("Firefox")&&12<=K.version("Firefox")||K.is("Chrome")&&K.is("AndroidOS")&&4<=K.version("Android")||K.is("Skyfire")&&4.1<=K.version("Skyfire")&&K.is("AndroidOS")&&2.3<=K.version("Android")||K.is("Opera")&&11<K.version("Opera Mobi")&&K.is("AndroidOS")||K.is("MeeGoOS")||K.is("Tizen")||K.is("Dolfin")&&2<=K.version("Bada")||(K.is("UC Browser")||K.is("Dolfin"))&&2.3<=K.version("Android")||K.match("Kindle Fire")||K.is("Kindle")&&3<=K.version("Kindle")||K.is("AndroidOS")&&K.is("NookTablet")||11<=K.version("Chrome")&&!Q||5<=K.version("Safari")&&!Q||4<=K.version("Firefox")&&!Q||7<=K.version("MSIE")&&!Q||10<=K.version("Opera")&&!Q?"A":K.os("iOS")&&4.3>K.version("iPad")||K.os("iOS")&&3.1>K.version("iPhone")||K.os("iOS")&&3.1>K.version("iPod")||K.is("Blackberry")&&5<=K.version("BlackBerry")&&6>K.version("BlackBerry")||5<=K.version("Opera Mini")&&6.5>=K.version("Opera Mini")&&(2.3<=K.version("Android")||K.is("iOS"))||K.match("NokiaN8|NokiaC7|N97.*Series60|Symbian/3")||11<=K.version("Opera Mobi")&&K.is("SymbianOS")?"B":5>K.version("BlackBerry")||K.match("MSIEMobile|Windows CE.*Mobile")||5.2>=K.version("Windows Mobile")?"C":"C"},X.detectOS=function(K){return X.findMatch(X.mobileDetectRules.oss0,K)||X.findMatch(X.mobileDetectRules.oss,K)},X.getDeviceSmallerSide=function(){return window.screen.width<window.screen.height?window.screen.width:window.screen.height},W.prototype={constructor:W,mobile:function(){return X.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.mobile},phone:function(){return X.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.phone},tablet:function(){return X.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.tablet},userAgent:function(){return this._cache.userAgent===F&&(this._cache.userAgent=X.findMatch(X.mobileDetectRules.uas,this.ua)),this._cache.userAgent},userAgents:function(){return this._cache.userAgents===F&&(this._cache.userAgents=X.findMatches(X.mobileDetectRules.uas,this.ua)),this._cache.userAgents},os:function(){return this._cache.os===F&&(this._cache.os=X.detectOS(this.ua)),this._cache.os},version:function(K){return X.getVersion(K,this.ua)},versionStr:function(K){return X.getVersionStr(K,this.ua)},is:function(K){return O(this.userAgents(),K)||H(K,this.os())||H(K,this.phone())||H(K,this.tablet())||O(X.findMatches(X.mobileDetectRules.utils,this.ua),K)},match:function(K){return K instanceof RegExp||(K=new RegExp(K,"i")),K.test(this.ua)},isPhoneSized:function(K){return W.isPhoneSized(K||this.maxPhoneWidth)},mobileGrade:function(){return this._cache.grade===F&&(this._cache.grade=X.mobileGrade(this)),this._cache.grade}},W.isPhoneSized="undefined"!=typeof window&&window.screen?function(K){return 0>K?F:X.getDeviceSmallerSide()<=K}:function(){},W._impl=X,W.version="1.3.5 2016-11-14",W})})(function(){if("undefined"!=typeof R&&R.exports)return function(G){R.exports=G()};if("function"==typeof C&&C.amd)return C;if("undefined"!=typeof window)return function(G){window.MobileDetect=G()};throw new Error("unknown environment")}())}(),E.register("1",["2","3","4","e","f"],function(){"use strict";var C,G,F,H,O,V,W,X,Y,Z,K,Q,J,$,ee,oe,ie,ne,se,le,pe,ue,fe,ge,he,ye,xe,Te,ve,Se,Ee,Me;return{setters:[function(){},function(Ae){C=Ae.AdditiveBlending,G=Ae.BufferAttribute,F=Ae.BufferGeometry,H=Ae.Color,O=Ae.CubeTexture,V=Ae.DepthTexture,W=Ae.LinearFilter,X=Ae.Matrix3,Y=Ae.Matrix4,Z=Ae.Mesh,K=Ae.Object3D,Q=Ae.OrthographicCamera,J=Ae.PerspectiveCamera,$=Ae.PlaneBufferGeometry,ee=Ae.Points,oe=Ae.RGBAFormat,ie=Ae.Scene,ne=Ae.ShaderLib,se=Ae.ShaderMaterial,le=Ae.Texture,pe=Ae.UniformsUtils,ue=Ae.UnsignedShortType,fe=Ae.Vector2,ge=Ae.Vector3,he=Ae.Vector4,ye=Ae.WebGLRenderTarget,xe=Ae.WebGLRenderer},function(){},function(Ae){Te=Ae.mat4,ve=Ae.quat,Se=Ae.vec2,Ee=Ae.vec3},function(Ae){Me=Ae.default}],execute:function(){class Ae extends Set{constructor(){super()}dispatch(st){for(let lt of this)lt(st)}}var Pe=new class extends Ae{constructor(){super(),this._updateBinded=this.update.bind(this),this._previousTimestamp=0,this.deltaTime=0,this.timeScale=1,this.update()}update(lt){requestAnimationFrame(this._updateBinded);let dt=window.performance?window.performance.now():Date.now();this.deltaTime=.001*(dt-this._previousTimestamp),this.timeScale=this.deltaTime/.0166666667,this._previousTimestamp=dt,this.dispatch(lt)}};class Le extends HTMLElement{constructor({autoplay:st=!0,background:lt=!1}={}){super(),this._autoplay=st,this._background=lt}connectedCallback(){this._background||(window.addEventListener("blur",this._pauseBinded=this.pause.bind(this)),window.addEventListener("focus",this._playBinded=this.play.bind(this))),this._autoplay&&this.play()}disconnectedCallback(){this.pause(),window.removeEventListener("blur",this._pauseBinded),window.removeEventListener("focus",this._playBinded)}play(){Pe.add(this._updateBinded=this._updateBinded||this.update.bind(this)),this.dispatchEvent(new Event("playing"))}pause(){Pe.delete(this._updateBinded),this.dispatchEvent(new Event("pause"))}update(){}}window.customElements.define("dlib-loop",Le);const we=new Map,Re=new Map;class Ce{static get onLoad(){return Promise.all(we.values())}static get promises(){return we}static get(st){return Re.get(st)}static load(st){st instanceof Array||(st=[st]);let lt=[];for(let dt of st)if(dt){let ct=we.get(dt)||new Promise(function(ut){if(Ce.get(dt))return void ut(Ce.get(dt));let mt=dt instanceof HTMLElement?dt:null,ft=gt=>{we.delete(dt),Re.set(dt,gt),mt?(mt.removeEventListener("load",ft),mt.removeEventListener("canplaythrough",ft),ut(mt)):ut(gt)};if("string"==typeof dt){let gt;if(/\.(png|jpg|gif)$/.test(dt))gt="img";else if(/\.(mp4|webm)$/.test(dt))gt="video";else if(/\.(mp3|ogg)$/.test(dt))gt="audio";else if(/\.(woff|woff2)$/.test(dt)){let ht=new FontFace(/([^\/]*)\.(woff|woff2)$/.exec(dt)[1],`url(${dt})`);ht.load().then(ft),document.fonts.add(ht)}else fetch(dt).catch(()=>{return new Promise(function(ht){let yt=new XMLHttpRequest;yt.onload=()=>{ht(new Response(yt.responseText,{status:yt.status}))},yt.open("GET",dt),yt.send(null)})}).then(ht=>{return ht[/\.(json)$/.test(dt)?"json":"text"]()}).then(ft);gt&&(mt=document.createElement(gt))}if(mt&&(mt instanceof HTMLMediaElement?mt.addEventListener("canplaythrough",ft):mt.addEventListener("load",ft),mt.src=mt.src||dt,mt instanceof HTMLMediaElement&&(mt.play(),!mt.autoplay))){let gt=function(){mt.pause(),mt.removeEventListener("playing",gt)};mt.addEventListener("playing",gt)}});lt.push(ct),we.set(dt,ct)}return 1<lt.length?Promise.all(lt):lt[0]}}class Ie extends Float32Array{constructor(st=0,lt=0){return super(2),this.set(st,lt),this}get x(){return this[0]}set x(st){this[0]=st}get y(){return this[1]}set y(st){this[1]=st}set(st,lt){return Se.set(this,st,lt),this}copy(st){return Se.copy(this,st),this}add(st){return Se.add(this,this,st),this}get size(){return Se.length(this)}get squaredSize(){return Se.squaredLength(this)}subtract(st){return Se.subtract(this,this,st),this}negate(st=this){return Se.negate(this,st),this}cross(st,lt){return Se.cross(this,st,lt),this}scale(st){return Se.scale(this,this,st),this}normalize(){Se.normalize(this,this)}dot(st){return Se.dot(this,st)}equals(st){return Se.exactEquals(this,st)}applyMatrix3(st){return Se.transformMat3(this,this,st),this}applyMatrix4(st){return Se.transformMat4(this,this,st),this}angle(st){return Se.angle(this,st)}lerp(st,lt){Se.lerp(this,this,st,lt)}clone(){return new Vector3(this.x,this.y,this.z)}}let De=new Map;class Ge extends Ie{static get TOUCH_TYPE(){return"touchtype"}static get MOUSE_TYPE(){return"mousetype"}static get(st){let lt=De.get(st);return lt||(lt=new Ge(st)),lt}get downed(){return this._downed}constructor(st=document.body){super(),this.domElement=st,this.type=Ge.TOUCH_TYPE,this._position=new Ie,this.velocity=new Ie,this.dragOffset=new Ie,this.centered=new Ie,this.centeredFlippedY=new Ie,this.normalized=new Ie,this.normalizedFlippedY=new Ie,this.normalizedCentered=new Ie,this.normalizedCenteredFlippedY=new Ie,this._downed=!1,De.set(this.domElement,this),this.onDown=new Ae,this.onMove=new Ae,this.onUp=new Ae,this.onClick=new Ae,this.onTypeChange=new Ae,this._preventMouseTypeChange=!1,this._onPointerMoveBinded=this._onPointerMove.bind(this),this._onPointerDownBinded=this._onPointerDown.bind(this),this._onPointerUpBinded=this._onPointerUp.bind(this),this._updateBinded=this._update.bind(this),this._resizeBinded=this.resize.bind(this),this.resize(),this.enable()}resize(){this._domElementBoundingRect=this.domElement.getBoundingClientRect()}_onPointerDown(st){"touchstart"===st.type&&(this._preventMouseTypeChange=!0,this._changeType(Ge.TOUCH_TYPE)),this._downed=!0,this.dragOffset.set(0,0),this.copy(this._position),this._onPointerEvent(st),this._updatePositions(),this.onDown.dispatch(st)}_onPointerMove(st){if("mousemove"===st.type){if(this._preventMouseTypeChange)return;this._changeType(Ge.MOUSE_TYPE)}this._onPointerEvent(st),this.onMove.dispatch(st)}_onPointerUp(st){this._downed=!1,this._onPointerEvent(st),this._updatePositions(),this.onUp.dispatch(st),4>this.dragOffset.length&&this.onClick.dispatch(st),clearTimeout(this._timeout),this._timeout=setTimeout(()=>{this._preventMouseTypeChange=!1},2e3)}_onPointerEvent(st){!!window.TouchEvent&&st instanceof window.TouchEvent&&("touchend"===st.type?st=st.changedTouches[0]:st=st.touches[0]),this._position.x=st.clientX-this._domElementBoundingRect.left,this._position.y=st.clientY-this._domElementBoundingRect.top}_changeType(st){this.type===st||(this.type=st,this.disable(),this.enable(),this.onTypeChange.dispatch(this.type))}_update(){(this.x||this.y)&&(this.velocity.x=this._position.x-this.x,this.velocity.y=this._position.y-this.y,this.downed&&this.dragOffset.add(this.velocity)),this._updatePositions()}_updatePositions(){this.x=this._position.x,this.y=this._position.y,this.centered.x=this.centeredFlippedY.x=this.x-.5*this._domElementBoundingRect.width,this.centered.y=this.centeredFlippedY.y=this.y-.5*this._domElementBoundingRect.height,this.centeredFlippedY.y*=-1,this.normalized.x=this.normalizedFlippedY.x=this.x/this._domElementBoundingRect.width,this.normalized.y=this.normalizedFlippedY.y=this.y/this._domElementBoundingRect.height,this.normalizedFlippedY.y=1-this.normalizedFlippedY.y,this.normalizedCentered.x=this.normalizedCenteredFlippedY.x=2*this.normalized.x-1,this.normalizedCentered.y=this.normalizedCenteredFlippedY.y=2*this.normalized.y-1,this.normalizedCenteredFlippedY.y*=-1}enable(){this.disable(),this.resize(),this.type===Ge.TOUCH_TYPE?(this.domElement.addEventListener("touchmove",this._onPointerMoveBinded),window.addEventListener("touchend",this._onPointerUpBinded)):(this.domElement.addEventListener("mousedown",this._onPointerDownBinded),window.addEventListener("mouseup",this._onPointerUpBinded)),this.domElement.addEventListener("touchstart",this._onPointerDownBinded),this.domElement.addEventListener("mousemove",this._onPointerMoveBinded),window.addEventListener("resize",this._resizeBinded),Pe.add(this._updateBinded=this._updateBinded||this._update.bind(this))}disable(){Pe.delete(this._updateBinded),this.domElement.removeEventListener("touchstart",this._onPointerDownBinded),this.domElement.removeEventListener("mousedown",this._onPointerDownBinded),this.domElement.removeEventListener("touchmove",this._onPointerMoveBinded),this.domElement.removeEventListener("mousemove",this._onPointerMoveBinded),window.removeEventListener("touchend",this._onPointerUpBinded),window.removeEventListener("mouseup",this._onPointerUpBinded),window.removeEventListener("resize",this._resizeBinded)}}class Be extends Float32Array{constructor(st){return super(16),st?this.copy(st):this.identity(),this}set x(st){this[12]=st}get x(){return this[12]}set y(st){this[13]=st}get y(){return this[13]}set z(st){this[14]=st}get z(){return this[14]}set w(st){this[15]=st}get w(){return this[15]}copy(st){return Te.copy(this,st),this}set(st,lt,dt,ct,ut,mt,ft,gt,ht,yt,xt,Tt,vt,_t,St,Et){return Te.set(this,st,lt,dt,ct,ut,mt,ft,gt,ht,yt,xt,Tt,vt,_t,St,Et),this}translate(st,lt=this){return Te.translate(this,lt,st),this}rotateX(st,lt=this){return Te.rotateX(this,lt,st),this}rotateY(st,lt=this){return Te.rotateY(this,lt,st),this}rotateZ(st,lt=this){return Te.rotateZ(this,lt,st),this}scale(st,lt=this){return Te.scale(this,lt,st),this}multiply(st,lt){return lt?Te.multiply(this,st,lt):Te.multiply(this,this,st),this}identity(){return Te.identity(this),this}copy(st){return Te.copy(this,st),this}fromPerspective({fov:st,aspect:lt,near:dt,far:ct}={}){return Te.perspective(this,st,lt,dt,ct),this}fromQuaternion(st){return Te.fromQuat(this,st),this}setPosition(st){return this.x=st.x,this.y=st.y,this.z=st.z,this}invert(st=this){return Te.invert(this,st),this}}class Fe extends Float32Array{constructor(st=0,lt=0,dt=0){return super(3),this.set(st,lt,dt),this}get x(){return this[0]}set x(st){this[0]=st}get y(){return this[1]}set y(st){this[1]=st}get z(){return this[2]}set z(st){this[2]=st}set(st,lt,dt){return Ee.set(this,st,lt,dt),this}copy(st){return Ee.copy(this,st),this}add(st){return Ee.add(this,this,st),this}get size(){return Ee.length(this)}get squaredSize(){return Ee.squaredLength(this)}subtract(st){return Ee.subtract(this,this,st),this}negate(st=this){return Ee.negate(this,st),this}cross(st,lt){return Ee.cross(this,st,lt),this}scale(st){return Ee.scale(this,this,st),this}normalize(){Ee.normalize(this,this)}dot(st){return Ee.dot(this,st)}equals(st){return Ee.exactEquals(this,st)}applyMatrix4(st){return Ee.transformMat4(this,this,st),this}angle(st){return Ee.angle(this,st)}clone(){return new Fe(this.x,this.y,this.z)}}class Ne extends Float32Array{constructor(st=0,lt=0,dt=0,ct=1){return super(4),this.set(st,lt,dt,ct),this}get x(){return this[0]}set x(st){this[0]=st}get y(){return this[1]}set y(st){this[1]=st}get z(){return this[2]}set z(st){this[2]=st}get w(){return this[3]}set w(st){this[3]=st}identity(){return ve.identity(this),this}set(st,lt,dt,ct){return ve.set(this,st,lt,dt,ct),this}rotateX(st){return ve.rotateX(this,this,st),this}rotateY(st){return ve.rotateY(this,this,st),this}rotateZ(st){return ve.rotateZ(this,this,st),this}invert(st=this){return ve.invert(this,st),this}copy(st){return ve.copy(this,st),this}normalize(st=this){return ve.normalize(this,this),this}multiply(st,lt){return lt?ve.multiply(this,st,lt):ve.multiply(this,this,st),this}fromMatrix3(st){return ve.fromMat3(this,st),this}}class Ue{constructor(st=new Be,{domElement:lt=document.body,distance:dt=0,invertRotation:ct=!0,rotationEaseRatio:ut=.04,zoomStep:mt=.1,zoomEaseRatio:ft=.1,autoupdate:gt=!0}={}){this.matrix=st,this.disabled=!1,this._distance=dt,this.invertRotation=ct,this.rotationEaseRatio=ut,this.zoomStep=mt,this.zoomEaseRatio=ft,this._pointer=Ge.get(lt),this._nextDistance=this._distance,this._cachedQuaternion=new Ne,this._cachedMatrix=new Be,this._cachedVector3=new Fe,this._velocity=new Ie,this._velocityOrigin=new Ie,this._position=new Fe(this.matrix.x,this.matrix.y,this.matrix.z),this._positionPrevious=this._position.clone(),this._positionOffset=new Fe,lt.addEventListener("wheel",this.onWheel.bind(this)),this.update()}set distance(st){this._distance=this._nextDistance=st}get distance(){return this._distance}onWheel(st){0<st.deltaY?this._nextDistance+=this.zoomStep:this._nextDistance-=this.zoomStep,this._nextDistance=Math.max(this._nextDistance,0)}update(){this.disabled||(this._cachedMatrix.identity(),this._cachedQuaternion.identity(),this._distance+=(this._nextDistance-this._distance)*this.zoomEaseRatio,this._position.set(this.matrix.x,this.matrix.y,this.matrix.z).subtract(this._positionOffset),this.matrix.x=0,this.matrix.y=0,this.matrix.z=0,this._pointer.downed&&this._velocity.copy(this._pointer.velocity).scale(.003),this._velocity.lerp(this._velocityOrigin,this.rotationEaseRatio),this._cachedQuaternion.rotateY(this.invertRotation?-this._velocity.x:this._velocity.x),this._cachedQuaternion.rotateX(this.invertRotation?-this._velocity.y:this._velocity.y),this._cachedMatrix.fromQuaternion(this._cachedQuaternion),this.matrix.multiply(this._cachedMatrix),this._positionOffset.set(0,0,1),this._positionOffset.applyMatrix4(this.matrix),this._positionOffset.scale(this._distance),this._cachedVector3.copy(this._position).add(this._positionOffset),this.matrix.x=this._cachedVector3.x,this.matrix.y=this._cachedVector3.y,this.matrix.z=this._cachedVector3.z)}}class He extends Ue{constructor(st=new K,lt){st.updateMatrix(),super(new Be(st.matrix.elements),lt),this._matrix4=new Y,this.object3D=st,this.update()}update(){this.object3D&&(this.matrix.x=this.object3D.position.x,this.matrix.y=this.object3D.position.y,this.matrix.z=this.object3D.position.z,super.update(),this._matrix4.fromArray(this.matrix),this.object3D.matrix.identity(),this.object3D.applyMatrix(this._matrix4))}}class ze{static add(st="void main() {}",lt){for(let[dt,ct]of lt)st="start"===dt?`${ct}\n${st}`:"end"===dt?st.replace(/(}\s*$)/,`\n${ct}\n$1`):"main"===dt?st.replace(/(\bvoid\b +\bmain\b[\s\S]*?{\s*)/,`$1\n${ct}\n`):st.replace(dt,ct);return st}constructor({vertexShader:st=`
    void main() {
      gl_Position = vec4(0.);
    }
  `,fragmentShader:lt=`
    void main() {
      gl_FragColor = vec4(1.);
    }
  `,uniforms:dt={},attributes:ct={},add:ut=[]}={}){this.uniforms=dt,this.attributes=ct,this.vertexShader=st,this.fragmentShader=lt;for(let mt of ut)this.add(mt)}add({vertexShaderChunks:st=[],fragmentShaderChunks:lt=[],uniforms:dt={},attributes:ct={}}={}){Object.assign(this.uniforms,dt),Object.assign(this.attributes,ct),this.vertexShader=ze.add(this.vertexShader,st),this.fragmentShader=ze.add(this.fragmentShader,lt)}set vertexShader(st){this._vertexShader=st,this._parseQualifiers(this._vertexShader)}get vertexShader(){return this._vertexShader}set fragmentShader(st){this._fragmentShader=st,this._parseQualifiers(this._fragmentShader)}get fragmentShader(){return this._fragmentShader}/**
         * Parse shader strings to extract uniforms and attributes
         */_parseQualifiers(st,{Vector2:lt=function(){return new Float32Array(2)},Vector3:dt=function(){return new Float32Array(3)},Vector4:ct=function(){return new Float32Array(4)},Matrix3:ut=function(){return new Float32Array(9)},Matrix4:mt=function(){return new Float32Array(16)},Texture2D:ft=function(){},TextureCube:gt=function(){}}={}){for(let ht=arguments[1],yt=/^\s*(uniform|attribute) (.[^ ]+) (.[^ ;\[\]]+)\[? *(\d+)? *\]?/gm,xt;xt=yt.exec(st);){let[,Tt,vt,_t,St]=xt,Et=parseInt(St),Mt=this[`${Tt}s`];if(Mt||(Mt=this[`${Tt}s`]={}),!Mt[_t]){let At,Pt;if(/float|double/.test(vt))At=isNaN(Et)?0:Array(Et).fill(0);else if(/int|uint/.test(vt))At=isNaN(Et)?0:Array(Et).fill(0);else if(/sampler2D/.test(vt))At=isNaN(Et)?new ht.Texture2D:Array(Et).fill().map(()=>new ht.Texture2D);else if(/samplerCube/.test(vt))At=isNaN(Et)?new ht.TextureCube:Array(Et).fill().map(()=>new ht.TextureCube);else if(Pt=/(.?)vec(\d)/.exec(vt)){let Lt=Pt[2];At=isNaN(Et)?new ht[`Vector${Lt}`]:Array(Et).fill().map(()=>new ht[`Vector${Lt}`])}else if(Pt=/mat(\d)/.exec(vt)){let Lt=Pt[1];At=isNaN(Et)?new ht[`Matrix${Lt}`]:Array(Et).fill().map(()=>new ht[`Matrix${Lt}`])}else At=null;Mt[_t]=At}}}}class Oe extends ze{constructor({vertexShader:st=`
    void main() {
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.);
    }
  `,fragmentShader:lt=`
    void main() {
      gl_FragColor = vec4(1.);
    }
  `,uniforms:dt={}}={}){super({vertexShader:st,fragmentShader:lt,uniforms:dt})}_parseQualifiers(st){for(let lt in super._parseQualifiers(st,{Vector2:fe,Vector3:ge,Vector4:he,Matrix3:X,Matrix4:Y,TextureCube:O,Texture2D:le}),this.uniforms){let dt=this.uniforms[lt];("object"!=typeof dt||void 0===dt.value)&&(this.uniforms[lt]={value:dt})}}}class Ve extends se{constructor(st={}){let lt=st.type||"";delete st.type;let dt=st.vertexShaderChunks;delete st.vertexShaderChunks;let ct=st.fragmentShaderChunks;delete st.fragmentShaderChunks;let ut=st.uniforms;delete st.uniforms;let mt=new Oe({vertexShader:st.vertexShader||(lt?ne[lt].vertexShader:void 0),fragmentShader:st.fragmentShader||(lt?ne[lt].fragmentShader:void 0),uniforms:lt?pe.clone(ne[lt].uniforms):void 0});super(Object.assign({fragmentShader:mt.fragmentShader,vertexShader:mt.vertexShader,uniforms:mt.uniforms},st)),this._shader=mt,this.add({vertexShaderChunks:dt,fragmentShaderChunks:ct,uniforms:ut}),this.lights=/lambert|phong|standard/.test(lt)}add({vertexShaderChunks:st,fragmentShaderChunks:lt,uniforms:dt}){for(let ct in this._shader.add({vertexShaderChunks:st,fragmentShaderChunks:lt,uniforms:dt}),this.fragmentShader=this._shader.fragmentShader,this.vertexShader=this._shader.vertexShader,this._shader.uniforms){let ut=ct;// Firefox fix
Object.defineProperty(this,ut,{configurable:!0,get:function(){return this.uniforms[ut].value},set:function(mt){this.uniforms[ut].value=mt}})}this.update()}}class ke{constructor({position:st=new Fe,velocity:lt=st instanceof Ie?new Ie:new Fe,life:dt=1/0}={}){return this.position=st,this.velocity=lt,this.life=dt,this.reset(),this}get x(){return this.position.x}set x(st){this.position.x=st}get y(){return this.position.y}set y(st){this.position.y=st}get z(){return this.position.z}set z(st){this.position.z=st}set({position:st=this.position,life:lt=this.life}={}){return this.position.copy(st),this.life=lt,this}reset({position:st,life:lt}={}){return this.set({position:st,life:lt}),this.currentLife=this.life,this.dead=!1,this}copy(st){this.position.copy(st.position),this.velocity.copy(st.velocity),this.life=st.life,this.currentLife=st.currentLife,this.dead=st.dead}update(){return this.dead?this:(this.position.add(this.velocity),this.currentLife--,1>this.currentLife&&(this.dead=!0),this)}}const We=1e3;let Xe;(function(){let st=document.createElement("canvas");st.width=64,st.height=64;let lt=st.getContext("2d"),dt=lt.createRadialGradient(32,32,32,32,32,0);dt.addColorStop(0,"rgba(255, 255, 255, 0)"),dt.addColorStop(.25,"rgba(255, 255, 255, 1)"),lt.fillStyle=dt,lt.fillRect(0,0,64,64),Xe=new le(st),Xe.needsUpdate=!0})();class je extends K{constructor({color:st}){super(),this.particle=new ke,this.particle.dead=!0;let lt=new Float32Array(3*We),dt=new Float32Array(3*We),ct=new ge;for(let mt=0;mt<We;mt++)ct.set(20*Math.random()-10,20*Math.random()-10,20*Math.random()-10),ct.normalize(),ct.multiplyScalar(.5+.5*Math.random()),lt[3*mt]=ct.x,lt[3*mt+1]=ct.y,lt[3*mt+2]=ct.z,dt[mt]=.5+.5*Math.random();let ut=new F;ut.addAttribute("position",new G(lt,3)),ut.addAttribute("vertexOpacity",new G(dt,1)),this.points=new ee(ut,new Ve({type:"points",transparent:!0,blending:C,depthTest:!1,depthWrite:!1,uniforms:{diffuse:new H(st),size:30,opacity:1,map:Xe},vertexShaderChunks:new Map([["start",`
          #define USE_SIZEATTENUATION

          varying vec3 vPosition;
          varying vec3 vInitialPosition;
          varying float vVertexOpacity;

          uniform vec3 head;
          uniform vec3 tail;
          uniform float explosion;

          attribute float vertexOpacity;
        `],["main",`
            vec3 position = position;
            vInitialPosition = position;
            vVertexOpacity = vertexOpacity;

            vec3 trailPosition = tail + (head - tail) * length(position) + position * .01;
            trailPosition.x += cos(trailPosition.y * 10.) * .01;
            trailPosition.z += sin(trailPosition.y * 10.) * .01;

            vec3 explosionPosition = tail + distance(head, tail) * position * .5;

            position = mix(trailPosition, explosionPosition, explosion);

            vPosition = position;
          `]]),fragmentShaderChunks:new Map([["start",`
          varying vec3 vPosition;
          varying vec3 vInitialPosition;
          varying float vVertexOpacity;

          uniform vec3 head;
          uniform vec3 tail;
          uniform float explosion;
        `],["main",`
            vec3 position = vPosition;

            float opacity = opacity;
            opacity *= smoothstep(0., mix(4., .5, explosion), distance(head, tail));
            opacity *= vVertexOpacity;
            opacity *= mix(1., .8 + ((cos((vPosition.y + length(vInitialPosition)) * 200.) + 1.) * .5) * .2, explosion);

            vec3 diffuse = diffuse;
            diffuse += .5 * mix(0., 1. - smoothstep(0., 4., distance(head, tail)), explosion);
            diffuse += mix(0., ((cos((vPosition.y + length(vInitialPosition)) * 100.) + 1.) * .5) * .5, explosion);
          `]])})),this.points.frustumCulled=!1,this.add(this.points)}reset(){this.points.material.explosion=0,this.particle.dead=!0,this.particle.position.set({x:0,y:0,z:0}),this.particle.velocity.set(0,0,0),this.points.material.head.set(0,0,0),this.points.material.tail.set(0,0,0)}launch(){this.reset(),this.points.material.explosion=0,this.particle.position.set(0,0,0),this.particle.velocity.set(.05*(Math.random()-.5),.07+.03*Math.random(),.05*(Math.random()-.5)),this.particle.dead=!1}explode(){this.points.material.explosion=1,this.particle.velocity.set(0,0,.05+.1*Math.random()),this.particle.dead=!1}update(){this.particle.dead||(this.particle.velocity.y-=this.points.material.explosion?1e-4:.001),this.particle.update(),!this.points.material.explosion&&0>this.particle.velocity.y&&(this.particle.dead=!0,.01>this.points.material.tail.distanceTo(this.particle)&&this.explode()),this.points.material.head.copy(this.particle),this.points.material.explosion?this.points.material.tail.y+=.01*(this.particle.y-this.points.material.tail.y):this.points.material.tail.lerp(this.particle,.2*(1-this.particle.velocity.y/.1))}}const Ye=["#ff4700","#c700e0","#665dff","#0c00ff","#ffffff"];class qe extends K{constructor({autoLaunch:st=!0}={}){super(),this.fireworks=[];for(let lt=0;200>lt;lt++){let dt=new je({color:Ye[lt%Ye.length]});this.fireworks.push(dt),this.add(dt)}st&&this.launch()}reset(){for(let st of this.fireworks)st.reset()}launch(){for(let st of this.fireworks)st.position.set(10*Math.random()-5,-3,0),st.reset(),setTimeout(()=>{st.launch()},3e3*Math.random())}launchFireworkAt(st,lt){let dt=this.fireworks[0];this.fireworks.push(this.fireworks.shift()),dt.position.set(st,lt,0),dt.launch()}update(){for(let st of this.fireworks)st.update()}}let Ze=new Set,Ke=new Ae,Qe=new Ae;class Je{static get LEFT(){return 37}static get RIGHT(){return 39}static get UP(){return 38}static get DOWN(){return 40}static get SPACE(){return 32}static get SHIFT(){return 16}static hasKeyDown(st){return Ze.has(st)}static addEventListener(st,lt){"keydown"===st?Ke.add(lt):"keyup"==st&&Qe.add(lt)}static removeEventListener(st,lt){"keydown"===st?Ke.remove(lt):"keyup"==st&&Qe.remove(lt)}}window.addEventListener("keydown",st=>{Je.hasKeyDown(st.keyCode)||Ke.dispatch(st),Ze.add(st.keyCode)}),window.addEventListener("keyup",st=>{Ze.delete(st.keyCode),Qe.dispatch(st)});class $e extends ie{constructor({canvas:st}){super(),this.camera=new J(65,window.innerWidth/window.innerHeight,0.1,1e4),this.controls=new He(this.camera,{distance:5,domElement:st}),this.pointer=Ge.get(st),this.fireworks=new qe({autoLaunch:!1}),this.add(this.fireworks),Je.addEventListener("keyup",lt=>{lt.keyCode===Je.SPACE&&this.fireworks.reset()})}resize(st,lt){this.camera.aspect=st/lt,this.camera.updateProjectionMatrix()}update(){this.controls.update(),this.pointer.velocity.size&&this.fireworks.launchFireworkAt(.0075*this.pointer.centeredFlippedY.x,.008*this.pointer.centeredFlippedY.y),this.fireworks.update()}}// From https://github.com/mattdesl/glsl-fxaa
class et{static vertex(){return`
      varying vec2 v_rgbNW;
      varying vec2 v_rgbNE;
      varying vec2 v_rgbSW;
      varying vec2 v_rgbSE;
      varying vec2 v_rgbM;

      void computeFXAATextureCoordinates(vec2 uv, vec2 resolution) {
        vec2 inverseVP = 1.0 / resolution.xy;
        vec2 fragCoord = uv * resolution;
        v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
        v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
        v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
        v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
        v_rgbM = vec2(fragCoord * inverseVP);
      }
    `}static fragment(){return`
      varying vec2 v_rgbNW;
      varying vec2 v_rgbNE;
      varying vec2 v_rgbSW;
      varying vec2 v_rgbSE;
      varying vec2 v_rgbM;

      #ifndef FXAA_REDUCE_MIN
      #define FXAA_REDUCE_MIN   (1.0/ 128.0)
      #endif
      #ifndef FXAA_REDUCE_MUL
      #define FXAA_REDUCE_MUL   (1.0 / 8.0)
      #endif
      #ifndef FXAA_SPAN_MAX
      #define FXAA_SPAN_MAX     8.0
      #endif

      vec4 fxaa(sampler2D tex, vec2 uv, vec2 resolution) {
        vec4 color;
        vec2 fragCoord = uv * resolution;
        mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);
        vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
        vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
        vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
        vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
        vec4 texColor = texture2D(tex, v_rgbM);
        vec3 rgbM  = texColor.xyz;
        vec3 luma = vec3(0.299, 0.587, 0.114);
        float lumaNW = dot(rgbNW, luma);
        float lumaNE = dot(rgbNE, luma);
        float lumaSW = dot(rgbSW, luma);
        float lumaSE = dot(rgbSE, luma);
        float lumaM  = dot(rgbM,  luma);
        float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
        float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

        mediump vec2 dir;
        dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
        dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

        float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

        float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
        dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
        max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
        dir * rcpDirMin)) * inverseVP;

        vec3 rgbA = 0.5 * (
        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
        vec3 rgbB = rgbA * 0.5 + 0.25 * (
          texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
          texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

        float lumaB = dot(rgbB, luma);
        if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
        else
        color = vec4(rgbB, texColor.a);
        return color;
      }
    `}}class tt extends xe{constructor(st){super(st),this.filters=[],this.renderTargetIn=new ye(this.domElement.width,this.domElement.height,{format:oe,minFilter:W,magFilter:W,stencilBuffer:!1}),this.renderTargetIn.texture.generateMipmaps=!1,this.renderTargetOut=this.renderTargetIn.clone(),this.renderTargetOut.texture.generateMipmaps=!1,this.context.getExtension("WEBGL_depth_texture")&&(this.renderTargetIn.depthTexture=new V,this.renderTargetIn.depthTexture.type=ue,this.renderTargetOut.depthTexture=new V,this.renderTargetOut.depthTexture.type=ue),this.scene=new ie,this.scene.camera=new Q(-1,1,1,-1,0,1),this._quad=new Z(new $(2,2)),this._quad.frustumCulled=!1,this.scene.add(this._quad),this._render=this.render,delete this.render}applyFilter(st,lt){this._quad.material=st,st.texture&&(st.texture=this.renderTargetIn.texture),st.depthTexture&&this.renderTargetIn.depthTexture&&(st.depthTexture=this.renderTargetIn.depthTexture),this._render(this.scene,this.scene.camera,lt),[this.renderTargetIn,this.renderTargetOut]=[this.renderTargetOut,this.renderTargetIn]}resize(st,lt){this.setSize(st,lt,!1),this.renderTargetIn.setSize(st,lt),this.renderTargetOut.setSize(st,lt)}render(st,lt){if(!lt&&this.filters.length){this._render(st,st.camera,this.renderTargetIn);for(let[dt,ct]of this.filters.entries())this.applyFilter(ct,dt<this.filters.length-1?this.renderTargetOut:void 0);this._render(this.scene,this.scene.camera)}else this._render(st,st.camera,lt),lt===this.renderTargetOut&&([this.renderTargetIn,this.renderTargetOut]=[this.renderTargetOut,this.renderTargetIn])}}const rt=new Me(window.navigator.userAgent);let at=!!rt.mobile()||/\bmobile\b/.test(window.location.search);class ot{static get mobile(){return at}}class it extends tt{constructor(st){super(Object.assign({antialias:!0},st)),this.setClearColor("#0e1430",1),this.context.getContextAttributes().antialias||ot.mobile||this.filters.push(this.fxaaFilter=new Ve({vertexShader:`
        uniform vec2 resolution;
        varying vec2 vUv;
        ${et.vertex()}
        void main() {
          computeFXAATextureCoordinates(uv, resolution);
          vUv = uv;
          gl_Position = vec4(position, 1.);
        }
        `,fragmentShader:`
        uniform vec2 resolution;
        uniform sampler2D texture;
        varying vec2 vUv;
        ${et.fragment()}
        void main() {
          gl_FragColor = fxaa(texture, vUv, resolution);
        }
        `}))}resize(st,lt){st*=window.devicePixelRatio,lt*=window.devicePixelRatio,super.resize(st,lt),this.fxaaFilter&&this.fxaaFilter.resolution.set(st,lt)}}class nt extends Le{constructor(){super({background:!0}),this.innerHTML="<canvas></canvas>",this.canvas=this.querySelector("canvas"),this.canvas.style.cursor="move",this.canvas.style.width="100%",this.canvas.style.height="100%",this.renderer=new it({canvas:this.canvas}),this.scene=new $e({canvas:this.canvas})}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.resize.bind(this)),this.resize()}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("resize",this.resize.bind(this))}resize(){let st=this.canvas.offsetWidth,lt=this.canvas.offsetHeight;this.scene.resize(st,lt),this.renderer.resize(st,lt),this.renderer.render(this.scene)}update(){super.update(),this.scene.update(),this.renderer.render(this.scene)}}Ce.onLoad.then(()=>{window.customElements.define("christmasxp-fireworks",nt)})}}})})(function(E){"function"==typeof define&&define.amd?define([],E):"object"==typeof module&&module.exports&&"function"==typeof require?module.exports=E():E()});
